# KeyPath CLI (One‑Shot Commands)

A minimal command‑line utility for quick, scripted key mapping tasks.

## Install / Build

- Build via SwiftPM: `swift build -c release --product keypath`
- Run in place: `.build/arm64-apple-macosx/release/keypath --help`

## Usage

- Create/replace a mapping and reload:
  - `keypath map --from caps --to esc`
- Append (merge) a mapping and reload:
  - `keypath map --from caps --to cmd+c --append`
- List current mappings (best‑effort for configs generated by KeyPath/CLI):
  - `keypath list`
- Reload (live, like the GUI):
  - `keypath reload` (tries TCP hot‑reload first; falls back to `launchctl`)

Notes
- Config path: `~/.config/keypath/keypath.kbd`
- Live reload: the CLI sends a TCP `{"Reload":{}}` to the local Kanata server (same as the app). If TCP isn’t enabled or reachable, it falls back to `launchctl kickstart -k system/com.keypath.kanata` (may require `sudo`).
- Audio feedback: matches the GUI — Tink on save, Glass on successful reload, system beep on failure.
- Supported key names include common aliases: `caps|capslock`, `esc|escape`, `space|spacebar`, `return|enter`, `ctrl|control`, `cmd|command`, and simple chords like `cmd+c`.

## Design

- No external dependencies; simple `CommandLine.arguments` parsing.
- Generates the same `defsrc/deflayer` structure used by the app for compatibility.
- Non‑destructive: `--append` merges by input key (replaces if the input already exists).
- Sounds use `/usr/bin/afplay` with system sound files (no AppKit), with an `osascript -e 'beep'` fallback.
