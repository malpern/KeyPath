Test Suite 'All tests' started at 2025-11-22 13:35:46.217.
Test Suite 'KeyPathPackageTests.xctest' started at 2025-11-22 13:35:46.218.
Test Suite 'AuthorizationServicesSmokeTests' started at 2025-11-22 13:35:46.218.
Test Case '-[KeyPathTests.AuthorizationServicesSmokeTests testAuthorizationServicesInstallationCreatesPlistsAndBootstraps]' started.
[2025-11-22 13:35:46.221] [INFO] [LaunchDaemonInstaller.swift:312 createAllLaunchDaemonServices()] ğŸ”§ [LaunchDaemon] Creating all LaunchDaemon services
[2025-11-22 13:35:46.222] [INFO] [ConfigurationService.swift:483 createInitialConfigIfNeeded()] âœ… [ConfigService] Config directory created at /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/auth-smoke-7A9F61D6-FF6B-4C41-BDA6-11359C624410/Users/malpern/.config/keypath
[2025-11-22 13:35:46.222] [INFO] [ConfigurationService.swift:488 createInitialConfigIfNeeded()] âš ï¸ [ConfigService] No existing config found at /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/auth-smoke-7A9F61D6-FF6B-4C41-BDA6-11359C624410/Users/malpern/.config/keypath/keypath.kbd
[2025-11-22 13:35:46.222] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:35:46.222] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:35:46.222] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 725 characters
[2025-11-22 13:35:46.222] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:35:46.222] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 10 src keys, 10 layer keys, deduplicated to 10 unique mappings
[2025-11-22 13:35:46.222] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:35:46.222] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:35:46.222] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 0 mappings
[2025-11-22 13:35:46.222] [INFO] [ConfigurationService.swift:492 createInitialConfigIfNeeded()] âœ… [ConfigService] Created initial empty configuration
[2025-11-22 13:35:46.222] [INFO] [LaunchDaemonInstaller.swift:945 ensureDefaultUserConfigExists()] âœ… [LaunchDaemon] Created default user config at /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/auth-smoke-7A9F61D6-FF6B-4C41-BDA6-11359C624410/Users/malpern/.config/keypath/keypath.kbd
[2025-11-22 13:35:46.222] [INFO] [LaunchDaemonInstaller.swift:229 getKanataBinaryPath()] âš ï¸ [LaunchDaemon] System kanata not found, using bundled path: /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/auth-smoke-7A9F61D6-FF6B-4C41-BDA6-11359C624410/bundled-kanata
[2025-11-22 13:35:46.222] [INFO] [LaunchDaemonInstaller.swift:2689 buildKanataPlistArguments(binaryPath:)] ğŸ“¡ [LaunchDaemon] TCP server enabled on port 45000
[2025-11-22 13:35:46.222] [INFO] [LaunchDaemonInstaller.swift:2705 buildKanataPlistArguments(binaryPath:)] ğŸ”§ [LaunchDaemon] Built plist arguments: /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/auth-smoke-7A9F61D6-FF6B-4C41-BDA6-11359C624410/bundled-kanata --cfg /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/auth-smoke-7A9F61D6-FF6B-4C41-BDA6-11359C624410/Users/malpern/.config/keypath/keypath.kbd --port 45000 --debug --log-layer-changes
[2025-11-22 13:35:46.223] [INFO] [LaunchDaemonInstaller.swift:1214 executeConsolidatedInstallationWithAuthServices(kanataTemp:vhidDaemonTemp:vhidManagerTemp:)] ğŸ”§ [LaunchDaemon] Starting consolidated installation with Authorization Services
[2025-11-22 13:35:46.223] [INFO] [LaunchDaemonInstaller.swift:1216 executeConsolidatedInstallationWithAuthServices(kanataTemp:vhidDaemonTemp:vhidManagerTemp:)] ğŸ”§ [LaunchDaemon] This approach bypasses osascript sandbox restrictions
[2025-11-22 13:35:46.796] [INFO] [LaunchDaemonInstaller.swift:1322 executeConsolidatedInstallationWithAuthServices(kanataTemp:vhidDaemonTemp:vhidManagerTemp:)] âœ… [LaunchDaemon] Authorization Services installation completed successfully
Test Case '-[KeyPathTests.AuthorizationServicesSmokeTests testAuthorizationServicesInstallationCreatesPlistsAndBootstraps]' passed (0.581 seconds).
Test Suite 'AuthorizationServicesSmokeTests' passed at 2025-11-22 13:35:46.799.
	 Executed 1 test, with 0 failures (0 unexpected) in 0.581 (0.581) seconds
Test Suite 'ConfigApplyTypesTests' started at 2025-11-22 13:35:46.799.
Test Case '-[KeyPathTests.ConfigApplyTypesTests testApplyResultInitConvenience]' started.
Test Case '-[KeyPathTests.ConfigApplyTypesTests testApplyResultInitConvenience]' passed (0.000 seconds).
Test Case '-[KeyPathTests.ConfigApplyTypesTests testConfigDiagnosticsInit]' started.
Test Case '-[KeyPathTests.ConfigApplyTypesTests testConfigDiagnosticsInit]' passed (0.000 seconds).
Test Case '-[KeyPathTests.ConfigApplyTypesTests testConfigEditCommandEquatable]' started.
Test Case '-[KeyPathTests.ConfigApplyTypesTests testConfigEditCommandEquatable]' passed (0.000 seconds).
Test Case '-[KeyPathTests.ConfigApplyTypesTests testConfigErrorEquality]' started.
Test Case '-[KeyPathTests.ConfigApplyTypesTests testConfigErrorEquality]' passed (0.000 seconds).
Test Case '-[KeyPathTests.ConfigApplyTypesTests testFeatureFlagDefaultsOff]' started.
Test Case '-[KeyPathTests.ConfigApplyTypesTests testFeatureFlagDefaultsOff]' passed (0.000 seconds).
Test Suite 'ConfigApplyTypesTests' passed at 2025-11-22 13:35:46.800.
	 Executed 5 tests, with 0 failures (0 unexpected) in 0.001 (0.001) seconds
Test Suite 'ConfigFileWatcherTests' started at 2025-11-22 13:35:46.800.
Test Case '-[KeyPathTests.ConfigFileWatcherTests testDebouncePreventsMultipleCallbacks]' started.
[2025-11-22 13:35:46.801] [INFO] [ConfigFileWatcher.swift:40 init()] ğŸ“ [FileWatcher] ConfigFileWatcher initialized with robust monitoring
[2025-11-22 13:35:46.801] [INFO] [ConfigFileWatcher.swift:80 startWatching(path:onChange:)] ğŸ“ [FileWatcher] Starting to watch file: /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/06179561-C7D4-4639-B13A-93CF7ABDF830/config.kbd
[2025-11-22 13:35:46.801] [INFO] [ConfigFileWatcher.swift:81 startWatching(path:onChange:)] ğŸ“ [FileWatcher] Parent directory: /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/06179561-C7D4-4639-B13A-93CF7ABDF830
[2025-11-22 13:35:46.801] [INFO] [ConfigFileWatcher.swift:85 startWatching(path:onChange:)] ğŸ“ [FileWatcher] Target file exists - setting up direct file monitoring
[2025-11-22 13:35:46.801] [INFO] [ConfigFileWatcher.swift:434 updateLastModificationDate()] ğŸ“ [FileWatcher] Updated last modification date: 2025-11-22 21:35:46 +0000
[2025-11-22 13:35:46.801] [INFO] [ConfigFileWatcher.swift:414 openFileDescriptor(at:)] ğŸ“ [FileWatcher] Successfully opened file descriptor 5 for: /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/06179561-C7D4-4639-B13A-93CF7ABDF830/config.kbd
[2025-11-22 13:35:46.801] [INFO] [ConfigFileWatcher.swift:114 setupFileMonitoring()] ğŸ“ [FileWatcher] Successfully opened file descriptor 5 for: /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/06179561-C7D4-4639-B13A-93CF7ABDF830/config.kbd
[2025-11-22 13:35:46.802] [INFO] [ConfigFileWatcher.swift:146 setupFileMonitoring()] âœ… [FileWatcher] Successfully started file monitoring for: /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/06179561-C7D4-4639-B13A-93CF7ABDF830/config.kbd
[2025-11-22 13:35:46.802] [INFO] [ConfigFileWatcher.swift:129 setupFileMonitoring()] ğŸ“ [FileWatcher] File system event received - flags: FileSystemEvent(rawValue: 1)
[2025-11-22 13:35:46.802] [INFO] [ConfigFileWatcher.swift:270 handleFileEvent(flags:)] ğŸ“ [FileWatcher] Detected atomic write (rename/delete) - rebinding file descriptor
[2025-11-22 13:35:46.802] [INFO] [ConfigFileWatcher.swift:282 rebindFileMonitor(to:)] ğŸ”„ [FileWatcher] Rebinding file monitor to: /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/06179561-C7D4-4639-B13A-93CF7ABDF830/config.kbd
[2025-11-22 13:35:46.802] [INFO] [ConfigFileWatcher.swift:331 handleFileChangeEvent()] ğŸ“ [FileWatcher] Processing file change event for: /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/06179561-C7D4-4639-B13A-93CF7ABDF830/config.kbd
[2025-11-22 13:35:46.802] [INFO] [ConfigFileWatcher.swift:137 setupFileMonitoring()] ğŸ“ [FileWatcher] Closing file descriptor 5
[2025-11-22 13:35:46.861] [INFO] [ConfigFileWatcher.swift:434 updateLastModificationDate()] ğŸ“ [FileWatcher] Updated last modification date: 2025-11-22 21:35:46 +0000
[2025-11-22 13:35:46.862] [INFO] [ConfigFileWatcher.swift:414 openFileDescriptor(at:)] ğŸ“ [FileWatcher] Successfully opened file descriptor 6 for: /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/06179561-C7D4-4639-B13A-93CF7ABDF830/config.kbd
[2025-11-22 13:35:46.862] [INFO] [ConfigFileWatcher.swift:114 setupFileMonitoring()] ğŸ“ [FileWatcher] Successfully opened file descriptor 6 for: /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/06179561-C7D4-4639-B13A-93CF7ABDF830/config.kbd
[2025-11-22 13:35:46.862] [INFO] [ConfigFileWatcher.swift:146 setupFileMonitoring()] âœ… [FileWatcher] Successfully started file monitoring for: /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/06179561-C7D4-4639-B13A-93CF7ABDF830/config.kbd
[2025-11-22 13:35:47.346] [INFO] [ConfigFileWatcher.swift:489 processFileChange()] ğŸ“ [FileWatcher] Processing debounced file change for: /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/06179561-C7D4-4639-B13A-93CF7ABDF830/config.kbd
[2025-11-22 13:35:47.347] [INFO] [ConfigFileWatcher.swift:505 processFileChange()] ğŸ“ [FileWatcher] Atomic write detected - forcing change callback
[2025-11-22 13:35:47.347] [INFO] [ConfigFileWatcher.swift:518 processFileChange()] ğŸ“ [FileWatcher] Triggering file change callback for file (5 bytes)
[2025-11-22 13:35:47.347] [INFO] [ConfigFileWatcher.swift:529 processFileChange()] âœ… [FileWatcher] File change callback completed
[2025-11-22 13:35:47.347] [INFO] [ConfigFileWatcher.swift:208 stopWatching()] ğŸ“ [FileWatcher] Stopping all monitoring...
[2025-11-22 13:35:47.348] [INFO] [ConfigFileWatcher.swift:216 stopWatching()] ğŸ“ [FileWatcher] Stopping file monitoring
[2025-11-22 13:35:47.348] [INFO] [ConfigFileWatcher.swift:237 stopWatching()] âœ… [FileWatcher] All monitoring stopped and state cleared
[2025-11-22 13:35:47.348] [INFO] [ConfigFileWatcher.swift:208 stopWatching()] ğŸ“ [FileWatcher] Stopping all monitoring...
[2025-11-22 13:35:47.348] [INFO] [ConfigFileWatcher.swift:237 stopWatching()] âœ… [FileWatcher] All monitoring stopped and state cleared
[2025-11-22 13:35:47.348] [INFO] [ConfigFileWatcher.swift:45 deinit] ğŸ“ [FileWatcher] ConfigFileWatcher deinitialized
[2025-11-22 13:35:47.348] [INFO] [ConfigFileWatcher.swift:137 setupFileMonitoring()] ğŸ“ [FileWatcher] Closing file descriptor 6
Test Case '-[KeyPathTests.ConfigFileWatcherTests testDebouncePreventsMultipleCallbacks]' passed (0.548 seconds).
Test Suite 'ConfigFileWatcherTests' passed at 2025-11-22 13:35:47.348.
	 Executed 1 test, with 0 failures (0 unexpected) in 0.548 (0.548) seconds
Test Suite 'ConfigurationServiceTests' started at 2025-11-22 13:35:47.348.
Test Case '-[KeyPathTests.ConfigurationServiceTests testBackupFailedConfigAndApplySafe]' started.
[2025-11-22 13:35:47.349] [INFO] [ConfigurationService.swift:757 backupFailedConfigAndApplySafe(failedConfig:mappings:)] ğŸ›¡ï¸ [Config] Backing up failed config and applying safe default
[2025-11-22 13:35:47.351] [INFO] [ConfigurationService.swift:782 backupFailedConfigAndApplySafe(failedConfig:mappings:)] ğŸ’¾ [Config] Failed config backed up to: /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/KeyPathConfigTests_AFDC32C1-7A3D-4544-B867-57DE306CAE7C/backups/failed_config_2025-11-22_13-35-47.kbd
[2025-11-22 13:35:47.352] [INFO] [ConfigurationService.swift:790 backupFailedConfigAndApplySafe(failedConfig:mappings:)] âœ… [Config] Safe default config applied
Test Case '-[KeyPathTests.ConfigurationServiceTests testBackupFailedConfigAndApplySafe]' passed (0.005 seconds).
Test Case '-[KeyPathTests.ConfigurationServiceTests testBackupFailedConfigAppliesSafeDefaults]' started.
[2025-11-22 13:35:47.355] [INFO] [ConfigurationService.swift:757 backupFailedConfigAndApplySafe(failedConfig:mappings:)] ğŸ›¡ï¸ [Config] Backing up failed config and applying safe default
[2025-11-22 13:35:47.356] [INFO] [ConfigurationService.swift:782 backupFailedConfigAndApplySafe(failedConfig:mappings:)] ğŸ’¾ [Config] Failed config backed up to: /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/KeyPathConfigTests_E260F3E4-5BDF-4377-9F85-D38E98EF8779/backups/failed_config_2025-11-22_13-35-47.kbd
[2025-11-22 13:35:47.358] [INFO] [ConfigurationService.swift:790 backupFailedConfigAndApplySafe(failedConfig:mappings:)] âœ… [Config] Safe default config applied
Test Case '-[KeyPathTests.ConfigurationServiceTests testBackupFailedConfigAppliesSafeDefaults]' passed (0.005 seconds).
Test Case '-[KeyPathTests.ConfigurationServiceTests testConvertToKanataKey_CaseInsensitive]' started.
Test Case '-[KeyPathTests.ConfigurationServiceTests testConvertToKanataKey_CaseInsensitive]' passed (0.000 seconds).
Test Case '-[KeyPathTests.ConfigurationServiceTests testConvertToKanataKey_ModifierKeys]' started.
Test Case '-[KeyPathTests.ConfigurationServiceTests testConvertToKanataKey_ModifierKeys]' passed (0.000 seconds).
Test Case '-[KeyPathTests.ConfigurationServiceTests testConvertToKanataKey_StandardKeys]' started.
Test Case '-[KeyPathTests.ConfigurationServiceTests testConvertToKanataKey_StandardKeys]' passed (0.000 seconds).
Test Case '-[KeyPathTests.ConfigurationServiceTests testConvertToKanataSequence_KeyNameNotMacro]' started.
Test Case '-[KeyPathTests.ConfigurationServiceTests testConvertToKanataSequence_KeyNameNotMacro]' passed (0.000 seconds).
Test Case '-[KeyPathTests.ConfigurationServiceTests testConvertToKanataSequence_MultipleKeys]' started.
Test Case '-[KeyPathTests.ConfigurationServiceTests testConvertToKanataSequence_MultipleKeys]' passed (0.000 seconds).
Test Case '-[KeyPathTests.ConfigurationServiceTests testConvertToKanataSequence_SingleKey]' started.
Test Case '-[KeyPathTests.ConfigurationServiceTests testConvertToKanataSequence_SingleKey]' passed (0.000 seconds).
Test Case '-[KeyPathTests.ConfigurationServiceTests testConvertToKanataSequence_SingleKeyVariants]' started.
Test Case '-[KeyPathTests.ConfigurationServiceTests testConvertToKanataSequence_SingleKeyVariants]' passed (0.000 seconds).
Test Case '-[KeyPathTests.ConfigurationServiceTests testConvertToKanataSequence_SingleLongKey]' started.
Test Case '-[KeyPathTests.ConfigurationServiceTests testConvertToKanataSequence_SingleLongKey]' passed (0.000 seconds).
Test Case '-[KeyPathTests.ConfigurationServiceTests testConvertToKanataSequence_TextMacro_Letters]' started.
Test Case '-[KeyPathTests.ConfigurationServiceTests testConvertToKanataSequence_TextMacro_Letters]' passed (0.000 seconds).
Test Case '-[KeyPathTests.ConfigurationServiceTests testConvertToKanataSequence_TextMacro_Numbers]' started.
Test Case '-[KeyPathTests.ConfigurationServiceTests testConvertToKanataSequence_TextMacro_Numbers]' passed (0.000 seconds).
Test Case '-[KeyPathTests.ConfigurationServiceTests testCreateInitialConfigWritesDefaultFile]' started.
[2025-11-22 13:35:47.364] [INFO] [ConfigurationService.swift:483 createInitialConfigIfNeeded()] âœ… [ConfigService] Config directory created at /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/KeyPathConfigTests_89729638-E764-439A-AB71-A577552C8D36
[2025-11-22 13:35:47.364] [INFO] [ConfigurationService.swift:488 createInitialConfigIfNeeded()] âš ï¸ [ConfigService] No existing config found at /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/KeyPathConfigTests_89729638-E764-439A-AB71-A577552C8D36/keypath.kbd
[2025-11-22 13:35:47.365] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:35:47.365] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:35:47.365] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 725 characters
[2025-11-22 13:35:47.365] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:35:47.365] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 10 src keys, 10 layer keys, deduplicated to 10 unique mappings
[2025-11-22 13:35:47.365] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:35:47.365] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:35:47.366] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 0 mappings
[2025-11-22 13:35:47.366] [INFO] [ConfigurationService.swift:492 createInitialConfigIfNeeded()] âœ… [ConfigService] Created initial empty configuration
Test Case '-[KeyPathTests.ConfigurationServiceTests testCreateInitialConfigWritesDefaultFile]' passed (0.003 seconds).
Test Case '-[KeyPathTests.ConfigurationServiceTests testDisablingMacFunctionKeysRemovesSpecialMappings]' started.
Test Case '-[KeyPathTests.ConfigurationServiceTests testDisablingMacFunctionKeysRemovesSpecialMappings]' passed (0.001 seconds).
Test Case '-[KeyPathTests.ConfigurationServiceTests testGeneratedConfigHasNoInvalidParentheses]' started.
Test Case '-[KeyPathTests.ConfigurationServiceTests testGeneratedConfigHasNoInvalidParentheses]' passed (0.001 seconds).
Test Case '-[KeyPathTests.ConfigurationServiceTests testGeneratedConfigWithTextMacro]' started.
Test Case '-[KeyPathTests.ConfigurationServiceTests testGeneratedConfigWithTextMacro]' passed (0.000 seconds).
Test Case '-[KeyPathTests.ConfigurationServiceTests testGenerateFromMappings_EmptyMappings]' started.
Test Case '-[KeyPathTests.ConfigurationServiceTests testGenerateFromMappings_EmptyMappings]' passed (0.000 seconds).
Test Case '-[KeyPathTests.ConfigurationServiceTests testGenerateFromMappings_MultipleMappings]' started.
Test Case '-[KeyPathTests.ConfigurationServiceTests testGenerateFromMappings_MultipleMappings]' passed (0.000 seconds).
Test Case '-[KeyPathTests.ConfigurationServiceTests testGenerateFromMappings_SingleMapping]' started.
Test Case '-[KeyPathTests.ConfigurationServiceTests testGenerateFromMappings_SingleMapping]' passed (0.001 seconds).
Test Case '-[KeyPathTests.ConfigurationServiceTests testGenerateFromMappings_UsesSingleDefsrcAndDeflayer]' started.
Test Case '-[KeyPathTests.ConfigurationServiceTests testGenerateFromMappings_UsesSingleDefsrcAndDeflayer]' passed (0.000 seconds).
Test Case '-[KeyPathTests.ConfigurationServiceTests testNavigationCollectionProducesSeparateLayerAndAlias]' started.
Test Case '-[KeyPathTests.ConfigurationServiceTests testNavigationCollectionProducesSeparateLayerAndAlias]' passed (0.001 seconds).
Test Case '-[KeyPathTests.ConfigurationServiceTests testObserverFiresOnMainActor_OnReload]' started.
[2025-11-22 13:35:47.373] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 0 src keys, 0 layer keys, deduplicated to 0 unique mappings
Test Case '-[KeyPathTests.ConfigurationServiceTests testObserverFiresOnMainActor_OnReload]' passed (0.002 seconds).
Test Case '-[KeyPathTests.ConfigurationServiceTests testObserverFiresOnMainActor_OnSave]' started.
[2025-11-22 13:35:47.374] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:35:47.374] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:35:47.374] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 1068 characters
[2025-11-22 13:35:47.374] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:35:47.374] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 11 src keys, 11 layer keys, deduplicated to 11 unique mappings
[2025-11-22 13:35:47.374] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:35:47.374] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:35:47.375] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 1 mappings
Test Case '-[KeyPathTests.ConfigurationServiceTests testObserverFiresOnMainActor_OnSave]' passed (0.002 seconds).
Test Case '-[KeyPathTests.ConfigurationServiceTests testParseConfigurationFromString_Deduplication]' started.
[2025-11-22 13:35:47.375] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 3 src keys, 3 layer keys, deduplicated to 2 unique mappings
Test Case '-[KeyPathTests.ConfigurationServiceTests testParseConfigurationFromString_Deduplication]' passed (0.000 seconds).
Test Case '-[KeyPathTests.ConfigurationServiceTests testParseConfigurationFromString_ValidConfig]' started.
[2025-11-22 13:35:47.376] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 3 src keys, 3 layer keys, deduplicated to 3 unique mappings
Test Case '-[KeyPathTests.ConfigurationServiceTests testParseConfigurationFromString_ValidConfig]' passed (0.000 seconds).
Test Case '-[KeyPathTests.ConfigurationServiceTests testParseConfigurationFromString_WithComments]' started.
[2025-11-22 13:35:47.376] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 1 src keys, 1 layer keys, deduplicated to 1 unique mappings
Test Case '-[KeyPathTests.ConfigurationServiceTests testParseConfigurationFromString_WithComments]' passed (0.001 seconds).
Test Case '-[KeyPathTests.ConfigurationServiceTests testParseKanataErrors_EmptyOutput]' started.
Test Case '-[KeyPathTests.ConfigurationServiceTests testParseKanataErrors_EmptyOutput]' passed (0.000 seconds).
Test Case '-[KeyPathTests.ConfigurationServiceTests testParseKanataErrors_NoErrorTags]' started.
Test Case '-[KeyPathTests.ConfigurationServiceTests testParseKanataErrors_NoErrorTags]' passed (0.000 seconds).
Test Case '-[KeyPathTests.ConfigurationServiceTests testParseKanataErrors_WithErrorTags]' started.
Test Case '-[KeyPathTests.ConfigurationServiceTests testParseKanataErrors_WithErrorTags]' passed (0.000 seconds).
Test Case '-[KeyPathTests.ConfigurationServiceTests testReloadCreatesDefaultConfigWhenMissing]' started.
[2025-11-22 13:35:47.378] [INFO] [ConfigurationService.swift:385 reload()] âš ï¸ [ConfigService] Config missing at /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/KeyPathConfigTests_C7ABEFA7-955A-4823-95B6-63C079E190C4/keypath.kbd â€“ creating default before reload
[2025-11-22 13:35:47.378] [INFO] [ConfigurationService.swift:483 createInitialConfigIfNeeded()] âœ… [ConfigService] Config directory created at /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/KeyPathConfigTests_C7ABEFA7-955A-4823-95B6-63C079E190C4
[2025-11-22 13:35:47.378] [INFO] [ConfigurationService.swift:488 createInitialConfigIfNeeded()] âš ï¸ [ConfigService] No existing config found at /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/KeyPathConfigTests_C7ABEFA7-955A-4823-95B6-63C079E190C4/keypath.kbd
[2025-11-22 13:35:47.379] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:35:47.379] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:35:47.379] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 725 characters
[2025-11-22 13:35:47.379] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:35:47.379] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 10 src keys, 10 layer keys, deduplicated to 10 unique mappings
[2025-11-22 13:35:47.379] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:35:47.379] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:35:47.379] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 0 mappings
[2025-11-22 13:35:47.379] [INFO] [ConfigurationService.swift:492 createInitialConfigIfNeeded()] âœ… [ConfigService] Created initial empty configuration
[2025-11-22 13:35:47.380] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 10 src keys, 10 layer keys, deduplicated to 10 unique mappings
Test Case '-[KeyPathTests.ConfigurationServiceTests testReloadCreatesDefaultConfigWhenMissing]' passed (0.002 seconds).
Test Case '-[KeyPathTests.ConfigurationServiceTests testRepairConfiguration_MismatchedLengths]' started.
[2025-11-22 13:35:47.380] [INFO] [ConfigurationService.swift:808 repairConfiguration(config:errors:mappings:)] ğŸ”§ [Config] Performing rule-based repair for 1 errors
Test Case '-[KeyPathTests.ConfigurationServiceTests testRepairConfiguration_MismatchedLengths]' passed (0.001 seconds).
Test Case '-[KeyPathTests.ConfigurationServiceTests testRepairConfiguration_MissingDefcfg]' started.
[2025-11-22 13:35:47.381] [INFO] [ConfigurationService.swift:808 repairConfiguration(config:errors:mappings:)] ğŸ”§ [Config] Performing rule-based repair for 1 errors
Test Case '-[KeyPathTests.ConfigurationServiceTests testRepairConfiguration_MissingDefcfg]' passed (0.000 seconds).
Test Case '-[KeyPathTests.ConfigurationServiceTests testRoundTrip_GenerateParseGenerate]' started.
[2025-11-22 13:35:47.382] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 12 src keys, 12 layer keys, deduplicated to 12 unique mappings
Test Case '-[KeyPathTests.ConfigurationServiceTests testRoundTrip_GenerateParseGenerate]' passed (0.001 seconds).
Test Case '-[KeyPathTests.ConfigurationServiceTests testSaveConfiguration_WithCustomRules]' started.
[2025-11-22 13:35:47.383] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:35:47.383] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:35:47.383] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 1442 characters
[2025-11-22 13:35:47.383] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:35:47.383] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 11 src keys, 11 layer keys, deduplicated to 11 unique mappings
[2025-11-22 13:35:47.383] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:35:47.383] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:35:47.383] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 2 mappings
Test Case '-[KeyPathTests.ConfigurationServiceTests testSaveConfiguration_WithCustomRules]' passed (0.001 seconds).
Test Case '-[KeyPathTests.ConfigurationServiceTests testSaveConfiguration_WithInputOutput]' started.
[2025-11-22 13:35:47.384] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:35:47.384] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:35:47.384] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 1063 characters
[2025-11-22 13:35:47.384] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:35:47.384] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 11 src keys, 11 layer keys, deduplicated to 11 unique mappings
[2025-11-22 13:35:47.384] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:35:47.384] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:35:47.384] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 1 mappings
Test Case '-[KeyPathTests.ConfigurationServiceTests testSaveConfiguration_WithInputOutput]' passed (0.001 seconds).
Test Case '-[KeyPathTests.ConfigurationServiceTests testSaveConfiguration_WithKeyMappings]' started.
[2025-11-22 13:35:47.385] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:35:47.385] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:35:47.385] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 1068 characters
[2025-11-22 13:35:47.385] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:35:47.385] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 11 src keys, 11 layer keys, deduplicated to 11 unique mappings
[2025-11-22 13:35:47.385] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:35:47.385] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:35:47.385] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 1 mappings
Test Case '-[KeyPathTests.ConfigurationServiceTests testSaveConfiguration_WithKeyMappings]' passed (0.001 seconds).
Test Case '-[KeyPathTests.ConfigurationServiceTests testSaveConfiguration_WithRuleCollections]' started.
[2025-11-22 13:35:47.386] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:35:47.386] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:35:47.386] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 1166 characters
[2025-11-22 13:35:47.386] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:35:47.386] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 11 src keys, 11 layer keys, deduplicated to 11 unique mappings
[2025-11-22 13:35:47.386] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:35:47.386] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:35:47.386] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 1 mappings
[2025-11-22 13:35:47.387] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 11 src keys, 11 layer keys, deduplicated to 11 unique mappings
Test Case '-[KeyPathTests.ConfigurationServiceTests testSaveConfiguration_WithRuleCollections]' passed (0.001 seconds).
Test Case '-[KeyPathTests.ConfigurationServiceTests testValidateConfigurationInTestModePasses]' started.
[2025-11-22 13:35:47.387] [INFO] [TestEnvironment.swift:82 forceTestMode] ğŸ§ª [TestEnvironment] Force test mode enabled
[2025-11-22 13:35:47.387] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:35:47.387] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 79 characters
[2025-11-22 13:35:47.388] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:35:47.388] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 1 src keys, 1 layer keys, deduplicated to 1 unique mappings
[2025-11-22 13:35:47.388] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
Test Case '-[KeyPathTests.ConfigurationServiceTests testValidateConfigurationInTestModePasses]' passed (0.001 seconds).
Test Case '-[KeyPathTests.ConfigurationServiceTests testValidateConfigurationInTestModeRejectsEmptyContent]' started.
[2025-11-22 13:35:47.388] [INFO] [TestEnvironment.swift:82 forceTestMode] ğŸ§ª [TestEnvironment] Force test mode enabled
[2025-11-22 13:35:47.388] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:35:47.388] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 3 characters
[2025-11-22 13:35:47.388] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:35:47.388] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
Test Case '-[KeyPathTests.ConfigurationServiceTests testValidateConfigurationInTestModeRejectsEmptyContent]' passed (0.001 seconds).
Test Case '-[KeyPathTests.ConfigurationServiceTests testValidateConfigViaFileSkipsBinaryInTestMode]' started.
[2025-11-22 13:35:47.389] [INFO] [TestEnvironment.swift:82 forceTestMode] ğŸ§ª [TestEnvironment] Force test mode enabled
[2025-11-22 13:35:47.389] [INFO] [ConfigurationService.swift:566 validateConfigViaFile()] âŒ [ConfigService] File validation skipped: Kanata binary missing at /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata
Test Case '-[KeyPathTests.ConfigurationServiceTests testValidateConfigViaFileSkipsBinaryInTestMode]' passed (0.000 seconds).
Test Suite 'ConfigurationServiceTests' passed at 2025-11-22 13:35:47.389.
	 Executed 40 tests, with 0 failures (0 unexpected) in 0.036 (0.041) seconds
Test Suite 'ContentViewDebounceTests' started at 2025-11-22 13:35:47.389.
Test Case '-[KeyPathTests.ContentViewDebounceTests testConfigurationSaveDebouncing]' started.
[2025-11-22 13:35:47.389] [INFO] [KanataManager.swift:325 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] init() called
[2025-11-22 13:35:47.389] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:35:47.389] [INFO] [ConfigFileWatcher.swift:40 init()] ğŸ“ [FileWatcher] ConfigFileWatcher initialized with robust monitoring
[2025-11-22 13:35:47.389] [INFO] [ServiceHealthMonitor.swift:140 init(processLifecycle:)] [HealthMonitor] Initialized with process lifecycle manager
[2025-11-22 13:35:47.390] [DEBUG] [KanataManager.swift:397 init(engineClient:injectedConfigurationService:)] ğŸ§ª [KanataManager] Skipping background initialization in test environment
[2025-11-22 13:35:47.390] [INFO] [KanataManager.swift:405 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] About to call bootstrapRuleCollections and startLayerMonitoring
[2025-11-22 13:35:47.390] [INFO] [KanataManager.swift:577 startLayerMonitoring()] ğŸŒ [KanataManager] startLayerMonitoring() called
[2025-11-22 13:35:47.390] [INFO] [KanataManager.swift:579 startLayerMonitoring()] ğŸŒ [KanataManager] Skipping layer monitoring (test environment)
[2025-11-22 13:35:47.390] [INFO] [KanataManager.swift:409 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] init() completed
[2025-11-22 13:35:47.390] [INFO] [ContentViewDebounceTests.swift:38 testConfigurationSaveDebouncing()] âœ… [Test] Configuration debouncing behavior verified
Test Case '-[KeyPathTests.ContentViewDebounceTests testConfigurationSaveDebouncing]' passed (0.001 seconds).
Test Case '-[KeyPathTests.ContentViewDebounceTests testConfigurationSaveFlow]' started.
[2025-11-22 13:35:47.390] [INFO] [KanataManager.swift:325 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] init() called
[2025-11-22 13:35:47.390] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:35:47.390] [INFO] [ConfigFileWatcher.swift:40 init()] ğŸ“ [FileWatcher] ConfigFileWatcher initialized with robust monitoring
[2025-11-22 13:35:47.390] [INFO] [ServiceHealthMonitor.swift:140 init(processLifecycle:)] [HealthMonitor] Initialized with process lifecycle manager
[2025-11-22 13:35:47.390] [DEBUG] [KanataManager.swift:397 init(engineClient:injectedConfigurationService:)] ğŸ§ª [KanataManager] Skipping background initialization in test environment
[2025-11-22 13:35:47.390] [INFO] [KanataManager.swift:405 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] About to call bootstrapRuleCollections and startLayerMonitoring
[2025-11-22 13:35:47.390] [INFO] [KanataManager.swift:577 startLayerMonitoring()] ğŸŒ [KanataManager] startLayerMonitoring() called
[2025-11-22 13:35:47.390] [INFO] [KanataManager.swift:579 startLayerMonitoring()] ğŸŒ [KanataManager] Skipping layer monitoring (test environment)
[2025-11-22 13:35:47.390] [INFO] [KanataManager.swift:409 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] init() completed
[2025-11-22 13:35:47.391] [INFO] [ContentViewDebounceTests.swift:81 testConfigurationSaveFlow()] âœ… [Test] Configuration save flow structure verified
Test Case '-[KeyPathTests.ContentViewDebounceTests testConfigurationSaveFlow]' passed (0.001 seconds).
Test Case '-[KeyPathTests.ContentViewDebounceTests testErrorHandlingPreservesUIState]' started.
[2025-11-22 13:35:47.391] [INFO] [KanataManager.swift:325 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] init() called
[2025-11-22 13:35:47.391] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:35:47.391] [INFO] [ConfigFileWatcher.swift:40 init()] ğŸ“ [FileWatcher] ConfigFileWatcher initialized with robust monitoring
[2025-11-22 13:35:47.391] [INFO] [ServiceHealthMonitor.swift:140 init(processLifecycle:)] [HealthMonitor] Initialized with process lifecycle manager
[2025-11-22 13:35:47.391] [DEBUG] [KanataManager.swift:397 init(engineClient:injectedConfigurationService:)] ğŸ§ª [KanataManager] Skipping background initialization in test environment
[2025-11-22 13:35:47.391] [INFO] [KanataManager.swift:405 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] About to call bootstrapRuleCollections and startLayerMonitoring
[2025-11-22 13:35:47.391] [INFO] [KanataManager.swift:577 startLayerMonitoring()] ğŸŒ [KanataManager] startLayerMonitoring() called
[2025-11-22 13:35:47.391] [INFO] [KanataManager.swift:579 startLayerMonitoring()] ğŸŒ [KanataManager] Skipping layer monitoring (test environment)
[2025-11-22 13:35:47.391] [INFO] [KanataManager.swift:409 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] init() completed
[2025-11-22 13:35:47.391] [INFO] [ContentViewDebounceTests.swift:53 testErrorHandlingPreservesUIState()] âœ… [Test] Error handling structure verified
Test Case '-[KeyPathTests.ContentViewDebounceTests testErrorHandlingPreservesUIState]' passed (0.000 seconds).
Test Case '-[KeyPathTests.ContentViewDebounceTests testMultipleConcurrentSaves]' started.
[2025-11-22 13:35:47.391] [INFO] [KanataManager.swift:325 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] init() called
[2025-11-22 13:35:47.391] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:35:47.391] [INFO] [ConfigFileWatcher.swift:40 init()] ğŸ“ [FileWatcher] ConfigFileWatcher initialized with robust monitoring
[2025-11-22 13:35:47.391] [INFO] [ServiceHealthMonitor.swift:140 init(processLifecycle:)] [HealthMonitor] Initialized with process lifecycle manager
[2025-11-22 13:35:47.391] [DEBUG] [KanataManager.swift:397 init(engineClient:injectedConfigurationService:)] ğŸ§ª [KanataManager] Skipping background initialization in test environment
[2025-11-22 13:35:47.391] [INFO] [KanataManager.swift:405 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] About to call bootstrapRuleCollections and startLayerMonitoring
[2025-11-22 13:35:47.391] [INFO] [KanataManager.swift:577 startLayerMonitoring()] ğŸŒ [KanataManager] startLayerMonitoring() called
[2025-11-22 13:35:47.391] [INFO] [KanataManager.swift:579 startLayerMonitoring()] ğŸŒ [KanataManager] Skipping layer monitoring (test environment)
[2025-11-22 13:35:47.391] [INFO] [KanataManager.swift:409 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] init() completed
[2025-11-22 13:35:47.392] [INFO] [ContentViewDebounceTests.swift:91 testMultipleConcurrentSaves()] ğŸ§ª [Test] Starting concurrent save task 1
[2025-11-22 13:35:47.392] [INFO] [ContentViewDebounceTests.swift:99 testMultipleConcurrentSaves()] ğŸ§ª [Test] Completed concurrent save task 1
[2025-11-22 13:35:47.392] [INFO] [ContentViewDebounceTests.swift:91 testMultipleConcurrentSaves()] ğŸ§ª [Test] Starting concurrent save task 2
[2025-11-22 13:35:47.392] [INFO] [ContentViewDebounceTests.swift:99 testMultipleConcurrentSaves()] ğŸ§ª [Test] Completed concurrent save task 2
[2025-11-22 13:35:47.392] [INFO] [ContentViewDebounceTests.swift:91 testMultipleConcurrentSaves()] ğŸ§ª [Test] Starting concurrent save task 3
[2025-11-22 13:35:47.392] [INFO] [ContentViewDebounceTests.swift:99 testMultipleConcurrentSaves()] ğŸ§ª [Test] Completed concurrent save task 3
[2025-11-22 13:35:47.392] [INFO] [KanataManager.swift:603 updateActiveLayerName(_:)] ğŸ¯ [KanataManager] updateActiveLayerName: raw='base' normalized='base' display='Base' current='Base'
[2025-11-22 13:35:47.392] [INFO] [KanataManager.swift:603 updateActiveLayerName(_:)] ğŸ¯ [KanataManager] updateActiveLayerName: raw='base' normalized='base' display='Base' current='Base'
[2025-11-22 13:35:47.392] [INFO] [KanataManager.swift:603 updateActiveLayerName(_:)] ğŸ¯ [KanataManager] updateActiveLayerName: raw='base' normalized='base' display='Base' current='Base'
[2025-11-22 13:35:47.392] [INFO] [KanataManager.swift:603 updateActiveLayerName(_:)] ğŸ¯ [KanataManager] updateActiveLayerName: raw='base' normalized='base' display='Base' current='Base'
[2025-11-22 13:35:47.392] [INFO] [KanataManager.swift:603 updateActiveLayerName(_:)] ğŸ¯ [KanataManager] updateActiveLayerName: raw='base' normalized='base' display='Base' current='Base'
[2025-11-22 13:35:47.392] [INFO] [KanataManager.swift:603 updateActiveLayerName(_:)] ğŸ¯ [KanataManager] updateActiveLayerName: raw='base' normalized='base' display='Base' current='Base'
[2025-11-22 13:35:47.392] [INFO] [ContentViewDebounceTests.swift:108 testMultipleConcurrentSaves()] âœ… [Test] Concurrent saves handled successfully
Test Case '-[KeyPathTests.ContentViewDebounceTests testMultipleConcurrentSaves]' passed (0.001 seconds).
Test Suite 'ContentViewDebounceTests' passed at 2025-11-22 13:35:47.392.
	 Executed 4 tests, with 0 failures (0 unexpected) in 0.003 (0.003) seconds
Test Suite 'CustomRulesStoreTests' started at 2025-11-22 13:35:47.392.
Test Case '-[KeyPathTests.CustomRulesStoreTests testLoadGracefullyHandlesCorruptData]' started.
[2025-11-22 13:35:47.393] [INFO] [KanataManager.swift:603 updateActiveLayerName(_:)] ğŸ¯ [KanataManager] updateActiveLayerName: raw='base' normalized='base' display='Base' current='Base'
[2025-11-22 13:35:47.393] [INFO] [KanataManager.swift:603 updateActiveLayerName(_:)] ğŸ¯ [KanataManager] updateActiveLayerName: raw='base' normalized='base' display='Base' current='Base'
[2025-11-22 13:35:47.394] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:35:47.394] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:35:47.394] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 3827 characters
[2025-11-22 13:35:47.394] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:35:47.394] [INFO] [CustomRulesStore.swift:35 loadRules()] âš ï¸ [CustomRulesStore] Failed to load rules: dataCorrupted(Swift.DecodingError.Context(codingPath: [], debugDescription: "The given data was not valid JSON.", underlyingError: Optional(Error Domain=NSCocoaErrorDomain Code=3840 "Unexpected character 'o' in expected null value around line 1, column 2." UserInfo={NSDebugDescription=Unexpected character 'o' in expected null value around line 1, column 2., NSJSONSerializationErrorIndex=1})))
[2025-11-22 13:35:47.394] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 18 src keys, 88 layer keys, deduplicated to 18 unique mappings
[2025-11-22 13:35:47.394] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:35:47.394] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
Test Case '-[KeyPathTests.CustomRulesStoreTests testLoadGracefullyHandlesCorruptData]' passed (0.002 seconds).
Test Case '-[KeyPathTests.CustomRulesStoreTests testLoadReturnsEmptyWhenFileMissing]' started.
[2025-11-22 13:35:47.395] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:35:47.395] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:35:47.395] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 3827 characters
[2025-11-22 13:35:47.395] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:35:47.396] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 18 src keys, 88 layer keys, deduplicated to 18 unique mappings
[2025-11-22 13:35:47.396] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:35:47.396] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:35:47.396] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 18 mappings
[2025-11-22 13:35:47.396] [DEBUG] [KanataManager+Configuration.swift:53 triggerConfigReload()] ğŸ“¡ [Reload] Attempting TCP reload
[2025-11-22 13:35:47.396] [DEBUG] [KanataManager+Configuration.swift:84 triggerTCPReload()] ğŸ§ª [TCP Reload] Skipping TCP reload in test environment
[2025-11-22 13:35:47.396] [DEBUG] [KanataManager+Configuration.swift:65 triggerConfigReload()] ğŸ“¡ [Reload] TCP reload failed: Test environment - TCP disabled
[2025-11-22 13:35:47.396] [WARN] [KanataManager+Configuration.swift:68 triggerConfigReload()] âš ï¸ [Reload] Falling back to service restart
[2025-11-22 13:35:47.396] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:35:47.396] [INFO] [SystemValidator.swift:63 init(launchDaemonInstaller:vhidDeviceManager:processLifecycleManager:kanataManager:)] ğŸ” [SystemValidator] Initialized (stateless, no cache)
[2025-11-22 13:35:47.396] [INFO] [InstallerEngine.swift:35 init(processLifecycleManager:kanataManager:)] ğŸ”§ [InstallerEngine] Initialized
[2025-11-22 13:35:47.396] [INFO] [PrivilegedOperationsCoordinator.swift:35 init()] ğŸ” [PrivCoordinator] Initialized with operation mode: directSudo
[2025-11-22 13:35:47.396] [INFO] [InstallerEngine.swift:419 run(intent:using:)] ğŸš€ [InstallerEngine] Starting run(intent: repair, using:)
[2025-11-22 13:35:47.396] [INFO] [InstallerEngine.swift:53 inspectSystem()] ğŸ” [InstallerEngine] Starting inspectSystem()
Test Case '-[KeyPathTests.CustomRulesStoreTests testLoadReturnsEmptyWhenFileMissing]' passed (0.001 seconds).
Test Case '-[KeyPathTests.CustomRulesStoreTests testSaveAndLoadRoundTrip]' started.
[2025-11-22 13:35:47.397] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:35:47.397] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:35:47.397] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 3827 characters
[2025-11-22 13:35:47.397] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:35:47.397] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 18 src keys, 88 layer keys, deduplicated to 18 unique mappings
[2025-11-22 13:35:47.397] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:35:47.397] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:35:47.397] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:35:47.397] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:35:47.397] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 3827 characters
[2025-11-22 13:35:47.397] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:35:47.398] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 18 src keys, 88 layer keys, deduplicated to 18 unique mappings
[2025-11-22 13:35:47.398] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:35:47.398] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:35:47.398] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 18 mappings
[2025-11-22 13:35:47.398] [DEBUG] [KanataManager+Configuration.swift:53 triggerConfigReload()] ğŸ“¡ [Reload] Attempting TCP reload
[2025-11-22 13:35:47.398] [DEBUG] [KanataManager+Configuration.swift:84 triggerTCPReload()] ğŸ§ª [TCP Reload] Skipping TCP reload in test environment
[2025-11-22 13:35:47.398] [DEBUG] [KanataManager+Configuration.swift:65 triggerConfigReload()] ğŸ“¡ [Reload] TCP reload failed: Test environment - TCP disabled
[2025-11-22 13:35:47.398] [WARN] [KanataManager+Configuration.swift:68 triggerConfigReload()] âš ï¸ [Reload] Falling back to service restart
[2025-11-22 13:35:47.398] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:35:47.398] [INFO] [SystemValidator.swift:63 init(launchDaemonInstaller:vhidDeviceManager:processLifecycleManager:kanataManager:)] ğŸ” [SystemValidator] Initialized (stateless, no cache)
[2025-11-22 13:35:47.398] [INFO] [InstallerEngine.swift:35 init(processLifecycleManager:kanataManager:)] ğŸ”§ [InstallerEngine] Initialized
[2025-11-22 13:35:47.398] [INFO] [InstallerEngine.swift:419 run(intent:using:)] ğŸš€ [InstallerEngine] Starting run(intent: repair, using:)
[2025-11-22 13:35:47.398] [INFO] [InstallerEngine.swift:53 inspectSystem()] ğŸ” [InstallerEngine] Starting inspectSystem()
[2025-11-22 13:35:47.398] [INFO] [SystemValidator.swift:143 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Starting validation #1
[2025-11-22 13:35:47.398] [INFO] [SystemValidator.swift:174 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 START: 1763847347.398
Test Case '-[KeyPathTests.CustomRulesStoreTests testSaveAndLoadRoundTrip]' passed (0.002 seconds).
Test Suite 'CustomRulesStoreTests' passed at 2025-11-22 13:35:47.398.
	 Executed 3 tests, with 0 failures (0 unexpected) in 0.006 (0.006) seconds
Test Suite 'DiagnosticsServiceTests' started at 2025-11-22 13:35:47.398.
Test Case '-[KeyPathTests.DiagnosticsServiceTests testAnalyzeLogFileNotFound]' started.
[2025-11-22 13:35:47.398] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:35:47.398] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 18 mappings
[2025-11-22 13:35:47.398] [DEBUG] [KanataManager+Configuration.swift:53 triggerConfigReload()] ğŸ“¡ [Reload] Attempting TCP reload
[2025-11-22 13:35:47.398] [DEBUG] [KanataManager+Configuration.swift:84 triggerTCPReload()] ğŸ§ª [TCP Reload] Skipping TCP reload in test environment
[2025-11-22 13:35:47.398] [DEBUG] [KanataManager+Configuration.swift:65 triggerConfigReload()] ğŸ“¡ [Reload] TCP reload failed: Test environment - TCP disabled
[2025-11-22 13:35:47.398] [WARN] [KanataManager+Configuration.swift:68 triggerConfigReload()] âš ï¸ [Reload] Falling back to service restart
[2025-11-22 13:35:47.398] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:35:47.398] [INFO] [SystemValidator.swift:63 init(launchDaemonInstaller:vhidDeviceManager:processLifecycleManager:kanataManager:)] ğŸ” [SystemValidator] Initialized (stateless, no cache)
[2025-11-22 13:35:47.398] [INFO] [InstallerEngine.swift:35 init(processLifecycleManager:kanataManager:)] ğŸ”§ [InstallerEngine] Initialized
[2025-11-22 13:35:47.398] [INFO] [InstallerEngine.swift:419 run(intent:using:)] ğŸš€ [InstallerEngine] Starting run(intent: repair, using:)
[2025-11-22 13:35:47.398] [INFO] [InstallerEngine.swift:53 inspectSystem()] ğŸ” [InstallerEngine] Starting inspectSystem()
[2025-11-22 13:35:47.398] [INFO] [SystemValidator.swift:133 performValidationBody(progressCallback:)] âš ï¸ [SystemValidator] RAPID VALIDATION: 0.001s since last validation
This might indicate automatic triggers. Expected: manual user actions only.
[2025-11-22 13:35:47.398] [INFO] [SystemValidator.swift:143 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Starting validation #1
[2025-11-22 13:35:47.398] [INFO] [SystemValidator.swift:174 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 START: 1763847347.398
[2025-11-22 13:35:47.398] [INFO] [SystemValidator.swift:312 checkHelper()] ğŸ” [SystemValidator] Checking privileged helper
[2025-11-22 13:35:47.398] [INFO] [HelperManager.swift:64 init()] ğŸ”§ [HelperManager] Initialized
[2025-11-22 13:35:47.398] [INFO] [SystemValidator.swift:344 checkPermissions()] ğŸ” [SystemValidator] Checking permissions via Oracle
[2025-11-22 13:35:47.398] [INFO] [PermissionOracle.swift:135 init()] ğŸ”® [Oracle] Permission Oracle initialized - ending the chaos!
[2025-11-22 13:35:47.398] [INFO] [SystemValidator.swift:372 checkComponents()] ğŸ” [SystemValidator] Checking components
[2025-11-22 13:35:47.398] [INFO] [KanataBinaryDetector.swift:66 detectCurrentStatus()] ğŸ” [KanataBinaryDetector] Starting unified kanata binary detection
[2025-11-22 13:35:47.398] [INFO] [PermissionOracle.swift:173 currentSnapshot()] ğŸ”® [Oracle] Test mode snapshot generated (non-blocking)
[2025-11-22 13:35:47.398] [INFO] [KanataBinaryDetector.swift:81 detectCurrentStatus()] âŒ [KanataBinaryDetector] No kanata binary found
[2025-11-22 13:35:47.399] [INFO] [VHIDDeviceManager.swift:50 detectInstallation()] ğŸ” [VHIDManager] Manager app exists at /Applications/.Karabiner-VirtualHIDDevice-Manager.app/Contents/MacOS/Karabiner-VirtualHIDDevice-Manager: true
[2025-11-22 13:35:47.453] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:35:47.457] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:35:47.470] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.072s)
[2025-11-22 13:35:47.470] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:35:47.474] [INFO] [HelperManager.swift:830 verifyEmbeddedHelperSignature()] ğŸ”’ [HelperManager] Embedded helper signature looks valid
[2025-11-22 13:35:47.474] [INFO] [HelperManager.swift:105 getConnection()] ğŸ”— [HelperManager] Creating XPC connection to com.keypath.helper
[2025-11-22 13:35:47.474] [INFO] [HelperManager.swift:129 getConnection()] âœ… [HelperManager] XPC connection established (PID: 0)
[2025-11-22 13:35:47.474] [INFO] [HelperManager.swift:228 getHelperVersion()] ğŸ“¤ [HelperManager] Calling proxy.getVersion()
[2025-11-22 13:35:47.474] [INFO] [HelperManager.swift:243 getHelperVersion()] ğŸ“¤ [HelperManager] proxy.getVersion() call dispatched, waiting for callback
[2025-11-22 13:35:47.475] [INFO] [HelperManager.swift:121 getConnection()] âš ï¸ [HelperManager] XPC connection interrupted - will reconnect
[2025-11-22 13:35:47.475] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:35:47.476] [INFO] [HelperManager.swift:578 getRemoteProxy(errorHandler:)] âŒ [HelperManager] XPC proxy error: Couldnâ€™t communicate with a helper application.
[2025-11-22 13:35:47.476] [INFO] [HelperManager.swift:584 getRemoteProxy(errorHandler:)] âš ï¸ [HelperManager] XPC connection interrupted - this may indicate:
[2025-11-22 13:35:47.476] [INFO] [HelperManager.swift:585 getRemoteProxy(errorHandler:)]    1. Helper signature validation failed (app updated but not restarted)
[2025-11-22 13:35:47.476] [INFO] [HelperManager.swift:587 getRemoteProxy(errorHandler:)]    2. Helper process crashed
[2025-11-22 13:35:47.476] [INFO] [HelperManager.swift:588 getRemoteProxy(errorHandler:)]    3. Helper was killed by the system
[2025-11-22 13:35:47.476] [INFO] [HelperManager.swift:589 getRemoteProxy(errorHandler:)] ğŸ’¡ If you just updated KeyPath, try restarting the app
[2025-11-22 13:35:47.476] [INFO] [HelperManager.swift:116 getConnection()] âŒ [HelperManager] XPC connection invalidated
[2025-11-22 13:35:47.476] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:35:48.054] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.074s)
[2025-11-22 13:35:48.054] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:35:48.054] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:35:48.055] [INFO] [VHIDDeviceManager.swift:343 getInstalledVersion()] ğŸ” [VHIDManager] Installed daemon version: 5.0.0
[2025-11-22 13:35:48.055] [INFO] [VHIDDeviceManager.swift:374 hasVersionMismatch()] âœ… [VHIDManager] Version compatible: v5.0.0
[2025-11-22 13:35:48.055] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:35:48.129] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:35:48.199] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:35:48.199] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:35:48.199] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:35:48.199] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:35:48.200] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:35:48.200] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:35:48.200] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:35:48.200] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:35:48.200] [INFO] [LaunchDaemonInstaller.swift:669 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Kanata service state: Uninstalled
[2025-11-22 13:35:48.200] [INFO] [LaunchDaemonInstaller.swift:696 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Service not installed (state: Uninstalled)
[2025-11-22 13:35:48.200] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:35:48.273] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:35:48.345] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhiddaemon loaded: false
[2025-11-22 13:35:48.421] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhidmanager loaded: false
[2025-11-22 13:35:48.422] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:35:48.495] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:35:48.495] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhidmanager
[2025-11-22 13:35:48.568] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhidmanager not found in system domain
[2025-11-22 13:35:48.568] [INFO] [SystemValidator.swift:400 checkComponents()] ğŸ” [SystemValidator] Components: kanata=false, driver=true, daemon=false, vhid=false, vhidVersionMismatch=false
[2025-11-22 13:35:48.568] [INFO] [SystemValidator.swift:220 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 3 (Components) completed in 1.170s
[2025-11-22 13:35:48.568] [INFO] [SystemValidator.swift:418 checkConflicts()] ğŸ” [SystemValidator] Checking for conflicts
[2025-11-22 13:35:48.568] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 20% (1/5 steps)
[2025-11-22 13:35:48.568] [INFO] [ProcessLifecycleManager.swift:117 detectConflicts()] ğŸ” [ProcessLifecycleManager] Detecting conflicts...
[2025-11-22 13:35:48.568] [INFO] [ProcessLifecycleManager.swift:121 detectConflicts()] ğŸ§ª [TestEnvironment] Skipping process conflict detection - returning clean state
[2025-11-22 13:35:48.568] [INFO] [SystemValidator.swift:443 checkConflicts()] ğŸ” [SystemValidator] Total conflicts: 0 (0 kanata, 0 karabiner)
[2025-11-22 13:35:48.568] [INFO] [SystemValidator.swift:484 checkHealth()] ğŸ” [SystemValidator] Checking system health
[2025-11-22 13:35:48.568] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:35:48.568] [INFO] [SystemValidator.swift:229 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 4 (Conflicts) completed in 1.171s
[2025-11-22 13:35:48.568] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 40% (2/5 steps)
[2025-11-22 13:35:48.640] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:35:48.640] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:35:48.712] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:35:48.785] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.073s)
[2025-11-22 13:35:48.785] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:35:49.368] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.073s)
[2025-11-22 13:35:49.368] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:35:49.368] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:35:49.368] [INFO] [SystemValidator.swift:494 checkHealth()] ğŸ” [SystemValidator] Health: kanata=false, daemon=false (launchctl), vhid=false
[2025-11-22 13:35:49.368] [INFO] [SystemValidator.swift:238 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 5 (Health) completed in 1.971s
[2025-11-22 13:35:49.368] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 60% (3/5 steps)
[2025-11-22 13:35:49.368] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 18 mappings
[2025-11-22 13:35:49.369] [DEBUG] [KanataManager+Configuration.swift:53 triggerConfigReload()] ğŸ“¡ [Reload] Attempting TCP reload
[2025-11-22 13:35:49.369] [DEBUG] [KanataManager+Configuration.swift:84 triggerTCPReload()] ğŸ§ª [TCP Reload] Skipping TCP reload in test environment
[2025-11-22 13:35:49.369] [DEBUG] [KanataManager+Configuration.swift:65 triggerConfigReload()] ğŸ“¡ [Reload] TCP reload failed: Test environment - TCP disabled
[2025-11-22 13:35:49.369] [WARN] [KanataManager+Configuration.swift:68 triggerConfigReload()] âš ï¸ [Reload] Falling back to service restart
[2025-11-22 13:35:49.369] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:35:49.369] [INFO] [SystemValidator.swift:63 init(launchDaemonInstaller:vhidDeviceManager:processLifecycleManager:kanataManager:)] ğŸ” [SystemValidator] Initialized (stateless, no cache)
[2025-11-22 13:35:49.369] [INFO] [InstallerEngine.swift:35 init(processLifecycleManager:kanataManager:)] ğŸ”§ [InstallerEngine] Initialized
[2025-11-22 13:35:49.369] [INFO] [InstallerEngine.swift:419 run(intent:using:)] ğŸš€ [InstallerEngine] Starting run(intent: repair, using:)
[2025-11-22 13:35:49.369] [INFO] [InstallerEngine.swift:53 inspectSystem()] ğŸ” [InstallerEngine] Starting inspectSystem()
[2025-11-22 13:35:49.369] [INFO] [SystemValidator.swift:143 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Starting validation #1
[2025-11-22 13:35:49.369] [INFO] [SystemValidator.swift:174 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 START: 1763847349.369
[2025-11-22 13:35:49.369] [INFO] [SystemValidator.swift:312 checkHelper()] ğŸ” [SystemValidator] Checking privileged helper
[2025-11-22 13:35:49.369] [INFO] [SystemValidator.swift:344 checkPermissions()] ğŸ” [SystemValidator] Checking permissions via Oracle
[2025-11-22 13:35:49.369] [INFO] [SystemValidator.swift:372 checkComponents()] ğŸ” [SystemValidator] Checking components
[2025-11-22 13:35:49.369] [INFO] [KanataBinaryDetector.swift:66 detectCurrentStatus()] ğŸ” [KanataBinaryDetector] Starting unified kanata binary detection
[2025-11-22 13:35:49.369] [INFO] [PermissionOracle.swift:173 currentSnapshot()] ğŸ”® [Oracle] Test mode snapshot generated (non-blocking)
[2025-11-22 13:35:49.369] [INFO] [KanataBinaryDetector.swift:81 detectCurrentStatus()] âŒ [KanataBinaryDetector] No kanata binary found
[2025-11-22 13:35:49.369] [INFO] [VHIDDeviceManager.swift:50 detectInstallation()] ğŸ” [VHIDManager] Manager app exists at /Applications/.Karabiner-VirtualHIDDevice-Manager.app/Contents/MacOS/Karabiner-VirtualHIDDevice-Manager: true
[2025-11-22 13:35:49.442] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.073s)
[2025-11-22 13:35:49.442] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:35:49.450] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:35:49.454] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:35:49.468] [INFO] [HelperManager.swift:830 verifyEmbeddedHelperSignature()] ğŸ”’ [HelperManager] Embedded helper signature looks valid
[2025-11-22 13:35:49.468] [INFO] [HelperManager.swift:105 getConnection()] ğŸ”— [HelperManager] Creating XPC connection to com.keypath.helper
[2025-11-22 13:35:49.468] [INFO] [HelperManager.swift:129 getConnection()] âœ… [HelperManager] XPC connection established (PID: 0)
[2025-11-22 13:35:49.468] [INFO] [HelperManager.swift:228 getHelperVersion()] ğŸ“¤ [HelperManager] Calling proxy.getVersion()
[2025-11-22 13:35:49.468] [INFO] [HelperManager.swift:243 getHelperVersion()] ğŸ“¤ [HelperManager] proxy.getVersion() call dispatched, waiting for callback
[2025-11-22 13:35:49.469] [INFO] [HelperManager.swift:121 getConnection()] âš ï¸ [HelperManager] XPC connection interrupted - will reconnect
[2025-11-22 13:35:49.469] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:35:49.469] [INFO] [HelperManager.swift:578 getRemoteProxy(errorHandler:)] âŒ [HelperManager] XPC proxy error: Couldnâ€™t communicate with a helper application.
[2025-11-22 13:35:49.469] [INFO] [HelperManager.swift:584 getRemoteProxy(errorHandler:)] âš ï¸ [HelperManager] XPC connection interrupted - this may indicate:
[2025-11-22 13:35:49.469] [INFO] [HelperManager.swift:585 getRemoteProxy(errorHandler:)]    1. Helper signature validation failed (app updated but not restarted)
[2025-11-22 13:35:49.469] [INFO] [HelperManager.swift:587 getRemoteProxy(errorHandler:)]    2. Helper process crashed
[2025-11-22 13:35:49.469] [INFO] [HelperManager.swift:588 getRemoteProxy(errorHandler:)]    3. Helper was killed by the system
[2025-11-22 13:35:49.469] [INFO] [HelperManager.swift:589 getRemoteProxy(errorHandler:)] ğŸ’¡ If you just updated KeyPath, try restarting the app
[2025-11-22 13:35:49.469] [INFO] [HelperManager.swift:116 getConnection()] âŒ [HelperManager] XPC connection invalidated
[2025-11-22 13:35:49.469] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:35:50.026] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.073s)
[2025-11-22 13:35:50.026] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:35:50.026] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:35:50.026] [INFO] [VHIDDeviceManager.swift:343 getInstalledVersion()] ğŸ” [VHIDManager] Installed daemon version: 5.0.0
[2025-11-22 13:35:50.026] [INFO] [VHIDDeviceManager.swift:374 hasVersionMismatch()] âœ… [VHIDManager] Version compatible: v5.0.0
[2025-11-22 13:35:50.026] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:35:50.099] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:35:50.100] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:35:50.100] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:35:50.100] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:35:50.100] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:35:50.100] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:35:50.100] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:35:50.100] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:35:50.100] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:35:50.100] [INFO] [LaunchDaemonInstaller.swift:669 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Kanata service state: Uninstalled
[2025-11-22 13:35:50.100] [INFO] [LaunchDaemonInstaller.swift:696 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Service not installed (state: Uninstalled)
[2025-11-22 13:35:50.100] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:35:50.173] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:35:50.245] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhiddaemon loaded: false
[2025-11-22 13:35:50.318] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhidmanager loaded: false
[2025-11-22 13:35:50.318] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:35:50.390] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:35:50.390] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhidmanager
[2025-11-22 13:35:50.462] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhidmanager not found in system domain
[2025-11-22 13:35:50.462] [INFO] [SystemValidator.swift:400 checkComponents()] ğŸ” [SystemValidator] Components: kanata=false, driver=true, daemon=false, vhid=false, vhidVersionMismatch=false
[2025-11-22 13:35:50.462] [INFO] [SystemValidator.swift:418 checkConflicts()] ğŸ” [SystemValidator] Checking for conflicts
[2025-11-22 13:35:50.462] [INFO] [SystemValidator.swift:220 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 3 (Components) completed in 3.063s
[2025-11-22 13:35:50.462] [INFO] [ProcessLifecycleManager.swift:117 detectConflicts()] ğŸ” [ProcessLifecycleManager] Detecting conflicts...
[2025-11-22 13:35:50.462] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 20% (1/5 steps)
[2025-11-22 13:35:50.462] [INFO] [ProcessLifecycleManager.swift:121 detectConflicts()] ğŸ§ª [TestEnvironment] Skipping process conflict detection - returning clean state
[2025-11-22 13:35:50.462] [INFO] [SystemValidator.swift:443 checkConflicts()] ğŸ” [SystemValidator] Total conflicts: 0 (0 kanata, 0 karabiner)
[2025-11-22 13:35:50.462] [INFO] [SystemValidator.swift:484 checkHealth()] ğŸ” [SystemValidator] Checking system health
[2025-11-22 13:35:50.462] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:35:50.462] [INFO] [SystemValidator.swift:229 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 4 (Conflicts) completed in 3.064s
[2025-11-22 13:35:50.462] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 40% (2/5 steps)
[2025-11-22 13:35:50.535] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:35:50.535] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:35:50.605] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:35:50.611] [INFO] [HelperManager.swift:248 getHelperVersion()] âš ï¸ [HelperManager] getVersion timed out - clearing connection cache
[2025-11-22 13:35:50.612] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:35:50.678] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.073s)
[2025-11-22 13:35:50.678] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:35:51.261] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.072s)
[2025-11-22 13:35:51.261] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:35:51.261] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:35:51.261] [INFO] [SystemValidator.swift:494 checkHealth()] ğŸ” [SystemValidator] Health: kanata=false, daemon=false (launchctl), vhid=false
[2025-11-22 13:35:51.261] [INFO] [SystemValidator.swift:238 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 5 (Health) completed in 3.863s
[2025-11-22 13:35:51.261] [INFO] [SystemValidator.swift:362 checkPermissions()] ğŸ” [SystemValidator] Oracle snapshot: ready=false, age=3.863s
[2025-11-22 13:35:51.261] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 60% (3/5 steps)
[2025-11-22 13:35:51.261] [INFO] [SystemValidator.swift:211 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 2 (Permissions) completed in 3.863s
[2025-11-22 13:35:51.261] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 80% (4/5 steps)
[2025-11-22 13:35:51.261] [INFO] [SystemValidator.swift:143 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Starting validation #1
[2025-11-22 13:35:51.261] [INFO] [SystemValidator.swift:174 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 START: 1763847351.261
Test Case '-[KeyPathTests.DiagnosticsServiceTests testAnalyzeLogFileNotFound]' passed (3.863 seconds).
Test Case '-[KeyPathTests.DiagnosticsServiceTests testAnalyzeLogFileWithCleanLogs]' started.
[2025-11-22 13:35:51.262] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:35:51.262] [INFO] [SystemValidator.swift:312 checkHelper()] ğŸ” [SystemValidator] Checking privileged helper
[2025-11-22 13:35:51.262] [INFO] [SystemValidator.swift:344 checkPermissions()] ğŸ” [SystemValidator] Checking permissions via Oracle
[2025-11-22 13:35:51.262] [INFO] [SystemValidator.swift:372 checkComponents()] ğŸ” [SystemValidator] Checking components
[2025-11-22 13:35:51.262] [INFO] [KanataBinaryDetector.swift:66 detectCurrentStatus()] ğŸ” [KanataBinaryDetector] Starting unified kanata binary detection
[2025-11-22 13:35:51.262] [INFO] [PermissionOracle.swift:173 currentSnapshot()] ğŸ”® [Oracle] Test mode snapshot generated (non-blocking)
[2025-11-22 13:35:51.262] [INFO] [KanataBinaryDetector.swift:81 detectCurrentStatus()] âŒ [KanataBinaryDetector] No kanata binary found
[2025-11-22 13:35:51.262] [INFO] [VHIDDeviceManager.swift:50 detectInstallation()] ğŸ” [VHIDManager] Manager app exists at /Applications/.Karabiner-VirtualHIDDevice-Manager.app/Contents/MacOS/Karabiner-VirtualHIDDevice-Manager: true
[2025-11-22 13:35:51.267] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:35:51.271] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:35:51.286] [INFO] [HelperManager.swift:830 verifyEmbeddedHelperSignature()] ğŸ”’ [HelperManager] Embedded helper signature looks valid
[2025-11-22 13:35:51.286] [INFO] [HelperManager.swift:105 getConnection()] ğŸ”— [HelperManager] Creating XPC connection to com.keypath.helper
[2025-11-22 13:35:51.286] [INFO] [HelperManager.swift:129 getConnection()] âœ… [HelperManager] XPC connection established (PID: 0)
[2025-11-22 13:35:51.286] [INFO] [HelperManager.swift:228 getHelperVersion()] ğŸ“¤ [HelperManager] Calling proxy.getVersion()
[2025-11-22 13:35:51.286] [INFO] [HelperManager.swift:243 getHelperVersion()] ğŸ“¤ [HelperManager] proxy.getVersion() call dispatched, waiting for callback
[2025-11-22 13:35:51.286] [INFO] [HelperManager.swift:121 getConnection()] âš ï¸ [HelperManager] XPC connection interrupted - will reconnect
[2025-11-22 13:35:51.286] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:35:51.286] [INFO] [HelperManager.swift:578 getRemoteProxy(errorHandler:)] âŒ [HelperManager] XPC proxy error: Couldnâ€™t communicate with a helper application.
[2025-11-22 13:35:51.286] [INFO] [HelperManager.swift:584 getRemoteProxy(errorHandler:)] âš ï¸ [HelperManager] XPC connection interrupted - this may indicate:
[2025-11-22 13:35:51.286] [INFO] [HelperManager.swift:585 getRemoteProxy(errorHandler:)]    1. Helper signature validation failed (app updated but not restarted)
[2025-11-22 13:35:51.286] [INFO] [HelperManager.swift:587 getRemoteProxy(errorHandler:)]    2. Helper process crashed
[2025-11-22 13:35:51.286] [INFO] [HelperManager.swift:588 getRemoteProxy(errorHandler:)]    3. Helper was killed by the system
[2025-11-22 13:35:51.286] [INFO] [HelperManager.swift:589 getRemoteProxy(errorHandler:)] ğŸ’¡ If you just updated KeyPath, try restarting the app
[2025-11-22 13:35:51.286] [INFO] [HelperManager.swift:116 getConnection()] âŒ [HelperManager] XPC connection invalidated
[2025-11-22 13:35:51.286] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:35:51.335] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.073s)
[2025-11-22 13:35:51.335] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:35:51.918] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.073s)
[2025-11-22 13:35:51.918] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:35:51.918] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:35:51.918] [INFO] [VHIDDeviceManager.swift:343 getInstalledVersion()] ğŸ” [VHIDManager] Installed daemon version: 5.0.0
[2025-11-22 13:35:51.918] [INFO] [VHIDDeviceManager.swift:374 hasVersionMismatch()] âœ… [VHIDManager] Version compatible: v5.0.0
[2025-11-22 13:35:51.918] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:35:51.989] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:35:51.990] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:35:51.990] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:35:51.990] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:35:51.990] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:35:51.990] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:35:51.990] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:35:51.990] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:35:51.990] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:35:51.990] [INFO] [LaunchDaemonInstaller.swift:669 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Kanata service state: Uninstalled
[2025-11-22 13:35:51.990] [INFO] [LaunchDaemonInstaller.swift:696 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Service not installed (state: Uninstalled)
[2025-11-22 13:35:51.990] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:35:52.061] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:35:52.134] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhiddaemon loaded: false
[2025-11-22 13:35:52.206] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhidmanager loaded: false
[2025-11-22 13:35:52.206] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:35:52.277] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:35:52.277] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhidmanager
[2025-11-22 13:35:52.350] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhidmanager not found in system domain
[2025-11-22 13:35:52.350] [INFO] [SystemValidator.swift:400 checkComponents()] ğŸ” [SystemValidator] Components: kanata=false, driver=true, daemon=false, vhid=false, vhidVersionMismatch=false
[2025-11-22 13:35:52.350] [INFO] [SystemValidator.swift:418 checkConflicts()] ğŸ” [SystemValidator] Checking for conflicts
[2025-11-22 13:35:52.350] [INFO] [SystemValidator.swift:220 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 3 (Components) completed in 2.981s
[2025-11-22 13:35:52.350] [INFO] [ProcessLifecycleManager.swift:117 detectConflicts()] ğŸ” [ProcessLifecycleManager] Detecting conflicts...
[2025-11-22 13:35:52.350] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 20% (1/5 steps)
[2025-11-22 13:35:52.350] [INFO] [ProcessLifecycleManager.swift:121 detectConflicts()] ğŸ§ª [TestEnvironment] Skipping process conflict detection - returning clean state
[2025-11-22 13:35:52.350] [INFO] [SystemValidator.swift:443 checkConflicts()] ğŸ” [SystemValidator] Total conflicts: 0 (0 kanata, 0 karabiner)
[2025-11-22 13:35:52.350] [INFO] [SystemValidator.swift:484 checkHealth()] ğŸ” [SystemValidator] Checking system health
[2025-11-22 13:35:52.350] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:35:52.350] [INFO] [SystemValidator.swift:229 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 4 (Conflicts) completed in 2.981s
[2025-11-22 13:35:52.350] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 40% (2/5 steps)
[2025-11-22 13:35:52.423] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:35:52.423] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:35:52.494] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:35:52.511] [INFO] [HelperManager.swift:248 getHelperVersion()] âš ï¸ [HelperManager] getVersion timed out - clearing connection cache
[2025-11-22 13:35:52.511] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:35:52.568] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.073s)
[2025-11-22 13:35:52.568] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:35:53.151] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.073s)
[2025-11-22 13:35:53.152] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:35:53.152] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:35:53.152] [INFO] [SystemValidator.swift:494 checkHealth()] ğŸ” [SystemValidator] Health: kanata=false, daemon=false (launchctl), vhid=false
[2025-11-22 13:35:53.152] [INFO] [SystemValidator.swift:362 checkPermissions()] ğŸ” [SystemValidator] Oracle snapshot: ready=false, age=3.783s
[2025-11-22 13:35:53.152] [INFO] [SystemValidator.swift:238 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 5 (Health) completed in 3.783s
[2025-11-22 13:35:53.152] [INFO] [SystemValidator.swift:328 checkHelper()] ğŸ” [SystemValidator] Helper state: registeredButUnresponsive Helper registered but XPC communication failed
[2025-11-22 13:35:53.152] [INFO] [SystemValidator.swift:211 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 2 (Permissions) completed in 5.753s
[2025-11-22 13:35:53.152] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 60% (3/5 steps)
[2025-11-22 13:35:53.152] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 80% (4/5 steps)
[2025-11-22 13:35:53.152] [INFO] [SystemValidator.swift:202 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 1 (Helper) completed in 5.754s
[2025-11-22 13:35:53.152] [INFO] [SystemValidator.swift:312 checkHelper()] ğŸ” [SystemValidator] Checking privileged helper
[2025-11-22 13:35:53.152] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 100% (5/5 steps)
[2025-11-22 13:35:53.152] [INFO] [SystemValidator.swift:344 checkPermissions()] ğŸ” [SystemValidator] Checking permissions via Oracle
[2025-11-22 13:35:53.152] [INFO] [SystemValidator.swift:372 checkComponents()] ğŸ” [SystemValidator] Checking components
[2025-11-22 13:35:53.152] [INFO] [PermissionOracle.swift:173 currentSnapshot()] ğŸ”® [Oracle] Test mode snapshot generated (non-blocking)
[2025-11-22 13:35:53.152] [INFO] [KanataBinaryDetector.swift:66 detectCurrentStatus()] ğŸ” [KanataBinaryDetector] Starting unified kanata binary detection
[2025-11-22 13:35:53.152] [INFO] [KanataBinaryDetector.swift:81 detectCurrentStatus()] âŒ [KanataBinaryDetector] No kanata binary found
[2025-11-22 13:35:53.152] [INFO] [VHIDDeviceManager.swift:50 detectInstallation()] ğŸ” [VHIDManager] Manager app exists at /Applications/.Karabiner-VirtualHIDDevice-Manager.app/Contents/MacOS/Karabiner-VirtualHIDDevice-Manager: true
[2025-11-22 13:35:53.160] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:35:53.167] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:35:53.188] [INFO] [HelperManager.swift:830 verifyEmbeddedHelperSignature()] ğŸ”’ [HelperManager] Embedded helper signature looks valid
[2025-11-22 13:35:53.188] [INFO] [HelperManager.swift:105 getConnection()] ğŸ”— [HelperManager] Creating XPC connection to com.keypath.helper
[2025-11-22 13:35:53.188] [INFO] [HelperManager.swift:129 getConnection()] âœ… [HelperManager] XPC connection established (PID: 0)
[2025-11-22 13:35:53.188] [INFO] [HelperManager.swift:228 getHelperVersion()] ğŸ“¤ [HelperManager] Calling proxy.getVersion()
[2025-11-22 13:35:53.188] [INFO] [HelperManager.swift:243 getHelperVersion()] ğŸ“¤ [HelperManager] proxy.getVersion() call dispatched, waiting for callback
[2025-11-22 13:35:53.189] [INFO] [HelperManager.swift:121 getConnection()] âš ï¸ [HelperManager] XPC connection interrupted - will reconnect
[2025-11-22 13:35:53.189] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:35:53.189] [INFO] [HelperManager.swift:578 getRemoteProxy(errorHandler:)] âŒ [HelperManager] XPC proxy error: Couldnâ€™t communicate with a helper application.
[2025-11-22 13:35:53.189] [INFO] [HelperManager.swift:584 getRemoteProxy(errorHandler:)] âš ï¸ [HelperManager] XPC connection interrupted - this may indicate:
[2025-11-22 13:35:53.189] [INFO] [HelperManager.swift:585 getRemoteProxy(errorHandler:)]    1. Helper signature validation failed (app updated but not restarted)
[2025-11-22 13:35:53.189] [INFO] [HelperManager.swift:587 getRemoteProxy(errorHandler:)]    2. Helper process crashed
[2025-11-22 13:35:53.189] [INFO] [HelperManager.swift:588 getRemoteProxy(errorHandler:)]    3. Helper was killed by the system
[2025-11-22 13:35:53.189] [INFO] [HelperManager.swift:589 getRemoteProxy(errorHandler:)] ğŸ’¡ If you just updated KeyPath, try restarting the app
[2025-11-22 13:35:53.189] [INFO] [HelperManager.swift:116 getConnection()] âŒ [HelperManager] XPC connection invalidated
[2025-11-22 13:35:53.189] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:35:53.223] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.071s)
[2025-11-22 13:35:53.223] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:35:53.805] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.071s)
[2025-11-22 13:35:53.805] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:35:53.805] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:35:53.805] [INFO] [VHIDDeviceManager.swift:343 getInstalledVersion()] ğŸ” [VHIDManager] Installed daemon version: 5.0.0
[2025-11-22 13:35:53.805] [INFO] [VHIDDeviceManager.swift:374 hasVersionMismatch()] âœ… [VHIDManager] Version compatible: v5.0.0
[2025-11-22 13:35:53.805] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:35:53.878] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:35:53.879] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:35:53.879] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:35:53.879] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:35:53.879] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:35:53.880] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:35:53.880] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:35:53.880] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:35:53.880] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:35:53.880] [INFO] [LaunchDaemonInstaller.swift:669 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Kanata service state: Uninstalled
[2025-11-22 13:35:53.880] [INFO] [LaunchDaemonInstaller.swift:696 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Service not installed (state: Uninstalled)
[2025-11-22 13:35:53.880] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:35:53.951] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:35:54.024] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhiddaemon loaded: false
[2025-11-22 13:35:54.096] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhidmanager loaded: false
[2025-11-22 13:35:54.096] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:35:54.168] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:35:54.168] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhidmanager
[2025-11-22 13:35:54.241] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhidmanager not found in system domain
[2025-11-22 13:35:54.241] [INFO] [SystemValidator.swift:400 checkComponents()] ğŸ” [SystemValidator] Components: kanata=false, driver=true, daemon=false, vhid=false, vhidVersionMismatch=false
[2025-11-22 13:35:54.241] [INFO] [SystemValidator.swift:220 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 3 (Components) completed in 2.981s
[2025-11-22 13:35:54.241] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 20% (1/5 steps)
[2025-11-22 13:35:54.241] [INFO] [SystemValidator.swift:484 checkHealth()] ğŸ” [SystemValidator] Checking system health
[2025-11-22 13:35:54.242] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:35:54.312] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:35:54.312] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:35:54.385] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:35:54.428] [INFO] [HelperManager.swift:248 getHelperVersion()] âš ï¸ [HelperManager] getVersion timed out - clearing connection cache
[2025-11-22 13:35:54.428] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:35:54.456] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.071s)
[2025-11-22 13:35:54.456] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:35:55.037] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.071s)
[2025-11-22 13:35:55.037] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:35:55.037] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:35:55.037] [INFO] [SystemValidator.swift:494 checkHealth()] ğŸ” [SystemValidator] Health: kanata=false, daemon=false (launchctl), vhid=false
[2025-11-22 13:35:55.037] [INFO] [SystemValidator.swift:238 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 5 (Health) completed in 3.777s
[2025-11-22 13:35:55.038] [INFO] [SystemValidator.swift:418 checkConflicts()] ğŸ” [SystemValidator] Checking for conflicts
[2025-11-22 13:35:55.038] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 40% (2/5 steps)
[2025-11-22 13:35:55.038] [INFO] [ProcessLifecycleManager.swift:117 detectConflicts()] ğŸ” [ProcessLifecycleManager] Detecting conflicts...
[2025-11-22 13:35:55.038] [INFO] [ProcessLifecycleManager.swift:121 detectConflicts()] ğŸ§ª [TestEnvironment] Skipping process conflict detection - returning clean state
[2025-11-22 13:35:55.038] [INFO] [SystemValidator.swift:443 checkConflicts()] ğŸ” [SystemValidator] Total conflicts: 0 (0 kanata, 0 karabiner)
[2025-11-22 13:35:55.038] [INFO] [SystemValidator.swift:229 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 4 (Conflicts) completed in 3.777s
[2025-11-22 13:35:55.038] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 60% (3/5 steps)
[2025-11-22 13:35:55.039] [INFO] [SystemValidator.swift:362 checkPermissions()] ğŸ” [SystemValidator] Oracle snapshot: ready=false, age=3.777s
[2025-11-22 13:35:55.039] [INFO] [SystemValidator.swift:328 checkHelper()] ğŸ” [SystemValidator] Helper state: registeredButUnresponsive Helper registered but XPC communication failed
[2025-11-22 13:35:55.039] [INFO] [SystemValidator.swift:362 checkPermissions()] ğŸ” [SystemValidator] Oracle snapshot: ready=false, age=1.887s
[2025-11-22 13:35:55.039] [INFO] [SystemValidator.swift:202 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 1 (Helper) completed in 7.641s
[2025-11-22 13:35:55.039] [INFO] [SystemValidator.swift:328 checkHelper()] ğŸ” [SystemValidator] Helper state: registeredButUnresponsive Helper registered but XPC communication failed
[2025-11-22 13:35:55.039] [INFO] [SystemValidator.swift:211 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 2 (Permissions) completed in 5.670s
[2025-11-22 13:35:55.039] [INFO] [SystemValidator.swift:202 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 1 (Helper) completed in 5.670s
[2025-11-22 13:35:55.039] [INFO] [SystemValidator.swift:211 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 2 (Permissions) completed in 3.778s
[2025-11-22 13:35:55.039] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 100% (5/5 steps)
[2025-11-22 13:35:55.039] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 80% (4/5 steps)
[2025-11-22 13:35:55.039] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 80% (4/5 steps)
[2025-11-22 13:35:55.039] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 100% (5/5 steps)
[2025-11-22 13:35:55.039] [INFO] [SystemValidator.swift:283 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 COMPLETE: Total duration 7.641s
[2025-11-22 13:35:55.039] [INFO] [SystemValidator.swift:297 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Validation #1 complete in 7.641s
[2025-11-22 13:35:55.039] [INFO] [SystemValidator.swift:299 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Result: ready=false, blocking=9, total=9
Test Case '-[KeyPathTests.DiagnosticsServiceTests testAnalyzeLogFileWithCleanLogs]' passed (3.778 seconds).
Test Case '-[KeyPathTests.DiagnosticsServiceTests testAnalyzeLogFileWithConnectionError]' started.
[2025-11-22 13:35:55.040] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:35:55.040] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:35:55.040] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:35:55.040] [INFO] [SystemRequirements.swift:135 validateSystemCompatibility()] ğŸ” [SystemRequirements] Validating system compatibility
[2025-11-22 13:35:55.040] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:35:55.040] [INFO] [SystemRequirements.swift:147 validateSystemCompatibility()] âœ… [SystemRequirements] Modern macOS detected: 26.0.1
[2025-11-22 13:35:55.040] [INFO] [SystemRequirements.swift:190 validateSystemCompatibility()] ğŸ” [SystemRequirements] Compatibility check complete: âœ… Compatible
[2025-11-22 13:35:55.040] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:35:55.040] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:35:55.040] [INFO] [InstallerEngine.swift:78 inspectSystem()] âœ… [InstallerEngine] inspectSystem() complete - ready=false, blocking=9
[2025-11-22 13:35:55.040] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: repair, context:)
[2025-11-22 13:35:55.040] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: repair
[2025-11-22 13:35:55.040] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:35:55.041] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:35:55.041] [INFO] [InstallerEngine.swift:194 execute(plan:using:)] âš™ï¸ [InstallerEngine] Starting execute(plan:, using:)
[2025-11-22 13:35:55.041] [INFO] [InstallerEngine.swift:213 execute(plan:using:)] âš™ï¸ [InstallerEngine] Executing recipe: install-bundled-kanata (type: installComponent)
[2025-11-22 13:35:55.041] [INFO] [PrivilegedOperationsCoordinator.swift:359 installBundledKanata()] ğŸ” [PrivCoordinator] Installing bundled Kanata binary
[2025-11-22 13:35:55.041] [INFO] [LaunchDaemonInstaller.swift:2898 installBundledKanataBinaryOnly()] ğŸ”§ [LaunchDaemon] Installing bundled kanata binary to system location
[2025-11-22 13:35:55.041] [INFO] [LaunchDaemonInstaller.swift:2906 installBundledKanataBinaryOnly()] âŒ [LaunchDaemon] CRITICAL: Bundled kanata binary not found at: /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata
[2025-11-22 13:35:55.041] [INFO] [LaunchDaemonInstaller.swift:2908 installBundledKanataBinaryOnly()] âŒ [LaunchDaemon] This indicates a packaging issue - the app bundle is missing the kanata binary
[2025-11-22 13:35:55.041] [INFO] [InstallerEngine.swift:255 execute(plan:using:)] âŒ [InstallerEngine] Recipe install-bundled-kanata failed: Operation failed: Bundled Kanata installation failed
[2025-11-22 13:35:55.041] [INFO] [InstallerEngine.swift:274 execute(plan:using:)] âœ… [InstallerEngine] execute() complete - success: false, recipes executed: 1
[2025-11-22 13:35:55.041] [INFO] [InstallerEngine.swift:432 run(intent:using:)] âœ… [InstallerEngine] run() complete - success: false
[2025-11-22 13:35:55.042] [INFO] [ConfigFileWatcher.swift:208 stopWatching()] ğŸ“ [FileWatcher] Stopping all monitoring...
[2025-11-22 13:35:55.042] [INFO] [ConfigFileWatcher.swift:237 stopWatching()] âœ… [FileWatcher] All monitoring stopped and state cleared
[2025-11-22 13:35:55.042] [INFO] [ConfigFileWatcher.swift:45 deinit] ğŸ“ [FileWatcher] ConfigFileWatcher deinitialized
[2025-11-22 13:35:55.042] [INFO] [LayerChangeListener.swift:27 stop()] ğŸŒ [LayerListener] Stopping layer listener
[2025-11-22 13:35:55.042] [INFO] [SystemValidator.swift:283 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 COMPLETE: Total duration 5.673s
[2025-11-22 13:35:55.042] [INFO] [SystemValidator.swift:297 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Validation #1 complete in 5.673s
[2025-11-22 13:35:55.042] [INFO] [SystemValidator.swift:299 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Result: ready=false, blocking=9, total=9
[2025-11-22 13:35:55.042] [INFO] [SystemValidator.swift:283 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 COMPLETE: Total duration 7.644s
[2025-11-22 13:35:55.042] [INFO] [SystemValidator.swift:297 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Validation #1 complete in 7.644s
[2025-11-22 13:35:55.042] [INFO] [SystemValidator.swift:299 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Result: ready=false, blocking=9, total=9
[2025-11-22 13:35:55.043] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:35:55.043] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:35:55.043] [INFO] [SystemRequirements.swift:135 validateSystemCompatibility()] ğŸ” [SystemRequirements] Validating system compatibility
[2025-11-22 13:35:55.043] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:35:55.043] [INFO] [SystemRequirements.swift:147 validateSystemCompatibility()] âœ… [SystemRequirements] Modern macOS detected: 26.0.1
[2025-11-22 13:35:55.043] [INFO] [SystemRequirements.swift:190 validateSystemCompatibility()] ğŸ” [SystemRequirements] Compatibility check complete: âœ… Compatible
[2025-11-22 13:35:55.043] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:35:55.043] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:35:55.043] [INFO] [InstallerEngine.swift:78 inspectSystem()] âœ… [InstallerEngine] inspectSystem() complete - ready=false, blocking=9
[2025-11-22 13:35:55.043] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: repair, context:)
[2025-11-22 13:35:55.043] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: repair
[2025-11-22 13:35:55.043] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:35:55.043] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:35:55.043] [INFO] [InstallerEngine.swift:194 execute(plan:using:)] âš™ï¸ [InstallerEngine] Starting execute(plan:, using:)
[2025-11-22 13:35:55.043] [INFO] [InstallerEngine.swift:213 execute(plan:using:)] âš™ï¸ [InstallerEngine] Executing recipe: install-bundled-kanata (type: installComponent)
[2025-11-22 13:35:55.043] [INFO] [PrivilegedOperationsCoordinator.swift:359 installBundledKanata()] ğŸ” [PrivCoordinator] Installing bundled Kanata binary
[2025-11-22 13:35:55.043] [INFO] [LaunchDaemonInstaller.swift:2898 installBundledKanataBinaryOnly()] ğŸ”§ [LaunchDaemon] Installing bundled kanata binary to system location
[2025-11-22 13:35:55.043] [INFO] [LaunchDaemonInstaller.swift:2906 installBundledKanataBinaryOnly()] âŒ [LaunchDaemon] CRITICAL: Bundled kanata binary not found at: /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata
[2025-11-22 13:35:55.043] [INFO] [LaunchDaemonInstaller.swift:2908 installBundledKanataBinaryOnly()] âŒ [LaunchDaemon] This indicates a packaging issue - the app bundle is missing the kanata binary
[2025-11-22 13:35:55.044] [INFO] [InstallerEngine.swift:255 execute(plan:using:)] âŒ [InstallerEngine] Recipe install-bundled-kanata failed: Operation failed: Bundled Kanata installation failed
[2025-11-22 13:35:55.044] [INFO] [InstallerEngine.swift:274 execute(plan:using:)] âœ… [InstallerEngine] execute() complete - success: false, recipes executed: 1
[2025-11-22 13:35:55.044] [INFO] [InstallerEngine.swift:432 run(intent:using:)] âœ… [InstallerEngine] run() complete - success: false
[2025-11-22 13:35:55.044] [INFO] [ConfigFileWatcher.swift:208 stopWatching()] ğŸ“ [FileWatcher] Stopping all monitoring...
[2025-11-22 13:35:55.044] [INFO] [ConfigFileWatcher.swift:237 stopWatching()] âœ… [FileWatcher] All monitoring stopped and state cleared
[2025-11-22 13:35:55.044] [INFO] [ConfigFileWatcher.swift:45 deinit] ğŸ“ [FileWatcher] ConfigFileWatcher deinitialized
[2025-11-22 13:35:55.044] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:35:55.044] [INFO] [LayerChangeListener.swift:27 stop()] ğŸŒ [LayerListener] Stopping layer listener
[2025-11-22 13:35:55.044] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:35:55.044] [INFO] [SystemRequirements.swift:135 validateSystemCompatibility()] ğŸ” [SystemRequirements] Validating system compatibility
[2025-11-22 13:35:55.044] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:35:55.044] [INFO] [SystemRequirements.swift:147 validateSystemCompatibility()] âœ… [SystemRequirements] Modern macOS detected: 26.0.1
[2025-11-22 13:35:55.044] [INFO] [SystemRequirements.swift:190 validateSystemCompatibility()] ğŸ” [SystemRequirements] Compatibility check complete: âœ… Compatible
[2025-11-22 13:35:55.044] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:35:55.044] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:35:55.044] [INFO] [InstallerEngine.swift:78 inspectSystem()] âœ… [InstallerEngine] inspectSystem() complete - ready=false, blocking=9
[2025-11-22 13:35:55.044] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: repair, context:)
[2025-11-22 13:35:55.044] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: repair
[2025-11-22 13:35:55.044] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:35:55.044] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:35:55.044] [INFO] [InstallerEngine.swift:194 execute(plan:using:)] âš™ï¸ [InstallerEngine] Starting execute(plan:, using:)
[2025-11-22 13:35:55.044] [INFO] [InstallerEngine.swift:213 execute(plan:using:)] âš™ï¸ [InstallerEngine] Executing recipe: install-bundled-kanata (type: installComponent)
[2025-11-22 13:35:55.044] [INFO] [PrivilegedOperationsCoordinator.swift:359 installBundledKanata()] ğŸ” [PrivCoordinator] Installing bundled Kanata binary
[2025-11-22 13:35:55.044] [INFO] [LaunchDaemonInstaller.swift:2898 installBundledKanataBinaryOnly()] ğŸ”§ [LaunchDaemon] Installing bundled kanata binary to system location
[2025-11-22 13:35:55.044] [INFO] [LaunchDaemonInstaller.swift:2906 installBundledKanataBinaryOnly()] âŒ [LaunchDaemon] CRITICAL: Bundled kanata binary not found at: /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata
[2025-11-22 13:35:55.044] [INFO] [LaunchDaemonInstaller.swift:2908 installBundledKanataBinaryOnly()] âŒ [LaunchDaemon] This indicates a packaging issue - the app bundle is missing the kanata binary
[2025-11-22 13:35:55.044] [INFO] [InstallerEngine.swift:255 execute(plan:using:)] âŒ [InstallerEngine] Recipe install-bundled-kanata failed: Operation failed: Bundled Kanata installation failed
[2025-11-22 13:35:55.044] [INFO] [InstallerEngine.swift:274 execute(plan:using:)] âœ… [InstallerEngine] execute() complete - success: false, recipes executed: 1
[2025-11-22 13:35:55.044] [INFO] [InstallerEngine.swift:432 run(intent:using:)] âœ… [InstallerEngine] run() complete - success: false
[2025-11-22 13:35:55.044] [INFO] [ConfigFileWatcher.swift:208 stopWatching()] ğŸ“ [FileWatcher] Stopping all monitoring...
[2025-11-22 13:35:55.044] [INFO] [ConfigFileWatcher.swift:237 stopWatching()] âœ… [FileWatcher] All monitoring stopped and state cleared
[2025-11-22 13:35:55.044] [INFO] [ConfigFileWatcher.swift:45 deinit] ğŸ“ [FileWatcher] ConfigFileWatcher deinitialized
[2025-11-22 13:35:55.044] [INFO] [LayerChangeListener.swift:27 stop()] ğŸŒ [LayerListener] Stopping layer listener
Test Case '-[KeyPathTests.DiagnosticsServiceTests testAnalyzeLogFileWithConnectionError]' passed (0.005 seconds).
Test Case '-[KeyPathTests.DiagnosticsServiceTests testAnalyzeLogFileWithGenericError]' started.
[2025-11-22 13:35:55.045] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
Test Case '-[KeyPathTests.DiagnosticsServiceTests testAnalyzeLogFileWithGenericError]' passed (0.001 seconds).
Test Case '-[KeyPathTests.DiagnosticsServiceTests testAnalyzeLogFileWithPermissionError]' started.
[2025-11-22 13:35:55.046] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
Test Case '-[KeyPathTests.DiagnosticsServiceTests testAnalyzeLogFileWithPermissionError]' passed (0.001 seconds).
Test Case '-[KeyPathTests.DiagnosticsServiceTests testCheckProcessConflictsReturnsNonNilResult]' started.
[2025-11-22 13:35:55.047] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:35:55.047] [INFO] [ProcessLifecycleManager.swift:117 detectConflicts()] ğŸ” [ProcessLifecycleManager] Detecting conflicts...
[2025-11-22 13:35:55.047] [INFO] [ProcessLifecycleManager.swift:121 detectConflicts()] ğŸ§ª [TestEnvironment] Skipping process conflict detection - returning clean state
Test Case '-[KeyPathTests.DiagnosticsServiceTests testCheckProcessConflictsReturnsNonNilResult]' passed (0.000 seconds).
Test Case '-[KeyPathTests.DiagnosticsServiceTests testDiagnoseConfigurationError]' started.
[2025-11-22 13:35:55.047] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
Test Case '-[KeyPathTests.DiagnosticsServiceTests testDiagnoseConfigurationError]' passed (0.000 seconds).
Test Case '-[KeyPathTests.DiagnosticsServiceTests testDiagnoseDeviceConflict]' started.
[2025-11-22 13:35:55.047] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
Test Case '-[KeyPathTests.DiagnosticsServiceTests testDiagnoseDeviceConflict]' passed (0.000 seconds).
Test Case '-[KeyPathTests.DiagnosticsServiceTests testDiagnoseGenericExitCode6]' started.
[2025-11-22 13:35:55.048] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
Test Case '-[KeyPathTests.DiagnosticsServiceTests testDiagnoseGenericExitCode6]' passed (0.000 seconds).
Test Case '-[KeyPathTests.DiagnosticsServiceTests testDiagnosePermissionError]' started.
[2025-11-22 13:35:55.048] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
Test Case '-[KeyPathTests.DiagnosticsServiceTests testDiagnosePermissionError]' passed (0.000 seconds).
Test Case '-[KeyPathTests.DiagnosticsServiceTests testDiagnosePermissionRelatedUnknownExitCode]' started.
[2025-11-22 13:35:55.048] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
Test Case '-[KeyPathTests.DiagnosticsServiceTests testDiagnosePermissionRelatedUnknownExitCode]' passed (0.000 seconds).
Test Case '-[KeyPathTests.DiagnosticsServiceTests testDiagnoseSIGKILL]' started.
[2025-11-22 13:35:55.048] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
Test Case '-[KeyPathTests.DiagnosticsServiceTests testDiagnoseSIGKILL]' passed (0.000 seconds).
Test Case '-[KeyPathTests.DiagnosticsServiceTests testDiagnoseSIGTERM]' started.
[2025-11-22 13:35:55.048] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
Test Case '-[KeyPathTests.DiagnosticsServiceTests testDiagnoseSIGTERM]' passed (0.000 seconds).
Test Case '-[KeyPathTests.DiagnosticsServiceTests testDiagnoseUnknownExitCode]' started.
[2025-11-22 13:35:55.049] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
Test Case '-[KeyPathTests.DiagnosticsServiceTests testDiagnoseUnknownExitCode]' passed (0.000 seconds).
Test Case '-[KeyPathTests.DiagnosticsServiceTests testDiagnoseVirtualHIDConnectionFailure]' started.
[2025-11-22 13:35:55.049] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
Test Case '-[KeyPathTests.DiagnosticsServiceTests testDiagnoseVirtualHIDConnectionFailure]' passed (0.000 seconds).
Test Case '-[KeyPathTests.DiagnosticsServiceTests testDiagnosticCategoryRawValues]' started.
[2025-11-22 13:35:55.049] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
Test Case '-[KeyPathTests.DiagnosticsServiceTests testDiagnosticCategoryRawValues]' passed (0.000 seconds).
Test Case '-[KeyPathTests.DiagnosticsServiceTests testDiagnosticSeverityEmojis]' started.
[2025-11-22 13:35:55.049] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
Test Case '-[KeyPathTests.DiagnosticsServiceTests testDiagnosticSeverityEmojis]' passed (0.000 seconds).
Test Suite 'DiagnosticsServiceTests' passed at 2025-11-22 13:35:55.049.
	 Executed 17 tests, with 0 failures (0 unexpected) in 7.649 (7.651) seconds
Test Suite 'ErrorHandlingTests' started at 2025-11-22 13:35:55.049.
Test Case '-[KeyPathTests.ErrorHandlingTests testAsyncConfigurationErrors]' started.
[2025-11-22 13:35:55.049] [INFO] [KanataManager.swift:325 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] init() called
[2025-11-22 13:35:55.049] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:35:55.049] [INFO] [ConfigFileWatcher.swift:40 init()] ğŸ“ [FileWatcher] ConfigFileWatcher initialized with robust monitoring
[2025-11-22 13:35:55.050] [INFO] [ServiceHealthMonitor.swift:140 init(processLifecycle:)] [HealthMonitor] Initialized with process lifecycle manager
[2025-11-22 13:35:55.050] [DEBUG] [KanataManager.swift:397 init(engineClient:injectedConfigurationService:)] ğŸ§ª [KanataManager] Skipping background initialization in test environment
[2025-11-22 13:35:55.050] [INFO] [KanataManager.swift:405 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] About to call bootstrapRuleCollections and startLayerMonitoring
[2025-11-22 13:35:55.050] [INFO] [KanataManager.swift:577 startLayerMonitoring()] ğŸŒ [KanataManager] startLayerMonitoring() called
[2025-11-22 13:35:55.050] [INFO] [KanataManager.swift:579 startLayerMonitoring()] ğŸŒ [KanataManager] Skipping layer monitoring (test environment)
[2025-11-22 13:35:55.050] [INFO] [KanataManager.swift:409 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] init() completed
[2025-11-22 13:35:55.050] [INFO] [ConfigFileWatcher.swift:54 suppressEvents(for:reason:)] ğŸ”‡ [FileWatcher] Suppressing events for 1.0s - Internal saveConfiguration
Test Case '-[KeyPathTests.ErrorHandlingTests testAsyncConfigurationErrors]' passed (0.001 seconds).
Test Case '-[KeyPathTests.ErrorHandlingTests testAsyncResetConfigurationErrors]' started.
[2025-11-22 13:35:55.050] [INFO] [KanataManager.swift:325 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] init() called
[2025-11-22 13:35:55.050] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:35:55.050] [INFO] [ConfigFileWatcher.swift:40 init()] ğŸ“ [FileWatcher] ConfigFileWatcher initialized with robust monitoring
[2025-11-22 13:35:55.050] [INFO] [ServiceHealthMonitor.swift:140 init(processLifecycle:)] [HealthMonitor] Initialized with process lifecycle manager
[2025-11-22 13:35:55.050] [DEBUG] [KanataManager.swift:397 init(engineClient:injectedConfigurationService:)] ğŸ§ª [KanataManager] Skipping background initialization in test environment
[2025-11-22 13:35:55.050] [INFO] [KanataManager.swift:405 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] About to call bootstrapRuleCollections and startLayerMonitoring
[2025-11-22 13:35:55.050] [INFO] [KanataManager.swift:577 startLayerMonitoring()] ğŸŒ [KanataManager] startLayerMonitoring() called
[2025-11-22 13:35:55.050] [INFO] [KanataManager.swift:579 startLayerMonitoring()] ğŸŒ [KanataManager] Skipping layer monitoring (test environment)
[2025-11-22 13:35:55.050] [INFO] [KanataManager.swift:409 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] init() completed
[2025-11-22 13:35:55.050] [INFO] [KanataManager.swift:1988 resetToDefaultConfig()] ğŸ”„ [Reset] Forcing reset to default config (no validation - recovery mode)
[2025-11-22 13:35:55.052] [INFO] [ConfigBackupManager.swift:61 createPreEditBackup()] âœ… [BackupManager] Created pre-edit backup: keypath_2025-11-22_21-35-55.kbd
[2025-11-22 13:35:55.054] [INFO] [ConfigBackupManager.swift:190 cleanupOldBackups()] ğŸ—‘ï¸ [BackupManager] Deleted old backup: keypath_2025-11-22_17-41-59.kbd
[2025-11-22 13:35:55.054] [INFO] [KanataManager.swift:1994 resetToDefaultConfig()] ğŸ’¾ [Reset] Safety backup created before default reset
[2025-11-22 13:35:55.054] [INFO] [KanataManager.swift:2011 resetToDefaultConfig()] ğŸ’¾ [Config] Reset to default configuration (macOS Function Keys only)
[2025-11-22 13:35:55.054] [INFO] [KanataManager.swift:603 updateActiveLayerName(_:)] ğŸ¯ [KanataManager] updateActiveLayerName: raw='base' normalized='base' display='Base' current='Base'
[2025-11-22 13:35:55.054] [INFO] [KanataManager.swift:603 updateActiveLayerName(_:)] ğŸ¯ [KanataManager] updateActiveLayerName: raw='base' normalized='base' display='Base' current='Base'
[2025-11-22 13:35:55.055] [INFO] [KanataManager.swift:603 updateActiveLayerName(_:)] ğŸ¯ [KanataManager] updateActiveLayerName: raw='base' normalized='base' display='Base' current='Base'
[2025-11-22 13:35:55.055] [INFO] [KanataManager.swift:603 updateActiveLayerName(_:)] ğŸ¯ [KanataManager] updateActiveLayerName: raw='base' normalized='base' display='Base' current='Base'
[2025-11-22 13:35:55.055] [INFO] [KanataManager.swift:2025 resetToDefaultConfig()] ğŸ”„ [Reset] Updated stores and manager properties to match default state
[2025-11-22 13:35:55.055] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:35:55.055] [INFO] [SystemValidator.swift:63 init(launchDaemonInstaller:vhidDeviceManager:processLifecycleManager:kanataManager:)] ğŸ” [SystemValidator] Initialized (stateless, no cache)
[2025-11-22 13:35:55.055] [INFO] [InstallerEngine.swift:35 init(processLifecycleManager:kanataManager:)] ğŸ”§ [InstallerEngine] Initialized
[2025-11-22 13:35:55.055] [INFO] [InstallerEngine.swift:53 inspectSystem()] ğŸ” [InstallerEngine] Starting inspectSystem()
[2025-11-22 13:35:55.055] [INFO] [SystemValidator.swift:143 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Starting validation #1
[2025-11-22 13:35:55.055] [INFO] [SystemValidator.swift:174 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 START: 1763847355.055
[2025-11-22 13:35:55.055] [INFO] [SystemValidator.swift:312 checkHelper()] ğŸ” [SystemValidator] Checking privileged helper
[2025-11-22 13:35:55.055] [INFO] [SystemValidator.swift:344 checkPermissions()] ğŸ” [SystemValidator] Checking permissions via Oracle
[2025-11-22 13:35:55.055] [INFO] [SystemValidator.swift:372 checkComponents()] ğŸ” [SystemValidator] Checking components
[2025-11-22 13:35:55.055] [INFO] [KanataBinaryDetector.swift:66 detectCurrentStatus()] ğŸ” [KanataBinaryDetector] Starting unified kanata binary detection
[2025-11-22 13:35:55.055] [INFO] [PermissionOracle.swift:173 currentSnapshot()] ğŸ”® [Oracle] Test mode snapshot generated (non-blocking)
[2025-11-22 13:35:55.055] [INFO] [KanataBinaryDetector.swift:81 detectCurrentStatus()] âŒ [KanataBinaryDetector] No kanata binary found
[2025-11-22 13:35:55.055] [INFO] [VHIDDeviceManager.swift:50 detectInstallation()] ğŸ” [VHIDManager] Manager app exists at /Applications/.Karabiner-VirtualHIDDevice-Manager.app/Contents/MacOS/Karabiner-VirtualHIDDevice-Manager: true
[2025-11-22 13:35:55.062] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:35:55.067] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:35:55.086] [INFO] [HelperManager.swift:830 verifyEmbeddedHelperSignature()] ğŸ”’ [HelperManager] Embedded helper signature looks valid
[2025-11-22 13:35:55.086] [INFO] [HelperManager.swift:105 getConnection()] ğŸ”— [HelperManager] Creating XPC connection to com.keypath.helper
[2025-11-22 13:35:55.086] [INFO] [HelperManager.swift:129 getConnection()] âœ… [HelperManager] XPC connection established (PID: 0)
[2025-11-22 13:35:55.086] [INFO] [HelperManager.swift:228 getHelperVersion()] ğŸ“¤ [HelperManager] Calling proxy.getVersion()
[2025-11-22 13:35:55.086] [INFO] [HelperManager.swift:243 getHelperVersion()] ğŸ“¤ [HelperManager] proxy.getVersion() call dispatched, waiting for callback
[2025-11-22 13:35:55.087] [INFO] [HelperManager.swift:121 getConnection()] âš ï¸ [HelperManager] XPC connection interrupted - will reconnect
[2025-11-22 13:35:55.087] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:35:55.087] [INFO] [HelperManager.swift:578 getRemoteProxy(errorHandler:)] âŒ [HelperManager] XPC proxy error: Couldnâ€™t communicate with a helper application.
[2025-11-22 13:35:55.087] [INFO] [HelperManager.swift:584 getRemoteProxy(errorHandler:)] âš ï¸ [HelperManager] XPC connection interrupted - this may indicate:
[2025-11-22 13:35:55.087] [INFO] [HelperManager.swift:585 getRemoteProxy(errorHandler:)]    1. Helper signature validation failed (app updated but not restarted)
[2025-11-22 13:35:55.087] [INFO] [HelperManager.swift:587 getRemoteProxy(errorHandler:)]    2. Helper process crashed
[2025-11-22 13:35:55.087] [INFO] [HelperManager.swift:588 getRemoteProxy(errorHandler:)]    3. Helper was killed by the system
[2025-11-22 13:35:55.087] [INFO] [HelperManager.swift:589 getRemoteProxy(errorHandler:)] ğŸ’¡ If you just updated KeyPath, try restarting the app
[2025-11-22 13:35:55.087] [INFO] [HelperManager.swift:116 getConnection()] âŒ [HelperManager] XPC connection invalidated
[2025-11-22 13:35:55.087] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:35:55.128] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.073s)
[2025-11-22 13:35:55.128] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:35:55.709] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.071s)
[2025-11-22 13:35:55.709] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:35:55.709] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:35:55.710] [INFO] [VHIDDeviceManager.swift:343 getInstalledVersion()] ğŸ” [VHIDManager] Installed daemon version: 5.0.0
[2025-11-22 13:35:55.710] [INFO] [VHIDDeviceManager.swift:374 hasVersionMismatch()] âœ… [VHIDManager] Version compatible: v5.0.0
[2025-11-22 13:35:55.710] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:35:55.782] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:35:55.782] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:35:55.783] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:35:55.783] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:35:55.783] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:35:55.783] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:35:55.783] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:35:55.783] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:35:55.783] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:35:55.783] [INFO] [LaunchDaemonInstaller.swift:669 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Kanata service state: Uninstalled
[2025-11-22 13:35:55.783] [INFO] [LaunchDaemonInstaller.swift:696 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Service not installed (state: Uninstalled)
[2025-11-22 13:35:55.783] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:35:55.854] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:35:55.927] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhiddaemon loaded: false
[2025-11-22 13:35:56.001] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhidmanager loaded: false
[2025-11-22 13:35:56.001] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:35:56.072] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:35:56.073] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhidmanager
[2025-11-22 13:35:56.145] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhidmanager not found in system domain
[2025-11-22 13:35:56.145] [INFO] [SystemValidator.swift:400 checkComponents()] ğŸ” [SystemValidator] Components: kanata=false, driver=true, daemon=false, vhid=false, vhidVersionMismatch=false
[2025-11-22 13:35:56.145] [INFO] [SystemValidator.swift:418 checkConflicts()] ğŸ” [SystemValidator] Checking for conflicts
[2025-11-22 13:35:56.145] [INFO] [ProcessLifecycleManager.swift:117 detectConflicts()] ğŸ” [ProcessLifecycleManager] Detecting conflicts...
[2025-11-22 13:35:56.145] [INFO] [SystemValidator.swift:220 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 3 (Components) completed in 1.090s
[2025-11-22 13:35:56.145] [INFO] [ProcessLifecycleManager.swift:121 detectConflicts()] ğŸ§ª [TestEnvironment] Skipping process conflict detection - returning clean state
[2025-11-22 13:35:56.145] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 20% (1/5 steps)
[2025-11-22 13:35:56.145] [INFO] [SystemValidator.swift:443 checkConflicts()] ğŸ” [SystemValidator] Total conflicts: 0 (0 kanata, 0 karabiner)
[2025-11-22 13:35:56.145] [INFO] [SystemValidator.swift:484 checkHealth()] ğŸ” [SystemValidator] Checking system health
[2025-11-22 13:35:56.145] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:35:56.145] [INFO] [SystemValidator.swift:229 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 4 (Conflicts) completed in 1.090s
[2025-11-22 13:35:56.145] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 40% (2/5 steps)
[2025-11-22 13:35:56.218] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:35:56.218] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:35:56.289] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:35:56.328] [INFO] [HelperManager.swift:248 getHelperVersion()] âš ï¸ [HelperManager] getVersion timed out - clearing connection cache
[2025-11-22 13:35:56.328] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:35:56.361] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.071s)
[2025-11-22 13:35:56.361] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:35:56.944] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.073s)
[2025-11-22 13:35:56.944] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:35:56.944] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:35:56.945] [INFO] [SystemValidator.swift:494 checkHealth()] ğŸ” [SystemValidator] Health: kanata=false, daemon=false (launchctl), vhid=false
[2025-11-22 13:35:56.945] [INFO] [SystemValidator.swift:238 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 5 (Health) completed in 1.890s
[2025-11-22 13:35:56.945] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 60% (3/5 steps)
[2025-11-22 13:35:56.945] [INFO] [KanataManager.swift:603 updateActiveLayerName(_:)] ğŸ¯ [KanataManager] updateActiveLayerName: raw='base' normalized='base' display='Base' current='Base'
[2025-11-22 13:35:56.945] [INFO] [KanataManager.swift:603 updateActiveLayerName(_:)] ğŸ¯ [KanataManager] updateActiveLayerName: raw='base' normalized='base' display='Base' current='Base'
[2025-11-22 13:35:56.945] [INFO] [SystemValidator.swift:362 checkPermissions()] ğŸ” [SystemValidator] Oracle snapshot: ready=false, age=1.890s
[2025-11-22 13:35:56.945] [INFO] [SystemValidator.swift:211 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 2 (Permissions) completed in 1.890s
[2025-11-22 13:35:56.945] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 80% (4/5 steps)
[2025-11-22 13:35:56.946] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:35:56.946] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:35:56.946] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 3827 characters
[2025-11-22 13:35:56.946] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:35:56.946] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 18 src keys, 88 layer keys, deduplicated to 18 unique mappings
[2025-11-22 13:35:56.946] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:35:56.946] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:35:56.946] [INFO] [SystemValidator.swift:328 checkHelper()] ğŸ” [SystemValidator] Helper state: registeredButUnresponsive Helper registered but XPC communication failed
[2025-11-22 13:35:56.946] [INFO] [SystemValidator.swift:202 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 1 (Helper) completed in 5.685s
[2025-11-22 13:35:56.946] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 100% (5/5 steps)
[2025-11-22 13:35:56.946] [INFO] [SystemValidator.swift:283 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 COMPLETE: Total duration 5.685s
[2025-11-22 13:35:56.946] [INFO] [SystemValidator.swift:297 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Validation #1 complete in 5.686s
[2025-11-22 13:35:56.946] [INFO] [SystemValidator.swift:299 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Result: ready=false, blocking=9, total=9
[2025-11-22 13:35:56.947] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:35:56.947] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:35:56.947] [INFO] [SystemRequirements.swift:135 validateSystemCompatibility()] ğŸ” [SystemRequirements] Validating system compatibility
[2025-11-22 13:35:56.947] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:35:56.947] [INFO] [SystemRequirements.swift:147 validateSystemCompatibility()] âœ… [SystemRequirements] Modern macOS detected: 26.0.1
[2025-11-22 13:35:56.947] [INFO] [SystemRequirements.swift:190 validateSystemCompatibility()] ğŸ” [SystemRequirements] Compatibility check complete: âœ… Compatible
[2025-11-22 13:35:56.947] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:35:56.947] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:35:56.947] [INFO] [InstallerEngine.swift:78 inspectSystem()] âœ… [InstallerEngine] inspectSystem() complete - ready=false, blocking=9
[2025-11-22 13:35:56.947] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: repair, context:)
[2025-11-22 13:35:56.947] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: repair
[2025-11-22 13:35:56.947] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:35:56.947] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:35:56.947] [INFO] [InstallerEngine.swift:194 execute(plan:using:)] âš™ï¸ [InstallerEngine] Starting execute(plan:, using:)
[2025-11-22 13:35:56.947] [INFO] [InstallerEngine.swift:213 execute(plan:using:)] âš™ï¸ [InstallerEngine] Executing recipe: install-bundled-kanata (type: installComponent)
[2025-11-22 13:35:56.947] [INFO] [PrivilegedOperationsCoordinator.swift:359 installBundledKanata()] ğŸ” [PrivCoordinator] Installing bundled Kanata binary
[2025-11-22 13:35:56.947] [INFO] [LaunchDaemonInstaller.swift:2898 installBundledKanataBinaryOnly()] ğŸ”§ [LaunchDaemon] Installing bundled kanata binary to system location
[2025-11-22 13:35:56.947] [INFO] [LaunchDaemonInstaller.swift:2906 installBundledKanataBinaryOnly()] âŒ [LaunchDaemon] CRITICAL: Bundled kanata binary not found at: /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata
[2025-11-22 13:35:56.947] [INFO] [LaunchDaemonInstaller.swift:2908 installBundledKanataBinaryOnly()] âŒ [LaunchDaemon] This indicates a packaging issue - the app bundle is missing the kanata binary
[2025-11-22 13:35:56.947] [INFO] [InstallerEngine.swift:255 execute(plan:using:)] âŒ [InstallerEngine] Recipe install-bundled-kanata failed: Operation failed: Bundled Kanata installation failed
[2025-11-22 13:35:56.947] [INFO] [InstallerEngine.swift:274 execute(plan:using:)] âœ… [InstallerEngine] execute() complete - success: false, recipes executed: 1
[2025-11-22 13:35:56.947] [INFO] [InstallerEngine.swift:432 run(intent:using:)] âœ… [InstallerEngine] run() complete - success: false
[2025-11-22 13:35:56.947] [INFO] [ConfigFileWatcher.swift:208 stopWatching()] ğŸ“ [FileWatcher] Stopping all monitoring...
[2025-11-22 13:35:56.947] [INFO] [ConfigFileWatcher.swift:237 stopWatching()] âœ… [FileWatcher] All monitoring stopped and state cleared
[2025-11-22 13:35:56.947] [INFO] [ConfigFileWatcher.swift:45 deinit] ğŸ“ [FileWatcher] ConfigFileWatcher deinitialized
[2025-11-22 13:35:56.947] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 18 mappings
[2025-11-22 13:35:56.947] [DEBUG] [KanataManager+Configuration.swift:53 triggerConfigReload()] ğŸ“¡ [Reload] Attempting TCP reload
[2025-11-22 13:35:56.947] [DEBUG] [KanataManager+Configuration.swift:84 triggerTCPReload()] ğŸ§ª [TCP Reload] Skipping TCP reload in test environment
[2025-11-22 13:35:56.947] [DEBUG] [KanataManager+Configuration.swift:65 triggerConfigReload()] ğŸ“¡ [Reload] TCP reload failed: Test environment - TCP disabled
[2025-11-22 13:35:56.947] [WARN] [KanataManager+Configuration.swift:68 triggerConfigReload()] âš ï¸ [Reload] Falling back to service restart
[2025-11-22 13:35:56.947] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:35:56.947] [INFO] [SystemValidator.swift:63 init(launchDaemonInstaller:vhidDeviceManager:processLifecycleManager:kanataManager:)] ğŸ” [SystemValidator] Initialized (stateless, no cache)
[2025-11-22 13:35:56.947] [INFO] [InstallerEngine.swift:35 init(processLifecycleManager:kanataManager:)] ğŸ”§ [InstallerEngine] Initialized
[2025-11-22 13:35:56.947] [INFO] [InstallerEngine.swift:419 run(intent:using:)] ğŸš€ [InstallerEngine] Starting run(intent: repair, using:)
[2025-11-22 13:35:56.947] [INFO] [InstallerEngine.swift:53 inspectSystem()] ğŸ” [InstallerEngine] Starting inspectSystem()
[2025-11-22 13:35:56.947] [INFO] [LayerChangeListener.swift:27 stop()] ğŸŒ [LayerListener] Stopping layer listener
[2025-11-22 13:35:56.948] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:35:56.948] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:35:56.948] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 3827 characters
[2025-11-22 13:35:56.948] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:35:56.948] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 18 src keys, 88 layer keys, deduplicated to 18 unique mappings
[2025-11-22 13:35:56.948] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:35:56.948] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:35:56.948] [INFO] [SystemValidator.swift:143 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Starting validation #1
[2025-11-22 13:35:56.948] [INFO] [SystemValidator.swift:174 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 START: 1763847356.948
[2025-11-22 13:35:56.948] [INFO] [SystemValidator.swift:312 checkHelper()] ğŸ” [SystemValidator] Checking privileged helper
[2025-11-22 13:35:56.948] [INFO] [SystemValidator.swift:344 checkPermissions()] ğŸ” [SystemValidator] Checking permissions via Oracle
[2025-11-22 13:35:56.948] [INFO] [SystemValidator.swift:372 checkComponents()] ğŸ” [SystemValidator] Checking components
[2025-11-22 13:35:56.948] [INFO] [KanataBinaryDetector.swift:66 detectCurrentStatus()] ğŸ” [KanataBinaryDetector] Starting unified kanata binary detection
[2025-11-22 13:35:56.949] [INFO] [PermissionOracle.swift:173 currentSnapshot()] ğŸ”® [Oracle] Test mode snapshot generated (non-blocking)
[2025-11-22 13:35:56.949] [INFO] [KanataBinaryDetector.swift:81 detectCurrentStatus()] âŒ [KanataBinaryDetector] No kanata binary found
[2025-11-22 13:35:56.949] [INFO] [VHIDDeviceManager.swift:50 detectInstallation()] ğŸ” [VHIDManager] Manager app exists at /Applications/.Karabiner-VirtualHIDDevice-Manager.app/Contents/MacOS/Karabiner-VirtualHIDDevice-Manager: true
[2025-11-22 13:35:56.955] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:35:56.960] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:35:56.978] [INFO] [HelperManager.swift:830 verifyEmbeddedHelperSignature()] ğŸ”’ [HelperManager] Embedded helper signature looks valid
[2025-11-22 13:35:56.979] [INFO] [HelperManager.swift:105 getConnection()] ğŸ”— [HelperManager] Creating XPC connection to com.keypath.helper
[2025-11-22 13:35:56.979] [INFO] [HelperManager.swift:129 getConnection()] âœ… [HelperManager] XPC connection established (PID: 0)
[2025-11-22 13:35:56.979] [INFO] [HelperManager.swift:228 getHelperVersion()] ğŸ“¤ [HelperManager] Calling proxy.getVersion()
[2025-11-22 13:35:56.979] [INFO] [HelperManager.swift:243 getHelperVersion()] ğŸ“¤ [HelperManager] proxy.getVersion() call dispatched, waiting for callback
[2025-11-22 13:35:56.980] [INFO] [HelperManager.swift:121 getConnection()] âš ï¸ [HelperManager] XPC connection interrupted - will reconnect
[2025-11-22 13:35:56.980] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:35:56.980] [INFO] [HelperManager.swift:578 getRemoteProxy(errorHandler:)] âŒ [HelperManager] XPC proxy error: Couldnâ€™t communicate with a helper application.
[2025-11-22 13:35:56.980] [INFO] [HelperManager.swift:584 getRemoteProxy(errorHandler:)] âš ï¸ [HelperManager] XPC connection interrupted - this may indicate:
[2025-11-22 13:35:56.980] [INFO] [HelperManager.swift:585 getRemoteProxy(errorHandler:)]    1. Helper signature validation failed (app updated but not restarted)
[2025-11-22 13:35:56.980] [INFO] [HelperManager.swift:587 getRemoteProxy(errorHandler:)]    2. Helper process crashed
[2025-11-22 13:35:56.980] [INFO] [HelperManager.swift:588 getRemoteProxy(errorHandler:)]    3. Helper was killed by the system
[2025-11-22 13:35:56.980] [INFO] [HelperManager.swift:589 getRemoteProxy(errorHandler:)] ğŸ’¡ If you just updated KeyPath, try restarting the app
[2025-11-22 13:35:56.980] [INFO] [HelperManager.swift:116 getConnection()] âŒ [HelperManager] XPC connection invalidated
[2025-11-22 13:35:56.980] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:35:57.021] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.072s)
[2025-11-22 13:35:57.021] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:35:57.603] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.071s)
[2025-11-22 13:35:57.603] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:35:57.603] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:35:57.603] [INFO] [VHIDDeviceManager.swift:343 getInstalledVersion()] ğŸ” [VHIDManager] Installed daemon version: 5.0.0
[2025-11-22 13:35:57.603] [INFO] [VHIDDeviceManager.swift:374 hasVersionMismatch()] âœ… [VHIDManager] Version compatible: v5.0.0
[2025-11-22 13:35:57.603] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:35:57.676] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:35:57.677] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:35:57.677] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:35:57.677] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:35:57.677] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:35:57.677] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:35:57.677] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:35:57.677] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:35:57.677] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:35:57.677] [INFO] [LaunchDaemonInstaller.swift:669 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Kanata service state: Uninstalled
[2025-11-22 13:35:57.677] [INFO] [LaunchDaemonInstaller.swift:696 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Service not installed (state: Uninstalled)
[2025-11-22 13:35:57.677] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:35:57.751] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:35:57.824] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhiddaemon loaded: false
[2025-11-22 13:35:57.896] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhidmanager loaded: false
[2025-11-22 13:35:57.897] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:35:57.968] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:35:57.968] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhidmanager
[2025-11-22 13:35:58.040] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhidmanager not found in system domain
[2025-11-22 13:35:58.040] [INFO] [SystemValidator.swift:400 checkComponents()] ğŸ” [SystemValidator] Components: kanata=false, driver=true, daemon=false, vhid=false, vhidVersionMismatch=false
[2025-11-22 13:35:58.040] [INFO] [SystemValidator.swift:220 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 3 (Components) completed in 1.091s
[2025-11-22 13:35:58.040] [INFO] [SystemValidator.swift:484 checkHealth()] ğŸ” [SystemValidator] Checking system health
[2025-11-22 13:35:58.040] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:35:58.040] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 20% (1/5 steps)
[2025-11-22 13:35:58.113] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:35:58.113] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:35:58.178] [INFO] [HelperManager.swift:248 getHelperVersion()] âš ï¸ [HelperManager] getVersion timed out - clearing connection cache
[2025-11-22 13:35:58.178] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:35:58.185] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:35:58.255] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.071s)
[2025-11-22 13:35:58.256] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:35:58.837] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.071s)
[2025-11-22 13:35:58.837] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:35:58.837] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:35:58.837] [INFO] [SystemValidator.swift:494 checkHealth()] ğŸ” [SystemValidator] Health: kanata=false, daemon=false (launchctl), vhid=false
[2025-11-22 13:35:58.837] [INFO] [SystemValidator.swift:238 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 5 (Health) completed in 1.889s
[2025-11-22 13:35:58.837] [INFO] [SystemValidator.swift:418 checkConflicts()] ğŸ” [SystemValidator] Checking for conflicts
[2025-11-22 13:35:58.837] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 40% (2/5 steps)
[2025-11-22 13:35:58.837] [INFO] [ProcessLifecycleManager.swift:117 detectConflicts()] ğŸ” [ProcessLifecycleManager] Detecting conflicts...
[2025-11-22 13:35:58.837] [INFO] [ProcessLifecycleManager.swift:121 detectConflicts()] ğŸ§ª [TestEnvironment] Skipping process conflict detection - returning clean state
[2025-11-22 13:35:58.837] [INFO] [SystemValidator.swift:443 checkConflicts()] ğŸ” [SystemValidator] Total conflicts: 0 (0 kanata, 0 karabiner)
[2025-11-22 13:35:58.837] [INFO] [SystemValidator.swift:229 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 4 (Conflicts) completed in 1.889s
[2025-11-22 13:35:58.837] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 60% (3/5 steps)
[2025-11-22 13:35:58.838] [INFO] [SystemValidator.swift:362 checkPermissions()] ğŸ” [SystemValidator] Oracle snapshot: ready=false, age=1.889s
[2025-11-22 13:35:58.838] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 18 mappings
[2025-11-22 13:35:58.838] [INFO] [SystemValidator.swift:211 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 2 (Permissions) completed in 1.889s
[2025-11-22 13:35:58.838] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 80% (4/5 steps)
[2025-11-22 13:35:58.838] [DEBUG] [KanataManager+Configuration.swift:53 triggerConfigReload()] ğŸ“¡ [Reload] Attempting TCP reload
[2025-11-22 13:35:58.838] [DEBUG] [KanataManager+Configuration.swift:84 triggerTCPReload()] ğŸ§ª [TCP Reload] Skipping TCP reload in test environment
[2025-11-22 13:35:58.838] [DEBUG] [KanataManager+Configuration.swift:65 triggerConfigReload()] ğŸ“¡ [Reload] TCP reload failed: Test environment - TCP disabled
[2025-11-22 13:35:58.838] [WARN] [KanataManager+Configuration.swift:68 triggerConfigReload()] âš ï¸ [Reload] Falling back to service restart
[2025-11-22 13:35:58.838] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:35:58.838] [INFO] [SystemValidator.swift:63 init(launchDaemonInstaller:vhidDeviceManager:processLifecycleManager:kanataManager:)] ğŸ” [SystemValidator] Initialized (stateless, no cache)
[2025-11-22 13:35:58.838] [INFO] [InstallerEngine.swift:35 init(processLifecycleManager:kanataManager:)] ğŸ”§ [InstallerEngine] Initialized
[2025-11-22 13:35:58.838] [INFO] [InstallerEngine.swift:419 run(intent:using:)] ğŸš€ [InstallerEngine] Starting run(intent: repair, using:)
[2025-11-22 13:35:58.838] [INFO] [InstallerEngine.swift:53 inspectSystem()] ğŸ” [InstallerEngine] Starting inspectSystem()
[2025-11-22 13:35:58.838] [INFO] [SystemValidator.swift:328 checkHelper()] ğŸ” [SystemValidator] Helper state: registeredButUnresponsive Helper registered but XPC communication failed
[2025-11-22 13:35:58.838] [INFO] [SystemValidator.swift:202 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 1 (Helper) completed in 3.783s
[2025-11-22 13:35:58.838] [INFO] [SystemValidator.swift:143 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Starting validation #1
[2025-11-22 13:35:58.838] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 100% (5/5 steps)
[2025-11-22 13:35:58.838] [INFO] [SystemValidator.swift:174 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 START: 1763847358.838
[2025-11-22 13:35:58.838] [INFO] [SystemValidator.swift:312 checkHelper()] ğŸ” [SystemValidator] Checking privileged helper
[2025-11-22 13:35:58.838] [INFO] [SystemValidator.swift:344 checkPermissions()] ğŸ” [SystemValidator] Checking permissions via Oracle
[2025-11-22 13:35:58.838] [INFO] [SystemValidator.swift:372 checkComponents()] ğŸ” [SystemValidator] Checking components
[2025-11-22 13:35:58.838] [INFO] [KanataBinaryDetector.swift:66 detectCurrentStatus()] ğŸ” [KanataBinaryDetector] Starting unified kanata binary detection
[2025-11-22 13:35:58.838] [INFO] [PermissionOracle.swift:173 currentSnapshot()] ğŸ”® [Oracle] Test mode snapshot generated (non-blocking)
[2025-11-22 13:35:58.838] [INFO] [KanataBinaryDetector.swift:81 detectCurrentStatus()] âŒ [KanataBinaryDetector] No kanata binary found
[2025-11-22 13:35:58.838] [INFO] [VHIDDeviceManager.swift:50 detectInstallation()] ğŸ” [VHIDManager] Manager app exists at /Applications/.Karabiner-VirtualHIDDevice-Manager.app/Contents/MacOS/Karabiner-VirtualHIDDevice-Manager: true
[2025-11-22 13:35:58.847] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:35:58.852] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:35:58.870] [INFO] [HelperManager.swift:830 verifyEmbeddedHelperSignature()] ğŸ”’ [HelperManager] Embedded helper signature looks valid
[2025-11-22 13:35:58.870] [INFO] [HelperManager.swift:105 getConnection()] ğŸ”— [HelperManager] Creating XPC connection to com.keypath.helper
[2025-11-22 13:35:58.870] [INFO] [HelperManager.swift:129 getConnection()] âœ… [HelperManager] XPC connection established (PID: 0)
[2025-11-22 13:35:58.870] [INFO] [HelperManager.swift:228 getHelperVersion()] ğŸ“¤ [HelperManager] Calling proxy.getVersion()
[2025-11-22 13:35:58.870] [INFO] [HelperManager.swift:243 getHelperVersion()] ğŸ“¤ [HelperManager] proxy.getVersion() call dispatched, waiting for callback
[2025-11-22 13:35:58.871] [INFO] [HelperManager.swift:121 getConnection()] âš ï¸ [HelperManager] XPC connection interrupted - will reconnect
[2025-11-22 13:35:58.871] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:35:58.871] [INFO] [HelperManager.swift:578 getRemoteProxy(errorHandler:)] âŒ [HelperManager] XPC proxy error: Couldnâ€™t communicate with a helper application.
[2025-11-22 13:35:58.871] [INFO] [HelperManager.swift:584 getRemoteProxy(errorHandler:)] âš ï¸ [HelperManager] XPC connection interrupted - this may indicate:
[2025-11-22 13:35:58.871] [INFO] [HelperManager.swift:585 getRemoteProxy(errorHandler:)]    1. Helper signature validation failed (app updated but not restarted)
[2025-11-22 13:35:58.871] [INFO] [HelperManager.swift:587 getRemoteProxy(errorHandler:)]    2. Helper process crashed
[2025-11-22 13:35:58.871] [INFO] [HelperManager.swift:588 getRemoteProxy(errorHandler:)]    3. Helper was killed by the system
[2025-11-22 13:35:58.871] [INFO] [HelperManager.swift:589 getRemoteProxy(errorHandler:)] ğŸ’¡ If you just updated KeyPath, try restarting the app
[2025-11-22 13:35:58.871] [INFO] [HelperManager.swift:116 getConnection()] âŒ [HelperManager] XPC connection invalidated
[2025-11-22 13:35:58.871] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:35:58.909] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.070s)
[2025-11-22 13:35:58.909] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:35:59.492] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.073s)
[2025-11-22 13:35:59.492] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:35:59.492] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:35:59.493] [INFO] [VHIDDeviceManager.swift:343 getInstalledVersion()] ğŸ” [VHIDManager] Installed daemon version: 5.0.0
[2025-11-22 13:35:59.493] [INFO] [VHIDDeviceManager.swift:374 hasVersionMismatch()] âœ… [VHIDManager] Version compatible: v5.0.0
[2025-11-22 13:35:59.493] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:35:59.565] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:35:59.566] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:35:59.566] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:35:59.566] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:35:59.566] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:35:59.566] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:35:59.566] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:35:59.566] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:35:59.566] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:35:59.566] [INFO] [LaunchDaemonInstaller.swift:669 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Kanata service state: Uninstalled
[2025-11-22 13:35:59.566] [INFO] [LaunchDaemonInstaller.swift:696 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Service not installed (state: Uninstalled)
[2025-11-22 13:35:59.566] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:35:59.637] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:35:59.709] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhiddaemon loaded: false
[2025-11-22 13:35:59.780] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhidmanager loaded: false
[2025-11-22 13:35:59.780] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:35:59.854] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:35:59.854] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhidmanager
[2025-11-22 13:35:59.927] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhidmanager not found in system domain
[2025-11-22 13:35:59.927] [INFO] [SystemValidator.swift:400 checkComponents()] ğŸ” [SystemValidator] Components: kanata=false, driver=true, daemon=false, vhid=false, vhidVersionMismatch=false
[2025-11-22 13:35:59.927] [INFO] [SystemValidator.swift:220 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 3 (Components) completed in 1.090s
[2025-11-22 13:35:59.927] [INFO] [SystemValidator.swift:484 checkHealth()] ğŸ” [SystemValidator] Checking system health
[2025-11-22 13:35:59.927] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 20% (1/5 steps)
[2025-11-22 13:35:59.927] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:36:00.001] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:36:00.001] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:36:00.072] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:36:00.085] [INFO] [HelperManager.swift:248 getHelperVersion()] âš ï¸ [HelperManager] getVersion timed out - clearing connection cache
[2025-11-22 13:36:00.085] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:36:00.145] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.071s)
[2025-11-22 13:36:00.145] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:36:00.727] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.072s)
[2025-11-22 13:36:00.727] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:36:00.727] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:36:00.728] [INFO] [SystemValidator.swift:494 checkHealth()] ğŸ” [SystemValidator] Health: kanata=false, daemon=false (launchctl), vhid=false
[2025-11-22 13:36:00.728] [INFO] [SystemValidator.swift:238 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 5 (Health) completed in 1.890s
[2025-11-22 13:36:00.728] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 40% (2/5 steps)
[2025-11-22 13:36:00.728] [INFO] [SystemValidator.swift:418 checkConflicts()] ğŸ” [SystemValidator] Checking for conflicts
[2025-11-22 13:36:00.728] [INFO] [ProcessLifecycleManager.swift:117 detectConflicts()] ğŸ” [ProcessLifecycleManager] Detecting conflicts...
[2025-11-22 13:36:00.728] [INFO] [ProcessLifecycleManager.swift:121 detectConflicts()] ğŸ§ª [TestEnvironment] Skipping process conflict detection - returning clean state
[2025-11-22 13:36:00.728] [INFO] [SystemValidator.swift:443 checkConflicts()] ğŸ” [SystemValidator] Total conflicts: 0 (0 kanata, 0 karabiner)
[2025-11-22 13:36:00.728] [INFO] [SystemValidator.swift:283 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 COMPLETE: Total duration 5.673s
[2025-11-22 13:36:00.728] [INFO] [SystemValidator.swift:297 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Validation #1 complete in 5.673s
[2025-11-22 13:36:00.728] [INFO] [SystemValidator.swift:229 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 4 (Conflicts) completed in 1.890s
[2025-11-22 13:36:00.728] [INFO] [SystemValidator.swift:299 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Result: ready=false, blocking=9, total=9
[2025-11-22 13:36:00.728] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 60% (3/5 steps)
[2025-11-22 13:36:00.728] [INFO] [SystemValidator.swift:362 checkPermissions()] ğŸ” [SystemValidator] Oracle snapshot: ready=false, age=1.890s
[2025-11-22 13:36:00.728] [INFO] [SystemValidator.swift:328 checkHelper()] ğŸ” [SystemValidator] Helper state: registeredButUnresponsive Helper registered but XPC communication failed
[2025-11-22 13:36:00.728] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:36:00.728] [INFO] [SystemValidator.swift:211 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 2 (Permissions) completed in 1.890s
[2025-11-22 13:36:00.728] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:36:00.728] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 80% (4/5 steps)
[2025-11-22 13:36:00.728] [INFO] [SystemRequirements.swift:135 validateSystemCompatibility()] ğŸ” [SystemRequirements] Validating system compatibility
[2025-11-22 13:36:00.728] [INFO] [SystemValidator.swift:202 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 1 (Helper) completed in 3.780s
[2025-11-22 13:36:00.728] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:36:00.728] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 100% (5/5 steps)
[2025-11-22 13:36:00.728] [INFO] [SystemRequirements.swift:147 validateSystemCompatibility()] âœ… [SystemRequirements] Modern macOS detected: 26.0.1
[2025-11-22 13:36:00.728] [INFO] [SystemRequirements.swift:190 validateSystemCompatibility()] ğŸ” [SystemRequirements] Compatibility check complete: âœ… Compatible
[2025-11-22 13:36:00.728] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:36:00.728] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:36:00.728] [INFO] [InstallerEngine.swift:78 inspectSystem()] âœ… [InstallerEngine] inspectSystem() complete - ready=false, blocking=9
Test Case '-[KeyPathTests.ErrorHandlingTests testAsyncResetConfigurationErrors]' passed (5.679 seconds).
Test Case '-[KeyPathTests.ErrorHandlingTests testCommandKeyMappingErrorHandling]' started.
[2025-11-22 13:36:00.729] [INFO] [KanataManager.swift:325 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] init() called
[2025-11-22 13:36:00.729] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:36:00.729] [INFO] [ConfigFileWatcher.swift:40 init()] ğŸ“ [FileWatcher] ConfigFileWatcher initialized with robust monitoring
[2025-11-22 13:36:00.729] [INFO] [ServiceHealthMonitor.swift:140 init(processLifecycle:)] [HealthMonitor] Initialized with process lifecycle manager
[2025-11-22 13:36:00.729] [DEBUG] [KanataManager.swift:397 init(engineClient:injectedConfigurationService:)] ğŸ§ª [KanataManager] Skipping background initialization in test environment
[2025-11-22 13:36:00.729] [INFO] [KanataManager.swift:405 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] About to call bootstrapRuleCollections and startLayerMonitoring
[2025-11-22 13:36:00.729] [INFO] [KanataManager.swift:577 startLayerMonitoring()] ğŸŒ [KanataManager] startLayerMonitoring() called
[2025-11-22 13:36:00.729] [INFO] [KanataManager.swift:579 startLayerMonitoring()] ğŸŒ [KanataManager] Skipping layer monitoring (test environment)
[2025-11-22 13:36:00.729] [INFO] [KanataManager.swift:409 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] init() completed
Test Case '-[KeyPathTests.ErrorHandlingTests testCommandKeyMappingErrorHandling]' passed (0.001 seconds).
Test Case '-[KeyPathTests.ErrorHandlingTests testConcurrentConfigurationOperations]' started.
[2025-11-22 13:36:00.730] [INFO] [SystemValidator.swift:283 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 COMPLETE: Total duration 3.782s
[2025-11-22 13:36:00.730] [INFO] [SystemValidator.swift:297 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Validation #1 complete in 3.782s
[2025-11-22 13:36:00.730] [INFO] [SystemValidator.swift:299 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Result: ready=false, blocking=9, total=9
[2025-11-22 13:36:00.730] [INFO] [KanataManager.swift:325 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] init() called
[2025-11-22 13:36:00.730] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:36:00.730] [INFO] [ConfigFileWatcher.swift:40 init()] ğŸ“ [FileWatcher] ConfigFileWatcher initialized with robust monitoring
[2025-11-22 13:36:00.730] [INFO] [ServiceHealthMonitor.swift:140 init(processLifecycle:)] [HealthMonitor] Initialized with process lifecycle manager
[2025-11-22 13:36:00.730] [DEBUG] [KanataManager.swift:397 init(engineClient:injectedConfigurationService:)] ğŸ§ª [KanataManager] Skipping background initialization in test environment
[2025-11-22 13:36:00.730] [INFO] [KanataManager.swift:405 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] About to call bootstrapRuleCollections and startLayerMonitoring
[2025-11-22 13:36:00.730] [INFO] [KanataManager.swift:577 startLayerMonitoring()] ğŸŒ [KanataManager] startLayerMonitoring() called
[2025-11-22 13:36:00.730] [INFO] [KanataManager.swift:579 startLayerMonitoring()] ğŸŒ [KanataManager] Skipping layer monitoring (test environment)
[2025-11-22 13:36:00.730] [INFO] [KanataManager.swift:409 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] init() completed
[2025-11-22 13:36:00.730] [INFO] [ConfigFileWatcher.swift:54 suppressEvents(for:reason:)] ğŸ”‡ [FileWatcher] Suppressing events for 1.0s - Internal saveConfiguration
[2025-11-22 13:36:00.730] [INFO] [ConfigFileWatcher.swift:54 suppressEvents(for:reason:)] ğŸ”‡ [FileWatcher] Suppressing events for 1.0s - Internal saveConfiguration
[2025-11-22 13:36:00.730] [INFO] [ConfigFileWatcher.swift:54 suppressEvents(for:reason:)] ğŸ”‡ [FileWatcher] Suppressing events for 1.0s - Internal saveConfiguration
[2025-11-22 13:36:00.730] [INFO] [ConfigFileWatcher.swift:54 suppressEvents(for:reason:)] ğŸ”‡ [FileWatcher] Suppressing events for 1.0s - Internal saveConfiguration
[2025-11-22 13:36:00.730] [INFO] [ConfigFileWatcher.swift:54 suppressEvents(for:reason:)] ğŸ”‡ [FileWatcher] Suppressing events for 1.0s - Internal saveConfiguration
[2025-11-22 13:36:00.730] [INFO] [ConfigFileWatcher.swift:54 suppressEvents(for:reason:)] ğŸ”‡ [FileWatcher] Suppressing events for 1.0s - Internal saveConfiguration
[2025-11-22 13:36:00.730] [INFO] [ConfigFileWatcher.swift:54 suppressEvents(for:reason:)] ğŸ”‡ [FileWatcher] Suppressing events for 1.0s - Internal saveConfiguration
[2025-11-22 13:36:00.730] [INFO] [ConfigFileWatcher.swift:54 suppressEvents(for:reason:)] ğŸ”‡ [FileWatcher] Suppressing events for 1.0s - Internal saveConfiguration
[2025-11-22 13:36:00.730] [INFO] [ConfigFileWatcher.swift:54 suppressEvents(for:reason:)] ğŸ”‡ [FileWatcher] Suppressing events for 1.0s - Internal saveConfiguration
[2025-11-22 13:36:00.730] [INFO] [ConfigFileWatcher.swift:54 suppressEvents(for:reason:)] ğŸ”‡ [FileWatcher] Suppressing events for 1.0s - Internal saveConfiguration
[2025-11-22 13:36:00.730] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:36:00.730] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:36:00.730] [INFO] [SystemRequirements.swift:135 validateSystemCompatibility()] ğŸ” [SystemRequirements] Validating system compatibility
[2025-11-22 13:36:00.730] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:36:00.730] [INFO] [SystemRequirements.swift:147 validateSystemCompatibility()] âœ… [SystemRequirements] Modern macOS detected: 26.0.1
[2025-11-22 13:36:00.730] [INFO] [SystemRequirements.swift:190 validateSystemCompatibility()] ğŸ” [SystemRequirements] Compatibility check complete: âœ… Compatible
[2025-11-22 13:36:00.730] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:36:00.730] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:36:00.730] [INFO] [InstallerEngine.swift:78 inspectSystem()] âœ… [InstallerEngine] inspectSystem() complete - ready=false, blocking=9
[2025-11-22 13:36:00.730] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: repair, context:)
[2025-11-22 13:36:00.730] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: repair
[2025-11-22 13:36:00.730] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:36:00.730] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:36:00.730] [INFO] [InstallerEngine.swift:194 execute(plan:using:)] âš™ï¸ [InstallerEngine] Starting execute(plan:, using:)
[2025-11-22 13:36:00.730] [INFO] [InstallerEngine.swift:213 execute(plan:using:)] âš™ï¸ [InstallerEngine] Executing recipe: install-bundled-kanata (type: installComponent)
[2025-11-22 13:36:00.730] [INFO] [PrivilegedOperationsCoordinator.swift:359 installBundledKanata()] ğŸ” [PrivCoordinator] Installing bundled Kanata binary
[2025-11-22 13:36:00.731] [INFO] [LaunchDaemonInstaller.swift:2898 installBundledKanataBinaryOnly()] ğŸ”§ [LaunchDaemon] Installing bundled kanata binary to system location
[2025-11-22 13:36:00.731] [INFO] [LaunchDaemonInstaller.swift:2906 installBundledKanataBinaryOnly()] âŒ [LaunchDaemon] CRITICAL: Bundled kanata binary not found at: /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata
[2025-11-22 13:36:00.731] [INFO] [LaunchDaemonInstaller.swift:2908 installBundledKanataBinaryOnly()] âŒ [LaunchDaemon] This indicates a packaging issue - the app bundle is missing the kanata binary
[2025-11-22 13:36:00.731] [INFO] [InstallerEngine.swift:255 execute(plan:using:)] âŒ [InstallerEngine] Recipe install-bundled-kanata failed: Operation failed: Bundled Kanata installation failed
[2025-11-22 13:36:00.731] [INFO] [InstallerEngine.swift:274 execute(plan:using:)] âœ… [InstallerEngine] execute() complete - success: false, recipes executed: 1
[2025-11-22 13:36:00.731] [INFO] [InstallerEngine.swift:432 run(intent:using:)] âœ… [InstallerEngine] run() complete - success: false
[2025-11-22 13:36:00.731] [INFO] [KanataManager.swift:603 updateActiveLayerName(_:)] ğŸ¯ [KanataManager] updateActiveLayerName: raw='base' normalized='base' display='Base' current='Base'
[2025-11-22 13:36:00.731] [INFO] [KanataManager.swift:603 updateActiveLayerName(_:)] ğŸ¯ [KanataManager] updateActiveLayerName: raw='base' normalized='base' display='Base' current='Base'
[2025-11-22 13:36:00.731] [INFO] [KanataManager.swift:814 backupCurrentConfig()] ğŸ’¾ [Backup] Current config backed up successfully
[2025-11-22 13:36:00.731] [INFO] [KanataManager.swift:814 backupCurrentConfig()] ğŸ’¾ [Backup] Current config backed up successfully
[2025-11-22 13:36:00.731] [INFO] [KanataManager.swift:814 backupCurrentConfig()] ğŸ’¾ [Backup] Current config backed up successfully
[2025-11-22 13:36:00.731] [INFO] [KanataManager.swift:814 backupCurrentConfig()] ğŸ’¾ [Backup] Current config backed up successfully
[2025-11-22 13:36:00.731] [INFO] [KanataManager.swift:814 backupCurrentConfig()] ğŸ’¾ [Backup] Current config backed up successfully
[2025-11-22 13:36:00.731] [INFO] [KanataManager.swift:814 backupCurrentConfig()] ğŸ’¾ [Backup] Current config backed up successfully
[2025-11-22 13:36:00.731] [INFO] [KanataManager.swift:814 backupCurrentConfig()] ğŸ’¾ [Backup] Current config backed up successfully
[2025-11-22 13:36:00.731] [INFO] [KanataManager.swift:814 backupCurrentConfig()] ğŸ’¾ [Backup] Current config backed up successfully
[2025-11-22 13:36:00.731] [INFO] [KanataManager.swift:814 backupCurrentConfig()] ğŸ’¾ [Backup] Current config backed up successfully
[2025-11-22 13:36:00.731] [INFO] [KanataManager.swift:814 backupCurrentConfig()] ğŸ’¾ [Backup] Current config backed up successfully
[2025-11-22 13:36:00.731] [INFO] [KanataManager.swift:603 updateActiveLayerName(_:)] ğŸ¯ [KanataManager] updateActiveLayerName: raw='base' normalized='base' display='Base' current='Base'
[2025-11-22 13:36:00.731] [INFO] [KanataManager.swift:603 updateActiveLayerName(_:)] ğŸ¯ [KanataManager] updateActiveLayerName: raw='base' normalized='base' display='Base' current='Base'
[2025-11-22 13:36:00.733] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:36:00.733] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:36:00.733] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 3827 characters
[2025-11-22 13:36:00.733] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:36:00.733] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 18 src keys, 88 layer keys, deduplicated to 18 unique mappings
[2025-11-22 13:36:00.733] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:36:00.733] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:36:00.734] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 18 mappings
[2025-11-22 13:36:00.734] [DEBUG] [KanataManager+Configuration.swift:53 triggerConfigReload()] ğŸ“¡ [Reload] Attempting TCP reload
[2025-11-22 13:36:00.734] [DEBUG] [KanataManager+Configuration.swift:84 triggerTCPReload()] ğŸ§ª [TCP Reload] Skipping TCP reload in test environment
[2025-11-22 13:36:00.734] [DEBUG] [KanataManager+Configuration.swift:65 triggerConfigReload()] ğŸ“¡ [Reload] TCP reload failed: Test environment - TCP disabled
[2025-11-22 13:36:00.734] [WARN] [KanataManager+Configuration.swift:68 triggerConfigReload()] âš ï¸ [Reload] Falling back to service restart
[2025-11-22 13:36:00.734] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:36:00.734] [INFO] [SystemValidator.swift:63 init(launchDaemonInstaller:vhidDeviceManager:processLifecycleManager:kanataManager:)] ğŸ” [SystemValidator] Initialized (stateless, no cache)
[2025-11-22 13:36:00.734] [INFO] [InstallerEngine.swift:35 init(processLifecycleManager:kanataManager:)] ğŸ”§ [InstallerEngine] Initialized
[2025-11-22 13:36:00.734] [INFO] [InstallerEngine.swift:419 run(intent:using:)] ğŸš€ [InstallerEngine] Starting run(intent: repair, using:)
[2025-11-22 13:36:00.734] [INFO] [InstallerEngine.swift:53 inspectSystem()] ğŸ” [InstallerEngine] Starting inspectSystem()
[2025-11-22 13:36:00.734] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:36:00.734] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:36:00.735] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 7007 characters
[2025-11-22 13:36:00.735] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:36:00.735] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 18 src keys, 88 layer keys, deduplicated to 18 unique mappings
[2025-11-22 13:36:00.735] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:36:00.735] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:36:00.735] [INFO] [SystemValidator.swift:143 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Starting validation #1
[2025-11-22 13:36:00.735] [INFO] [SystemValidator.swift:174 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 START: 1763847360.735
[2025-11-22 13:36:00.736] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:36:00.736] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:36:00.736] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 7007 characters
[2025-11-22 13:36:00.736] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:36:00.736] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 18 src keys, 88 layer keys, deduplicated to 18 unique mappings
[2025-11-22 13:36:00.736] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:36:00.736] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:36:00.737] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:36:00.737] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:36:00.737] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 7007 characters
[2025-11-22 13:36:00.737] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:36:00.737] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 18 src keys, 88 layer keys, deduplicated to 18 unique mappings
[2025-11-22 13:36:00.737] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:36:00.737] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:36:00.737] [INFO] [SystemValidator.swift:312 checkHelper()] ğŸ” [SystemValidator] Checking privileged helper
[2025-11-22 13:36:00.737] [INFO] [SystemValidator.swift:344 checkPermissions()] ğŸ” [SystemValidator] Checking permissions via Oracle
[2025-11-22 13:36:00.737] [INFO] [SystemValidator.swift:372 checkComponents()] ğŸ” [SystemValidator] Checking components
[2025-11-22 13:36:00.737] [INFO] [KanataBinaryDetector.swift:66 detectCurrentStatus()] ğŸ” [KanataBinaryDetector] Starting unified kanata binary detection
[2025-11-22 13:36:00.737] [INFO] [PermissionOracle.swift:173 currentSnapshot()] ğŸ”® [Oracle] Test mode snapshot generated (non-blocking)
[2025-11-22 13:36:00.737] [INFO] [KanataBinaryDetector.swift:81 detectCurrentStatus()] âŒ [KanataBinaryDetector] No kanata binary found
[2025-11-22 13:36:00.737] [INFO] [VHIDDeviceManager.swift:50 detectInstallation()] ğŸ” [VHIDManager] Manager app exists at /Applications/.Karabiner-VirtualHIDDevice-Manager.app/Contents/MacOS/Karabiner-VirtualHIDDevice-Manager: true
[2025-11-22 13:36:00.742] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:36:00.748] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:36:00.764] [INFO] [HelperManager.swift:830 verifyEmbeddedHelperSignature()] ğŸ”’ [HelperManager] Embedded helper signature looks valid
[2025-11-22 13:36:00.764] [INFO] [HelperManager.swift:105 getConnection()] ğŸ”— [HelperManager] Creating XPC connection to com.keypath.helper
[2025-11-22 13:36:00.764] [INFO] [HelperManager.swift:129 getConnection()] âœ… [HelperManager] XPC connection established (PID: 0)
[2025-11-22 13:36:00.764] [INFO] [HelperManager.swift:228 getHelperVersion()] ğŸ“¤ [HelperManager] Calling proxy.getVersion()
[2025-11-22 13:36:00.764] [INFO] [HelperManager.swift:243 getHelperVersion()] ğŸ“¤ [HelperManager] proxy.getVersion() call dispatched, waiting for callback
[2025-11-22 13:36:00.765] [INFO] [HelperManager.swift:121 getConnection()] âš ï¸ [HelperManager] XPC connection interrupted - will reconnect
[2025-11-22 13:36:00.765] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:36:00.765] [INFO] [HelperManager.swift:578 getRemoteProxy(errorHandler:)] âŒ [HelperManager] XPC proxy error: Couldnâ€™t communicate with a helper application.
[2025-11-22 13:36:00.765] [INFO] [HelperManager.swift:584 getRemoteProxy(errorHandler:)] âš ï¸ [HelperManager] XPC connection interrupted - this may indicate:
[2025-11-22 13:36:00.765] [INFO] [HelperManager.swift:585 getRemoteProxy(errorHandler:)]    1. Helper signature validation failed (app updated but not restarted)
[2025-11-22 13:36:00.765] [INFO] [HelperManager.swift:587 getRemoteProxy(errorHandler:)]    2. Helper process crashed
[2025-11-22 13:36:00.765] [INFO] [HelperManager.swift:588 getRemoteProxy(errorHandler:)]    3. Helper was killed by the system
[2025-11-22 13:36:00.765] [INFO] [HelperManager.swift:589 getRemoteProxy(errorHandler:)] ğŸ’¡ If you just updated KeyPath, try restarting the app
[2025-11-22 13:36:00.765] [INFO] [HelperManager.swift:116 getConnection()] âŒ [HelperManager] XPC connection invalidated
[2025-11-22 13:36:00.765] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:36:00.809] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.072s)
[2025-11-22 13:36:00.809] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:36:01.392] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.073s)
[2025-11-22 13:36:01.392] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:36:01.392] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:36:01.393] [INFO] [VHIDDeviceManager.swift:343 getInstalledVersion()] ğŸ” [VHIDManager] Installed daemon version: 5.0.0
[2025-11-22 13:36:01.393] [INFO] [VHIDDeviceManager.swift:374 hasVersionMismatch()] âœ… [VHIDManager] Version compatible: v5.0.0
[2025-11-22 13:36:01.393] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:36:01.463] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:36:01.464] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:36:01.464] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:36:01.464] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:36:01.464] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:36:01.465] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:36:01.465] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:36:01.465] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:36:01.465] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:36:01.465] [INFO] [LaunchDaemonInstaller.swift:669 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Kanata service state: Uninstalled
[2025-11-22 13:36:01.465] [INFO] [LaunchDaemonInstaller.swift:696 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Service not installed (state: Uninstalled)
[2025-11-22 13:36:01.465] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:36:01.538] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:36:01.609] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhiddaemon loaded: false
[2025-11-22 13:36:01.681] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhidmanager loaded: false
[2025-11-22 13:36:01.681] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:36:01.754] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:36:01.754] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhidmanager
[2025-11-22 13:36:01.827] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhidmanager not found in system domain
[2025-11-22 13:36:01.827] [INFO] [SystemValidator.swift:400 checkComponents()] ğŸ” [SystemValidator] Components: kanata=false, driver=true, daemon=false, vhid=false, vhidVersionMismatch=false
[2025-11-22 13:36:01.827] [INFO] [SystemValidator.swift:418 checkConflicts()] ğŸ” [SystemValidator] Checking for conflicts
[2025-11-22 13:36:01.827] [INFO] [SystemValidator.swift:220 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 3 (Components) completed in 1.092s
[2025-11-22 13:36:01.827] [INFO] [ProcessLifecycleManager.swift:117 detectConflicts()] ğŸ” [ProcessLifecycleManager] Detecting conflicts...
[2025-11-22 13:36:01.827] [INFO] [ProcessLifecycleManager.swift:121 detectConflicts()] ğŸ§ª [TestEnvironment] Skipping process conflict detection - returning clean state
[2025-11-22 13:36:01.827] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 20% (1/5 steps)
[2025-11-22 13:36:01.827] [INFO] [SystemValidator.swift:443 checkConflicts()] ğŸ” [SystemValidator] Total conflicts: 0 (0 kanata, 0 karabiner)
[2025-11-22 13:36:01.828] [INFO] [SystemValidator.swift:229 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 4 (Conflicts) completed in 1.092s
[2025-11-22 13:36:01.828] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 40% (2/5 steps)
[2025-11-22 13:36:01.828] [INFO] [SystemValidator.swift:484 checkHealth()] ğŸ” [SystemValidator] Checking system health
[2025-11-22 13:36:01.828] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:36:01.888] [INFO] [HelperManager.swift:248 getHelperVersion()] âš ï¸ [HelperManager] getVersion timed out - clearing connection cache
[2025-11-22 13:36:01.889] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:36:01.901] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:36:01.901] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:36:01.974] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:36:02.045] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.071s)
[2025-11-22 13:36:02.045] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:36:02.630] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.074s)
[2025-11-22 13:36:02.630] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:36:02.630] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:36:02.630] [INFO] [SystemValidator.swift:494 checkHealth()] ğŸ” [SystemValidator] Health: kanata=false, daemon=false (launchctl), vhid=false
[2025-11-22 13:36:02.630] [INFO] [SystemValidator.swift:238 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 5 (Health) completed in 1.895s
[2025-11-22 13:36:02.630] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 28 mappings
[2025-11-22 13:36:02.630] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 60% (3/5 steps)
[2025-11-22 13:36:02.630] [DEBUG] [KanataManager+Configuration.swift:53 triggerConfigReload()] ğŸ“¡ [Reload] Attempting TCP reload
[2025-11-22 13:36:02.630] [DEBUG] [KanataManager+Configuration.swift:84 triggerTCPReload()] ğŸ§ª [TCP Reload] Skipping TCP reload in test environment
[2025-11-22 13:36:02.630] [DEBUG] [KanataManager+Configuration.swift:65 triggerConfigReload()] ğŸ“¡ [Reload] TCP reload failed: Test environment - TCP disabled
[2025-11-22 13:36:02.630] [WARN] [KanataManager+Configuration.swift:68 triggerConfigReload()] âš ï¸ [Reload] Falling back to service restart
[2025-11-22 13:36:02.630] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:36:02.630] [INFO] [SystemValidator.swift:63 init(launchDaemonInstaller:vhidDeviceManager:processLifecycleManager:kanataManager:)] ğŸ” [SystemValidator] Initialized (stateless, no cache)
[2025-11-22 13:36:02.630] [INFO] [InstallerEngine.swift:35 init(processLifecycleManager:kanataManager:)] ğŸ”§ [InstallerEngine] Initialized
[2025-11-22 13:36:02.630] [INFO] [InstallerEngine.swift:419 run(intent:using:)] ğŸš€ [InstallerEngine] Starting run(intent: repair, using:)
[2025-11-22 13:36:02.630] [INFO] [InstallerEngine.swift:53 inspectSystem()] ğŸ” [InstallerEngine] Starting inspectSystem()
[2025-11-22 13:36:02.630] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:36:02.630] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:36:02.631] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 7007 characters
[2025-11-22 13:36:02.631] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:36:02.631] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 18 src keys, 88 layer keys, deduplicated to 18 unique mappings
[2025-11-22 13:36:02.631] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:36:02.631] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:36:02.632] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:36:02.632] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:36:02.632] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 7007 characters
[2025-11-22 13:36:02.632] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:36:02.632] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 18 src keys, 88 layer keys, deduplicated to 18 unique mappings
[2025-11-22 13:36:02.632] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:36:02.632] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:36:02.632] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 28 mappings
[2025-11-22 13:36:02.632] [DEBUG] [KanataManager.swift:1214 saveConfiguration(input:output:)] ğŸ“¡ [Config] Triggering TCP reload for validation
[2025-11-22 13:36:02.632] [DEBUG] [KanataManager+Configuration.swift:84 triggerTCPReload()] ğŸ§ª [TCP Reload] Skipping TCP reload in test environment
[2025-11-22 13:36:02.633] [ERROR] [KanataManager.swift:1230 saveConfiguration(input:output:)] âŒ [Config] TCP reload FAILED: Test environment - TCP disabled
[2025-11-22 13:36:02.633] [ERROR] [KanataManager.swift:1231 saveConfiguration(input:output:)] âŒ [Config] TCP server is required for validation-on-demand - restoring backup
[2025-11-22 13:36:02.633] [INFO] [KanataManager.swift:827 restoreLastGoodConfig()] ğŸ”„ [Restore] Restored last good config successfully
[2025-11-22 13:36:02.634] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:36:02.634] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:36:02.634] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 7007 characters
[2025-11-22 13:36:02.634] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:36:02.634] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 18 src keys, 88 layer keys, deduplicated to 18 unique mappings
[2025-11-22 13:36:02.634] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:36:02.634] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:36:02.634] [INFO] [SystemValidator.swift:362 checkPermissions()] ğŸ” [SystemValidator] Oracle snapshot: ready=false, age=1.897s
[2025-11-22 13:36:02.634] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 28 mappings
[2025-11-22 13:36:02.634] [DEBUG] [KanataManager.swift:1214 saveConfiguration(input:output:)] ğŸ“¡ [Config] Triggering TCP reload for validation
[2025-11-22 13:36:02.634] [DEBUG] [KanataManager+Configuration.swift:84 triggerTCPReload()] ğŸ§ª [TCP Reload] Skipping TCP reload in test environment
[2025-11-22 13:36:02.634] [ERROR] [KanataManager.swift:1230 saveConfiguration(input:output:)] âŒ [Config] TCP reload FAILED: Test environment - TCP disabled
[2025-11-22 13:36:02.634] [ERROR] [KanataManager.swift:1231 saveConfiguration(input:output:)] âŒ [Config] TCP server is required for validation-on-demand - restoring backup
[2025-11-22 13:36:02.634] [INFO] [SystemValidator.swift:211 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 2 (Permissions) completed in 1.899s
[2025-11-22 13:36:02.635] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 80% (4/5 steps)
[2025-11-22 13:36:02.635] [INFO] [KanataManager.swift:827 restoreLastGoodConfig()] ğŸ”„ [Restore] Restored last good config successfully
[2025-11-22 13:36:02.636] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:36:02.636] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:36:02.636] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 7007 characters
[2025-11-22 13:36:02.636] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:36:02.636] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 18 src keys, 88 layer keys, deduplicated to 18 unique mappings
[2025-11-22 13:36:02.636] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:36:02.636] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:36:02.636] [INFO] [SystemValidator.swift:328 checkHelper()] ğŸ” [SystemValidator] Helper state: registeredButUnresponsive Helper registered but XPC communication failed
[2025-11-22 13:36:02.636] [INFO] [SystemValidator.swift:143 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Starting validation #1
[2025-11-22 13:36:02.636] [INFO] [SystemValidator.swift:202 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 1 (Helper) completed in 3.798s
[2025-11-22 13:36:02.636] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 100% (5/5 steps)
[2025-11-22 13:36:02.636] [INFO] [SystemValidator.swift:174 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 START: 1763847362.636
[2025-11-22 13:36:02.637] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:36:02.637] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:36:02.637] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 7007 characters
[2025-11-22 13:36:02.637] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:36:02.637] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 18 src keys, 88 layer keys, deduplicated to 18 unique mappings
[2025-11-22 13:36:02.637] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:36:02.637] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:36:02.637] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 28 mappings
[2025-11-22 13:36:02.637] [DEBUG] [KanataManager.swift:1214 saveConfiguration(input:output:)] ğŸ“¡ [Config] Triggering TCP reload for validation
[2025-11-22 13:36:02.637] [DEBUG] [KanataManager+Configuration.swift:84 triggerTCPReload()] ğŸ§ª [TCP Reload] Skipping TCP reload in test environment
[2025-11-22 13:36:02.637] [ERROR] [KanataManager.swift:1230 saveConfiguration(input:output:)] âŒ [Config] TCP reload FAILED: Test environment - TCP disabled
[2025-11-22 13:36:02.637] [ERROR] [KanataManager.swift:1231 saveConfiguration(input:output:)] âŒ [Config] TCP server is required for validation-on-demand - restoring backup
[2025-11-22 13:36:02.637] [INFO] [KanataManager.swift:827 restoreLastGoodConfig()] ğŸ”„ [Restore] Restored last good config successfully
[2025-11-22 13:36:02.638] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:36:02.638] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:36:02.638] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 7007 characters
[2025-11-22 13:36:02.638] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:36:02.638] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 18 src keys, 88 layer keys, deduplicated to 18 unique mappings
[2025-11-22 13:36:02.638] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:36:02.638] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:36:02.638] [INFO] [SoundManager.swift:15 playTinkSound()] ğŸ§ª [Sound] Suppressed tink sound in test environment
[2025-11-22 13:36:02.638] [INFO] [SoundManager.swift:35 playErrorSound()] ğŸ§ª [Sound] Suppressed error beep in test environment
[2025-11-22 13:36:02.639] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:36:02.639] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:36:02.639] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 7007 characters
[2025-11-22 13:36:02.639] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:36:02.639] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 18 src keys, 88 layer keys, deduplicated to 18 unique mappings
[2025-11-22 13:36:02.639] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:36:02.639] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:36:02.639] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 28 mappings
[2025-11-22 13:36:02.639] [DEBUG] [KanataManager.swift:1214 saveConfiguration(input:output:)] ğŸ“¡ [Config] Triggering TCP reload for validation
[2025-11-22 13:36:02.639] [DEBUG] [KanataManager+Configuration.swift:84 triggerTCPReload()] ğŸ§ª [TCP Reload] Skipping TCP reload in test environment
[2025-11-22 13:36:02.639] [ERROR] [KanataManager.swift:1230 saveConfiguration(input:output:)] âŒ [Config] TCP reload FAILED: Test environment - TCP disabled
[2025-11-22 13:36:02.639] [ERROR] [KanataManager.swift:1231 saveConfiguration(input:output:)] âŒ [Config] TCP server is required for validation-on-demand - restoring backup
[2025-11-22 13:36:02.640] [INFO] [KanataManager.swift:827 restoreLastGoodConfig()] ğŸ”„ [Restore] Restored last good config successfully
[2025-11-22 13:36:02.640] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:36:02.640] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:36:02.640] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 7007 characters
[2025-11-22 13:36:02.640] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:36:02.641] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 18 src keys, 88 layer keys, deduplicated to 18 unique mappings
[2025-11-22 13:36:02.641] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:36:02.641] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:36:02.641] [INFO] [SoundManager.swift:15 playTinkSound()] ğŸ§ª [Sound] Suppressed tink sound in test environment
[2025-11-22 13:36:02.641] [INFO] [SoundManager.swift:35 playErrorSound()] ğŸ§ª [Sound] Suppressed error beep in test environment
[2025-11-22 13:36:02.641] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 28 mappings
[2025-11-22 13:36:02.641] [DEBUG] [KanataManager.swift:1214 saveConfiguration(input:output:)] ğŸ“¡ [Config] Triggering TCP reload for validation
[2025-11-22 13:36:02.641] [DEBUG] [KanataManager+Configuration.swift:84 triggerTCPReload()] ğŸ§ª [TCP Reload] Skipping TCP reload in test environment
[2025-11-22 13:36:02.641] [ERROR] [KanataManager.swift:1230 saveConfiguration(input:output:)] âŒ [Config] TCP reload FAILED: Test environment - TCP disabled
[2025-11-22 13:36:02.641] [ERROR] [KanataManager.swift:1231 saveConfiguration(input:output:)] âŒ [Config] TCP server is required for validation-on-demand - restoring backup
[2025-11-22 13:36:02.641] [INFO] [KanataManager.swift:827 restoreLastGoodConfig()] ğŸ”„ [Restore] Restored last good config successfully
[2025-11-22 13:36:02.641] [INFO] [SystemValidator.swift:312 checkHelper()] ğŸ” [SystemValidator] Checking privileged helper
[2025-11-22 13:36:02.641] [INFO] [SystemValidator.swift:344 checkPermissions()] ğŸ” [SystemValidator] Checking permissions via Oracle
[2025-11-22 13:36:02.641] [INFO] [SystemValidator.swift:372 checkComponents()] ğŸ” [SystemValidator] Checking components
[2025-11-22 13:36:02.641] [INFO] [KanataBinaryDetector.swift:66 detectCurrentStatus()] ğŸ” [KanataBinaryDetector] Starting unified kanata binary detection
[2025-11-22 13:36:02.641] [INFO] [PermissionOracle.swift:173 currentSnapshot()] ğŸ”® [Oracle] Test mode snapshot generated (non-blocking)
[2025-11-22 13:36:02.641] [INFO] [KanataBinaryDetector.swift:81 detectCurrentStatus()] âŒ [KanataBinaryDetector] No kanata binary found
[2025-11-22 13:36:02.641] [INFO] [VHIDDeviceManager.swift:50 detectInstallation()] ğŸ” [VHIDManager] Manager app exists at /Applications/.Karabiner-VirtualHIDDevice-Manager.app/Contents/MacOS/Karabiner-VirtualHIDDevice-Manager: true
[2025-11-22 13:36:02.647] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:36:02.652] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:36:02.671] [INFO] [HelperManager.swift:830 verifyEmbeddedHelperSignature()] ğŸ”’ [HelperManager] Embedded helper signature looks valid
[2025-11-22 13:36:02.671] [INFO] [HelperManager.swift:105 getConnection()] ğŸ”— [HelperManager] Creating XPC connection to com.keypath.helper
[2025-11-22 13:36:02.671] [INFO] [HelperManager.swift:129 getConnection()] âœ… [HelperManager] XPC connection established (PID: 0)
[2025-11-22 13:36:02.671] [INFO] [HelperManager.swift:228 getHelperVersion()] ğŸ“¤ [HelperManager] Calling proxy.getVersion()
[2025-11-22 13:36:02.672] [INFO] [HelperManager.swift:243 getHelperVersion()] ğŸ“¤ [HelperManager] proxy.getVersion() call dispatched, waiting for callback
[2025-11-22 13:36:02.672] [INFO] [HelperManager.swift:121 getConnection()] âš ï¸ [HelperManager] XPC connection interrupted - will reconnect
[2025-11-22 13:36:02.672] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:36:02.672] [INFO] [HelperManager.swift:578 getRemoteProxy(errorHandler:)] âŒ [HelperManager] XPC proxy error: Couldnâ€™t communicate with a helper application.
[2025-11-22 13:36:02.672] [INFO] [HelperManager.swift:584 getRemoteProxy(errorHandler:)] âš ï¸ [HelperManager] XPC connection interrupted - this may indicate:
[2025-11-22 13:36:02.672] [INFO] [HelperManager.swift:585 getRemoteProxy(errorHandler:)]    1. Helper signature validation failed (app updated but not restarted)
[2025-11-22 13:36:02.672] [INFO] [HelperManager.swift:587 getRemoteProxy(errorHandler:)]    2. Helper process crashed
[2025-11-22 13:36:02.672] [INFO] [HelperManager.swift:588 getRemoteProxy(errorHandler:)]    3. Helper was killed by the system
[2025-11-22 13:36:02.672] [INFO] [HelperManager.swift:589 getRemoteProxy(errorHandler:)] ğŸ’¡ If you just updated KeyPath, try restarting the app
[2025-11-22 13:36:02.672] [INFO] [HelperManager.swift:116 getConnection()] âŒ [HelperManager] XPC connection invalidated
[2025-11-22 13:36:02.672] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:36:02.712] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.070s)
[2025-11-22 13:36:02.712] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:36:03.297] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.075s)
[2025-11-22 13:36:03.297] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:36:03.297] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:36:03.297] [INFO] [VHIDDeviceManager.swift:343 getInstalledVersion()] ğŸ” [VHIDManager] Installed daemon version: 5.0.0
[2025-11-22 13:36:03.297] [INFO] [VHIDDeviceManager.swift:374 hasVersionMismatch()] âœ… [VHIDManager] Version compatible: v5.0.0
[2025-11-22 13:36:03.297] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:36:03.369] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:36:03.369] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:36:03.369] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:36:03.369] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:36:03.369] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:36:03.370] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:36:03.370] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:36:03.370] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:36:03.370] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:36:03.370] [INFO] [LaunchDaemonInstaller.swift:669 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Kanata service state: Uninstalled
[2025-11-22 13:36:03.370] [INFO] [LaunchDaemonInstaller.swift:696 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Service not installed (state: Uninstalled)
[2025-11-22 13:36:03.370] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:36:03.442] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:36:03.515] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhiddaemon loaded: false
[2025-11-22 13:36:03.587] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhidmanager loaded: false
[2025-11-22 13:36:03.587] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:36:03.661] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:36:03.661] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhidmanager
[2025-11-22 13:36:03.739] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhidmanager not found in system domain
[2025-11-22 13:36:03.740] [INFO] [SystemValidator.swift:400 checkComponents()] ğŸ” [SystemValidator] Components: kanata=false, driver=true, daemon=false, vhid=false, vhidVersionMismatch=false
[2025-11-22 13:36:03.740] [INFO] [SystemValidator.swift:418 checkConflicts()] ğŸ” [SystemValidator] Checking for conflicts
[2025-11-22 13:36:03.740] [INFO] [ProcessLifecycleManager.swift:117 detectConflicts()] ğŸ” [ProcessLifecycleManager] Detecting conflicts...
[2025-11-22 13:36:03.740] [INFO] [ProcessLifecycleManager.swift:121 detectConflicts()] ğŸ§ª [TestEnvironment] Skipping process conflict detection - returning clean state
[2025-11-22 13:36:03.740] [INFO] [SystemValidator.swift:443 checkConflicts()] ğŸ” [SystemValidator] Total conflicts: 0 (0 kanata, 0 karabiner)
[2025-11-22 13:36:03.740] [INFO] [SystemValidator.swift:484 checkHealth()] ğŸ” [SystemValidator] Checking system health
[2025-11-22 13:36:03.740] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:36:03.740] [INFO] [SystemValidator.swift:220 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 3 (Components) completed in 1.104s
[2025-11-22 13:36:03.740] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 20% (1/5 steps)
[2025-11-22 13:36:03.740] [INFO] [SystemValidator.swift:229 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 4 (Conflicts) completed in 1.104s
[2025-11-22 13:36:03.741] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 40% (2/5 steps)
[2025-11-22 13:36:03.780] [INFO] [HelperManager.swift:248 getHelperVersion()] âš ï¸ [HelperManager] getVersion timed out - clearing connection cache
[2025-11-22 13:36:03.780] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:36:03.814] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:36:03.814] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:36:03.884] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:36:03.956] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.072s)
[2025-11-22 13:36:03.956] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:36:04.539] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.073s)
[2025-11-22 13:36:04.539] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:36:04.539] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:36:04.540] [INFO] [SystemValidator.swift:494 checkHealth()] ğŸ” [SystemValidator] Health: kanata=false, daemon=false (launchctl), vhid=false
[2025-11-22 13:36:04.540] [INFO] [SystemValidator.swift:238 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 5 (Health) completed in 1.903s
[2025-11-22 13:36:04.540] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 28 mappings
[2025-11-22 13:36:04.540] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 60% (3/5 steps)
[2025-11-22 13:36:04.540] [DEBUG] [KanataManager.swift:1214 saveConfiguration(input:output:)] ğŸ“¡ [Config] Triggering TCP reload for validation
[2025-11-22 13:36:04.540] [DEBUG] [KanataManager+Configuration.swift:84 triggerTCPReload()] ğŸ§ª [TCP Reload] Skipping TCP reload in test environment
[2025-11-22 13:36:04.540] [ERROR] [KanataManager.swift:1230 saveConfiguration(input:output:)] âŒ [Config] TCP reload FAILED: Test environment - TCP disabled
[2025-11-22 13:36:04.540] [ERROR] [KanataManager.swift:1231 saveConfiguration(input:output:)] âŒ [Config] TCP server is required for validation-on-demand - restoring backup
[2025-11-22 13:36:04.540] [INFO] [KanataManager.swift:827 restoreLastGoodConfig()] ğŸ”„ [Restore] Restored last good config successfully
[2025-11-22 13:36:04.540] [INFO] [SoundManager.swift:15 playTinkSound()] ğŸ§ª [Sound] Suppressed tink sound in test environment
[2025-11-22 13:36:04.540] [INFO] [SoundManager.swift:35 playErrorSound()] ğŸ§ª [Sound] Suppressed error beep in test environment
[2025-11-22 13:36:04.540] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 28 mappings
[2025-11-22 13:36:04.540] [DEBUG] [KanataManager.swift:1214 saveConfiguration(input:output:)] ğŸ“¡ [Config] Triggering TCP reload for validation
[2025-11-22 13:36:04.540] [DEBUG] [KanataManager+Configuration.swift:84 triggerTCPReload()] ğŸ§ª [TCP Reload] Skipping TCP reload in test environment
[2025-11-22 13:36:04.540] [ERROR] [KanataManager.swift:1230 saveConfiguration(input:output:)] âŒ [Config] TCP reload FAILED: Test environment - TCP disabled
[2025-11-22 13:36:04.540] [ERROR] [KanataManager.swift:1231 saveConfiguration(input:output:)] âŒ [Config] TCP server is required for validation-on-demand - restoring backup
[2025-11-22 13:36:04.541] [INFO] [KanataManager.swift:827 restoreLastGoodConfig()] ğŸ”„ [Restore] Restored last good config successfully
[2025-11-22 13:36:04.541] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 28 mappings
[2025-11-22 13:36:04.541] [DEBUG] [KanataManager.swift:1214 saveConfiguration(input:output:)] ğŸ“¡ [Config] Triggering TCP reload for validation
[2025-11-22 13:36:04.541] [DEBUG] [KanataManager+Configuration.swift:84 triggerTCPReload()] ğŸ§ª [TCP Reload] Skipping TCP reload in test environment
[2025-11-22 13:36:04.541] [ERROR] [KanataManager.swift:1230 saveConfiguration(input:output:)] âŒ [Config] TCP reload FAILED: Test environment - TCP disabled
[2025-11-22 13:36:04.541] [ERROR] [KanataManager.swift:1231 saveConfiguration(input:output:)] âŒ [Config] TCP server is required for validation-on-demand - restoring backup
[2025-11-22 13:36:04.541] [INFO] [KanataManager.swift:827 restoreLastGoodConfig()] ğŸ”„ [Restore] Restored last good config successfully
[2025-11-22 13:36:04.541] [INFO] [SoundManager.swift:15 playTinkSound()] ğŸ§ª [Sound] Suppressed tink sound in test environment
[2025-11-22 13:36:04.541] [INFO] [SoundManager.swift:35 playErrorSound()] ğŸ§ª [Sound] Suppressed error beep in test environment
[2025-11-22 13:36:04.541] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 28 mappings
[2025-11-22 13:36:04.541] [DEBUG] [KanataManager.swift:1214 saveConfiguration(input:output:)] ğŸ“¡ [Config] Triggering TCP reload for validation
[2025-11-22 13:36:04.541] [DEBUG] [KanataManager+Configuration.swift:84 triggerTCPReload()] ğŸ§ª [TCP Reload] Skipping TCP reload in test environment
[2025-11-22 13:36:04.541] [ERROR] [KanataManager.swift:1230 saveConfiguration(input:output:)] âŒ [Config] TCP reload FAILED: Test environment - TCP disabled
[2025-11-22 13:36:04.541] [ERROR] [KanataManager.swift:1231 saveConfiguration(input:output:)] âŒ [Config] TCP server is required for validation-on-demand - restoring backup
[2025-11-22 13:36:04.542] [INFO] [KanataManager.swift:827 restoreLastGoodConfig()] ğŸ”„ [Restore] Restored last good config successfully
[2025-11-22 13:36:04.542] [INFO] [SoundManager.swift:15 playTinkSound()] ğŸ§ª [Sound] Suppressed tink sound in test environment
[2025-11-22 13:36:04.542] [INFO] [SoundManager.swift:35 playErrorSound()] ğŸ§ª [Sound] Suppressed error beep in test environment
[2025-11-22 13:36:04.542] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 28 mappings
[2025-11-22 13:36:04.542] [DEBUG] [KanataManager.swift:1214 saveConfiguration(input:output:)] ğŸ“¡ [Config] Triggering TCP reload for validation
[2025-11-22 13:36:04.542] [DEBUG] [KanataManager+Configuration.swift:84 triggerTCPReload()] ğŸ§ª [TCP Reload] Skipping TCP reload in test environment
[2025-11-22 13:36:04.542] [ERROR] [KanataManager.swift:1230 saveConfiguration(input:output:)] âŒ [Config] TCP reload FAILED: Test environment - TCP disabled
[2025-11-22 13:36:04.542] [ERROR] [KanataManager.swift:1231 saveConfiguration(input:output:)] âŒ [Config] TCP server is required for validation-on-demand - restoring backup
[2025-11-22 13:36:04.542] [INFO] [KanataManager.swift:827 restoreLastGoodConfig()] ğŸ”„ [Restore] Restored last good config successfully
[2025-11-22 13:36:04.542] [INFO] [SystemValidator.swift:283 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 COMPLETE: Total duration 5.704s
[2025-11-22 13:36:04.542] [INFO] [SystemValidator.swift:297 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Validation #1 complete in 5.704s
[2025-11-22 13:36:04.542] [INFO] [SystemValidator.swift:299 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Result: ready=false, blocking=9, total=9
[2025-11-22 13:36:04.542] [INFO] [SystemValidator.swift:362 checkPermissions()] ğŸ” [SystemValidator] Oracle snapshot: ready=false, age=1.901s
[2025-11-22 13:36:04.542] [INFO] [SystemValidator.swift:328 checkHelper()] ğŸ” [SystemValidator] Helper state: registeredButUnresponsive Helper registered but XPC communication failed
[2025-11-22 13:36:04.542] [INFO] [SystemValidator.swift:211 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 2 (Permissions) completed in 1.906s
[2025-11-22 13:36:04.542] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 80% (4/5 steps)
[2025-11-22 13:36:04.542] [INFO] [SoundManager.swift:15 playTinkSound()] ğŸ§ª [Sound] Suppressed tink sound in test environment
[2025-11-22 13:36:04.542] [INFO] [SystemValidator.swift:202 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 1 (Helper) completed in 3.807s
[2025-11-22 13:36:04.542] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 100% (5/5 steps)
[2025-11-22 13:36:04.542] [INFO] [SoundManager.swift:35 playErrorSound()] ğŸ§ª [Sound] Suppressed error beep in test environment
[2025-11-22 13:36:04.542] [INFO] [SoundManager.swift:15 playTinkSound()] ğŸ§ª [Sound] Suppressed tink sound in test environment
[2025-11-22 13:36:04.542] [INFO] [SoundManager.swift:35 playErrorSound()] ğŸ§ª [Sound] Suppressed error beep in test environment
[2025-11-22 13:36:04.542] [INFO] [SoundManager.swift:15 playTinkSound()] ğŸ§ª [Sound] Suppressed tink sound in test environment
[2025-11-22 13:36:04.542] [INFO] [SoundManager.swift:35 playErrorSound()] ğŸ§ª [Sound] Suppressed error beep in test environment
[2025-11-22 13:36:04.542] [INFO] [SoundManager.swift:15 playTinkSound()] ğŸ§ª [Sound] Suppressed tink sound in test environment
[2025-11-22 13:36:04.542] [INFO] [SoundManager.swift:35 playErrorSound()] ğŸ§ª [Sound] Suppressed error beep in test environment
[2025-11-22 13:36:04.542] [INFO] [SoundManager.swift:15 playTinkSound()] ğŸ§ª [Sound] Suppressed tink sound in test environment
[2025-11-22 13:36:04.542] [INFO] [SoundManager.swift:35 playErrorSound()] ğŸ§ª [Sound] Suppressed error beep in test environment
[2025-11-22 13:36:04.542] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:36:04.542] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:36:04.542] [INFO] [SystemRequirements.swift:135 validateSystemCompatibility()] ğŸ” [SystemRequirements] Validating system compatibility
[2025-11-22 13:36:04.542] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:36:04.542] [INFO] [SystemRequirements.swift:147 validateSystemCompatibility()] âœ… [SystemRequirements] Modern macOS detected: 26.0.1
[2025-11-22 13:36:04.542] [INFO] [SystemRequirements.swift:190 validateSystemCompatibility()] ğŸ” [SystemRequirements] Compatibility check complete: âœ… Compatible
[2025-11-22 13:36:04.542] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:36:04.542] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:36:04.542] [INFO] [InstallerEngine.swift:78 inspectSystem()] âœ… [InstallerEngine] inspectSystem() complete - ready=false, blocking=9
[2025-11-22 13:36:04.542] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: repair, context:)
[2025-11-22 13:36:04.542] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: repair
[2025-11-22 13:36:04.542] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:36:04.542] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:36:04.542] [INFO] [InstallerEngine.swift:194 execute(plan:using:)] âš™ï¸ [InstallerEngine] Starting execute(plan:, using:)
[2025-11-22 13:36:04.542] [INFO] [InstallerEngine.swift:213 execute(plan:using:)] âš™ï¸ [InstallerEngine] Executing recipe: install-bundled-kanata (type: installComponent)
[2025-11-22 13:36:04.542] [INFO] [PrivilegedOperationsCoordinator.swift:359 installBundledKanata()] ğŸ” [PrivCoordinator] Installing bundled Kanata binary
[2025-11-22 13:36:04.542] [INFO] [LaunchDaemonInstaller.swift:2898 installBundledKanataBinaryOnly()] ğŸ”§ [LaunchDaemon] Installing bundled kanata binary to system location
[2025-11-22 13:36:04.543] [INFO] [LaunchDaemonInstaller.swift:2906 installBundledKanataBinaryOnly()] âŒ [LaunchDaemon] CRITICAL: Bundled kanata binary not found at: /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata
[2025-11-22 13:36:04.543] [INFO] [LaunchDaemonInstaller.swift:2908 installBundledKanataBinaryOnly()] âŒ [LaunchDaemon] This indicates a packaging issue - the app bundle is missing the kanata binary
[2025-11-22 13:36:04.543] [INFO] [InstallerEngine.swift:255 execute(plan:using:)] âŒ [InstallerEngine] Recipe install-bundled-kanata failed: Operation failed: Bundled Kanata installation failed
[2025-11-22 13:36:04.543] [INFO] [InstallerEngine.swift:274 execute(plan:using:)] âœ… [InstallerEngine] execute() complete - success: false, recipes executed: 1
[2025-11-22 13:36:04.543] [INFO] [InstallerEngine.swift:432 run(intent:using:)] âœ… [InstallerEngine] run() complete - success: false
[2025-11-22 13:36:04.543] [INFO] [SystemValidator.swift:283 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 COMPLETE: Total duration 3.808s
[2025-11-22 13:36:04.543] [INFO] [SystemValidator.swift:297 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Validation #1 complete in 3.808s
[2025-11-22 13:36:04.543] [INFO] [SystemValidator.swift:299 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Result: ready=false, blocking=9, total=9
[2025-11-22 13:36:04.543] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:36:04.543] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:36:04.543] [INFO] [SystemRequirements.swift:135 validateSystemCompatibility()] ğŸ” [SystemRequirements] Validating system compatibility
[2025-11-22 13:36:04.543] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:36:04.543] [INFO] [SystemRequirements.swift:147 validateSystemCompatibility()] âœ… [SystemRequirements] Modern macOS detected: 26.0.1
[2025-11-22 13:36:04.543] [INFO] [SystemRequirements.swift:190 validateSystemCompatibility()] ğŸ” [SystemRequirements] Compatibility check complete: âœ… Compatible
[2025-11-22 13:36:04.543] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:36:04.543] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:36:04.543] [INFO] [InstallerEngine.swift:78 inspectSystem()] âœ… [InstallerEngine] inspectSystem() complete - ready=false, blocking=9
[2025-11-22 13:36:04.543] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: repair, context:)
[2025-11-22 13:36:04.543] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: repair
[2025-11-22 13:36:04.543] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:36:04.543] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:36:04.543] [INFO] [InstallerEngine.swift:194 execute(plan:using:)] âš™ï¸ [InstallerEngine] Starting execute(plan:, using:)
[2025-11-22 13:36:04.543] [INFO] [InstallerEngine.swift:213 execute(plan:using:)] âš™ï¸ [InstallerEngine] Executing recipe: install-bundled-kanata (type: installComponent)
[2025-11-22 13:36:04.543] [INFO] [PrivilegedOperationsCoordinator.swift:359 installBundledKanata()] ğŸ” [PrivCoordinator] Installing bundled Kanata binary
[2025-11-22 13:36:04.543] [INFO] [LaunchDaemonInstaller.swift:2898 installBundledKanataBinaryOnly()] ğŸ”§ [LaunchDaemon] Installing bundled kanata binary to system location
[2025-11-22 13:36:04.543] [INFO] [LaunchDaemonInstaller.swift:2906 installBundledKanataBinaryOnly()] âŒ [LaunchDaemon] CRITICAL: Bundled kanata binary not found at: /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata
[2025-11-22 13:36:04.543] [INFO] [LaunchDaemonInstaller.swift:2908 installBundledKanataBinaryOnly()] âŒ [LaunchDaemon] This indicates a packaging issue - the app bundle is missing the kanata binary
[2025-11-22 13:36:04.543] [INFO] [InstallerEngine.swift:255 execute(plan:using:)] âŒ [InstallerEngine] Recipe install-bundled-kanata failed: Operation failed: Bundled Kanata installation failed
[2025-11-22 13:36:04.543] [INFO] [InstallerEngine.swift:274 execute(plan:using:)] âœ… [InstallerEngine] execute() complete - success: false, recipes executed: 1
[2025-11-22 13:36:04.543] [INFO] [InstallerEngine.swift:432 run(intent:using:)] âœ… [InstallerEngine] run() complete - success: false
Test Case '-[KeyPathTests.ErrorHandlingTests testConcurrentConfigurationOperations]' passed (3.814 seconds).
Test Case '-[KeyPathTests.ErrorHandlingTests testConfigGenerationWithInvalidInputOutput]' started.
Test Case '-[KeyPathTests.ErrorHandlingTests testConfigGenerationWithInvalidInputOutput]' passed (0.002 seconds).
Test Case '-[KeyPathTests.ErrorHandlingTests testConfigurationIntegrity]' started.
Test Case '-[KeyPathTests.ErrorHandlingTests testConfigurationIntegrity]' passed (0.011 seconds).
Test Case '-[KeyPathTests.ErrorHandlingTests testConfigurationRoundTrip]' started.
Test Case '-[KeyPathTests.ErrorHandlingTests testConfigurationRoundTrip]' passed (0.001 seconds).
Test Case '-[KeyPathTests.ErrorHandlingTests testConfigWithNonASCIICharacters]' started.
Test Case '-[KeyPathTests.ErrorHandlingTests testConfigWithNonASCIICharacters]' passed (0.007 seconds).
Test Case '-[KeyPathTests.ErrorHandlingTests testConfigWithSpecialKanataCharacters]' started.
Test Case '-[KeyPathTests.ErrorHandlingTests testConfigWithSpecialKanataCharacters]' passed (0.002 seconds).
Test Case '-[KeyPathTests.ErrorHandlingTests testDirectoryCreationErrorHandling]' started.
[2025-11-22 13:36:04.567] [INFO] [KanataManager.swift:325 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] init() called
[2025-11-22 13:36:04.567] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:36:04.567] [INFO] [ConfigFileWatcher.swift:40 init()] ğŸ“ [FileWatcher] ConfigFileWatcher initialized with robust monitoring
[2025-11-22 13:36:04.567] [INFO] [ServiceHealthMonitor.swift:140 init(processLifecycle:)] [HealthMonitor] Initialized with process lifecycle manager
[2025-11-22 13:36:04.567] [DEBUG] [KanataManager.swift:397 init(engineClient:injectedConfigurationService:)] ğŸ§ª [KanataManager] Skipping background initialization in test environment
[2025-11-22 13:36:04.567] [INFO] [KanataManager.swift:405 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] About to call bootstrapRuleCollections and startLayerMonitoring
[2025-11-22 13:36:04.567] [INFO] [KanataManager.swift:577 startLayerMonitoring()] ğŸŒ [KanataManager] startLayerMonitoring() called
[2025-11-22 13:36:04.567] [INFO] [KanataManager.swift:579 startLayerMonitoring()] ğŸŒ [KanataManager] Skipping layer monitoring (test environment)
[2025-11-22 13:36:04.567] [INFO] [KanataManager.swift:409 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] init() completed
[2025-11-22 13:36:04.567] [INFO] [ConfigFileWatcher.swift:54 suppressEvents(for:reason:)] ğŸ”‡ [FileWatcher] Suppressing events for 1.0s - Internal saveConfiguration
[2025-11-22 13:36:04.567] [INFO] [KanataManager.swift:814 backupCurrentConfig()] ğŸ’¾ [Backup] Current config backed up successfully
[2025-11-22 13:36:04.567] [INFO] [KanataManager.swift:603 updateActiveLayerName(_:)] ğŸ¯ [KanataManager] updateActiveLayerName: raw='base' normalized='base' display='Base' current='Base'
[2025-11-22 13:36:04.567] [INFO] [KanataManager.swift:603 updateActiveLayerName(_:)] ğŸ¯ [KanataManager] updateActiveLayerName: raw='base' normalized='base' display='Base' current='Base'
[2025-11-22 13:36:04.573] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:36:04.573] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:36:04.573] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 7007 characters
[2025-11-22 13:36:04.573] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:36:04.573] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 18 src keys, 88 layer keys, deduplicated to 18 unique mappings
[2025-11-22 13:36:04.573] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:36:04.573] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:36:04.573] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:36:04.573] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:36:04.573] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 7007 characters
[2025-11-22 13:36:04.573] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:36:04.574] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 18 src keys, 88 layer keys, deduplicated to 18 unique mappings
[2025-11-22 13:36:04.574] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:36:04.574] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:36:04.574] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 28 mappings
[2025-11-22 13:36:04.574] [DEBUG] [KanataManager.swift:1214 saveConfiguration(input:output:)] ğŸ“¡ [Config] Triggering TCP reload for validation
[2025-11-22 13:36:04.574] [DEBUG] [KanataManager+Configuration.swift:84 triggerTCPReload()] ğŸ§ª [TCP Reload] Skipping TCP reload in test environment
[2025-11-22 13:36:04.574] [ERROR] [KanataManager.swift:1230 saveConfiguration(input:output:)] âŒ [Config] TCP reload FAILED: Test environment - TCP disabled
[2025-11-22 13:36:04.574] [ERROR] [KanataManager.swift:1231 saveConfiguration(input:output:)] âŒ [Config] TCP server is required for validation-on-demand - restoring backup
[2025-11-22 13:36:04.574] [INFO] [KanataManager.swift:827 restoreLastGoodConfig()] ğŸ”„ [Restore] Restored last good config successfully
[2025-11-22 13:36:04.574] [INFO] [SoundManager.swift:15 playTinkSound()] ğŸ§ª [Sound] Suppressed tink sound in test environment
[2025-11-22 13:36:04.574] [INFO] [SoundManager.swift:35 playErrorSound()] ğŸ§ª [Sound] Suppressed error beep in test environment
Test Case '-[KeyPathTests.ErrorHandlingTests testDirectoryCreationErrorHandling]' passed (0.007 seconds).
Test Case '-[KeyPathTests.ErrorHandlingTests testExtremeKeyCodeHandling]' started.
Test Case '-[KeyPathTests.ErrorHandlingTests testExtremeKeyCodeHandling]' passed (0.000 seconds).
Test Case '-[KeyPathTests.ErrorHandlingTests testInvalidKeyInputHandling]' started.
[2025-11-22 13:36:04.575] [INFO] [KanataManager.swift:325 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] init() called
[2025-11-22 13:36:04.575] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:36:04.575] [INFO] [ConfigFileWatcher.swift:40 init()] ğŸ“ [FileWatcher] ConfigFileWatcher initialized with robust monitoring
[2025-11-22 13:36:04.575] [INFO] [ServiceHealthMonitor.swift:140 init(processLifecycle:)] [HealthMonitor] Initialized with process lifecycle manager
[2025-11-22 13:36:04.575] [DEBUG] [KanataManager.swift:397 init(engineClient:injectedConfigurationService:)] ğŸ§ª [KanataManager] Skipping background initialization in test environment
[2025-11-22 13:36:04.575] [INFO] [KanataManager.swift:405 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] About to call bootstrapRuleCollections and startLayerMonitoring
[2025-11-22 13:36:04.575] [INFO] [KanataManager.swift:577 startLayerMonitoring()] ğŸŒ [KanataManager] startLayerMonitoring() called
[2025-11-22 13:36:04.575] [INFO] [KanataManager.swift:579 startLayerMonitoring()] ğŸŒ [KanataManager] Skipping layer monitoring (test environment)
[2025-11-22 13:36:04.575] [INFO] [KanataManager.swift:409 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] init() completed
Test Case '-[KeyPathTests.ErrorHandlingTests testInvalidKeyInputHandling]' passed (0.000 seconds).
Test Case '-[KeyPathTests.ErrorHandlingTests testInvalidPathHandling]' started.
[2025-11-22 13:36:04.575] [INFO] [KanataManager.swift:325 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] init() called
[2025-11-22 13:36:04.575] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:36:04.575] [INFO] [ConfigFileWatcher.swift:40 init()] ğŸ“ [FileWatcher] ConfigFileWatcher initialized with robust monitoring
[2025-11-22 13:36:04.575] [INFO] [ServiceHealthMonitor.swift:140 init(processLifecycle:)] [HealthMonitor] Initialized with process lifecycle manager
[2025-11-22 13:36:04.575] [DEBUG] [KanataManager.swift:397 init(engineClient:injectedConfigurationService:)] ğŸ§ª [KanataManager] Skipping background initialization in test environment
[2025-11-22 13:36:04.575] [INFO] [KanataManager.swift:405 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] About to call bootstrapRuleCollections and startLayerMonitoring
[2025-11-22 13:36:04.575] [INFO] [KanataManager.swift:577 startLayerMonitoring()] ğŸŒ [KanataManager] startLayerMonitoring() called
[2025-11-22 13:36:04.575] [INFO] [KanataManager.swift:579 startLayerMonitoring()] ğŸŒ [KanataManager] Skipping layer monitoring (test environment)
[2025-11-22 13:36:04.575] [INFO] [KanataManager.swift:409 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] init() completed
Test Case '-[KeyPathTests.ErrorHandlingTests testInvalidPathHandling]' passed (0.000 seconds).
Test Case '-[KeyPathTests.ErrorHandlingTests testKanataProcessErrorHandling]' started.
[2025-11-22 13:36:04.575] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 28 mappings
[2025-11-22 13:36:04.575] [DEBUG] [KanataManager+Configuration.swift:53 triggerConfigReload()] ğŸ“¡ [Reload] Attempting TCP reload
[2025-11-22 13:36:04.575] [DEBUG] [KanataManager+Configuration.swift:84 triggerTCPReload()] ğŸ§ª [TCP Reload] Skipping TCP reload in test environment
[2025-11-22 13:36:04.575] [DEBUG] [KanataManager+Configuration.swift:65 triggerConfigReload()] ğŸ“¡ [Reload] TCP reload failed: Test environment - TCP disabled
[2025-11-22 13:36:04.575] [WARN] [KanataManager+Configuration.swift:68 triggerConfigReload()] âš ï¸ [Reload] Falling back to service restart
[2025-11-22 13:36:04.575] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:36:04.575] [INFO] [SystemValidator.swift:63 init(launchDaemonInstaller:vhidDeviceManager:processLifecycleManager:kanataManager:)] ğŸ” [SystemValidator] Initialized (stateless, no cache)
[2025-11-22 13:36:04.575] [INFO] [InstallerEngine.swift:35 init(processLifecycleManager:kanataManager:)] ğŸ”§ [InstallerEngine] Initialized
[2025-11-22 13:36:04.575] [INFO] [InstallerEngine.swift:419 run(intent:using:)] ğŸš€ [InstallerEngine] Starting run(intent: repair, using:)
[2025-11-22 13:36:04.575] [INFO] [InstallerEngine.swift:53 inspectSystem()] ğŸ” [InstallerEngine] Starting inspectSystem()
[2025-11-22 13:36:04.575] [INFO] [KanataManager.swift:325 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] init() called
[2025-11-22 13:36:04.576] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:36:04.576] [INFO] [ConfigFileWatcher.swift:40 init()] ğŸ“ [FileWatcher] ConfigFileWatcher initialized with robust monitoring
[2025-11-22 13:36:04.576] [INFO] [ServiceHealthMonitor.swift:140 init(processLifecycle:)] [HealthMonitor] Initialized with process lifecycle manager
[2025-11-22 13:36:04.576] [DEBUG] [KanataManager.swift:397 init(engineClient:injectedConfigurationService:)] ğŸ§ª [KanataManager] Skipping background initialization in test environment
[2025-11-22 13:36:04.576] [INFO] [KanataManager.swift:405 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] About to call bootstrapRuleCollections and startLayerMonitoring
[2025-11-22 13:36:04.576] [INFO] [KanataManager.swift:577 startLayerMonitoring()] ğŸŒ [KanataManager] startLayerMonitoring() called
[2025-11-22 13:36:04.576] [INFO] [KanataManager.swift:579 startLayerMonitoring()] ğŸŒ [KanataManager] Skipping layer monitoring (test environment)
[2025-11-22 13:36:04.576] [INFO] [KanataManager.swift:409 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] init() completed
[2025-11-22 13:36:04.576] [INFO] [PrivilegedOperationsCoordinator.swift:839 sudoExecuteCommand(_:description:)] ğŸ”§ [PrivCoordinator] Executing admin command: Stop Kanata service
[2025-11-22 13:36:04.576] [INFO] [SystemValidator.swift:143 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Starting validation #1
[2025-11-22 13:36:04.576] [INFO] [SystemValidator.swift:174 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 START: 1763847364.576
[2025-11-22 13:36:04.576] [INFO] [SystemValidator.swift:312 checkHelper()] ğŸ” [SystemValidator] Checking privileged helper
[2025-11-22 13:36:04.576] [INFO] [SystemValidator.swift:344 checkPermissions()] ğŸ” [SystemValidator] Checking permissions via Oracle
[2025-11-22 13:36:04.576] [INFO] [SystemValidator.swift:372 checkComponents()] ğŸ” [SystemValidator] Checking components
[2025-11-22 13:36:04.576] [INFO] [KanataBinaryDetector.swift:66 detectCurrentStatus()] ğŸ” [KanataBinaryDetector] Starting unified kanata binary detection
[2025-11-22 13:36:04.576] [INFO] [PermissionOracle.swift:173 currentSnapshot()] ğŸ”® [Oracle] Test mode snapshot generated (non-blocking)
[2025-11-22 13:36:04.576] [INFO] [KanataBinaryDetector.swift:81 detectCurrentStatus()] âŒ [KanataBinaryDetector] No kanata binary found
[2025-11-22 13:36:04.576] [INFO] [VHIDDeviceManager.swift:50 detectInstallation()] ğŸ” [VHIDManager] Manager app exists at /Applications/.Karabiner-VirtualHIDDevice-Manager.app/Contents/MacOS/Karabiner-VirtualHIDDevice-Manager: true
[2025-11-22 13:36:04.581] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:36:04.586] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:36:04.603] [INFO] [HelperManager.swift:830 verifyEmbeddedHelperSignature()] ğŸ”’ [HelperManager] Embedded helper signature looks valid
[2025-11-22 13:36:04.603] [INFO] [HelperManager.swift:105 getConnection()] ğŸ”— [HelperManager] Creating XPC connection to com.keypath.helper
[2025-11-22 13:36:04.604] [INFO] [HelperManager.swift:129 getConnection()] âœ… [HelperManager] XPC connection established (PID: 0)
[2025-11-22 13:36:04.604] [INFO] [HelperManager.swift:228 getHelperVersion()] ğŸ“¤ [HelperManager] Calling proxy.getVersion()
[2025-11-22 13:36:04.604] [INFO] [HelperManager.swift:243 getHelperVersion()] ğŸ“¤ [HelperManager] proxy.getVersion() call dispatched, waiting for callback
[2025-11-22 13:36:04.604] [INFO] [HelperManager.swift:121 getConnection()] âš ï¸ [HelperManager] XPC connection interrupted - will reconnect
[2025-11-22 13:36:04.604] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:36:04.604] [INFO] [HelperManager.swift:578 getRemoteProxy(errorHandler:)] âŒ [HelperManager] XPC proxy error: Couldnâ€™t communicate with a helper application.
[2025-11-22 13:36:04.605] [INFO] [HelperManager.swift:584 getRemoteProxy(errorHandler:)] âš ï¸ [HelperManager] XPC connection interrupted - this may indicate:
[2025-11-22 13:36:04.605] [INFO] [HelperManager.swift:585 getRemoteProxy(errorHandler:)]    1. Helper signature validation failed (app updated but not restarted)
[2025-11-22 13:36:04.605] [INFO] [HelperManager.swift:587 getRemoteProxy(errorHandler:)]    2. Helper process crashed
[2025-11-22 13:36:04.605] [INFO] [HelperManager.swift:588 getRemoteProxy(errorHandler:)]    3. Helper was killed by the system
[2025-11-22 13:36:04.605] [INFO] [HelperManager.swift:589 getRemoteProxy(errorHandler:)] ğŸ’¡ If you just updated KeyPath, try restarting the app
[2025-11-22 13:36:04.605] [INFO] [HelperManager.swift:116 getConnection()] âŒ [HelperManager] XPC connection invalidated
[2025-11-22 13:36:04.605] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:36:04.646] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.070s)
[2025-11-22 13:36:04.646] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:36:05.794] [INFO] [HelperManager.swift:248 getHelperVersion()] âš ï¸ [HelperManager] getVersion timed out - clearing connection cache
[2025-11-22 13:36:05.794] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:36:07.754] [INFO] [HelperManager.swift:248 getHelperVersion()] âš ï¸ [HelperManager] getVersion timed out - clearing connection cache
[2025-11-22 13:36:07.754] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:36:08.214] [INFO] [VHIDDeviceManager.swift:168 evaluateDaemonProcess()] âš ï¸ [VHIDManager] VHIDDevice process check timed out after 3s - fallback launchctl says running=false
[2025-11-22 13:36:08.280] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:36:08.280] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:36:08.281] [INFO] [VHIDDeviceManager.swift:343 getInstalledVersion()] ğŸ” [VHIDManager] Installed daemon version: 5.0.0
[2025-11-22 13:36:08.281] [INFO] [VHIDDeviceManager.swift:374 hasVersionMismatch()] âœ… [VHIDManager] Version compatible: v5.0.0
[2025-11-22 13:36:08.281] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:36:08.351] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:36:08.352] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:36:08.352] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:36:08.352] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:36:08.352] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:36:08.352] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:36:08.352] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:36:08.352] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:36:08.353] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:36:08.353] [INFO] [LaunchDaemonInstaller.swift:669 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Kanata service state: Uninstalled
[2025-11-22 13:36:08.353] [INFO] [LaunchDaemonInstaller.swift:696 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Service not installed (state: Uninstalled)
[2025-11-22 13:36:08.353] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:36:08.423] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:36:08.494] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhiddaemon loaded: false
[2025-11-22 13:36:08.566] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhidmanager loaded: false
[2025-11-22 13:36:08.566] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:36:08.637] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:36:08.637] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhidmanager
[2025-11-22 13:36:08.709] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhidmanager not found in system domain
[2025-11-22 13:36:08.709] [INFO] [SystemValidator.swift:400 checkComponents()] ğŸ” [SystemValidator] Components: kanata=false, driver=true, daemon=false, vhid=false, vhidVersionMismatch=false
[2025-11-22 13:36:08.709] [INFO] [SystemValidator.swift:220 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 3 (Components) completed in 4.133s
[2025-11-22 13:36:08.709] [INFO] [SystemValidator.swift:418 checkConflicts()] ğŸ” [SystemValidator] Checking for conflicts
[2025-11-22 13:36:08.709] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 20% (1/5 steps)
[2025-11-22 13:36:08.709] [INFO] [ProcessLifecycleManager.swift:117 detectConflicts()] ğŸ” [ProcessLifecycleManager] Detecting conflicts...
[2025-11-22 13:36:08.709] [INFO] [ProcessLifecycleManager.swift:121 detectConflicts()] ğŸ§ª [TestEnvironment] Skipping process conflict detection - returning clean state
[2025-11-22 13:36:08.709] [INFO] [SystemValidator.swift:443 checkConflicts()] ğŸ” [SystemValidator] Total conflicts: 0 (0 kanata, 0 karabiner)
[2025-11-22 13:36:08.709] [INFO] [SystemValidator.swift:484 checkHealth()] ğŸ” [SystemValidator] Checking system health
[2025-11-22 13:36:08.709] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:36:08.709] [INFO] [SystemValidator.swift:229 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 4 (Conflicts) completed in 4.133s
[2025-11-22 13:36:08.709] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 40% (2/5 steps)
[2025-11-22 13:36:08.780] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:36:08.780] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:36:08.851] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:36:08.923] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.072s)
[2025-11-22 13:36:08.923] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:36:09.498] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.065s)
[2025-11-22 13:36:09.499] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:36:09.499] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:36:09.499] [INFO] [SystemValidator.swift:494 checkHealth()] ğŸ” [SystemValidator] Health: kanata=false, daemon=false (launchctl), vhid=false
[2025-11-22 13:36:09.499] [INFO] [SystemValidator.swift:238 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 5 (Health) completed in 4.923s
[2025-11-22 13:36:09.499] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 60% (3/5 steps)
[2025-11-22 13:36:09.499] [INFO] [SystemValidator.swift:362 checkPermissions()] ğŸ” [SystemValidator] Oracle snapshot: ready=false, age=4.923s
[2025-11-22 13:36:09.499] [INFO] [SystemValidator.swift:328 checkHelper()] ğŸ” [SystemValidator] Helper state: registeredButUnresponsive Helper registered but XPC communication failed
[2025-11-22 13:36:09.499] [INFO] [SystemValidator.swift:211 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 2 (Permissions) completed in 4.923s
[2025-11-22 13:36:09.499] [INFO] [SystemValidator.swift:328 checkHelper()] ğŸ” [SystemValidator] Helper state: registeredButUnresponsive Helper registered but XPC communication failed
[2025-11-22 13:36:09.499] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 80% (4/5 steps)
[2025-11-22 13:36:09.499] [INFO] [SystemValidator.swift:202 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 1 (Helper) completed in 6.863s
[2025-11-22 13:36:09.499] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 100% (5/5 steps)
[2025-11-22 13:36:09.499] [INFO] [KanataManager.swift:603 updateActiveLayerName(_:)] ğŸ¯ [KanataManager] updateActiveLayerName: raw='base' normalized='base' display='Base' current='Base'
[2025-11-22 13:36:09.499] [INFO] [SystemValidator.swift:202 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 1 (Helper) completed in 4.923s
[2025-11-22 13:36:09.499] [INFO] [KanataManager.swift:603 updateActiveLayerName(_:)] ğŸ¯ [KanataManager] updateActiveLayerName: raw='base' normalized='base' display='Base' current='Base'
[2025-11-22 13:36:09.499] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 100% (5/5 steps)
[2025-11-22 13:36:09.499] [INFO] [KanataManager.swift:603 updateActiveLayerName(_:)] ğŸ¯ [KanataManager] updateActiveLayerName: raw='base' normalized='base' display='Base' current='Base'
[2025-11-22 13:36:09.499] [INFO] [KanataManager.swift:603 updateActiveLayerName(_:)] ğŸ¯ [KanataManager] updateActiveLayerName: raw='base' normalized='base' display='Base' current='Base'
[2025-11-22 13:36:09.499] [INFO] [KanataManager.swift:603 updateActiveLayerName(_:)] ğŸ¯ [KanataManager] updateActiveLayerName: raw='base' normalized='base' display='Base' current='Base'
[2025-11-22 13:36:09.499] [INFO] [KanataManager.swift:603 updateActiveLayerName(_:)] ğŸ¯ [KanataManager] updateActiveLayerName: raw='base' normalized='base' display='Base' current='Base'
[2025-11-22 13:36:09.499] [INFO] [SystemValidator.swift:283 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 COMPLETE: Total duration 6.863s
[2025-11-22 13:36:09.499] [INFO] [SystemValidator.swift:297 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Validation #1 complete in 6.863s
[2025-11-22 13:36:09.499] [INFO] [SystemValidator.swift:299 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Result: ready=false, blocking=9, total=9
[2025-11-22 13:36:09.499] [INFO] [SystemValidator.swift:283 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 COMPLETE: Total duration 4.923s
[2025-11-22 13:36:09.499] [INFO] [SystemValidator.swift:297 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Validation #1 complete in 4.924s
[2025-11-22 13:36:09.499] [INFO] [SystemValidator.swift:299 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Result: ready=false, blocking=9, total=9
[2025-11-22 13:36:09.499] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:36:09.499] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:36:09.499] [INFO] [SystemRequirements.swift:135 validateSystemCompatibility()] ğŸ” [SystemRequirements] Validating system compatibility
[2025-11-22 13:36:09.499] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:36:09.499] [INFO] [SystemRequirements.swift:147 validateSystemCompatibility()] âœ… [SystemRequirements] Modern macOS detected: 26.0.1
[2025-11-22 13:36:09.499] [INFO] [SystemRequirements.swift:190 validateSystemCompatibility()] ğŸ” [SystemRequirements] Compatibility check complete: âœ… Compatible
[2025-11-22 13:36:09.499] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:36:09.499] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:36:09.499] [INFO] [InstallerEngine.swift:78 inspectSystem()] âœ… [InstallerEngine] inspectSystem() complete - ready=false, blocking=9
[2025-11-22 13:36:09.499] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: repair, context:)
[2025-11-22 13:36:09.499] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: repair
[2025-11-22 13:36:09.499] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:36:09.499] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:36:09.499] [INFO] [InstallerEngine.swift:194 execute(plan:using:)] âš™ï¸ [InstallerEngine] Starting execute(plan:, using:)
[2025-11-22 13:36:09.499] [INFO] [InstallerEngine.swift:213 execute(plan:using:)] âš™ï¸ [InstallerEngine] Executing recipe: install-bundled-kanata (type: installComponent)
[2025-11-22 13:36:09.499] [INFO] [PrivilegedOperationsCoordinator.swift:359 installBundledKanata()] ğŸ” [PrivCoordinator] Installing bundled Kanata binary
[2025-11-22 13:36:09.499] [INFO] [LaunchDaemonInstaller.swift:2898 installBundledKanataBinaryOnly()] ğŸ”§ [LaunchDaemon] Installing bundled kanata binary to system location
[2025-11-22 13:36:09.500] [INFO] [LaunchDaemonInstaller.swift:2906 installBundledKanataBinaryOnly()] âŒ [LaunchDaemon] CRITICAL: Bundled kanata binary not found at: /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata
[2025-11-22 13:36:09.500] [INFO] [LaunchDaemonInstaller.swift:2908 installBundledKanataBinaryOnly()] âŒ [LaunchDaemon] This indicates a packaging issue - the app bundle is missing the kanata binary
[2025-11-22 13:36:09.500] [INFO] [InstallerEngine.swift:255 execute(plan:using:)] âŒ [InstallerEngine] Recipe install-bundled-kanata failed: Operation failed: Bundled Kanata installation failed
[2025-11-22 13:36:09.500] [INFO] [InstallerEngine.swift:274 execute(plan:using:)] âœ… [InstallerEngine] execute() complete - success: false, recipes executed: 1
[2025-11-22 13:36:09.500] [INFO] [InstallerEngine.swift:432 run(intent:using:)] âœ… [InstallerEngine] run() complete - success: false
[2025-11-22 13:36:09.500] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:36:09.500] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:36:09.500] [INFO] [SystemRequirements.swift:135 validateSystemCompatibility()] ğŸ” [SystemRequirements] Validating system compatibility
[2025-11-22 13:36:09.500] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:36:09.500] [INFO] [SystemRequirements.swift:147 validateSystemCompatibility()] âœ… [SystemRequirements] Modern macOS detected: 26.0.1
[2025-11-22 13:36:09.500] [INFO] [SystemRequirements.swift:190 validateSystemCompatibility()] ğŸ” [SystemRequirements] Compatibility check complete: âœ… Compatible
[2025-11-22 13:36:09.500] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:36:09.500] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:36:09.500] [INFO] [InstallerEngine.swift:78 inspectSystem()] âœ… [InstallerEngine] inspectSystem() complete - ready=false, blocking=9
[2025-11-22 13:36:09.500] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: repair, context:)
[2025-11-22 13:36:09.500] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: repair
[2025-11-22 13:36:09.500] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:36:09.500] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:36:09.500] [INFO] [InstallerEngine.swift:194 execute(plan:using:)] âš™ï¸ [InstallerEngine] Starting execute(plan:, using:)
[2025-11-22 13:36:09.500] [INFO] [InstallerEngine.swift:213 execute(plan:using:)] âš™ï¸ [InstallerEngine] Executing recipe: install-bundled-kanata (type: installComponent)
[2025-11-22 13:36:09.500] [INFO] [PrivilegedOperationsCoordinator.swift:359 installBundledKanata()] ğŸ” [PrivCoordinator] Installing bundled Kanata binary
[2025-11-22 13:36:09.500] [INFO] [LaunchDaemonInstaller.swift:2898 installBundledKanataBinaryOnly()] ğŸ”§ [LaunchDaemon] Installing bundled kanata binary to system location
[2025-11-22 13:36:09.500] [INFO] [LaunchDaemonInstaller.swift:2906 installBundledKanataBinaryOnly()] âŒ [LaunchDaemon] CRITICAL: Bundled kanata binary not found at: /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata
[2025-11-22 13:36:09.500] [INFO] [LaunchDaemonInstaller.swift:2908 installBundledKanataBinaryOnly()] âŒ [LaunchDaemon] This indicates a packaging issue - the app bundle is missing the kanata binary
[2025-11-22 13:36:09.500] [INFO] [InstallerEngine.swift:255 execute(plan:using:)] âŒ [InstallerEngine] Recipe install-bundled-kanata failed: Operation failed: Bundled Kanata installation failed
[2025-11-22 13:36:09.500] [INFO] [InstallerEngine.swift:274 execute(plan:using:)] âœ… [InstallerEngine] execute() complete - success: false, recipes executed: 1
[2025-11-22 13:36:09.500] [INFO] [InstallerEngine.swift:432 run(intent:using:)] âœ… [InstallerEngine] run() complete - success: false
[2025-11-22 13:36:09.502] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:36:09.502] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:36:09.502] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 7007 characters
[2025-11-22 13:36:09.502] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:36:09.502] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 18 src keys, 88 layer keys, deduplicated to 18 unique mappings
[2025-11-22 13:36:09.502] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:36:09.502] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:36:09.503] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:36:09.503] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:36:09.503] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 7007 characters
[2025-11-22 13:36:09.503] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:36:09.503] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 18 src keys, 88 layer keys, deduplicated to 18 unique mappings
[2025-11-22 13:36:09.503] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:36:09.503] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:36:09.504] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:36:09.504] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:36:09.504] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 7007 characters
[2025-11-22 13:36:09.504] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:36:09.504] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 18 src keys, 88 layer keys, deduplicated to 18 unique mappings
[2025-11-22 13:36:09.504] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:36:09.504] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:36:09.504] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 28 mappings
[2025-11-22 13:36:09.504] [DEBUG] [KanataManager+Configuration.swift:53 triggerConfigReload()] ğŸ“¡ [Reload] Attempting TCP reload
[2025-11-22 13:36:09.505] [DEBUG] [KanataManager+Configuration.swift:84 triggerTCPReload()] ğŸ§ª [TCP Reload] Skipping TCP reload in test environment
[2025-11-22 13:36:09.505] [DEBUG] [KanataManager+Configuration.swift:65 triggerConfigReload()] ğŸ“¡ [Reload] TCP reload failed: Test environment - TCP disabled
[2025-11-22 13:36:09.505] [WARN] [KanataManager+Configuration.swift:68 triggerConfigReload()] âš ï¸ [Reload] Falling back to service restart
[2025-11-22 13:36:09.505] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:36:09.505] [INFO] [SystemValidator.swift:63 init(launchDaemonInstaller:vhidDeviceManager:processLifecycleManager:kanataManager:)] ğŸ” [SystemValidator] Initialized (stateless, no cache)
[2025-11-22 13:36:09.505] [INFO] [InstallerEngine.swift:35 init(processLifecycleManager:kanataManager:)] ğŸ”§ [InstallerEngine] Initialized
[2025-11-22 13:36:09.505] [INFO] [InstallerEngine.swift:419 run(intent:using:)] ğŸš€ [InstallerEngine] Starting run(intent: repair, using:)
[2025-11-22 13:36:09.505] [INFO] [InstallerEngine.swift:53 inspectSystem()] ğŸ” [InstallerEngine] Starting inspectSystem()
[2025-11-22 13:36:09.505] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 28 mappings
[2025-11-22 13:36:09.505] [DEBUG] [KanataManager+Configuration.swift:53 triggerConfigReload()] ğŸ“¡ [Reload] Attempting TCP reload
[2025-11-22 13:36:09.505] [DEBUG] [KanataManager+Configuration.swift:84 triggerTCPReload()] ğŸ§ª [TCP Reload] Skipping TCP reload in test environment
[2025-11-22 13:36:09.505] [DEBUG] [KanataManager+Configuration.swift:65 triggerConfigReload()] ğŸ“¡ [Reload] TCP reload failed: Test environment - TCP disabled
[2025-11-22 13:36:09.505] [WARN] [KanataManager+Configuration.swift:68 triggerConfigReload()] âš ï¸ [Reload] Falling back to service restart
[2025-11-22 13:36:09.505] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:36:09.505] [INFO] [SystemValidator.swift:63 init(launchDaemonInstaller:vhidDeviceManager:processLifecycleManager:kanataManager:)] ğŸ” [SystemValidator] Initialized (stateless, no cache)
[2025-11-22 13:36:09.505] [INFO] [InstallerEngine.swift:35 init(processLifecycleManager:kanataManager:)] ğŸ”§ [InstallerEngine] Initialized
[2025-11-22 13:36:09.505] [INFO] [InstallerEngine.swift:419 run(intent:using:)] ğŸš€ [InstallerEngine] Starting run(intent: repair, using:)
[2025-11-22 13:36:09.505] [INFO] [InstallerEngine.swift:53 inspectSystem()] ğŸ” [InstallerEngine] Starting inspectSystem()
[2025-11-22 13:36:09.505] [INFO] [SystemValidator.swift:143 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Starting validation #1
[2025-11-22 13:36:09.505] [INFO] [SystemValidator.swift:174 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 START: 1763847369.505
[2025-11-22 13:36:09.505] [INFO] [SystemValidator.swift:133 performValidationBody(progressCallback:)] âš ï¸ [SystemValidator] RAPID VALIDATION: 0.000s since last validation
This might indicate automatic triggers. Expected: manual user actions only.
[2025-11-22 13:36:09.505] [INFO] [SystemValidator.swift:143 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Starting validation #1
[2025-11-22 13:36:09.505] [INFO] [SystemValidator.swift:174 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 START: 1763847369.505
[2025-11-22 13:36:09.505] [INFO] [SystemValidator.swift:312 checkHelper()] ğŸ” [SystemValidator] Checking privileged helper
[2025-11-22 13:36:09.505] [INFO] [SystemValidator.swift:344 checkPermissions()] ğŸ” [SystemValidator] Checking permissions via Oracle
[2025-11-22 13:36:09.505] [INFO] [SystemValidator.swift:372 checkComponents()] ğŸ” [SystemValidator] Checking components
[2025-11-22 13:36:09.505] [INFO] [KanataBinaryDetector.swift:66 detectCurrentStatus()] ğŸ” [KanataBinaryDetector] Starting unified kanata binary detection
[2025-11-22 13:36:09.505] [INFO] [PermissionOracle.swift:173 currentSnapshot()] ğŸ”® [Oracle] Test mode snapshot generated (non-blocking)
[2025-11-22 13:36:09.505] [INFO] [KanataBinaryDetector.swift:81 detectCurrentStatus()] âŒ [KanataBinaryDetector] No kanata binary found
[2025-11-22 13:36:09.505] [INFO] [VHIDDeviceManager.swift:50 detectInstallation()] ğŸ” [VHIDManager] Manager app exists at /Applications/.Karabiner-VirtualHIDDevice-Manager.app/Contents/MacOS/Karabiner-VirtualHIDDevice-Manager: true
[2025-11-22 13:36:09.511] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:36:09.516] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:36:09.535] [INFO] [HelperManager.swift:830 verifyEmbeddedHelperSignature()] ğŸ”’ [HelperManager] Embedded helper signature looks valid
[2025-11-22 13:36:09.535] [INFO] [HelperManager.swift:105 getConnection()] ğŸ”— [HelperManager] Creating XPC connection to com.keypath.helper
[2025-11-22 13:36:09.535] [INFO] [HelperManager.swift:129 getConnection()] âœ… [HelperManager] XPC connection established (PID: 0)
[2025-11-22 13:36:09.535] [INFO] [HelperManager.swift:228 getHelperVersion()] ğŸ“¤ [HelperManager] Calling proxy.getVersion()
[2025-11-22 13:36:09.535] [INFO] [HelperManager.swift:243 getHelperVersion()] ğŸ“¤ [HelperManager] proxy.getVersion() call dispatched, waiting for callback
[2025-11-22 13:36:09.536] [INFO] [HelperManager.swift:121 getConnection()] âš ï¸ [HelperManager] XPC connection interrupted - will reconnect
[2025-11-22 13:36:09.536] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:36:09.536] [INFO] [HelperManager.swift:578 getRemoteProxy(errorHandler:)] âŒ [HelperManager] XPC proxy error: Couldnâ€™t communicate with a helper application.
[2025-11-22 13:36:09.536] [INFO] [HelperManager.swift:584 getRemoteProxy(errorHandler:)] âš ï¸ [HelperManager] XPC connection interrupted - this may indicate:
[2025-11-22 13:36:09.536] [INFO] [HelperManager.swift:585 getRemoteProxy(errorHandler:)]    1. Helper signature validation failed (app updated but not restarted)
[2025-11-22 13:36:09.536] [INFO] [HelperManager.swift:587 getRemoteProxy(errorHandler:)]    2. Helper process crashed
[2025-11-22 13:36:09.536] [INFO] [HelperManager.swift:588 getRemoteProxy(errorHandler:)]    3. Helper was killed by the system
[2025-11-22 13:36:09.536] [INFO] [HelperManager.swift:589 getRemoteProxy(errorHandler:)] ğŸ’¡ If you just updated KeyPath, try restarting the app
[2025-11-22 13:36:09.536] [INFO] [HelperManager.swift:116 getConnection()] âŒ [HelperManager] XPC connection invalidated
[2025-11-22 13:36:09.536] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:36:09.568] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.063s)
[2025-11-22 13:36:09.568] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:36:10.151] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.070s)
[2025-11-22 13:36:10.151] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:36:10.151] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:36:10.151] [INFO] [VHIDDeviceManager.swift:343 getInstalledVersion()] ğŸ” [VHIDManager] Installed daemon version: 5.0.0
[2025-11-22 13:36:10.151] [INFO] [VHIDDeviceManager.swift:374 hasVersionMismatch()] âœ… [VHIDManager] Version compatible: v5.0.0
[2025-11-22 13:36:10.151] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:36:10.218] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:36:10.219] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:36:10.219] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:36:10.219] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:36:10.219] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:36:10.219] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:36:10.219] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:36:10.219] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:36:10.219] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:36:10.219] [INFO] [LaunchDaemonInstaller.swift:669 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Kanata service state: Uninstalled
[2025-11-22 13:36:10.219] [INFO] [LaunchDaemonInstaller.swift:696 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Service not installed (state: Uninstalled)
[2025-11-22 13:36:10.220] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:36:10.284] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:36:10.349] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhiddaemon loaded: false
[2025-11-22 13:36:10.422] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhidmanager loaded: false
[2025-11-22 13:36:10.422] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:36:10.494] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:36:10.494] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhidmanager
[2025-11-22 13:36:10.565] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhidmanager not found in system domain
[2025-11-22 13:36:10.565] [INFO] [SystemValidator.swift:400 checkComponents()] ğŸ” [SystemValidator] Components: kanata=false, driver=true, daemon=false, vhid=false, vhidVersionMismatch=false
[2025-11-22 13:36:10.566] [INFO] [SystemValidator.swift:220 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 3 (Components) completed in 1.061s
[2025-11-22 13:36:10.566] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 20% (1/5 steps)
[2025-11-22 13:36:10.566] [INFO] [SystemValidator.swift:484 checkHealth()] ğŸ” [SystemValidator] Checking system health
[2025-11-22 13:36:10.566] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:36:10.636] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:36:10.637] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:36:10.709] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:36:12.646] [INFO] [HelperManager.swift:248 getHelperVersion()] âš ï¸ [HelperManager] getVersion timed out - clearing connection cache
[2025-11-22 13:36:12.647] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:36:13.778] [INFO] [VHIDDeviceManager.swift:168 evaluateDaemonProcess()] âš ï¸ [VHIDManager] VHIDDevice process check timed out after 3s - fallback launchctl says running=false
[2025-11-22 13:36:13.845] [INFO] [VHIDDeviceManager.swift:88 detectRunning()] â³ [VHIDManager] Timeout while checking daemon; retrying to avoid false negatives
[2025-11-22 13:36:14.422] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.070s)
[2025-11-22 13:36:14.423] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:36:14.423] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:36:14.423] [INFO] [SystemValidator.swift:494 checkHealth()] ğŸ” [SystemValidator] Health: kanata=false, daemon=false (launchctl), vhid=false
[2025-11-22 13:36:14.423] [INFO] [SystemValidator.swift:418 checkConflicts()] ğŸ” [SystemValidator] Checking for conflicts
[2025-11-22 13:36:14.423] [INFO] [ProcessLifecycleManager.swift:117 detectConflicts()] ğŸ” [ProcessLifecycleManager] Detecting conflicts...
[2025-11-22 13:36:14.423] [INFO] [ProcessLifecycleManager.swift:121 detectConflicts()] ğŸ§ª [TestEnvironment] Skipping process conflict detection - returning clean state
[2025-11-22 13:36:14.423] [INFO] [SystemValidator.swift:238 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 5 (Health) completed in 4.918s
[2025-11-22 13:36:14.423] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 40% (2/5 steps)
[2025-11-22 13:36:14.423] [INFO] [SystemValidator.swift:443 checkConflicts()] ğŸ” [SystemValidator] Total conflicts: 0 (0 kanata, 0 karabiner)
[2025-11-22 13:36:14.423] [INFO] [SystemValidator.swift:312 checkHelper()] ğŸ” [SystemValidator] Checking privileged helper
[2025-11-22 13:36:14.423] [INFO] [SystemValidator.swift:344 checkPermissions()] ğŸ” [SystemValidator] Checking permissions via Oracle
[2025-11-22 13:36:14.423] [INFO] [SystemValidator.swift:372 checkComponents()] ğŸ” [SystemValidator] Checking components
[2025-11-22 13:36:14.423] [INFO] [KanataBinaryDetector.swift:66 detectCurrentStatus()] ğŸ” [KanataBinaryDetector] Starting unified kanata binary detection
[2025-11-22 13:36:14.423] [INFO] [PermissionOracle.swift:173 currentSnapshot()] ğŸ”® [Oracle] Test mode snapshot generated (non-blocking)
[2025-11-22 13:36:14.423] [INFO] [SystemValidator.swift:229 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 4 (Conflicts) completed in 4.918s
[2025-11-22 13:36:14.423] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 60% (3/5 steps)
[2025-11-22 13:36:14.423] [INFO] [KanataBinaryDetector.swift:81 detectCurrentStatus()] âŒ [KanataBinaryDetector] No kanata binary found
[2025-11-22 13:36:14.423] [INFO] [VHIDDeviceManager.swift:50 detectInstallation()] ğŸ” [VHIDManager] Manager app exists at /Applications/.Karabiner-VirtualHIDDevice-Manager.app/Contents/MacOS/Karabiner-VirtualHIDDevice-Manager: true
[2025-11-22 13:36:14.432] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:36:14.438] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:36:14.458] [INFO] [HelperManager.swift:830 verifyEmbeddedHelperSignature()] ğŸ”’ [HelperManager] Embedded helper signature looks valid
[2025-11-22 13:36:14.458] [INFO] [HelperManager.swift:105 getConnection()] ğŸ”— [HelperManager] Creating XPC connection to com.keypath.helper
[2025-11-22 13:36:14.458] [INFO] [HelperManager.swift:129 getConnection()] âœ… [HelperManager] XPC connection established (PID: 0)
[2025-11-22 13:36:14.458] [INFO] [HelperManager.swift:228 getHelperVersion()] ğŸ“¤ [HelperManager] Calling proxy.getVersion()
[2025-11-22 13:36:14.458] [INFO] [HelperManager.swift:243 getHelperVersion()] ğŸ“¤ [HelperManager] proxy.getVersion() call dispatched, waiting for callback
[2025-11-22 13:36:14.459] [INFO] [HelperManager.swift:121 getConnection()] âš ï¸ [HelperManager] XPC connection interrupted - will reconnect
[2025-11-22 13:36:14.459] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:36:14.459] [INFO] [HelperManager.swift:578 getRemoteProxy(errorHandler:)] âŒ [HelperManager] XPC proxy error: Couldnâ€™t communicate with a helper application.
[2025-11-22 13:36:14.459] [INFO] [HelperManager.swift:584 getRemoteProxy(errorHandler:)] âš ï¸ [HelperManager] XPC connection interrupted - this may indicate:
[2025-11-22 13:36:14.459] [INFO] [HelperManager.swift:585 getRemoteProxy(errorHandler:)]    1. Helper signature validation failed (app updated but not restarted)
[2025-11-22 13:36:14.459] [INFO] [HelperManager.swift:587 getRemoteProxy(errorHandler:)]    2. Helper process crashed
[2025-11-22 13:36:14.459] [INFO] [HelperManager.swift:588 getRemoteProxy(errorHandler:)]    3. Helper was killed by the system
[2025-11-22 13:36:14.459] [INFO] [HelperManager.swift:589 getRemoteProxy(errorHandler:)] ğŸ’¡ If you just updated KeyPath, try restarting the app
[2025-11-22 13:36:14.459] [INFO] [HelperManager.swift:116 getConnection()] âŒ [HelperManager] XPC connection invalidated
[2025-11-22 13:36:14.459] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:36:14.491] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.067s)
[2025-11-22 13:36:14.491] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:36:15.076] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.074s)
[2025-11-22 13:36:15.076] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:36:15.076] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:36:15.076] [INFO] [VHIDDeviceManager.swift:343 getInstalledVersion()] ğŸ” [VHIDManager] Installed daemon version: 5.0.0
[2025-11-22 13:36:15.076] [INFO] [VHIDDeviceManager.swift:374 hasVersionMismatch()] âœ… [VHIDManager] Version compatible: v5.0.0
[2025-11-22 13:36:15.076] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:36:15.150] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:36:15.151] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:36:15.151] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:36:15.151] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:36:15.151] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:36:15.152] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:36:15.152] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:36:15.152] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:36:15.152] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:36:15.152] [INFO] [LaunchDaemonInstaller.swift:669 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Kanata service state: Uninstalled
[2025-11-22 13:36:15.152] [INFO] [LaunchDaemonInstaller.swift:696 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Service not installed (state: Uninstalled)
[2025-11-22 13:36:15.152] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:36:15.225] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:36:15.298] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhiddaemon loaded: false
[2025-11-22 13:36:15.371] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhidmanager loaded: false
[2025-11-22 13:36:15.371] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:36:15.442] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:36:15.442] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhidmanager
[2025-11-22 13:36:15.515] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhidmanager not found in system domain
[2025-11-22 13:36:15.515] [INFO] [SystemValidator.swift:400 checkComponents()] ğŸ” [SystemValidator] Components: kanata=false, driver=true, daemon=false, vhid=false, vhidVersionMismatch=false
[2025-11-22 13:36:15.515] [INFO] [SystemValidator.swift:220 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 3 (Components) completed in 6.011s
[2025-11-22 13:36:15.515] [INFO] [SystemValidator.swift:418 checkConflicts()] ğŸ” [SystemValidator] Checking for conflicts
[2025-11-22 13:36:15.515] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 20% (1/5 steps)
[2025-11-22 13:36:15.515] [INFO] [ProcessLifecycleManager.swift:117 detectConflicts()] ğŸ” [ProcessLifecycleManager] Detecting conflicts...
[2025-11-22 13:36:15.515] [INFO] [ProcessLifecycleManager.swift:121 detectConflicts()] ğŸ§ª [TestEnvironment] Skipping process conflict detection - returning clean state
[2025-11-22 13:36:15.516] [INFO] [SystemValidator.swift:443 checkConflicts()] ğŸ” [SystemValidator] Total conflicts: 0 (0 kanata, 0 karabiner)
[2025-11-22 13:36:15.516] [INFO] [SystemValidator.swift:484 checkHealth()] ğŸ” [SystemValidator] Checking system health
[2025-11-22 13:36:15.516] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:36:15.516] [INFO] [SystemValidator.swift:229 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 4 (Conflicts) completed in 6.011s
[2025-11-22 13:36:15.516] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 40% (2/5 steps)
[2025-11-22 13:36:15.587] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:36:15.587] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:36:15.660] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:36:15.732] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.072s)
[2025-11-22 13:36:15.732] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:36:16.314] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.071s)
[2025-11-22 13:36:16.314] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:36:16.314] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:36:16.314] [INFO] [SystemValidator.swift:494 checkHealth()] ğŸ” [SystemValidator] Health: kanata=false, daemon=false (launchctl), vhid=false
[2025-11-22 13:36:16.314] [INFO] [SystemValidator.swift:359 checkPermissions()] âš ï¸ [SystemValidator] Oracle snapshot is 6.8s old (ignored in tests)
[2025-11-22 13:36:16.314] [INFO] [SystemValidator.swift:362 checkPermissions()] ğŸ” [SystemValidator] Oracle snapshot: ready=false, age=6.809s
[2025-11-22 13:36:16.314] [INFO] [SystemValidator.swift:211 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 2 (Permissions) completed in 6.810s
[2025-11-22 13:36:16.314] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 28 mappings
[2025-11-22 13:36:16.314] [INFO] [SystemValidator.swift:238 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 5 (Health) completed in 6.809s
[2025-11-22 13:36:16.314] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 80% (4/5 steps)
[2025-11-22 13:36:16.314] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 60% (3/5 steps)
[2025-11-22 13:36:16.314] [DEBUG] [KanataManager+Configuration.swift:53 triggerConfigReload()] ğŸ“¡ [Reload] Attempting TCP reload
[2025-11-22 13:36:16.314] [DEBUG] [KanataManager+Configuration.swift:84 triggerTCPReload()] ğŸ§ª [TCP Reload] Skipping TCP reload in test environment
[2025-11-22 13:36:16.314] [DEBUG] [KanataManager+Configuration.swift:65 triggerConfigReload()] ğŸ“¡ [Reload] TCP reload failed: Test environment - TCP disabled
[2025-11-22 13:36:16.314] [WARN] [KanataManager+Configuration.swift:68 triggerConfigReload()] âš ï¸ [Reload] Falling back to service restart
[2025-11-22 13:36:16.315] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:36:16.315] [INFO] [SystemValidator.swift:63 init(launchDaemonInstaller:vhidDeviceManager:processLifecycleManager:kanataManager:)] ğŸ” [SystemValidator] Initialized (stateless, no cache)
[2025-11-22 13:36:16.315] [INFO] [InstallerEngine.swift:35 init(processLifecycleManager:kanataManager:)] ğŸ”§ [InstallerEngine] Initialized
[2025-11-22 13:36:16.315] [INFO] [InstallerEngine.swift:419 run(intent:using:)] ğŸš€ [InstallerEngine] Starting run(intent: repair, using:)
[2025-11-22 13:36:16.315] [INFO] [InstallerEngine.swift:53 inspectSystem()] ğŸ” [InstallerEngine] Starting inspectSystem()
[2025-11-22 13:36:16.315] [INFO] [SystemValidator.swift:328 checkHelper()] ğŸ” [SystemValidator] Helper state: registeredButUnresponsive Helper registered but XPC communication failed
[2025-11-22 13:36:16.315] [INFO] [SystemValidator.swift:362 checkPermissions()] ğŸ” [SystemValidator] Oracle snapshot: ready=false, age=1.892s
[2025-11-22 13:36:16.315] [INFO] [SystemValidator.swift:202 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 1 (Helper) completed in 6.810s
[2025-11-22 13:36:16.315] [INFO] [SystemValidator.swift:143 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Starting validation #1
[2025-11-22 13:36:16.315] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 100% (5/5 steps)
[2025-11-22 13:36:16.315] [INFO] [SystemValidator.swift:174 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 START: 1763847376.315
[2025-11-22 13:36:16.315] [INFO] [SystemValidator.swift:211 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 2 (Permissions) completed in 6.810s
[2025-11-22 13:36:16.315] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 80% (4/5 steps)
[2025-11-22 13:36:16.315] [INFO] [SystemValidator.swift:312 checkHelper()] ğŸ” [SystemValidator] Checking privileged helper
[2025-11-22 13:36:16.315] [INFO] [SystemValidator.swift:344 checkPermissions()] ğŸ” [SystemValidator] Checking permissions via Oracle
[2025-11-22 13:36:16.315] [INFO] [SystemValidator.swift:372 checkComponents()] ğŸ” [SystemValidator] Checking components
[2025-11-22 13:36:16.315] [INFO] [KanataBinaryDetector.swift:66 detectCurrentStatus()] ğŸ” [KanataBinaryDetector] Starting unified kanata binary detection
[2025-11-22 13:36:16.315] [INFO] [PermissionOracle.swift:173 currentSnapshot()] ğŸ”® [Oracle] Test mode snapshot generated (non-blocking)
[2025-11-22 13:36:16.315] [INFO] [KanataBinaryDetector.swift:81 detectCurrentStatus()] âŒ [KanataBinaryDetector] No kanata binary found
[2025-11-22 13:36:16.315] [INFO] [VHIDDeviceManager.swift:50 detectInstallation()] ğŸ” [VHIDManager] Manager app exists at /Applications/.Karabiner-VirtualHIDDevice-Manager.app/Contents/MacOS/Karabiner-VirtualHIDDevice-Manager: true
[2025-11-22 13:36:16.323] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:36:16.331] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:36:16.348] [INFO] [HelperManager.swift:830 verifyEmbeddedHelperSignature()] ğŸ”’ [HelperManager] Embedded helper signature looks valid
[2025-11-22 13:36:16.348] [INFO] [HelperManager.swift:105 getConnection()] ğŸ”— [HelperManager] Creating XPC connection to com.keypath.helper
[2025-11-22 13:36:16.348] [INFO] [HelperManager.swift:129 getConnection()] âœ… [HelperManager] XPC connection established (PID: 0)
[2025-11-22 13:36:16.348] [INFO] [HelperManager.swift:228 getHelperVersion()] ğŸ“¤ [HelperManager] Calling proxy.getVersion()
[2025-11-22 13:36:16.348] [INFO] [HelperManager.swift:243 getHelperVersion()] ğŸ“¤ [HelperManager] proxy.getVersion() call dispatched, waiting for callback
[2025-11-22 13:36:16.349] [INFO] [HelperManager.swift:121 getConnection()] âš ï¸ [HelperManager] XPC connection interrupted - will reconnect
[2025-11-22 13:36:16.349] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:36:16.349] [INFO] [HelperManager.swift:578 getRemoteProxy(errorHandler:)] âŒ [HelperManager] XPC proxy error: Couldnâ€™t communicate with a helper application.
[2025-11-22 13:36:16.349] [INFO] [HelperManager.swift:584 getRemoteProxy(errorHandler:)] âš ï¸ [HelperManager] XPC connection interrupted - this may indicate:
[2025-11-22 13:36:16.349] [INFO] [HelperManager.swift:585 getRemoteProxy(errorHandler:)]    1. Helper signature validation failed (app updated but not restarted)
[2025-11-22 13:36:16.349] [INFO] [HelperManager.swift:587 getRemoteProxy(errorHandler:)]    2. Helper process crashed
[2025-11-22 13:36:16.349] [INFO] [HelperManager.swift:588 getRemoteProxy(errorHandler:)]    3. Helper was killed by the system
[2025-11-22 13:36:16.349] [INFO] [HelperManager.swift:589 getRemoteProxy(errorHandler:)] ğŸ’¡ If you just updated KeyPath, try restarting the app
[2025-11-22 13:36:16.349] [INFO] [HelperManager.swift:116 getConnection()] âŒ [HelperManager] XPC connection invalidated
[2025-11-22 13:36:16.349] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:36:16.387] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.071s)
[2025-11-22 13:36:16.387] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:36:16.961] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.064s)
[2025-11-22 13:36:16.961] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:36:16.961] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:36:16.962] [INFO] [VHIDDeviceManager.swift:343 getInstalledVersion()] ğŸ” [VHIDManager] Installed daemon version: 5.0.0
[2025-11-22 13:36:16.962] [INFO] [VHIDDeviceManager.swift:374 hasVersionMismatch()] âœ… [VHIDManager] Version compatible: v5.0.0
[2025-11-22 13:36:16.962] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:36:17.025] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:36:17.026] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:36:17.026] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:36:17.026] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:36:17.026] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:36:17.027] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:36:17.027] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:36:17.027] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:36:17.027] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:36:17.027] [INFO] [LaunchDaemonInstaller.swift:669 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Kanata service state: Uninstalled
[2025-11-22 13:36:17.027] [INFO] [LaunchDaemonInstaller.swift:696 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Service not installed (state: Uninstalled)
[2025-11-22 13:36:17.027] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:36:17.096] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:36:17.171] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhiddaemon loaded: false
[2025-11-22 13:36:17.252] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhidmanager loaded: false
[2025-11-22 13:36:17.252] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:36:17.329] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:36:17.329] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhidmanager
[2025-11-22 13:36:17.401] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhidmanager not found in system domain
[2025-11-22 13:36:17.401] [INFO] [SystemValidator.swift:400 checkComponents()] ğŸ” [SystemValidator] Components: kanata=false, driver=true, daemon=false, vhid=false, vhidVersionMismatch=false
[2025-11-22 13:36:17.401] [INFO] [SystemValidator.swift:220 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 3 (Components) completed in 1.086s
[2025-11-22 13:36:17.401] [INFO] [SystemValidator.swift:418 checkConflicts()] ğŸ” [SystemValidator] Checking for conflicts
[2025-11-22 13:36:17.401] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 20% (1/5 steps)
[2025-11-22 13:36:17.401] [INFO] [ProcessLifecycleManager.swift:117 detectConflicts()] ğŸ” [ProcessLifecycleManager] Detecting conflicts...
[2025-11-22 13:36:17.401] [INFO] [ProcessLifecycleManager.swift:121 detectConflicts()] ğŸ§ª [TestEnvironment] Skipping process conflict detection - returning clean state
[2025-11-22 13:36:17.401] [INFO] [SystemValidator.swift:443 checkConflicts()] ğŸ” [SystemValidator] Total conflicts: 0 (0 kanata, 0 karabiner)
[2025-11-22 13:36:17.401] [INFO] [SystemValidator.swift:484 checkHealth()] ğŸ” [SystemValidator] Checking system health
[2025-11-22 13:36:17.401] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:36:17.401] [INFO] [SystemValidator.swift:229 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 4 (Conflicts) completed in 1.086s
[2025-11-22 13:36:17.401] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 40% (2/5 steps)
[2025-11-22 13:36:17.472] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:36:17.472] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:36:17.500] [INFO] [HelperManager.swift:248 getHelperVersion()] âš ï¸ [HelperManager] getVersion timed out - clearing connection cache
[2025-11-22 13:36:17.500] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:36:17.542] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:36:17.612] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.069s)
[2025-11-22 13:36:17.612] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:36:18.189] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.066s)
[2025-11-22 13:36:18.189] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:36:18.189] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:36:18.189] [INFO] [SystemValidator.swift:494 checkHealth()] ğŸ” [SystemValidator] Health: kanata=false, daemon=false (launchctl), vhid=false
[2025-11-22 13:36:18.189] [INFO] [SystemValidator.swift:238 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 5 (Health) completed in 1.874s
[2025-11-22 13:36:18.189] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 60% (3/5 steps)
[2025-11-22 13:36:18.189] [INFO] [SystemValidator.swift:283 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 COMPLETE: Total duration 8.684s
[2025-11-22 13:36:18.189] [INFO] [SystemValidator.swift:297 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Validation #1 complete in 8.684s
[2025-11-22 13:36:18.189] [INFO] [SystemValidator.swift:299 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Result: ready=false, blocking=9, total=9
[2025-11-22 13:36:18.189] [INFO] [SystemValidator.swift:362 checkPermissions()] ğŸ” [SystemValidator] Oracle snapshot: ready=false, age=1.874s
[2025-11-22 13:36:18.189] [INFO] [SystemValidator.swift:328 checkHelper()] ğŸ” [SystemValidator] Helper state: registeredButUnresponsive Helper registered but XPC communication failed
[2025-11-22 13:36:18.189] [INFO] [SystemValidator.swift:202 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 1 (Helper) completed in 8.684s
[2025-11-22 13:36:18.189] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:36:18.189] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:36:18.189] [INFO] [SystemValidator.swift:211 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 2 (Permissions) completed in 1.874s
[2025-11-22 13:36:18.189] [INFO] [SystemRequirements.swift:135 validateSystemCompatibility()] ğŸ” [SystemRequirements] Validating system compatibility
[2025-11-22 13:36:18.189] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 100% (5/5 steps)
[2025-11-22 13:36:18.189] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 80% (4/5 steps)
[2025-11-22 13:36:18.189] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:36:18.189] [INFO] [SystemRequirements.swift:147 validateSystemCompatibility()] âœ… [SystemRequirements] Modern macOS detected: 26.0.1
[2025-11-22 13:36:18.189] [INFO] [SystemRequirements.swift:190 validateSystemCompatibility()] ğŸ” [SystemRequirements] Compatibility check complete: âœ… Compatible
[2025-11-22 13:36:18.189] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:36:18.189] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:36:18.189] [INFO] [InstallerEngine.swift:78 inspectSystem()] âœ… [InstallerEngine] inspectSystem() complete - ready=false, blocking=9
[2025-11-22 13:36:18.189] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: repair, context:)
[2025-11-22 13:36:18.189] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: repair
[2025-11-22 13:36:18.189] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:36:18.189] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:36:18.190] [INFO] [InstallerEngine.swift:194 execute(plan:using:)] âš™ï¸ [InstallerEngine] Starting execute(plan:, using:)
[2025-11-22 13:36:18.190] [INFO] [InstallerEngine.swift:213 execute(plan:using:)] âš™ï¸ [InstallerEngine] Executing recipe: install-bundled-kanata (type: installComponent)
[2025-11-22 13:36:18.190] [INFO] [PrivilegedOperationsCoordinator.swift:359 installBundledKanata()] ğŸ” [PrivCoordinator] Installing bundled Kanata binary
[2025-11-22 13:36:18.190] [INFO] [LaunchDaemonInstaller.swift:2898 installBundledKanataBinaryOnly()] ğŸ”§ [LaunchDaemon] Installing bundled kanata binary to system location
[2025-11-22 13:36:18.190] [INFO] [LaunchDaemonInstaller.swift:2906 installBundledKanataBinaryOnly()] âŒ [LaunchDaemon] CRITICAL: Bundled kanata binary not found at: /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata
[2025-11-22 13:36:18.190] [INFO] [LaunchDaemonInstaller.swift:2908 installBundledKanataBinaryOnly()] âŒ [LaunchDaemon] This indicates a packaging issue - the app bundle is missing the kanata binary
[2025-11-22 13:36:18.190] [INFO] [InstallerEngine.swift:255 execute(plan:using:)] âŒ [InstallerEngine] Recipe install-bundled-kanata failed: Operation failed: Bundled Kanata installation failed
[2025-11-22 13:36:18.190] [INFO] [InstallerEngine.swift:274 execute(plan:using:)] âœ… [InstallerEngine] execute() complete - success: false, recipes executed: 1
[2025-11-22 13:36:18.190] [INFO] [InstallerEngine.swift:432 run(intent:using:)] âœ… [InstallerEngine] run() complete - success: false
[2025-11-22 13:36:18.190] [INFO] [SystemValidator.swift:283 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 COMPLETE: Total duration 8.685s
[2025-11-22 13:36:18.190] [INFO] [SystemValidator.swift:297 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Validation #1 complete in 8.685s
[2025-11-22 13:36:18.190] [INFO] [SystemValidator.swift:299 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Result: ready=false, blocking=9, total=9
[2025-11-22 13:36:18.190] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:36:18.190] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:36:18.190] [INFO] [SystemRequirements.swift:135 validateSystemCompatibility()] ğŸ” [SystemRequirements] Validating system compatibility
[2025-11-22 13:36:18.190] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:36:18.190] [INFO] [SystemRequirements.swift:147 validateSystemCompatibility()] âœ… [SystemRequirements] Modern macOS detected: 26.0.1
[2025-11-22 13:36:18.190] [INFO] [SystemRequirements.swift:190 validateSystemCompatibility()] ğŸ” [SystemRequirements] Compatibility check complete: âœ… Compatible
[2025-11-22 13:36:18.190] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:36:18.190] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:36:18.190] [INFO] [InstallerEngine.swift:78 inspectSystem()] âœ… [InstallerEngine] inspectSystem() complete - ready=false, blocking=9
[2025-11-22 13:36:18.190] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: repair, context:)
[2025-11-22 13:36:18.190] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: repair
[2025-11-22 13:36:18.190] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:36:18.190] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:36:18.190] [INFO] [InstallerEngine.swift:194 execute(plan:using:)] âš™ï¸ [InstallerEngine] Starting execute(plan:, using:)
[2025-11-22 13:36:18.191] [INFO] [InstallerEngine.swift:213 execute(plan:using:)] âš™ï¸ [InstallerEngine] Executing recipe: install-bundled-kanata (type: installComponent)
[2025-11-22 13:36:18.191] [INFO] [PrivilegedOperationsCoordinator.swift:359 installBundledKanata()] ğŸ” [PrivCoordinator] Installing bundled Kanata binary
[2025-11-22 13:36:18.191] [INFO] [LaunchDaemonInstaller.swift:2898 installBundledKanataBinaryOnly()] ğŸ”§ [LaunchDaemon] Installing bundled kanata binary to system location
[2025-11-22 13:36:18.191] [INFO] [LaunchDaemonInstaller.swift:2906 installBundledKanataBinaryOnly()] âŒ [LaunchDaemon] CRITICAL: Bundled kanata binary not found at: /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata
[2025-11-22 13:36:18.191] [INFO] [LaunchDaemonInstaller.swift:2908 installBundledKanataBinaryOnly()] âŒ [LaunchDaemon] This indicates a packaging issue - the app bundle is missing the kanata binary
[2025-11-22 13:36:18.191] [INFO] [InstallerEngine.swift:255 execute(plan:using:)] âŒ [InstallerEngine] Recipe install-bundled-kanata failed: Operation failed: Bundled Kanata installation failed
[2025-11-22 13:36:18.191] [INFO] [InstallerEngine.swift:274 execute(plan:using:)] âœ… [InstallerEngine] execute() complete - success: false, recipes executed: 1
[2025-11-22 13:36:18.191] [INFO] [InstallerEngine.swift:432 run(intent:using:)] âœ… [InstallerEngine] run() complete - success: false
[2025-11-22 13:36:19.468] [INFO] [HelperManager.swift:248 getHelperVersion()] âš ï¸ [HelperManager] getVersion timed out - clearing connection cache
[2025-11-22 13:36:19.468] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:36:19.468] [INFO] [SystemValidator.swift:328 checkHelper()] ğŸ” [SystemValidator] Helper state: registeredButUnresponsive Helper registered but XPC communication failed
[2025-11-22 13:36:19.468] [INFO] [SystemValidator.swift:202 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 1 (Helper) completed in 3.153s
[2025-11-22 13:36:19.468] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 100% (5/5 steps)
[2025-11-22 13:36:19.468] [INFO] [SystemValidator.swift:283 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 COMPLETE: Total duration 3.153s
[2025-11-22 13:36:19.468] [INFO] [SystemValidator.swift:297 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Validation #1 complete in 3.153s
[2025-11-22 13:36:19.468] [INFO] [SystemValidator.swift:299 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Result: ready=false, blocking=9, total=9
[2025-11-22 13:36:19.468] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:36:19.468] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:36:19.468] [INFO] [SystemRequirements.swift:135 validateSystemCompatibility()] ğŸ” [SystemRequirements] Validating system compatibility
[2025-11-22 13:36:19.468] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:36:19.468] [INFO] [SystemRequirements.swift:147 validateSystemCompatibility()] âœ… [SystemRequirements] Modern macOS detected: 26.0.1
[2025-11-22 13:36:19.468] [INFO] [SystemRequirements.swift:190 validateSystemCompatibility()] ğŸ” [SystemRequirements] Compatibility check complete: âœ… Compatible
[2025-11-22 13:36:19.468] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:36:19.468] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:36:19.468] [INFO] [InstallerEngine.swift:78 inspectSystem()] âœ… [InstallerEngine] inspectSystem() complete - ready=false, blocking=9
[2025-11-22 13:36:19.468] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: repair, context:)
[2025-11-22 13:36:19.468] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: repair
[2025-11-22 13:36:19.468] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:36:19.468] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:36:19.468] [INFO] [InstallerEngine.swift:194 execute(plan:using:)] âš™ï¸ [InstallerEngine] Starting execute(plan:, using:)
[2025-11-22 13:36:19.468] [INFO] [InstallerEngine.swift:213 execute(plan:using:)] âš™ï¸ [InstallerEngine] Executing recipe: install-bundled-kanata (type: installComponent)
[2025-11-22 13:36:19.469] [INFO] [PrivilegedOperationsCoordinator.swift:359 installBundledKanata()] ğŸ” [PrivCoordinator] Installing bundled Kanata binary
[2025-11-22 13:36:19.469] [INFO] [LaunchDaemonInstaller.swift:2898 installBundledKanataBinaryOnly()] ğŸ”§ [LaunchDaemon] Installing bundled kanata binary to system location
[2025-11-22 13:36:19.469] [INFO] [LaunchDaemonInstaller.swift:2906 installBundledKanataBinaryOnly()] âŒ [LaunchDaemon] CRITICAL: Bundled kanata binary not found at: /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata
[2025-11-22 13:36:19.469] [INFO] [LaunchDaemonInstaller.swift:2908 installBundledKanataBinaryOnly()] âŒ [LaunchDaemon] This indicates a packaging issue - the app bundle is missing the kanata binary
[2025-11-22 13:36:19.469] [INFO] [InstallerEngine.swift:255 execute(plan:using:)] âŒ [InstallerEngine] Recipe install-bundled-kanata failed: Operation failed: Bundled Kanata installation failed
[2025-11-22 13:36:19.469] [INFO] [InstallerEngine.swift:274 execute(plan:using:)] âœ… [InstallerEngine] execute() complete - success: false, recipes executed: 1
[2025-11-22 13:36:19.469] [INFO] [InstallerEngine.swift:432 run(intent:using:)] âœ… [InstallerEngine] run() complete - success: false
[2025-11-22 13:36:58.310] [INFO] [PrivilegedOperationsCoordinator.swift:844 sudoExecuteCommand(_:description:)] âœ… [PrivCoordinator] Successfully executed: Stop Kanata service
[2025-11-22 13:36:58.310] [INFO] [PrivilegedOperationsCoordinator.swift:330 killAllKanataProcesses()] ğŸ” [PrivCoordinator] Killing all Kanata processes
[2025-11-22 13:36:58.310] [INFO] [PrivilegedOperationsCoordinator.swift:839 sudoExecuteCommand(_:description:)] ğŸ”§ [PrivCoordinator] Executing admin command: Kill all Kanata processes
[2025-11-22 13:37:06.276] [INFO] [PrivilegedOperationsCoordinator.swift:846 sudoExecuteCommand(_:description:)] âŒ [PrivCoordinator] Failed to execute: Kill all Kanata processes
[2025-11-22 13:37:06.276] [INFO] [PrivilegedOperationsCoordinator.swift:847 sudoExecuteCommand(_:description:)] âŒ [PrivCoordinator] Output: 
Test Case '-[KeyPathTests.ErrorHandlingTests testKanataProcessErrorHandling]' passed (61.701 seconds).
Test Case '-[KeyPathTests.ErrorHandlingTests testMemoryPressureErrorHandling]' started.
Test Case '-[KeyPathTests.ErrorHandlingTests testMemoryPressureErrorHandling]' passed (0.019 seconds).
Test Case '-[KeyPathTests.ErrorHandlingTests testNilAndOptionalHandling]' started.
[2025-11-22 13:37:06.296] [INFO] [KanataManager.swift:325 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] init() called
[2025-11-22 13:37:06.296] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:37:06.296] [INFO] [ConfigFileWatcher.swift:40 init()] ğŸ“ [FileWatcher] ConfigFileWatcher initialized with robust monitoring
[2025-11-22 13:37:06.296] [INFO] [ServiceHealthMonitor.swift:140 init(processLifecycle:)] [HealthMonitor] Initialized with process lifecycle manager
[2025-11-22 13:37:06.296] [DEBUG] [KanataManager.swift:397 init(engineClient:injectedConfigurationService:)] ğŸ§ª [KanataManager] Skipping background initialization in test environment
[2025-11-22 13:37:06.296] [INFO] [KanataManager.swift:405 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] About to call bootstrapRuleCollections and startLayerMonitoring
[2025-11-22 13:37:06.296] [INFO] [KanataManager.swift:577 startLayerMonitoring()] ğŸŒ [KanataManager] startLayerMonitoring() called
[2025-11-22 13:37:06.296] [INFO] [KanataManager.swift:579 startLayerMonitoring()] ğŸŒ [KanataManager] Skipping layer monitoring (test environment)
[2025-11-22 13:37:06.296] [INFO] [KanataManager.swift:409 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] init() completed
Test Case '-[KeyPathTests.ErrorHandlingTests testNilAndOptionalHandling]' passed (0.000 seconds).
Test Case '-[KeyPathTests.ErrorHandlingTests testPermissionErrorHandling]' started.
[2025-11-22 13:37:06.296] [INFO] [KanataManager.swift:325 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] init() called
[2025-11-22 13:37:06.297] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:37:06.297] [INFO] [ConfigFileWatcher.swift:40 init()] ğŸ“ [FileWatcher] ConfigFileWatcher initialized with robust monitoring
[2025-11-22 13:37:06.297] [INFO] [ServiceHealthMonitor.swift:140 init(processLifecycle:)] [HealthMonitor] Initialized with process lifecycle manager
[2025-11-22 13:37:06.297] [DEBUG] [KanataManager.swift:397 init(engineClient:injectedConfigurationService:)] ğŸ§ª [KanataManager] Skipping background initialization in test environment
[2025-11-22 13:37:06.297] [INFO] [KanataManager.swift:405 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] About to call bootstrapRuleCollections and startLayerMonitoring
[2025-11-22 13:37:06.297] [INFO] [KanataManager.swift:577 startLayerMonitoring()] ğŸŒ [KanataManager] startLayerMonitoring() called
[2025-11-22 13:37:06.297] [INFO] [KanataManager.swift:579 startLayerMonitoring()] ğŸŒ [KanataManager] Skipping layer monitoring (test environment)
[2025-11-22 13:37:06.297] [INFO] [KanataManager.swift:409 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] init() completed
[2025-11-22 13:37:06.297] [INFO] [PermissionOracle.swift:173 currentSnapshot()] ğŸ”® [Oracle] Test mode snapshot generated (non-blocking)
Test Case '-[KeyPathTests.ErrorHandlingTests testPermissionErrorHandling]' passed (0.010 seconds).
Test Case '-[KeyPathTests.ErrorHandlingTests testResourceCleanupErrorHandling]' started.
[2025-11-22 13:37:06.306] [DEBUG] [KeyboardCapture.swift:331 setupEventTap(at:)] ğŸ§ª [KeyboardCapture] Test environment detected â€“ skipping CGEvent tap setup
[2025-11-22 13:37:06.306] [DEBUG] [KeyboardCapture.swift:331 setupEventTap(at:)] ğŸ§ª [KeyboardCapture] Test environment detected â€“ skipping CGEvent tap setup
[2025-11-22 13:37:06.306] [DEBUG] [KeyboardCapture.swift:331 setupEventTap(at:)] ğŸ§ª [KeyboardCapture] Test environment detected â€“ skipping CGEvent tap setup
[2025-11-22 13:37:06.306] [DEBUG] [KeyboardCapture.swift:331 setupEventTap(at:)] ğŸ§ª [KeyboardCapture] Test environment detected â€“ skipping CGEvent tap setup
[2025-11-22 13:37:06.306] [DEBUG] [KeyboardCapture.swift:331 setupEventTap(at:)] ğŸ§ª [KeyboardCapture] Test environment detected â€“ skipping CGEvent tap setup
[2025-11-22 13:37:06.306] [DEBUG] [KeyboardCapture.swift:331 setupEventTap(at:)] ğŸ§ª [KeyboardCapture] Test environment detected â€“ skipping CGEvent tap setup
[2025-11-22 13:37:06.306] [DEBUG] [KeyboardCapture.swift:331 setupEventTap(at:)] ğŸ§ª [KeyboardCapture] Test environment detected â€“ skipping CGEvent tap setup
[2025-11-22 13:37:06.306] [DEBUG] [KeyboardCapture.swift:331 setupEventTap(at:)] ğŸ§ª [KeyboardCapture] Test environment detected â€“ skipping CGEvent tap setup
[2025-11-22 13:37:06.306] [DEBUG] [KeyboardCapture.swift:331 setupEventTap(at:)] ğŸ§ª [KeyboardCapture] Test environment detected â€“ skipping CGEvent tap setup
[2025-11-22 13:37:06.306] [DEBUG] [KeyboardCapture.swift:331 setupEventTap(at:)] ğŸ§ª [KeyboardCapture] Test environment detected â€“ skipping CGEvent tap setup
[2025-11-22 13:37:06.306] [DEBUG] [KeyboardCapture.swift:331 setupEventTap(at:)] ğŸ§ª [KeyboardCapture] Test environment detected â€“ skipping CGEvent tap setup
[2025-11-22 13:37:06.306] [DEBUG] [KeyboardCapture.swift:331 setupEventTap(at:)] ğŸ§ª [KeyboardCapture] Test environment detected â€“ skipping CGEvent tap setup
[2025-11-22 13:37:06.306] [DEBUG] [KeyboardCapture.swift:331 setupEventTap(at:)] ğŸ§ª [KeyboardCapture] Test environment detected â€“ skipping CGEvent tap setup
[2025-11-22 13:37:06.306] [DEBUG] [KeyboardCapture.swift:331 setupEventTap(at:)] ğŸ§ª [KeyboardCapture] Test environment detected â€“ skipping CGEvent tap setup
[2025-11-22 13:37:06.306] [DEBUG] [KeyboardCapture.swift:331 setupEventTap(at:)] ğŸ§ª [KeyboardCapture] Test environment detected â€“ skipping CGEvent tap setup
[2025-11-22 13:37:06.306] [DEBUG] [KeyboardCapture.swift:331 setupEventTap(at:)] ğŸ§ª [KeyboardCapture] Test environment detected â€“ skipping CGEvent tap setup
[2025-11-22 13:37:06.306] [DEBUG] [KeyboardCapture.swift:331 setupEventTap(at:)] ğŸ§ª [KeyboardCapture] Test environment detected â€“ skipping CGEvent tap setup
[2025-11-22 13:37:06.306] [DEBUG] [KeyboardCapture.swift:331 setupEventTap(at:)] ğŸ§ª [KeyboardCapture] Test environment detected â€“ skipping CGEvent tap setup
[2025-11-22 13:37:06.306] [DEBUG] [KeyboardCapture.swift:331 setupEventTap(at:)] ğŸ§ª [KeyboardCapture] Test environment detected â€“ skipping CGEvent tap setup
[2025-11-22 13:37:06.306] [DEBUG] [KeyboardCapture.swift:331 setupEventTap(at:)] ğŸ§ª [KeyboardCapture] Test environment detected â€“ skipping CGEvent tap setup
[2025-11-22 13:37:06.306] [DEBUG] [KeyboardCapture.swift:600 startEmergencyMonitoring(callback:)] ğŸ§ª [KeyboardCapture] Test environment â€“ skipping emergency monitoring tap
[2025-11-22 13:37:06.306] [DEBUG] [KeyboardCapture.swift:600 startEmergencyMonitoring(callback:)] ğŸ§ª [KeyboardCapture] Test environment â€“ skipping emergency monitoring tap
[2025-11-22 13:37:06.306] [DEBUG] [KeyboardCapture.swift:600 startEmergencyMonitoring(callback:)] ğŸ§ª [KeyboardCapture] Test environment â€“ skipping emergency monitoring tap
[2025-11-22 13:37:06.306] [DEBUG] [KeyboardCapture.swift:600 startEmergencyMonitoring(callback:)] ğŸ§ª [KeyboardCapture] Test environment â€“ skipping emergency monitoring tap
[2025-11-22 13:37:06.306] [DEBUG] [KeyboardCapture.swift:600 startEmergencyMonitoring(callback:)] ğŸ§ª [KeyboardCapture] Test environment â€“ skipping emergency monitoring tap
[2025-11-22 13:37:06.306] [DEBUG] [KeyboardCapture.swift:600 startEmergencyMonitoring(callback:)] ğŸ§ª [KeyboardCapture] Test environment â€“ skipping emergency monitoring tap
[2025-11-22 13:37:06.306] [DEBUG] [KeyboardCapture.swift:600 startEmergencyMonitoring(callback:)] ğŸ§ª [KeyboardCapture] Test environment â€“ skipping emergency monitoring tap
[2025-11-22 13:37:06.306] [DEBUG] [KeyboardCapture.swift:600 startEmergencyMonitoring(callback:)] ğŸ§ª [KeyboardCapture] Test environment â€“ skipping emergency monitoring tap
[2025-11-22 13:37:06.306] [DEBUG] [KeyboardCapture.swift:600 startEmergencyMonitoring(callback:)] ğŸ§ª [KeyboardCapture] Test environment â€“ skipping emergency monitoring tap
[2025-11-22 13:37:06.306] [DEBUG] [KeyboardCapture.swift:600 startEmergencyMonitoring(callback:)] ğŸ§ª [KeyboardCapture] Test environment â€“ skipping emergency monitoring tap
[2025-11-22 13:37:06.306] [DEBUG] [KeyboardCapture.swift:600 startEmergencyMonitoring(callback:)] ğŸ§ª [KeyboardCapture] Test environment â€“ skipping emergency monitoring tap
[2025-11-22 13:37:06.306] [DEBUG] [KeyboardCapture.swift:600 startEmergencyMonitoring(callback:)] ğŸ§ª [KeyboardCapture] Test environment â€“ skipping emergency monitoring tap
[2025-11-22 13:37:06.306] [DEBUG] [KeyboardCapture.swift:600 startEmergencyMonitoring(callback:)] ğŸ§ª [KeyboardCapture] Test environment â€“ skipping emergency monitoring tap
[2025-11-22 13:37:06.306] [DEBUG] [KeyboardCapture.swift:600 startEmergencyMonitoring(callback:)] ğŸ§ª [KeyboardCapture] Test environment â€“ skipping emergency monitoring tap
[2025-11-22 13:37:06.306] [DEBUG] [KeyboardCapture.swift:600 startEmergencyMonitoring(callback:)] ğŸ§ª [KeyboardCapture] Test environment â€“ skipping emergency monitoring tap
[2025-11-22 13:37:06.306] [DEBUG] [KeyboardCapture.swift:600 startEmergencyMonitoring(callback:)] ğŸ§ª [KeyboardCapture] Test environment â€“ skipping emergency monitoring tap
[2025-11-22 13:37:06.306] [DEBUG] [KeyboardCapture.swift:600 startEmergencyMonitoring(callback:)] ğŸ§ª [KeyboardCapture] Test environment â€“ skipping emergency monitoring tap
[2025-11-22 13:37:06.306] [DEBUG] [KeyboardCapture.swift:600 startEmergencyMonitoring(callback:)] ğŸ§ª [KeyboardCapture] Test environment â€“ skipping emergency monitoring tap
[2025-11-22 13:37:06.306] [DEBUG] [KeyboardCapture.swift:600 startEmergencyMonitoring(callback:)] ğŸ§ª [KeyboardCapture] Test environment â€“ skipping emergency monitoring tap
[2025-11-22 13:37:06.306] [DEBUG] [KeyboardCapture.swift:600 startEmergencyMonitoring(callback:)] ğŸ§ª [KeyboardCapture] Test environment â€“ skipping emergency monitoring tap
Test Case '-[KeyPathTests.ErrorHandlingTests testResourceCleanupErrorHandling]' passed (0.000 seconds).
Test Case '-[KeyPathTests.ErrorHandlingTests testSequenceGenerationErrorHandling]' started.
[2025-11-22 13:37:06.306] [INFO] [KanataManager.swift:325 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] init() called
[2025-11-22 13:37:06.306] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:37:06.306] [INFO] [ConfigFileWatcher.swift:40 init()] ğŸ“ [FileWatcher] ConfigFileWatcher initialized with robust monitoring
[2025-11-22 13:37:06.306] [INFO] [ServiceHealthMonitor.swift:140 init(processLifecycle:)] [HealthMonitor] Initialized with process lifecycle manager
[2025-11-22 13:37:06.306] [DEBUG] [KanataManager.swift:397 init(engineClient:injectedConfigurationService:)] ğŸ§ª [KanataManager] Skipping background initialization in test environment
[2025-11-22 13:37:06.306] [INFO] [KanataManager.swift:405 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] About to call bootstrapRuleCollections and startLayerMonitoring
[2025-11-22 13:37:06.306] [INFO] [KanataManager.swift:577 startLayerMonitoring()] ğŸŒ [KanataManager] startLayerMonitoring() called
[2025-11-22 13:37:06.307] [INFO] [KanataManager.swift:579 startLayerMonitoring()] ğŸŒ [KanataManager] Skipping layer monitoring (test environment)
[2025-11-22 13:37:06.307] [INFO] [KanataManager.swift:409 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] init() completed
Test Case '-[KeyPathTests.ErrorHandlingTests testSequenceGenerationErrorHandling]' passed (0.000 seconds).
Test Case '-[KeyPathTests.ErrorHandlingTests testServiceInstallationErrorHandling]' started.
[2025-11-22 13:37:06.307] [INFO] [KanataManager.swift:325 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] init() called
[2025-11-22 13:37:06.307] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:37:06.307] [INFO] [ConfigFileWatcher.swift:40 init()] ğŸ“ [FileWatcher] ConfigFileWatcher initialized with robust monitoring
[2025-11-22 13:37:06.307] [INFO] [ServiceHealthMonitor.swift:140 init(processLifecycle:)] [HealthMonitor] Initialized with process lifecycle manager
[2025-11-22 13:37:06.307] [DEBUG] [KanataManager.swift:397 init(engineClient:injectedConfigurationService:)] ğŸ§ª [KanataManager] Skipping background initialization in test environment
[2025-11-22 13:37:06.307] [INFO] [KanataManager.swift:405 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] About to call bootstrapRuleCollections and startLayerMonitoring
[2025-11-22 13:37:06.307] [INFO] [KanataManager.swift:577 startLayerMonitoring()] ğŸŒ [KanataManager] startLayerMonitoring() called
[2025-11-22 13:37:06.307] [INFO] [KanataManager.swift:579 startLayerMonitoring()] ğŸŒ [KanataManager] Skipping layer monitoring (test environment)
[2025-11-22 13:37:06.307] [INFO] [KanataManager.swift:409 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] init() completed
[2025-11-22 13:37:06.307] [INFO] [KanataBinaryDetector.swift:66 detectCurrentStatus()] ğŸ” [KanataBinaryDetector] Starting unified kanata binary detection
[2025-11-22 13:37:06.307] [INFO] [KanataBinaryDetector.swift:81 detectCurrentStatus()] âŒ [KanataBinaryDetector] No kanata binary found
[2025-11-22 13:37:06.307] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:37:06.307] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:37:06.307] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:37:06.307] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:37:06.307] [INFO] [KanataBinaryDetector.swift:66 detectCurrentStatus()] ğŸ” [KanataBinaryDetector] Starting unified kanata binary detection
[2025-11-22 13:37:06.307] [INFO] [KanataBinaryDetector.swift:81 detectCurrentStatus()] âŒ [KanataBinaryDetector] No kanata binary found
[2025-11-22 13:37:06.307] [INFO] [KanataBinaryDetector.swift:66 detectCurrentStatus()] ğŸ” [KanataBinaryDetector] Starting unified kanata binary detection
[2025-11-22 13:37:06.308] [INFO] [KanataBinaryDetector.swift:81 detectCurrentStatus()] âŒ [KanataBinaryDetector] No kanata binary found
Test Case '-[KeyPathTests.ErrorHandlingTests testServiceInstallationErrorHandling]' passed (0.001 seconds).
Test Case '-[KeyPathTests.ErrorHandlingTests testSpecialCharacterKeyMapping]' started.
[2025-11-22 13:37:06.308] [INFO] [KanataManager.swift:325 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] init() called
[2025-11-22 13:37:06.308] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:37:06.308] [INFO] [ConfigFileWatcher.swift:40 init()] ğŸ“ [FileWatcher] ConfigFileWatcher initialized with robust monitoring
[2025-11-22 13:37:06.308] [INFO] [ServiceHealthMonitor.swift:140 init(processLifecycle:)] [HealthMonitor] Initialized with process lifecycle manager
[2025-11-22 13:37:06.308] [DEBUG] [KanataManager.swift:397 init(engineClient:injectedConfigurationService:)] ğŸ§ª [KanataManager] Skipping background initialization in test environment
[2025-11-22 13:37:06.308] [INFO] [KanataManager.swift:405 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] About to call bootstrapRuleCollections and startLayerMonitoring
[2025-11-22 13:37:06.308] [INFO] [KanataManager.swift:577 startLayerMonitoring()] ğŸŒ [KanataManager] startLayerMonitoring() called
[2025-11-22 13:37:06.308] [INFO] [KanataManager.swift:579 startLayerMonitoring()] ğŸŒ [KanataManager] Skipping layer monitoring (test environment)
[2025-11-22 13:37:06.308] [INFO] [KanataManager.swift:409 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] init() completed
Test Case '-[KeyPathTests.ErrorHandlingTests testSpecialCharacterKeyMapping]' passed (0.000 seconds).
Test Suite 'ErrorHandlingTests' passed at 2025-11-22 13:37:06.308.
	 Executed 21 tests, with 0 failures (0 unexpected) in 71.257 (71.259) seconds
Test Suite 'FDADetectionTests' started at 2025-11-22 13:37:06.308.
Test Case '-[KeyPathTests.FDADetectionTests testDetectionModalTiming]' started.
Test Case '-[KeyPathTests.FDADetectionTests testDetectionModalTiming]' passed (0.000 seconds).
Test Case '-[KeyPathTests.FDADetectionTests testFDACaching]' started.
Test Case '-[KeyPathTests.FDADetectionTests testFDACaching]' passed (0.000 seconds).
Test Case '-[KeyPathTests.FDADetectionTests testFDACheckPerformance]' started.
[2025-11-22 13:37:06.308] [INFO] [KanataManager.swift:603 updateActiveLayerName(_:)] ğŸ¯ [KanataManager] updateActiveLayerName: raw='base' normalized='base' display='Base' current='Base'
[2025-11-22 13:37:06.308] [INFO] [KanataManager.swift:603 updateActiveLayerName(_:)] ğŸ¯ [KanataManager] updateActiveLayerName: raw='base' normalized='base' display='Base' current='Base'
[2025-11-22 13:37:06.308] [INFO] [KanataManager.swift:603 updateActiveLayerName(_:)] ğŸ¯ [KanataManager] updateActiveLayerName: raw='base' normalized='base' display='Base' current='Base'
[2025-11-22 13:37:06.308] [INFO] [KanataManager.swift:603 updateActiveLayerName(_:)] ğŸ¯ [KanataManager] updateActiveLayerName: raw='base' normalized='base' display='Base' current='Base'
[2025-11-22 13:37:06.308] [INFO] [KanataManager.swift:603 updateActiveLayerName(_:)] ğŸ¯ [KanataManager] updateActiveLayerName: raw='base' normalized='base' display='Base' current='Base'
[2025-11-22 13:37:06.309] [INFO] [KanataManager.swift:603 updateActiveLayerName(_:)] ğŸ¯ [KanataManager] updateActiveLayerName: raw='base' normalized='base' display='Base' current='Base'
[2025-11-22 13:37:06.309] [INFO] [KanataManager.swift:603 updateActiveLayerName(_:)] ğŸ¯ [KanataManager] updateActiveLayerName: raw='base' normalized='base' display='Base' current='Base'
[2025-11-22 13:37:06.309] [INFO] [KanataManager.swift:603 updateActiveLayerName(_:)] ğŸ¯ [KanataManager] updateActiveLayerName: raw='base' normalized='base' display='Base' current='Base'
[2025-11-22 13:37:06.309] [INFO] [KanataManager.swift:603 updateActiveLayerName(_:)] ğŸ¯ [KanataManager] updateActiveLayerName: raw='base' normalized='base' display='Base' current='Base'
[2025-11-22 13:37:06.309] [INFO] [KanataManager.swift:603 updateActiveLayerName(_:)] ğŸ¯ [KanataManager] updateActiveLayerName: raw='base' normalized='base' display='Base' current='Base'
[2025-11-22 13:37:06.310] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:37:06.310] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:37:06.310] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 7007 characters
[2025-11-22 13:37:06.310] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:37:06.310] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 18 src keys, 88 layer keys, deduplicated to 18 unique mappings
[2025-11-22 13:37:06.310] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:37:06.310] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:37:06.310] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:37:06.310] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:37:06.310] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 7007 characters
[2025-11-22 13:37:06.310] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:37:06.310] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 18 src keys, 88 layer keys, deduplicated to 18 unique mappings
[2025-11-22 13:37:06.311] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:37:06.311] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:37:06.311] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 28 mappings
[2025-11-22 13:37:06.311] [DEBUG] [KanataManager+Configuration.swift:53 triggerConfigReload()] ğŸ“¡ [Reload] Attempting TCP reload
[2025-11-22 13:37:06.311] [DEBUG] [KanataManager+Configuration.swift:84 triggerTCPReload()] ğŸ§ª [TCP Reload] Skipping TCP reload in test environment
[2025-11-22 13:37:06.311] [DEBUG] [KanataManager+Configuration.swift:65 triggerConfigReload()] ğŸ“¡ [Reload] TCP reload failed: Test environment - TCP disabled
[2025-11-22 13:37:06.311] [WARN] [KanataManager+Configuration.swift:68 triggerConfigReload()] âš ï¸ [Reload] Falling back to service restart
[2025-11-22 13:37:06.311] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:37:06.311] [INFO] [SystemValidator.swift:63 init(launchDaemonInstaller:vhidDeviceManager:processLifecycleManager:kanataManager:)] ğŸ” [SystemValidator] Initialized (stateless, no cache)
[2025-11-22 13:37:06.311] [INFO] [InstallerEngine.swift:35 init(processLifecycleManager:kanataManager:)] ğŸ”§ [InstallerEngine] Initialized
[2025-11-22 13:37:06.311] [INFO] [InstallerEngine.swift:419 run(intent:using:)] ğŸš€ [InstallerEngine] Starting run(intent: repair, using:)
[2025-11-22 13:37:06.311] [INFO] [InstallerEngine.swift:53 inspectSystem()] ğŸ” [InstallerEngine] Starting inspectSystem()
[2025-11-22 13:37:06.311] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:37:06.311] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:37:06.311] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 7007 characters
[2025-11-22 13:37:06.311] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:37:06.311] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 18 src keys, 88 layer keys, deduplicated to 18 unique mappings
[2025-11-22 13:37:06.311] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:37:06.311] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:37:06.311] [INFO] [SystemValidator.swift:143 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Starting validation #1
[2025-11-22 13:37:06.311] [INFO] [SystemValidator.swift:174 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 START: 1763847426.311
[2025-11-22 13:37:06.312] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:37:06.312] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:37:06.312] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 7007 characters
[2025-11-22 13:37:06.312] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:37:06.312] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 18 src keys, 88 layer keys, deduplicated to 18 unique mappings
[2025-11-22 13:37:06.312] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:37:06.312] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:37:06.312] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 28 mappings
[2025-11-22 13:37:06.312] [DEBUG] [KanataManager+Configuration.swift:53 triggerConfigReload()] ğŸ“¡ [Reload] Attempting TCP reload
[2025-11-22 13:37:06.312] [DEBUG] [KanataManager+Configuration.swift:84 triggerTCPReload()] ğŸ§ª [TCP Reload] Skipping TCP reload in test environment
[2025-11-22 13:37:06.312] [DEBUG] [KanataManager+Configuration.swift:65 triggerConfigReload()] ğŸ“¡ [Reload] TCP reload failed: Test environment - TCP disabled
[2025-11-22 13:37:06.312] [WARN] [KanataManager+Configuration.swift:68 triggerConfigReload()] âš ï¸ [Reload] Falling back to service restart
[2025-11-22 13:37:06.312] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:37:06.312] [INFO] [SystemValidator.swift:63 init(launchDaemonInstaller:vhidDeviceManager:processLifecycleManager:kanataManager:)] ğŸ” [SystemValidator] Initialized (stateless, no cache)
[2025-11-22 13:37:06.312] [INFO] [InstallerEngine.swift:35 init(processLifecycleManager:kanataManager:)] ğŸ”§ [InstallerEngine] Initialized
[2025-11-22 13:37:06.312] [INFO] [InstallerEngine.swift:419 run(intent:using:)] ğŸš€ [InstallerEngine] Starting run(intent: repair, using:)
[2025-11-22 13:37:06.312] [INFO] [InstallerEngine.swift:53 inspectSystem()] ğŸ” [InstallerEngine] Starting inspectSystem()
[2025-11-22 13:37:06.312] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:37:06.312] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:37:06.312] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 7007 characters
[2025-11-22 13:37:06.312] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:37:06.313] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 18 src keys, 88 layer keys, deduplicated to 18 unique mappings
[2025-11-22 13:37:06.313] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:37:06.313] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:37:06.313] [INFO] [SystemValidator.swift:312 checkHelper()] ğŸ” [SystemValidator] Checking privileged helper
[2025-11-22 13:37:06.313] [INFO] [SystemValidator.swift:372 checkComponents()] ğŸ” [SystemValidator] Checking components
[2025-11-22 13:37:06.313] [INFO] [KanataBinaryDetector.swift:66 detectCurrentStatus()] ğŸ” [KanataBinaryDetector] Starting unified kanata binary detection
[2025-11-22 13:37:06.313] [INFO] [KanataBinaryDetector.swift:81 detectCurrentStatus()] âŒ [KanataBinaryDetector] No kanata binary found
[2025-11-22 13:37:06.313] [INFO] [VHIDDeviceManager.swift:50 detectInstallation()] ğŸ” [VHIDManager] Manager app exists at /Applications/.Karabiner-VirtualHIDDevice-Manager.app/Contents/MacOS/Karabiner-VirtualHIDDevice-Manager: true
[2025-11-22 13:37:06.319] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:37:06.322] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:37:06.337] [INFO] [HelperManager.swift:830 verifyEmbeddedHelperSignature()] ğŸ”’ [HelperManager] Embedded helper signature looks valid
[2025-11-22 13:37:06.337] [INFO] [HelperManager.swift:105 getConnection()] ğŸ”— [HelperManager] Creating XPC connection to com.keypath.helper
[2025-11-22 13:37:06.337] [INFO] [HelperManager.swift:129 getConnection()] âœ… [HelperManager] XPC connection established (PID: 0)
[2025-11-22 13:37:06.337] [INFO] [HelperManager.swift:228 getHelperVersion()] ğŸ“¤ [HelperManager] Calling proxy.getVersion()
[2025-11-22 13:37:06.337] [INFO] [HelperManager.swift:243 getHelperVersion()] ğŸ“¤ [HelperManager] proxy.getVersion() call dispatched, waiting for callback
[2025-11-22 13:37:06.338] [INFO] [HelperManager.swift:121 getConnection()] âš ï¸ [HelperManager] XPC connection interrupted - will reconnect
[2025-11-22 13:37:06.338] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:37:06.338] [INFO] [HelperManager.swift:578 getRemoteProxy(errorHandler:)] âŒ [HelperManager] XPC proxy error: Couldnâ€™t communicate with a helper application.
[2025-11-22 13:37:06.339] [INFO] [HelperManager.swift:584 getRemoteProxy(errorHandler:)] âš ï¸ [HelperManager] XPC connection interrupted - this may indicate:
[2025-11-22 13:37:06.339] [INFO] [HelperManager.swift:585 getRemoteProxy(errorHandler:)]    1. Helper signature validation failed (app updated but not restarted)
[2025-11-22 13:37:06.339] [INFO] [HelperManager.swift:587 getRemoteProxy(errorHandler:)]    2. Helper process crashed
[2025-11-22 13:37:06.339] [INFO] [HelperManager.swift:588 getRemoteProxy(errorHandler:)]    3. Helper was killed by the system
[2025-11-22 13:37:06.339] [INFO] [HelperManager.swift:589 getRemoteProxy(errorHandler:)] ğŸ’¡ If you just updated KeyPath, try restarting the app
[2025-11-22 13:37:06.339] [INFO] [HelperManager.swift:116 getConnection()] âŒ [HelperManager] XPC connection invalidated
[2025-11-22 13:37:06.339] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:37:06.380] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.067s)
[2025-11-22 13:37:06.380] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:37:06.951] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.066s)
[2025-11-22 13:37:06.952] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:37:06.952] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:37:06.952] [INFO] [VHIDDeviceManager.swift:343 getInstalledVersion()] ğŸ” [VHIDManager] Installed daemon version: 5.0.0
[2025-11-22 13:37:06.952] [INFO] [VHIDDeviceManager.swift:374 hasVersionMismatch()] âœ… [VHIDManager] Version compatible: v5.0.0
[2025-11-22 13:37:06.952] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:37:07.025] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:37:07.044] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:37:07.044] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:37:07.044] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:37:07.044] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:37:07.048] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:37:07.050] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:37:07.052] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:37:07.052] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:37:07.052] [INFO] [LaunchDaemonInstaller.swift:669 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Kanata service state: Uninstalled
[2025-11-22 13:37:07.052] [INFO] [LaunchDaemonInstaller.swift:696 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Service not installed (state: Uninstalled)
[2025-11-22 13:37:07.052] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:37:07.131] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:37:07.201] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhiddaemon loaded: false
[2025-11-22 13:37:07.268] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhidmanager loaded: false
[2025-11-22 13:37:07.268] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:37:07.335] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:37:07.335] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhidmanager
[2025-11-22 13:37:07.401] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhidmanager not found in system domain
[2025-11-22 13:37:07.401] [INFO] [SystemValidator.swift:400 checkComponents()] ğŸ” [SystemValidator] Components: kanata=false, driver=true, daemon=false, vhid=false, vhidVersionMismatch=false
[2025-11-22 13:37:07.401] [INFO] [SystemValidator.swift:220 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 3 (Components) completed in 1.090s
[2025-11-22 13:37:07.401] [INFO] [SystemValidator.swift:418 checkConflicts()] ğŸ” [SystemValidator] Checking for conflicts
[2025-11-22 13:37:07.401] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 20% (1/5 steps)
[2025-11-22 13:37:07.401] [INFO] [ProcessLifecycleManager.swift:117 detectConflicts()] ğŸ” [ProcessLifecycleManager] Detecting conflicts...
[2025-11-22 13:37:07.401] [INFO] [ProcessLifecycleManager.swift:121 detectConflicts()] ğŸ§ª [TestEnvironment] Skipping process conflict detection - returning clean state
[2025-11-22 13:37:07.401] [INFO] [SystemValidator.swift:443 checkConflicts()] ğŸ” [SystemValidator] Total conflicts: 0 (0 kanata, 0 karabiner)
[2025-11-22 13:37:07.402] [INFO] [SystemValidator.swift:484 checkHealth()] ğŸ” [SystemValidator] Checking system health
[2025-11-22 13:37:07.402] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:37:07.402] [INFO] [SystemValidator.swift:229 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 4 (Conflicts) completed in 1.090s
[2025-11-22 13:37:07.402] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 40% (2/5 steps)
[2025-11-22 13:37:07.468] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:37:07.468] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:37:07.535] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:37:07.601] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.066s)
[2025-11-22 13:37:07.601] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:37:08.175] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.068s)
[2025-11-22 13:37:08.175] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:37:08.175] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:37:08.175] [INFO] [SystemValidator.swift:494 checkHealth()] ğŸ” [SystemValidator] Health: kanata=false, daemon=false (launchctl), vhid=false
[2025-11-22 13:37:08.175] [INFO] [SystemValidator.swift:344 checkPermissions()] ğŸ” [SystemValidator] Checking permissions via Oracle
[2025-11-22 13:37:08.175] [INFO] [SystemValidator.swift:238 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 5 (Health) completed in 1.864s
[2025-11-22 13:37:08.175] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 60% (3/5 steps)
[2025-11-22 13:37:08.175] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 28 mappings
[2025-11-22 13:37:08.175] [INFO] [PermissionOracle.swift:173 currentSnapshot()] ğŸ”® [Oracle] Test mode snapshot generated (non-blocking)
[2025-11-22 13:37:08.175] [DEBUG] [KanataManager+Configuration.swift:53 triggerConfigReload()] ğŸ“¡ [Reload] Attempting TCP reload
[2025-11-22 13:37:08.175] [DEBUG] [KanataManager+Configuration.swift:84 triggerTCPReload()] ğŸ§ª [TCP Reload] Skipping TCP reload in test environment
[2025-11-22 13:37:08.175] [DEBUG] [KanataManager+Configuration.swift:65 triggerConfigReload()] ğŸ“¡ [Reload] TCP reload failed: Test environment - TCP disabled
[2025-11-22 13:37:08.176] [WARN] [KanataManager+Configuration.swift:68 triggerConfigReload()] âš ï¸ [Reload] Falling back to service restart
[2025-11-22 13:37:08.176] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:37:08.176] [INFO] [SystemValidator.swift:63 init(launchDaemonInstaller:vhidDeviceManager:processLifecycleManager:kanataManager:)] ğŸ” [SystemValidator] Initialized (stateless, no cache)
[2025-11-22 13:37:08.176] [INFO] [InstallerEngine.swift:35 init(processLifecycleManager:kanataManager:)] ğŸ”§ [InstallerEngine] Initialized
[2025-11-22 13:37:08.176] [INFO] [InstallerEngine.swift:419 run(intent:using:)] ğŸš€ [InstallerEngine] Starting run(intent: repair, using:)
[2025-11-22 13:37:08.176] [INFO] [InstallerEngine.swift:53 inspectSystem()] ğŸ” [InstallerEngine] Starting inspectSystem()
[2025-11-22 13:37:08.176] [INFO] [SystemValidator.swift:143 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Starting validation #1
[2025-11-22 13:37:08.176] [INFO] [SystemValidator.swift:174 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 START: 1763847428.176
/Users/malpern/local-code/KeyPath/Tests/KeyPathTests/FDADetectionTests.swift:154: Test Case '-[KeyPathTests.FDADetectionTests testFDACheckPerformance]' measured [Time, seconds] average: 0.001, relative standard deviation: 160.380%, values: [0.004243, 0.003218, 0.000185, 0.000184, 0.000200, 0.000181, 0.000260, 0.000170, 0.000161, 0.000154], performanceMetricID:com.apple.XCTPerformanceMetric_WallClockTime, baselineName: "", baselineAverage: , polarity: prefers smaller, maxPercentRegression: 10.000%, maxPercentRelativeStandardDeviation: 10.000%, maxRegression: 0.100, maxStandardDeviation: 0.100
Test Case '-[KeyPathTests.FDADetectionTests testFDACheckPerformance]' passed (2.099 seconds).
Test Case '-[KeyPathTests.FDADetectionTests testFDADetectionWithoutAccess]' started.
Test Case '-[KeyPathTests.FDADetectionTests testFDADetectionWithoutAccess]' passed (0.001 seconds).
Test Case '-[KeyPathTests.FDADetectionTests testProtectedPathDetection]' started.
No FDA access to: /Users/malpern/Library/Mail
No FDA access to: /Users/malpern/Library/Messages
Has FDA access to: /Users/malpern/Library/Safari/Bookmarks.plist
Test Case '-[KeyPathTests.FDADetectionTests testProtectedPathDetection]' passed (0.000 seconds).
Test Case '-[KeyPathTests.FDADetectionTests testRestartTimingWindow]' started.
Test Case '-[KeyPathTests.FDADetectionTests testRestartTimingWindow]' passed (0.001 seconds).
Test Case '-[KeyPathTests.FDADetectionTests testWizardStatePreservation]' started.
Test Case '-[KeyPathTests.FDADetectionTests testWizardStatePreservation]' passed (0.000 seconds).
Test Suite 'FDADetectionTests' passed at 2025-11-22 13:37:08.410.
	 Executed 7 tests, with 0 failures (0 unexpected) in 2.101 (2.102) seconds
Test Suite 'HealthCheckServiceTests' started at 2025-11-22 13:37:08.410.
Test Case '-[KeyPathTests.HealthCheckServiceTests testEvaluate_Healthy_NoRestart]' started.
[2025-11-22 13:37:08.410] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 28 mappings
[2025-11-22 13:37:08.410] [DEBUG] [KanataManager+Configuration.swift:53 triggerConfigReload()] ğŸ“¡ [Reload] Attempting TCP reload
[2025-11-22 13:37:08.410] [DEBUG] [KanataManager+Configuration.swift:84 triggerTCPReload()] ğŸ§ª [TCP Reload] Skipping TCP reload in test environment
[2025-11-22 13:37:08.410] [DEBUG] [KanataManager+Configuration.swift:65 triggerConfigReload()] ğŸ“¡ [Reload] TCP reload failed: Test environment - TCP disabled
[2025-11-22 13:37:08.410] [WARN] [KanataManager+Configuration.swift:68 triggerConfigReload()] âš ï¸ [Reload] Falling back to service restart
[2025-11-22 13:37:08.410] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:37:08.410] [INFO] [SystemValidator.swift:63 init(launchDaemonInstaller:vhidDeviceManager:processLifecycleManager:kanataManager:)] ğŸ” [SystemValidator] Initialized (stateless, no cache)
[2025-11-22 13:37:08.410] [INFO] [InstallerEngine.swift:35 init(processLifecycleManager:kanataManager:)] ğŸ”§ [InstallerEngine] Initialized
[2025-11-22 13:37:08.410] [INFO] [InstallerEngine.swift:419 run(intent:using:)] ğŸš€ [InstallerEngine] Starting run(intent: repair, using:)
[2025-11-22 13:37:08.410] [INFO] [InstallerEngine.swift:53 inspectSystem()] ğŸ” [InstallerEngine] Starting inspectSystem()
[2025-11-22 13:37:08.410] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 28 mappings
[2025-11-22 13:37:08.410] [DEBUG] [KanataManager+Configuration.swift:53 triggerConfigReload()] ğŸ“¡ [Reload] Attempting TCP reload
[2025-11-22 13:37:08.410] [DEBUG] [KanataManager+Configuration.swift:84 triggerTCPReload()] ğŸ§ª [TCP Reload] Skipping TCP reload in test environment
[2025-11-22 13:37:08.410] [DEBUG] [KanataManager+Configuration.swift:65 triggerConfigReload()] ğŸ“¡ [Reload] TCP reload failed: Test environment - TCP disabled
[2025-11-22 13:37:08.410] [WARN] [KanataManager+Configuration.swift:68 triggerConfigReload()] âš ï¸ [Reload] Falling back to service restart
[2025-11-22 13:37:08.410] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:37:08.410] [INFO] [SystemValidator.swift:63 init(launchDaemonInstaller:vhidDeviceManager:processLifecycleManager:kanataManager:)] ğŸ” [SystemValidator] Initialized (stateless, no cache)
[2025-11-22 13:37:08.410] [INFO] [InstallerEngine.swift:35 init(processLifecycleManager:kanataManager:)] ğŸ”§ [InstallerEngine] Initialized
[2025-11-22 13:37:08.410] [INFO] [InstallerEngine.swift:419 run(intent:using:)] ğŸš€ [InstallerEngine] Starting run(intent: repair, using:)
[2025-11-22 13:37:08.410] [INFO] [InstallerEngine.swift:53 inspectSystem()] ğŸ” [InstallerEngine] Starting inspectSystem()
[2025-11-22 13:37:08.410] [INFO] [SystemValidator.swift:362 checkPermissions()] ğŸ” [SystemValidator] Oracle snapshot: ready=false, age=0.235s
[2025-11-22 13:37:08.410] [INFO] [SystemValidator.swift:133 performValidationBody(progressCallback:)] âš ï¸ [SystemValidator] RAPID VALIDATION: 0.234s since last validation
This might indicate automatic triggers. Expected: manual user actions only.
[2025-11-22 13:37:08.410] [INFO] [SystemValidator.swift:143 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Starting validation #1
[2025-11-22 13:37:08.410] [INFO] [SystemValidator.swift:211 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 2 (Permissions) completed in 2.099s
[2025-11-22 13:37:08.410] [INFO] [SystemValidator.swift:174 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 START: 1763847428.410
[2025-11-22 13:37:08.410] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 80% (4/5 steps)
[2025-11-22 13:37:08.410] [INFO] [SystemValidator.swift:312 checkHelper()] ğŸ” [SystemValidator] Checking privileged helper
[2025-11-22 13:37:08.410] [INFO] [SystemValidator.swift:344 checkPermissions()] ğŸ” [SystemValidator] Checking permissions via Oracle
[2025-11-22 13:37:08.410] [INFO] [SystemValidator.swift:372 checkComponents()] ğŸ” [SystemValidator] Checking components
[2025-11-22 13:37:08.410] [INFO] [KanataBinaryDetector.swift:66 detectCurrentStatus()] ğŸ” [KanataBinaryDetector] Starting unified kanata binary detection
[2025-11-22 13:37:08.410] [INFO] [PermissionOracle.swift:158 currentSnapshot()] ğŸ”® [Oracle] (Test) Returning cached snapshot
[2025-11-22 13:37:08.410] [INFO] [KanataBinaryDetector.swift:81 detectCurrentStatus()] âŒ [KanataBinaryDetector] No kanata binary found
[2025-11-22 13:37:08.410] [INFO] [VHIDDeviceManager.swift:50 detectInstallation()] ğŸ” [VHIDManager] Manager app exists at /Applications/.Karabiner-VirtualHIDDevice-Manager.app/Contents/MacOS/Karabiner-VirtualHIDDevice-Manager: true
[2025-11-22 13:37:08.413] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:37:08.416] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:37:08.427] [INFO] [HelperManager.swift:830 verifyEmbeddedHelperSignature()] ğŸ”’ [HelperManager] Embedded helper signature looks valid
[2025-11-22 13:37:08.427] [INFO] [HelperManager.swift:105 getConnection()] ğŸ”— [HelperManager] Creating XPC connection to com.keypath.helper
[2025-11-22 13:37:08.427] [INFO] [HelperManager.swift:129 getConnection()] âœ… [HelperManager] XPC connection established (PID: 0)
[2025-11-22 13:37:08.427] [INFO] [HelperManager.swift:228 getHelperVersion()] ğŸ“¤ [HelperManager] Calling proxy.getVersion()
[2025-11-22 13:37:08.427] [INFO] [HelperManager.swift:243 getHelperVersion()] ğŸ“¤ [HelperManager] proxy.getVersion() call dispatched, waiting for callback
[2025-11-22 13:37:08.428] [INFO] [HelperManager.swift:121 getConnection()] âš ï¸ [HelperManager] XPC connection interrupted - will reconnect
[2025-11-22 13:37:08.428] [INFO] [HelperManager.swift:578 getRemoteProxy(errorHandler:)] âŒ [HelperManager] XPC proxy error: Couldnâ€™t communicate with a helper application.
[2025-11-22 13:37:08.428] [INFO] [HelperManager.swift:584 getRemoteProxy(errorHandler:)] âš ï¸ [HelperManager] XPC connection interrupted - this may indicate:
[2025-11-22 13:37:08.428] [INFO] [HelperManager.swift:585 getRemoteProxy(errorHandler:)]    1. Helper signature validation failed (app updated but not restarted)
[2025-11-22 13:37:08.428] [INFO] [HelperManager.swift:587 getRemoteProxy(errorHandler:)]    2. Helper process crashed
[2025-11-22 13:37:08.428] [INFO] [HelperManager.swift:588 getRemoteProxy(errorHandler:)]    3. Helper was killed by the system
[2025-11-22 13:37:08.428] [INFO] [HelperManager.swift:589 getRemoteProxy(errorHandler:)] ğŸ’¡ If you just updated KeyPath, try restarting the app
[2025-11-22 13:37:08.428] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:37:08.428] [INFO] [HelperManager.swift:116 getConnection()] âŒ [HelperManager] XPC connection invalidated
[2025-11-22 13:37:08.428] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:37:09.409] [INFO] [HelperManager.swift:248 getHelperVersion()] âš ï¸ [HelperManager] getVersion timed out - clearing connection cache
[2025-11-22 13:37:09.409] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:37:11.479] [INFO] [VHIDDeviceManager.swift:168 evaluateDaemonProcess()] âš ï¸ [VHIDManager] VHIDDevice process check timed out after 3s - fallback launchctl says running=false
[2025-11-22 13:37:11.502] [INFO] [HelperManager.swift:248 getHelperVersion()] âš ï¸ [HelperManager] getVersion timed out - clearing connection cache
[2025-11-22 13:37:11.502] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:37:11.548] [INFO] [VHIDDeviceManager.swift:88 detectRunning()] â³ [VHIDManager] Timeout while checking daemon; retrying to avoid false negatives
[2025-11-22 13:37:12.123] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.070s)
[2025-11-22 13:37:12.124] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:37:12.124] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:37:12.124] [INFO] [VHIDDeviceManager.swift:343 getInstalledVersion()] ğŸ” [VHIDManager] Installed daemon version: 5.0.0
[2025-11-22 13:37:12.124] [INFO] [VHIDDeviceManager.swift:374 hasVersionMismatch()] âœ… [VHIDManager] Version compatible: v5.0.0
[2025-11-22 13:37:12.124] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:37:12.191] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:37:12.192] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:37:12.192] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:37:12.192] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:37:12.192] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:37:12.193] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:37:12.193] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:37:12.193] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:37:12.193] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:37:12.193] [INFO] [LaunchDaemonInstaller.swift:669 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Kanata service state: Uninstalled
[2025-11-22 13:37:12.193] [INFO] [LaunchDaemonInstaller.swift:696 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Service not installed (state: Uninstalled)
[2025-11-22 13:37:12.193] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:37:12.260] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:37:12.327] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhiddaemon loaded: false
[2025-11-22 13:37:12.395] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhidmanager loaded: false
[2025-11-22 13:37:12.395] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:37:12.463] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:37:12.463] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhidmanager
[2025-11-22 13:37:12.530] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhidmanager not found in system domain
[2025-11-22 13:37:12.530] [INFO] [SystemValidator.swift:400 checkComponents()] ğŸ” [SystemValidator] Components: kanata=false, driver=true, daemon=false, vhid=false, vhidVersionMismatch=false
[2025-11-22 13:37:12.530] [INFO] [SystemValidator.swift:220 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 3 (Components) completed in 4.354s
[2025-11-22 13:37:12.530] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 20% (1/5 steps)
[2025-11-22 13:37:12.530] [INFO] [SystemValidator.swift:418 checkConflicts()] ğŸ” [SystemValidator] Checking for conflicts
[2025-11-22 13:37:12.530] [INFO] [ProcessLifecycleManager.swift:117 detectConflicts()] ğŸ” [ProcessLifecycleManager] Detecting conflicts...
[2025-11-22 13:37:12.530] [INFO] [ProcessLifecycleManager.swift:121 detectConflicts()] ğŸ§ª [TestEnvironment] Skipping process conflict detection - returning clean state
[2025-11-22 13:37:12.530] [INFO] [SystemValidator.swift:443 checkConflicts()] ğŸ” [SystemValidator] Total conflicts: 0 (0 kanata, 0 karabiner)
[2025-11-22 13:37:12.530] [INFO] [SystemValidator.swift:484 checkHealth()] ğŸ” [SystemValidator] Checking system health
[2025-11-22 13:37:12.530] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:37:12.530] [INFO] [SystemValidator.swift:229 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 4 (Conflicts) completed in 4.354s
[2025-11-22 13:37:12.530] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 40% (2/5 steps)
[2025-11-22 13:37:12.596] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:37:12.596] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:37:12.665] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:37:12.734] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.068s)
[2025-11-22 13:37:12.734] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:37:13.308] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.069s)
[2025-11-22 13:37:13.308] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:37:13.308] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:37:13.308] [INFO] [SystemValidator.swift:494 checkHealth()] ğŸ” [SystemValidator] Health: kanata=false, daemon=false (launchctl), vhid=false
[2025-11-22 13:37:13.308] [INFO] [SystemValidator.swift:238 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 5 (Health) completed in 5.132s
[2025-11-22 13:37:13.308] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 60% (3/5 steps)
[2025-11-22 13:37:13.308] [INFO] [SystemValidator.swift:143 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Starting validation #1
[2025-11-22 13:37:13.308] [INFO] [SystemValidator.swift:174 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 START: 1763847433.308
[2025-11-22 13:37:13.308] [INFO] [SystemValidator.swift:133 performValidationBody(progressCallback:)] âš ï¸ [SystemValidator] RAPID VALIDATION: 0.000s since last validation
This might indicate automatic triggers. Expected: manual user actions only.
[2025-11-22 13:37:13.308] [INFO] [SystemValidator.swift:143 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Starting validation #1
[2025-11-22 13:37:13.308] [INFO] [SystemValidator.swift:174 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 START: 1763847433.308
[2025-11-22 13:37:13.308] [INFO] [SystemValidator.swift:312 checkHelper()] ğŸ” [SystemValidator] Checking privileged helper
[2025-11-22 13:37:13.308] [INFO] [SystemValidator.swift:372 checkComponents()] ğŸ” [SystemValidator] Checking components
[2025-11-22 13:37:13.308] [INFO] [KanataBinaryDetector.swift:66 detectCurrentStatus()] ğŸ” [KanataBinaryDetector] Starting unified kanata binary detection
[2025-11-22 13:37:13.308] [INFO] [KanataBinaryDetector.swift:81 detectCurrentStatus()] âŒ [KanataBinaryDetector] No kanata binary found
[2025-11-22 13:37:13.308] [INFO] [VHIDDeviceManager.swift:50 detectInstallation()] ğŸ” [VHIDManager] Manager app exists at /Applications/.Karabiner-VirtualHIDDevice-Manager.app/Contents/MacOS/Karabiner-VirtualHIDDevice-Manager: true
[2025-11-22 13:37:13.316] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:37:13.322] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:37:13.340] [INFO] [HelperManager.swift:830 verifyEmbeddedHelperSignature()] ğŸ”’ [HelperManager] Embedded helper signature looks valid
[2025-11-22 13:37:13.340] [INFO] [HelperManager.swift:105 getConnection()] ğŸ”— [HelperManager] Creating XPC connection to com.keypath.helper
[2025-11-22 13:37:13.341] [INFO] [HelperManager.swift:129 getConnection()] âœ… [HelperManager] XPC connection established (PID: 0)
[2025-11-22 13:37:13.341] [INFO] [HelperManager.swift:228 getHelperVersion()] ğŸ“¤ [HelperManager] Calling proxy.getVersion()
[2025-11-22 13:37:13.341] [INFO] [HelperManager.swift:243 getHelperVersion()] ğŸ“¤ [HelperManager] proxy.getVersion() call dispatched, waiting for callback
[2025-11-22 13:37:13.343] [INFO] [HelperManager.swift:121 getConnection()] âš ï¸ [HelperManager] XPC connection interrupted - will reconnect
[2025-11-22 13:37:13.343] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:37:13.343] [INFO] [HelperManager.swift:578 getRemoteProxy(errorHandler:)] âŒ [HelperManager] XPC proxy error: Couldnâ€™t communicate with a helper application.
[2025-11-22 13:37:13.343] [INFO] [HelperManager.swift:584 getRemoteProxy(errorHandler:)] âš ï¸ [HelperManager] XPC connection interrupted - this may indicate:
[2025-11-22 13:37:13.343] [INFO] [HelperManager.swift:585 getRemoteProxy(errorHandler:)]    1. Helper signature validation failed (app updated but not restarted)
[2025-11-22 13:37:13.343] [INFO] [HelperManager.swift:587 getRemoteProxy(errorHandler:)]    2. Helper process crashed
[2025-11-22 13:37:13.343] [INFO] [HelperManager.swift:588 getRemoteProxy(errorHandler:)]    3. Helper was killed by the system
[2025-11-22 13:37:13.343] [INFO] [HelperManager.swift:589 getRemoteProxy(errorHandler:)] ğŸ’¡ If you just updated KeyPath, try restarting the app
[2025-11-22 13:37:13.343] [INFO] [HelperManager.swift:116 getConnection()] âŒ [HelperManager] XPC connection invalidated
[2025-11-22 13:37:13.343] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:37:13.377] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.068s)
[2025-11-22 13:37:13.377] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:37:13.950] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.068s)
[2025-11-22 13:37:13.950] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:37:13.950] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:37:13.951] [INFO] [VHIDDeviceManager.swift:343 getInstalledVersion()] ğŸ” [VHIDManager] Installed daemon version: 5.0.0
[2025-11-22 13:37:13.951] [INFO] [VHIDDeviceManager.swift:374 hasVersionMismatch()] âœ… [VHIDManager] Version compatible: v5.0.0
[2025-11-22 13:37:13.951] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:37:14.018] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:37:14.021] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:37:14.021] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:37:14.021] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:37:14.021] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:37:14.021] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:37:14.021] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:37:14.021] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:37:14.021] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:37:14.021] [INFO] [LaunchDaemonInstaller.swift:669 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Kanata service state: Uninstalled
[2025-11-22 13:37:14.021] [INFO] [LaunchDaemonInstaller.swift:696 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Service not installed (state: Uninstalled)
[2025-11-22 13:37:14.021] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:37:14.090] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:37:14.158] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhiddaemon loaded: false
[2025-11-22 13:37:14.226] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhidmanager loaded: false
[2025-11-22 13:37:14.226] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:37:14.295] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:37:14.295] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhidmanager
[2025-11-22 13:37:14.371] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhidmanager not found in system domain
[2025-11-22 13:37:14.371] [INFO] [SystemValidator.swift:400 checkComponents()] ğŸ” [SystemValidator] Components: kanata=false, driver=true, daemon=false, vhid=false, vhidVersionMismatch=false
[2025-11-22 13:37:14.371] [INFO] [SystemValidator.swift:418 checkConflicts()] ğŸ” [SystemValidator] Checking for conflicts
[2025-11-22 13:37:14.371] [INFO] [ProcessLifecycleManager.swift:117 detectConflicts()] ğŸ” [ProcessLifecycleManager] Detecting conflicts...
[2025-11-22 13:37:14.371] [INFO] [ProcessLifecycleManager.swift:121 detectConflicts()] ğŸ§ª [TestEnvironment] Skipping process conflict detection - returning clean state
[2025-11-22 13:37:14.371] [INFO] [SystemValidator.swift:443 checkConflicts()] ğŸ” [SystemValidator] Total conflicts: 0 (0 kanata, 0 karabiner)
[2025-11-22 13:37:14.371] [INFO] [SystemValidator.swift:220 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 3 (Components) completed in 5.961s
[2025-11-22 13:37:14.371] [INFO] [SystemValidator.swift:344 checkPermissions()] ğŸ” [SystemValidator] Checking permissions via Oracle
[2025-11-22 13:37:14.371] [INFO] [SystemValidator.swift:484 checkHealth()] ğŸ” [SystemValidator] Checking system health
[2025-11-22 13:37:14.371] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 20% (1/5 steps)
[2025-11-22 13:37:14.371] [INFO] [SystemValidator.swift:229 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 4 (Conflicts) completed in 5.961s
[2025-11-22 13:37:14.371] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 40% (2/5 steps)
[2025-11-22 13:37:14.371] [INFO] [PermissionOracle.swift:173 currentSnapshot()] ğŸ”® [Oracle] Test mode snapshot generated (non-blocking)
[2025-11-22 13:37:14.371] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:37:14.437] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:37:14.437] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:37:14.503] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:37:14.571] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.068s)
[2025-11-22 13:37:14.571] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:37:15.213] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.136s)
[2025-11-22 13:37:15.213] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:37:15.213] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:37:15.213] [INFO] [SystemValidator.swift:494 checkHealth()] ğŸ” [SystemValidator] Health: kanata=false, daemon=false (launchctl), vhid=false
[2025-11-22 13:37:15.213] [INFO] [SystemValidator.swift:238 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 5 (Health) completed in 6.803s
[2025-11-22 13:37:15.213] [INFO] [SystemValidator.swift:359 checkPermissions()] âš ï¸ [SystemValidator] Oracle snapshot is 7.0s old (ignored in tests)
[2025-11-22 13:37:15.213] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 60% (3/5 steps)
[2025-11-22 13:37:15.213] [INFO] [SystemValidator.swift:362 checkPermissions()] ğŸ” [SystemValidator] Oracle snapshot: ready=false, age=7.038s
[2025-11-22 13:37:15.213] [INFO] [SystemValidator.swift:328 checkHelper()] ğŸ” [SystemValidator] Helper state: registeredButUnresponsive Helper registered but XPC communication failed
[2025-11-22 13:37:15.213] [INFO] [SystemValidator.swift:211 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 2 (Permissions) completed in 7.037s
[2025-11-22 13:37:15.213] [INFO] [SystemValidator.swift:328 checkHelper()] ğŸ” [SystemValidator] Helper state: registeredButUnresponsive Helper registered but XPC communication failed
[2025-11-22 13:37:15.213] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 80% (4/5 steps)
[2025-11-22 13:37:15.213] [INFO] [SystemValidator.swift:202 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 1 (Helper) completed in 8.902s
[2025-11-22 13:37:15.213] [INFO] [SystemValidator.swift:202 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 1 (Helper) completed in 7.037s
[2025-11-22 13:37:15.213] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 100% (5/5 steps)
[2025-11-22 13:37:15.213] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 100% (5/5 steps)
Test Case '-[KeyPathTests.HealthCheckServiceTests testEvaluate_Healthy_NoRestart]' passed (6.804 seconds).
Test Case '-[KeyPathTests.HealthCheckServiceTests testEvaluate_Unhealthy_ShouldRestart]' started.
[2025-11-22 13:37:15.214] [INFO] [SystemValidator.swift:312 checkHelper()] ğŸ” [SystemValidator] Checking privileged helper
[2025-11-22 13:37:15.214] [INFO] [SystemValidator.swift:344 checkPermissions()] ğŸ” [SystemValidator] Checking permissions via Oracle
[2025-11-22 13:37:15.214] [INFO] [SystemValidator.swift:418 checkConflicts()] ğŸ” [SystemValidator] Checking for conflicts
[2025-11-22 13:37:15.214] [INFO] [ProcessLifecycleManager.swift:117 detectConflicts()] ğŸ” [ProcessLifecycleManager] Detecting conflicts...
[2025-11-22 13:37:15.214] [INFO] [ProcessLifecycleManager.swift:121 detectConflicts()] ğŸ§ª [TestEnvironment] Skipping process conflict detection - returning clean state
[2025-11-22 13:37:15.214] [INFO] [PermissionOracle.swift:158 currentSnapshot()] ğŸ”® [Oracle] (Test) Returning cached snapshot
[2025-11-22 13:37:15.214] [INFO] [SystemValidator.swift:443 checkConflicts()] ğŸ” [SystemValidator] Total conflicts: 0 (0 kanata, 0 karabiner)
[2025-11-22 13:37:15.214] [INFO] [SystemValidator.swift:484 checkHealth()] ğŸ” [SystemValidator] Checking system health
[2025-11-22 13:37:15.214] [INFO] [SystemValidator.swift:229 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 4 (Conflicts) completed in 1.906s
[2025-11-22 13:37:15.214] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:37:15.214] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 20% (1/5 steps)
[2025-11-22 13:37:15.220] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:37:15.225] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:37:15.241] [INFO] [HelperManager.swift:830 verifyEmbeddedHelperSignature()] ğŸ”’ [HelperManager] Embedded helper signature looks valid
[2025-11-22 13:37:15.241] [INFO] [HelperManager.swift:105 getConnection()] ğŸ”— [HelperManager] Creating XPC connection to com.keypath.helper
[2025-11-22 13:37:15.241] [INFO] [HelperManager.swift:129 getConnection()] âœ… [HelperManager] XPC connection established (PID: 0)
[2025-11-22 13:37:15.241] [INFO] [HelperManager.swift:228 getHelperVersion()] ğŸ“¤ [HelperManager] Calling proxy.getVersion()
[2025-11-22 13:37:15.241] [INFO] [HelperManager.swift:243 getHelperVersion()] ğŸ“¤ [HelperManager] proxy.getVersion() call dispatched, waiting for callback
[2025-11-22 13:37:15.241] [INFO] [HelperManager.swift:121 getConnection()] âš ï¸ [HelperManager] XPC connection interrupted - will reconnect
[2025-11-22 13:37:15.241] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:37:15.241] [INFO] [HelperManager.swift:578 getRemoteProxy(errorHandler:)] âŒ [HelperManager] XPC proxy error: Couldnâ€™t communicate with a helper application.
[2025-11-22 13:37:15.241] [INFO] [HelperManager.swift:584 getRemoteProxy(errorHandler:)] âš ï¸ [HelperManager] XPC connection interrupted - this may indicate:
[2025-11-22 13:37:15.241] [INFO] [HelperManager.swift:585 getRemoteProxy(errorHandler:)]    1. Helper signature validation failed (app updated but not restarted)
[2025-11-22 13:37:15.241] [INFO] [HelperManager.swift:587 getRemoteProxy(errorHandler:)]    2. Helper process crashed
[2025-11-22 13:37:15.241] [INFO] [HelperManager.swift:588 getRemoteProxy(errorHandler:)]    3. Helper was killed by the system
[2025-11-22 13:37:15.241] [INFO] [HelperManager.swift:589 getRemoteProxy(errorHandler:)] ğŸ’¡ If you just updated KeyPath, try restarting the app
[2025-11-22 13:37:15.241] [INFO] [HelperManager.swift:116 getConnection()] âŒ [HelperManager] XPC connection invalidated
[2025-11-22 13:37:15.242] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:37:15.282] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:37:15.282] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:37:15.350] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:37:15.418] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.067s)
[2025-11-22 13:37:15.418] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:37:15.991] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.068s)
[2025-11-22 13:37:15.991] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:37:15.991] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:37:15.991] [INFO] [SystemValidator.swift:494 checkHealth()] ğŸ” [SystemValidator] Health: kanata=false, daemon=false (launchctl), vhid=false
[2025-11-22 13:37:15.991] [INFO] [SystemValidator.swift:238 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 5 (Health) completed in 2.683s
[2025-11-22 13:37:15.991] [INFO] [SystemValidator.swift:372 checkComponents()] ğŸ” [SystemValidator] Checking components
[2025-11-22 13:37:15.991] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 40% (2/5 steps)
[2025-11-22 13:37:15.991] [INFO] [KanataBinaryDetector.swift:66 detectCurrentStatus()] ğŸ” [KanataBinaryDetector] Starting unified kanata binary detection
[2025-11-22 13:37:15.991] [INFO] [KanataBinaryDetector.swift:81 detectCurrentStatus()] âŒ [KanataBinaryDetector] No kanata binary found
[2025-11-22 13:37:15.992] [INFO] [VHIDDeviceManager.swift:50 detectInstallation()] ğŸ” [VHIDManager] Manager app exists at /Applications/.Karabiner-VirtualHIDDevice-Manager.app/Contents/MacOS/Karabiner-VirtualHIDDevice-Manager: true
[2025-11-22 13:37:16.059] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.068s)
[2025-11-22 13:37:16.060] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:37:16.416] [INFO] [HelperManager.swift:248 getHelperVersion()] âš ï¸ [HelperManager] getVersion timed out - clearing connection cache
[2025-11-22 13:37:16.416] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:37:16.633] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.068s)
[2025-11-22 13:37:16.633] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:37:16.633] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:37:16.633] [INFO] [VHIDDeviceManager.swift:343 getInstalledVersion()] ğŸ” [VHIDManager] Installed daemon version: 5.0.0
[2025-11-22 13:37:16.633] [INFO] [VHIDDeviceManager.swift:374 hasVersionMismatch()] âœ… [VHIDManager] Version compatible: v5.0.0
[2025-11-22 13:37:16.633] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:37:16.701] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:37:16.702] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:37:16.702] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:37:16.702] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:37:16.702] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:37:16.703] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:37:16.703] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:37:16.703] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:37:16.703] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:37:16.703] [INFO] [LaunchDaemonInstaller.swift:669 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Kanata service state: Uninstalled
[2025-11-22 13:37:16.703] [INFO] [LaunchDaemonInstaller.swift:696 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Service not installed (state: Uninstalled)
[2025-11-22 13:37:16.703] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:37:16.769] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:37:16.838] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhiddaemon loaded: false
[2025-11-22 13:37:16.906] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhidmanager loaded: false
[2025-11-22 13:37:16.906] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:37:16.973] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:37:16.973] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhidmanager
[2025-11-22 13:37:17.041] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhidmanager not found in system domain
[2025-11-22 13:37:17.041] [INFO] [SystemValidator.swift:400 checkComponents()] ğŸ” [SystemValidator] Components: kanata=false, driver=true, daemon=false, vhid=false, vhidVersionMismatch=false
[2025-11-22 13:37:17.041] [INFO] [SystemValidator.swift:220 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 3 (Components) completed in 3.733s
[2025-11-22 13:37:17.041] [INFO] [SystemValidator.swift:312 checkHelper()] ğŸ” [SystemValidator] Checking privileged helper
[2025-11-22 13:37:17.041] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 60% (3/5 steps)
[2025-11-22 13:37:17.041] [INFO] [SystemValidator.swift:344 checkPermissions()] ğŸ” [SystemValidator] Checking permissions via Oracle
[2025-11-22 13:37:17.041] [INFO] [SystemValidator.swift:372 checkComponents()] ğŸ” [SystemValidator] Checking components
[2025-11-22 13:37:17.041] [INFO] [KanataBinaryDetector.swift:66 detectCurrentStatus()] ğŸ” [KanataBinaryDetector] Starting unified kanata binary detection
[2025-11-22 13:37:17.041] [INFO] [PermissionOracle.swift:173 currentSnapshot()] ğŸ”® [Oracle] Test mode snapshot generated (non-blocking)
[2025-11-22 13:37:17.041] [INFO] [KanataBinaryDetector.swift:81 detectCurrentStatus()] âŒ [KanataBinaryDetector] No kanata binary found
[2025-11-22 13:37:17.041] [INFO] [VHIDDeviceManager.swift:50 detectInstallation()] ğŸ” [VHIDManager] Manager app exists at /Applications/.Karabiner-VirtualHIDDevice-Manager.app/Contents/MacOS/Karabiner-VirtualHIDDevice-Manager: true
[2025-11-22 13:37:17.048] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:37:17.052] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:37:17.069] [INFO] [HelperManager.swift:830 verifyEmbeddedHelperSignature()] ğŸ”’ [HelperManager] Embedded helper signature looks valid
[2025-11-22 13:37:17.069] [INFO] [HelperManager.swift:105 getConnection()] ğŸ”— [HelperManager] Creating XPC connection to com.keypath.helper
[2025-11-22 13:37:17.070] [INFO] [HelperManager.swift:129 getConnection()] âœ… [HelperManager] XPC connection established (PID: 0)
[2025-11-22 13:37:17.070] [INFO] [HelperManager.swift:228 getHelperVersion()] ğŸ“¤ [HelperManager] Calling proxy.getVersion()
[2025-11-22 13:37:17.070] [INFO] [HelperManager.swift:243 getHelperVersion()] ğŸ“¤ [HelperManager] proxy.getVersion() call dispatched, waiting for callback
[2025-11-22 13:37:17.071] [INFO] [HelperManager.swift:121 getConnection()] âš ï¸ [HelperManager] XPC connection interrupted - will reconnect
[2025-11-22 13:37:17.071] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:37:17.071] [INFO] [HelperManager.swift:578 getRemoteProxy(errorHandler:)] âŒ [HelperManager] XPC proxy error: Couldnâ€™t communicate with a helper application.
[2025-11-22 13:37:17.071] [INFO] [HelperManager.swift:584 getRemoteProxy(errorHandler:)] âš ï¸ [HelperManager] XPC connection interrupted - this may indicate:
[2025-11-22 13:37:17.071] [INFO] [HelperManager.swift:585 getRemoteProxy(errorHandler:)]    1. Helper signature validation failed (app updated but not restarted)
[2025-11-22 13:37:17.071] [INFO] [HelperManager.swift:587 getRemoteProxy(errorHandler:)]    2. Helper process crashed
[2025-11-22 13:37:17.071] [INFO] [HelperManager.swift:588 getRemoteProxy(errorHandler:)]    3. Helper was killed by the system
[2025-11-22 13:37:17.071] [INFO] [HelperManager.swift:589 getRemoteProxy(errorHandler:)] ğŸ’¡ If you just updated KeyPath, try restarting the app
[2025-11-22 13:37:17.071] [INFO] [HelperManager.swift:116 getConnection()] âŒ [HelperManager] XPC connection invalidated
[2025-11-22 13:37:17.071] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:37:17.110] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.068s)
[2025-11-22 13:37:17.110] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:37:17.684] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.069s)
[2025-11-22 13:37:17.685] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:37:17.685] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:37:17.685] [INFO] [VHIDDeviceManager.swift:343 getInstalledVersion()] ğŸ” [VHIDManager] Installed daemon version: 5.0.0
[2025-11-22 13:37:17.685] [INFO] [VHIDDeviceManager.swift:374 hasVersionMismatch()] âœ… [VHIDManager] Version compatible: v5.0.0
[2025-11-22 13:37:17.685] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:37:17.751] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:37:17.753] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:37:17.753] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:37:17.753] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:37:17.753] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:37:17.754] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:37:17.754] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:37:17.754] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:37:17.754] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:37:17.754] [INFO] [LaunchDaemonInstaller.swift:669 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Kanata service state: Uninstalled
[2025-11-22 13:37:17.754] [INFO] [LaunchDaemonInstaller.swift:696 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Service not installed (state: Uninstalled)
[2025-11-22 13:37:17.754] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:37:17.821] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:37:17.889] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhiddaemon loaded: false
[2025-11-22 13:37:17.956] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhidmanager loaded: false
[2025-11-22 13:37:17.956] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:37:18.024] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:37:18.024] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhidmanager
[2025-11-22 13:37:18.093] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhidmanager not found in system domain
[2025-11-22 13:37:18.093] [INFO] [SystemValidator.swift:400 checkComponents()] ğŸ” [SystemValidator] Components: kanata=false, driver=true, daemon=false, vhid=false, vhidVersionMismatch=false
[2025-11-22 13:37:18.093] [INFO] [SystemValidator.swift:220 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 3 (Components) completed in 4.785s
[2025-11-22 13:37:18.093] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 20% (1/5 steps)
[2025-11-22 13:37:18.093] [INFO] [SystemValidator.swift:418 checkConflicts()] ğŸ” [SystemValidator] Checking for conflicts
[2025-11-22 13:37:18.093] [INFO] [ProcessLifecycleManager.swift:117 detectConflicts()] ğŸ” [ProcessLifecycleManager] Detecting conflicts...
[2025-11-22 13:37:18.093] [INFO] [ProcessLifecycleManager.swift:121 detectConflicts()] ğŸ§ª [TestEnvironment] Skipping process conflict detection - returning clean state
[2025-11-22 13:37:18.093] [INFO] [SystemValidator.swift:443 checkConflicts()] ğŸ” [SystemValidator] Total conflicts: 0 (0 kanata, 0 karabiner)
[2025-11-22 13:37:18.093] [INFO] [SystemValidator.swift:484 checkHealth()] ğŸ” [SystemValidator] Checking system health
[2025-11-22 13:37:18.093] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:37:18.093] [INFO] [SystemValidator.swift:229 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 4 (Conflicts) completed in 4.785s
[2025-11-22 13:37:18.093] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 40% (2/5 steps)
[2025-11-22 13:37:18.161] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:37:18.161] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:37:18.228] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:37:18.258] [INFO] [HelperManager.swift:248 getHelperVersion()] âš ï¸ [HelperManager] getVersion timed out - clearing connection cache
[2025-11-22 13:37:18.258] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:37:18.295] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.067s)
[2025-11-22 13:37:18.295] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:37:18.870] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.069s)
[2025-11-22 13:37:18.870] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:37:18.870] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:37:18.870] [INFO] [SystemValidator.swift:494 checkHealth()] ğŸ” [SystemValidator] Health: kanata=false, daemon=false (launchctl), vhid=false
[2025-11-22 13:37:18.870] [INFO] [SystemValidator.swift:238 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 5 (Health) completed in 5.562s
[2025-11-22 13:37:18.870] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 60% (3/5 steps)
[2025-11-22 13:37:18.870] [INFO] [SystemValidator.swift:362 checkPermissions()] ğŸ” [SystemValidator] Oracle snapshot: ready=false, age=4.499s
[2025-11-22 13:37:18.870] [INFO] [SystemValidator.swift:211 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 2 (Permissions) completed in 10.460s
[2025-11-22 13:37:18.870] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 80% (4/5 steps)
[2025-11-22 13:37:18.870] [INFO] [SystemValidator.swift:362 checkPermissions()] ğŸ” [SystemValidator] Oracle snapshot: ready=false, age=4.499s
[2025-11-22 13:37:18.870] [INFO] [SystemValidator.swift:328 checkHelper()] ğŸ” [SystemValidator] Helper state: registeredButUnresponsive Helper registered but XPC communication failed
[2025-11-22 13:37:18.870] [INFO] [SystemValidator.swift:362 checkPermissions()] ğŸ” [SystemValidator] Oracle snapshot: ready=false, age=1.829s
[2025-11-22 13:37:18.870] [INFO] [SystemValidator.swift:328 checkHelper()] ğŸ” [SystemValidator] Helper state: registeredButUnresponsive Helper registered but XPC communication failed
[2025-11-22 13:37:18.870] [INFO] [SystemValidator.swift:211 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 2 (Permissions) completed in 5.562s
[2025-11-22 13:37:18.870] [INFO] [SystemValidator.swift:283 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 COMPLETE: Total duration 10.695s
[2025-11-22 13:37:18.870] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 80% (4/5 steps)
[2025-11-22 13:37:18.870] [INFO] [SystemValidator.swift:297 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Validation #1 complete in 10.695s
[2025-11-22 13:37:18.870] [INFO] [SystemValidator.swift:202 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 1 (Helper) completed in 5.562s
[2025-11-22 13:37:18.870] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 100% (5/5 steps)
[2025-11-22 13:37:18.870] [INFO] [SystemValidator.swift:299 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Result: ready=false, blocking=9, total=9
[2025-11-22 13:37:18.870] [INFO] [SystemValidator.swift:202 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 1 (Helper) completed in 10.460s
[2025-11-22 13:37:18.870] [INFO] [SystemValidator.swift:211 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 2 (Permissions) completed in 5.562s
[2025-11-22 13:37:18.870] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 100% (5/5 steps)
[2025-11-22 13:37:18.870] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 80% (4/5 steps)
[2025-11-22 13:37:18.870] [INFO] [SystemValidator.swift:283 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 COMPLETE: Total duration 12.559s
[2025-11-22 13:37:18.870] [INFO] [SystemValidator.swift:297 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Validation #1 complete in 12.559s
[2025-11-22 13:37:18.870] [INFO] [SystemValidator.swift:299 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Result: ready=false, blocking=9, total=9
Test Case '-[KeyPathTests.HealthCheckServiceTests testEvaluate_Unhealthy_ShouldRestart]' passed (3.657 seconds).
Test Suite 'HealthCheckServiceTests' passed at 2025-11-22 13:37:18.871.
	 Executed 2 tests, with 0 failures (0 unexpected) in 10.461 (10.461) seconds
Test Suite 'HelperMaintenanceTests' started at 2025-11-22 13:37:18.871.
Test Case '-[KeyPathTests.HelperMaintenanceTests testAdminCleanupFallbackFailureAbortsRun]' started.
[2025-11-22 13:37:18.871] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:37:18.871] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:37:18.871] [INFO] [SystemRequirements.swift:135 validateSystemCompatibility()] ğŸ” [SystemRequirements] Validating system compatibility
[2025-11-22 13:37:18.871] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:37:18.871] [INFO] [SystemRequirements.swift:147 validateSystemCompatibility()] âœ… [SystemRequirements] Modern macOS detected: 26.0.1
[2025-11-22 13:37:18.871] [INFO] [SystemRequirements.swift:190 validateSystemCompatibility()] ğŸ” [SystemRequirements] Compatibility check complete: âœ… Compatible
[2025-11-22 13:37:18.871] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:37:18.871] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:37:18.871] [INFO] [InstallerEngine.swift:78 inspectSystem()] âœ… [InstallerEngine] inspectSystem() complete - ready=false, blocking=9
[2025-11-22 13:37:18.871] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: repair, context:)
[2025-11-22 13:37:18.871] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: repair
[2025-11-22 13:37:18.871] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:37:18.871] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:37:18.871] [INFO] [InstallerEngine.swift:194 execute(plan:using:)] âš™ï¸ [InstallerEngine] Starting execute(plan:, using:)
[2025-11-22 13:37:18.871] [INFO] [InstallerEngine.swift:213 execute(plan:using:)] âš™ï¸ [InstallerEngine] Executing recipe: install-bundled-kanata (type: installComponent)
[2025-11-22 13:37:18.871] [INFO] [PrivilegedOperationsCoordinator.swift:359 installBundledKanata()] ğŸ” [PrivCoordinator] Installing bundled Kanata binary
[2025-11-22 13:37:18.871] [INFO] [LaunchDaemonInstaller.swift:2898 installBundledKanataBinaryOnly()] ğŸ”§ [LaunchDaemon] Installing bundled kanata binary to system location
[2025-11-22 13:37:18.872] [INFO] [LaunchDaemonInstaller.swift:2906 installBundledKanataBinaryOnly()] âŒ [LaunchDaemon] CRITICAL: Bundled kanata binary not found at: /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata
[2025-11-22 13:37:18.872] [INFO] [LaunchDaemonInstaller.swift:2908 installBundledKanataBinaryOnly()] âŒ [LaunchDaemon] This indicates a packaging issue - the app bundle is missing the kanata binary
[2025-11-22 13:37:18.872] [INFO] [InstallerEngine.swift:255 execute(plan:using:)] âŒ [InstallerEngine] Recipe install-bundled-kanata failed: Operation failed: Bundled Kanata installation failed
[2025-11-22 13:37:18.872] [INFO] [InstallerEngine.swift:274 execute(plan:using:)] âœ… [InstallerEngine] execute() complete - success: false, recipes executed: 1
[2025-11-22 13:37:18.872] [INFO] [InstallerEngine.swift:432 run(intent:using:)] âœ… [InstallerEngine] run() complete - success: false
[2025-11-22 13:37:18.872] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:37:18.872] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:37:18.872] [INFO] [SystemRequirements.swift:135 validateSystemCompatibility()] ğŸ” [SystemRequirements] Validating system compatibility
[2025-11-22 13:37:18.872] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:37:18.872] [INFO] [SystemRequirements.swift:147 validateSystemCompatibility()] âœ… [SystemRequirements] Modern macOS detected: 26.0.1
[2025-11-22 13:37:18.872] [INFO] [SystemRequirements.swift:190 validateSystemCompatibility()] ğŸ” [SystemRequirements] Compatibility check complete: âœ… Compatible
[2025-11-22 13:37:18.872] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:37:18.872] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:37:18.872] [INFO] [InstallerEngine.swift:78 inspectSystem()] âœ… [InstallerEngine] inspectSystem() complete - ready=false, blocking=9
[2025-11-22 13:37:18.872] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: repair, context:)
[2025-11-22 13:37:18.872] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: repair
[2025-11-22 13:37:18.872] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:37:18.872] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:37:18.872] [INFO] [InstallerEngine.swift:194 execute(plan:using:)] âš™ï¸ [InstallerEngine] Starting execute(plan:, using:)
[2025-11-22 13:37:18.872] [INFO] [InstallerEngine.swift:213 execute(plan:using:)] âš™ï¸ [InstallerEngine] Executing recipe: install-bundled-kanata (type: installComponent)
[2025-11-22 13:37:18.872] [INFO] [PrivilegedOperationsCoordinator.swift:359 installBundledKanata()] ğŸ” [PrivCoordinator] Installing bundled Kanata binary
[2025-11-22 13:37:18.872] [INFO] [LaunchDaemonInstaller.swift:2898 installBundledKanataBinaryOnly()] ğŸ”§ [LaunchDaemon] Installing bundled kanata binary to system location
[2025-11-22 13:37:18.872] [INFO] [LaunchDaemonInstaller.swift:2906 installBundledKanataBinaryOnly()] âŒ [LaunchDaemon] CRITICAL: Bundled kanata binary not found at: /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata
[2025-11-22 13:37:18.872] [INFO] [LaunchDaemonInstaller.swift:2908 installBundledKanataBinaryOnly()] âŒ [LaunchDaemon] This indicates a packaging issue - the app bundle is missing the kanata binary
[2025-11-22 13:37:18.872] [INFO] [InstallerEngine.swift:255 execute(plan:using:)] âŒ [InstallerEngine] Recipe install-bundled-kanata failed: Operation failed: Bundled Kanata installation failed
[2025-11-22 13:37:18.872] [INFO] [InstallerEngine.swift:274 execute(plan:using:)] âœ… [InstallerEngine] execute() complete - success: false, recipes executed: 1
[2025-11-22 13:37:18.872] [INFO] [InstallerEngine.swift:432 run(intent:using:)] âœ… [InstallerEngine] run() complete - success: false
[2025-11-22 13:37:18.872] [INFO] [SystemValidator.swift:283 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 COMPLETE: Total duration 10.462s
[2025-11-22 13:37:18.872] [INFO] [SystemValidator.swift:297 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Validation #1 complete in 10.462s
[2025-11-22 13:37:18.872] [INFO] [SystemValidator.swift:299 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Result: ready=false, blocking=9, total=9
[2025-11-22 13:37:18.872] [INFO] [SystemValidator.swift:283 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 COMPLETE: Total duration 5.564s
[2025-11-22 13:37:18.872] [INFO] [SystemValidator.swift:297 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Validation #1 complete in 5.564s
[2025-11-22 13:37:18.872] [INFO] [SystemValidator.swift:299 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Result: ready=false, blocking=9, total=9
[2025-11-22 13:37:18.872] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:37:18.872] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:37:18.872] [INFO] [SystemRequirements.swift:135 validateSystemCompatibility()] ğŸ” [SystemRequirements] Validating system compatibility
[2025-11-22 13:37:18.872] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:37:18.872] [INFO] [SystemRequirements.swift:147 validateSystemCompatibility()] âœ… [SystemRequirements] Modern macOS detected: 26.0.1
[2025-11-22 13:37:18.872] [INFO] [SystemRequirements.swift:190 validateSystemCompatibility()] ğŸ” [SystemRequirements] Compatibility check complete: âœ… Compatible
[2025-11-22 13:37:18.872] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:37:18.872] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:37:18.872] [INFO] [InstallerEngine.swift:78 inspectSystem()] âœ… [InstallerEngine] inspectSystem() complete - ready=false, blocking=9
[2025-11-22 13:37:18.872] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: repair, context:)
[2025-11-22 13:37:18.873] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: repair
[2025-11-22 13:37:18.873] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:37:18.873] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:37:18.873] [INFO] [InstallerEngine.swift:194 execute(plan:using:)] âš™ï¸ [InstallerEngine] Starting execute(plan:, using:)
[2025-11-22 13:37:18.873] [INFO] [InstallerEngine.swift:213 execute(plan:using:)] âš™ï¸ [InstallerEngine] Executing recipe: install-bundled-kanata (type: installComponent)
[2025-11-22 13:37:18.873] [INFO] [PrivilegedOperationsCoordinator.swift:359 installBundledKanata()] ğŸ” [PrivCoordinator] Installing bundled Kanata binary
[2025-11-22 13:37:18.873] [INFO] [LaunchDaemonInstaller.swift:2898 installBundledKanataBinaryOnly()] ğŸ”§ [LaunchDaemon] Installing bundled kanata binary to system location
[2025-11-22 13:37:18.873] [INFO] [LaunchDaemonInstaller.swift:2906 installBundledKanataBinaryOnly()] âŒ [LaunchDaemon] CRITICAL: Bundled kanata binary not found at: /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata
[2025-11-22 13:37:18.873] [INFO] [LaunchDaemonInstaller.swift:2908 installBundledKanataBinaryOnly()] âŒ [LaunchDaemon] This indicates a packaging issue - the app bundle is missing the kanata binary
[2025-11-22 13:37:18.873] [INFO] [InstallerEngine.swift:255 execute(plan:using:)] âŒ [InstallerEngine] Recipe install-bundled-kanata failed: Operation failed: Bundled Kanata installation failed
[2025-11-22 13:37:18.873] [INFO] [InstallerEngine.swift:274 execute(plan:using:)] âœ… [InstallerEngine] execute() complete - success: false, recipes executed: 1
[2025-11-22 13:37:18.873] [INFO] [InstallerEngine.swift:432 run(intent:using:)] âœ… [InstallerEngine] run() complete - success: false
[2025-11-22 13:37:18.874] [INFO] [HelperMaintenance.swift:298 log(_:)] ğŸ§¹ Cleanup & Repair started
[2025-11-22 13:37:18.876] [INFO] [HelperMaintenance.swift:298 log(_:)] âœ… App copy check: OK (/Applications/KeyPath.app)
[2025-11-22 13:37:18.876] [INFO] [HelperMaintenance.swift:298 log(_:)] âš ï¸ Primary registration failed; attempting cleanup then retry
[2025-11-22 13:37:18.876] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:37:18.876] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:37:18.876] [INFO] [SystemRequirements.swift:135 validateSystemCompatibility()] ğŸ” [SystemRequirements] Validating system compatibility
[2025-11-22 13:37:18.876] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:37:18.876] [INFO] [SystemRequirements.swift:147 validateSystemCompatibility()] âœ… [SystemRequirements] Modern macOS detected: 26.0.1
[2025-11-22 13:37:18.876] [INFO] [SystemRequirements.swift:190 validateSystemCompatibility()] ğŸ” [SystemRequirements] Compatibility check complete: âœ… Compatible
[2025-11-22 13:37:18.876] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:37:18.876] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:37:18.876] [INFO] [InstallerEngine.swift:78 inspectSystem()] âœ… [InstallerEngine] inspectSystem() complete - ready=false, blocking=9
[2025-11-22 13:37:18.876] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: repair, context:)
[2025-11-22 13:37:18.876] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: repair
[2025-11-22 13:37:18.876] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:37:18.876] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:37:18.876] [INFO] [InstallerEngine.swift:194 execute(plan:using:)] âš™ï¸ [InstallerEngine] Starting execute(plan:, using:)
[2025-11-22 13:37:18.876] [INFO] [InstallerEngine.swift:213 execute(plan:using:)] âš™ï¸ [InstallerEngine] Executing recipe: install-bundled-kanata (type: installComponent)
[2025-11-22 13:37:18.876] [INFO] [PrivilegedOperationsCoordinator.swift:359 installBundledKanata()] ğŸ” [PrivCoordinator] Installing bundled Kanata binary
[2025-11-22 13:37:18.876] [INFO] [LaunchDaemonInstaller.swift:2898 installBundledKanataBinaryOnly()] ğŸ”§ [LaunchDaemon] Installing bundled kanata binary to system location
[2025-11-22 13:37:18.876] [INFO] [LaunchDaemonInstaller.swift:2906 installBundledKanataBinaryOnly()] âŒ [LaunchDaemon] CRITICAL: Bundled kanata binary not found at: /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata
[2025-11-22 13:37:18.876] [INFO] [LaunchDaemonInstaller.swift:2908 installBundledKanataBinaryOnly()] âŒ [LaunchDaemon] This indicates a packaging issue - the app bundle is missing the kanata binary
[2025-11-22 13:37:18.876] [INFO] [InstallerEngine.swift:255 execute(plan:using:)] âŒ [InstallerEngine] Recipe install-bundled-kanata failed: Operation failed: Bundled Kanata installation failed
[2025-11-22 13:37:18.876] [INFO] [InstallerEngine.swift:274 execute(plan:using:)] âœ… [InstallerEngine] execute() complete - success: false, recipes executed: 1
[2025-11-22 13:37:18.876] [INFO] [InstallerEngine.swift:432 run(intent:using:)] âœ… [InstallerEngine] run() complete - success: false
[2025-11-22 13:37:18.876] [INFO] [HelperMaintenance.swift:298 log(_:)] âš ï¸ Admin cleanup failed (exit 1): Permission denied
[2025-11-22 13:37:18.876] [INFO] [HelperMaintenance.swift:298 log(_:)] âŒ Legacy helper cleanup failed; aborting repair
[2025-11-22 13:37:18.876] [INFO] [HelperMaintenance.swift:298 log(_:)] ğŸ§¹ Cleanup & Repair finished
Test Case '-[KeyPathTests.HelperMaintenanceTests testAdminCleanupFallbackFailureAbortsRun]' passed (0.006 seconds).
Test Case '-[KeyPathTests.HelperMaintenanceTests testAdminCleanupFallbackSucceedsWithExecutor]' started.
[2025-11-22 13:37:18.877] [INFO] [HelperMaintenance.swift:298 log(_:)] ğŸ§¹ Cleanup & Repair started
[2025-11-22 13:37:18.877] [INFO] [HelperMaintenance.swift:298 log(_:)] âœ… App copy check: OK (/Applications/KeyPath.app)
[2025-11-22 13:37:18.877] [INFO] [HelperMaintenance.swift:298 log(_:)] âš ï¸ Primary registration failed; attempting cleanup then retry
[2025-11-22 13:37:18.877] [INFO] [HelperMaintenance.swift:298 log(_:)] âœ… Admin cleanup removed legacy helper artifacts
[2025-11-22 13:37:18.877] [INFO] [HelperMaintenance.swift:298 log(_:)] âœ… Helper responding via XPC
[2025-11-22 13:37:18.877] [INFO] [HelperMaintenance.swift:298 log(_:)] ğŸ§¹ Cleanup & Repair finished
Test Case '-[KeyPathTests.HelperMaintenanceTests testAdminCleanupFallbackSucceedsWithExecutor]' passed (0.001 seconds).
Test Case '-[KeyPathTests.HelperMaintenanceTests testDetectDuplicateAppCopiesFiltersBuildPathsAndSortsApplicationsFirst]' started.
Test Case '-[KeyPathTests.HelperMaintenanceTests testDetectDuplicateAppCopiesFiltersBuildPathsAndSortsApplicationsFirst]' passed (0.001 seconds).
Test Case '-[KeyPathTests.HelperMaintenanceTests testRunCleanupIsIdempotentWithoutDuplicates]' started.
[2025-11-22 13:37:18.879] [INFO] [HelperMaintenance.swift:298 log(_:)] ğŸ§¹ Cleanup & Repair started
[2025-11-22 13:37:18.879] [INFO] [HelperMaintenance.swift:298 log(_:)] âœ… App copy check: OK (/Applications/KeyPath.app)
[2025-11-22 13:37:18.879] [INFO] [HelperMaintenance.swift:298 log(_:)] âœ… Helper registered via SMAppService on first attempt
[2025-11-22 13:37:18.879] [INFO] [HelperMaintenance.swift:298 log(_:)] âœ… Helper responding via XPC
[2025-11-22 13:37:18.879] [INFO] [HelperMaintenance.swift:298 log(_:)] ğŸ§¹ Cleanup & Repair finished
[2025-11-22 13:37:18.879] [INFO] [HelperMaintenance.swift:298 log(_:)] ğŸ§¹ Cleanup & Repair started
[2025-11-22 13:37:18.880] [INFO] [HelperMaintenance.swift:298 log(_:)] âœ… App copy check: OK (/Applications/KeyPath.app)
[2025-11-22 13:37:18.880] [INFO] [HelperMaintenance.swift:298 log(_:)] âœ… Helper registered via SMAppService on first attempt
[2025-11-22 13:37:18.881] [INFO] [HelperMaintenance.swift:298 log(_:)] âœ… Helper responding via XPC
[2025-11-22 13:37:18.881] [INFO] [HelperMaintenance.swift:298 log(_:)] ğŸ§¹ Cleanup & Repair finished
Test Case '-[KeyPathTests.HelperMaintenanceTests testRunCleanupIsIdempotentWithoutDuplicates]' passed (0.004 seconds).
Test Case '-[KeyPathTests.HelperMaintenanceTests testRunCleanupLogsWarningForDuplicateCopies]' started.
[2025-11-22 13:37:18.883] [INFO] [HelperMaintenance.swift:298 log(_:)] ğŸ§¹ Cleanup & Repair started
[2025-11-22 13:37:18.884] [INFO] [HelperMaintenance.swift:298 log(_:)] âš ï¸ Multiple KeyPath.app copies detected:
[2025-11-22 13:37:18.884] [INFO] [HelperMaintenance.swift:298 log(_:)]    - /Applications/KeyPath.app
[2025-11-22 13:37:18.884] [INFO] [HelperMaintenance.swift:298 log(_:)]    - /Users/other/KeyPath.app
[2025-11-22 13:37:18.884] [INFO] [HelperMaintenance.swift:298 log(_:)] â— Background Item approval may point at a non-/Applications copy.
[2025-11-22 13:37:18.884] [INFO] [HelperMaintenance.swift:298 log(_:)] âœ… Helper registered via SMAppService on first attempt
[2025-11-22 13:37:18.885] [INFO] [HelperMaintenance.swift:298 log(_:)] âœ… Helper responding via XPC
[2025-11-22 13:37:18.885] [INFO] [HelperMaintenance.swift:298 log(_:)] ğŸ§¹ Cleanup & Repair finished
Test Case '-[KeyPathTests.HelperMaintenanceTests testRunCleanupLogsWarningForDuplicateCopies]' passed (0.002 seconds).
Test Suite 'HelperMaintenanceTests' passed at 2025-11-22 13:37:18.885.
	 Executed 5 tests, with 0 failures (0 unexpected) in 0.013 (0.014) seconds
Test Suite 'HelperManagerTests' started at 2025-11-22 13:37:18.885.
Test Case '-[KeyPathTests.HelperManagerTests testInstallHelperAttemptsRegisterWhenStatusIsNotFoundAndSurfacesError]' started.
[2025-11-22 13:37:18.886] [INFO] [HelperManager.swift:430 installHelper()] ğŸ”§ [HelperManager] Registering privileged helper via SMAppService
[2025-11-22 13:37:18.886] [INFO] [HelperManager.swift:437 installHelper()] ğŸ“¦ [HelperManager] App bundle: /Applications/Xcode.app/Contents/Developer/usr/bin
[2025-11-22 13:37:18.886] [INFO] [HelperManager.swift:444 installHelper()] âš ï¸ [HelperManager] Could not read Info.plist
[2025-11-22 13:37:18.886] [INFO] [HelperManager.swift:449 installHelper()] ğŸ” [HelperManager] SMAppService status: 3 (0=notRegistered, 1=enabled, 2=requiresApproval, 3=notFound)
[2025-11-22 13:37:18.886] [INFO] [HelperManager.swift:494 installHelper()] âš ï¸ [HelperManager] Helper status is .notFound - attempting registration anyway to get detailed error
[2025-11-22 13:37:18.886] [INFO] [HelperManager.swift:505 installHelper()] âŒ [HelperManager] Registration failed with detailed error: Codesigning failure loading plist: com.keypath.helper code: -67028 [SMAppServiceErrorDomain:3]
Test Case '-[KeyPathTests.HelperManagerTests testInstallHelperAttemptsRegisterWhenStatusIsNotFoundAndSurfacesError]' passed (0.002 seconds).
Test Suite 'HelperManagerTests' passed at 2025-11-22 13:37:18.887.
	 Executed 1 test, with 0 failures (0 unexpected) in 0.002 (0.002) seconds
Test Suite 'InstallerEngineFunctionalTests' started at 2025-11-22 13:37:18.887.
Test Case '-[KeyPathTests.InstallerEngineFunctionalTests testBundledKanataMissingProducesLogWarning]' started.
[2025-11-22 13:37:18.890] [INFO] [LaunchDaemonInstaller.swift:312 createAllLaunchDaemonServices()] ğŸ”§ [LaunchDaemon] Creating all LaunchDaemon services
[2025-11-22 13:37:18.891] [INFO] [ConfigurationService.swift:483 createInitialConfigIfNeeded()] âœ… [ConfigService] Config directory created at /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-73F26D54-7588-4833-898F-F08D5AC5866B/Users/tester/.config/keypath
[2025-11-22 13:37:18.891] [INFO] [ConfigurationService.swift:488 createInitialConfigIfNeeded()] âš ï¸ [ConfigService] No existing config found at /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-73F26D54-7588-4833-898F-F08D5AC5866B/Users/tester/.config/keypath/keypath.kbd
[2025-11-22 13:37:18.891] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:37:18.891] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:37:18.892] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 725 characters
[2025-11-22 13:37:18.892] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:37:18.892] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 10 src keys, 10 layer keys, deduplicated to 10 unique mappings
[2025-11-22 13:37:18.892] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:37:18.892] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:37:18.892] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 0 mappings
[2025-11-22 13:37:18.892] [INFO] [ConfigurationService.swift:492 createInitialConfigIfNeeded()] âœ… [ConfigService] Created initial empty configuration
[2025-11-22 13:37:18.892] [INFO] [LaunchDaemonInstaller.swift:945 ensureDefaultUserConfigExists()] âœ… [LaunchDaemon] Created default user config at /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-73F26D54-7588-4833-898F-F08D5AC5866B/Users/tester/.config/keypath/keypath.kbd
[2025-11-22 13:37:18.892] [INFO] [LaunchDaemonInstaller.swift:232 getKanataBinaryPath()] âŒ [LaunchDaemon] Bundled Kanata binary not found at: /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-73F26D54-7588-4833-898F-F08D5AC5866B/missing-kanata
[2025-11-22 13:37:18.893] [INFO] [LaunchDaemonInstaller.swift:233 getKanataBinaryPath()] ğŸ’¡ [LaunchDaemon] User may need to reinstall Kanata components before proceeding
[2025-11-22 13:37:18.893] [INFO] [LaunchDaemonInstaller.swift:2689 buildKanataPlistArguments(binaryPath:)] ğŸ“¡ [LaunchDaemon] TCP server enabled on port 45000
[2025-11-22 13:37:18.893] [INFO] [LaunchDaemonInstaller.swift:2705 buildKanataPlistArguments(binaryPath:)] ğŸ”§ [LaunchDaemon] Built plist arguments: /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-73F26D54-7588-4833-898F-F08D5AC5866B/missing-kanata --cfg /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-73F26D54-7588-4833-898F-F08D5AC5866B/Users/tester/.config/keypath/keypath.kbd --port 45000 --debug --log-layer-changes
[2025-11-22 13:37:18.895] [INFO] [LaunchDaemonInstaller.swift:361 createAllLaunchDaemonServices()] ğŸ§ª [LaunchDaemon] Test mode without auth-script override â€“ using local installer path
[2025-11-22 13:37:18.895] [INFO] [LaunchDaemonInstaller.swift:1089 executeAllWithAdminPrivileges(kanataTemp:vhidDaemonTemp:vhidManagerTemp:)] ğŸ”§ [LaunchDaemon] Requesting admin privileges to install all services
[2025-11-22 13:37:18.897] [INFO] [LaunchDaemonInstaller.swift:1104 executeAllWithAdminPrivileges(kanataTemp:vhidDaemonTemp:vhidManagerTemp:)] âœ… [LaunchDaemon] (test) Installed all plists to /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-73F26D54-7588-4833-898F-F08D5AC5866B/Library/LaunchDaemons
Test Case '-[KeyPathTests.InstallerEngineFunctionalTests testBundledKanataMissingProducesLogWarning]' passed (0.067 seconds).
Test Case '-[KeyPathTests.InstallerEngineFunctionalTests testCreateAllServicesLogsErrorWhenUserConfigDirectoryBlocked]' started.
[2025-11-22 13:37:18.955] [INFO] [LaunchDaemonInstaller.swift:312 createAllLaunchDaemonServices()] ğŸ”§ [LaunchDaemon] Creating all LaunchDaemon services
[2025-11-22 13:37:18.958] [INFO] [LaunchDaemonInstaller.swift:947 ensureDefaultUserConfigExists()] âŒ [LaunchDaemon] Failed to create default user config: Error Domain=NSCocoaErrorDomain Code=516 "The file â€œkeypathâ€ couldnâ€™t be saved in the folder â€œ.configâ€ because a file with the same name already exists." UserInfo={NSFilePath=/var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-4B5C2889-E670-43F2-817E-6D841A6EFCB1/Users/tester/.config/keypath, NSURL=file:///var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-4B5C2889-E670-43F2-817E-6D841A6EFCB1/Users/tester/.config/keypath, NSUnderlyingError=0x76c96a370 {Error Domain=NSPOSIXErrorDomain Code=17 "File exists"}}
[2025-11-22 13:37:18.958] [INFO] [LaunchDaemonInstaller.swift:232 getKanataBinaryPath()] âŒ [LaunchDaemon] Bundled Kanata binary not found at: /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata
[2025-11-22 13:37:18.958] [INFO] [LaunchDaemonInstaller.swift:233 getKanataBinaryPath()] ğŸ’¡ [LaunchDaemon] User may need to reinstall Kanata components before proceeding
[2025-11-22 13:37:18.958] [INFO] [LaunchDaemonInstaller.swift:2689 buildKanataPlistArguments(binaryPath:)] ğŸ“¡ [LaunchDaemon] TCP server enabled on port 45000
[2025-11-22 13:37:18.958] [INFO] [LaunchDaemonInstaller.swift:2705 buildKanataPlistArguments(binaryPath:)] ğŸ”§ [LaunchDaemon] Built plist arguments: /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata --cfg /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-4B5C2889-E670-43F2-817E-6D841A6EFCB1/Users/tester/.config/keypath/keypath.kbd --port 45000 --debug --log-layer-changes
[2025-11-22 13:37:18.960] [INFO] [LaunchDaemonInstaller.swift:361 createAllLaunchDaemonServices()] ğŸ§ª [LaunchDaemon] Test mode without auth-script override â€“ using local installer path
[2025-11-22 13:37:18.960] [INFO] [LaunchDaemonInstaller.swift:1089 executeAllWithAdminPrivileges(kanataTemp:vhidDaemonTemp:vhidManagerTemp:)] ğŸ”§ [LaunchDaemon] Requesting admin privileges to install all services
[2025-11-22 13:37:18.961] [INFO] [LaunchDaemonInstaller.swift:1104 executeAllWithAdminPrivileges(kanataTemp:vhidDaemonTemp:vhidManagerTemp:)] âœ… [LaunchDaemon] (test) Installed all plists to /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-4B5C2889-E670-43F2-817E-6D841A6EFCB1/Library/LaunchDaemons
Test Case '-[KeyPathTests.InstallerEngineFunctionalTests testCreateAllServicesLogsErrorWhenUserConfigDirectoryBlocked]' passed (0.010 seconds).
Test Case '-[KeyPathTests.InstallerEngineFunctionalTests testCreateAllServicesWritesUserConfig]' started.
[2025-11-22 13:37:18.966] [INFO] [LaunchDaemonInstaller.swift:312 createAllLaunchDaemonServices()] ğŸ”§ [LaunchDaemon] Creating all LaunchDaemon services
[2025-11-22 13:37:18.966] [INFO] [ConfigurationService.swift:483 createInitialConfigIfNeeded()] âœ… [ConfigService] Config directory created at /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-53838CAE-ECF3-4749-97C4-32107B363AD3/Users/tester/.config/keypath
[2025-11-22 13:37:18.966] [INFO] [ConfigurationService.swift:488 createInitialConfigIfNeeded()] âš ï¸ [ConfigService] No existing config found at /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-53838CAE-ECF3-4749-97C4-32107B363AD3/Users/tester/.config/keypath/keypath.kbd
[2025-11-22 13:37:18.966] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:37:18.966] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:37:18.966] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 725 characters
[2025-11-22 13:37:18.966] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:37:18.966] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 10 src keys, 10 layer keys, deduplicated to 10 unique mappings
[2025-11-22 13:37:18.966] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:37:18.966] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:37:18.967] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 0 mappings
[2025-11-22 13:37:18.967] [INFO] [ConfigurationService.swift:492 createInitialConfigIfNeeded()] âœ… [ConfigService] Created initial empty configuration
[2025-11-22 13:37:18.967] [INFO] [LaunchDaemonInstaller.swift:945 ensureDefaultUserConfigExists()] âœ… [LaunchDaemon] Created default user config at /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-53838CAE-ECF3-4749-97C4-32107B363AD3/Users/tester/.config/keypath/keypath.kbd
[2025-11-22 13:37:18.967] [INFO] [LaunchDaemonInstaller.swift:232 getKanataBinaryPath()] âŒ [LaunchDaemon] Bundled Kanata binary not found at: /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata
[2025-11-22 13:37:18.967] [INFO] [LaunchDaemonInstaller.swift:233 getKanataBinaryPath()] ğŸ’¡ [LaunchDaemon] User may need to reinstall Kanata components before proceeding
[2025-11-22 13:37:18.967] [INFO] [LaunchDaemonInstaller.swift:2689 buildKanataPlistArguments(binaryPath:)] ğŸ“¡ [LaunchDaemon] TCP server enabled on port 45000
[2025-11-22 13:37:18.967] [INFO] [LaunchDaemonInstaller.swift:2705 buildKanataPlistArguments(binaryPath:)] ğŸ”§ [LaunchDaemon] Built plist arguments: /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata --cfg /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-53838CAE-ECF3-4749-97C4-32107B363AD3/Users/tester/.config/keypath/keypath.kbd --port 45000 --debug --log-layer-changes
[2025-11-22 13:37:18.968] [INFO] [LaunchDaemonInstaller.swift:361 createAllLaunchDaemonServices()] ğŸ§ª [LaunchDaemon] Test mode without auth-script override â€“ using local installer path
[2025-11-22 13:37:18.968] [INFO] [LaunchDaemonInstaller.swift:1089 executeAllWithAdminPrivileges(kanataTemp:vhidDaemonTemp:vhidManagerTemp:)] ğŸ”§ [LaunchDaemon] Requesting admin privileges to install all services
[2025-11-22 13:37:18.969] [INFO] [LaunchDaemonInstaller.swift:1104 executeAllWithAdminPrivileges(kanataTemp:vhidDaemonTemp:vhidManagerTemp:)] âœ… [LaunchDaemon] (test) Installed all plists to /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-53838CAE-ECF3-4749-97C4-32107B363AD3/Library/LaunchDaemons
Test Case '-[KeyPathTests.InstallerEngineFunctionalTests testCreateAllServicesWritesUserConfig]' passed (0.006 seconds).
Test Case '-[KeyPathTests.InstallerEngineFunctionalTests testCreateKanataLaunchDaemonAcknowledgesPendingApproval]' started.
[2025-11-22 13:37:18.971] [INFO] [LaunchDaemonInstaller.swift:412 createKanataLaunchDaemon()] ğŸ”§ [LaunchDaemon] Creating Kanata LaunchDaemon service via SMAppService
[2025-11-22 13:37:18.971] [INFO] [LaunchDaemonInstaller.swift:420 createKanataLaunchDaemonViaSMAppService()] ğŸ“± [LaunchDaemon] Registering Kanata daemon via SMAppService
[2025-11-22 13:37:18.971] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:37:18.971] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:37:18.971] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 2 (SMAppServiceStatus(rawValue: 2))
[2025-11-22 13:37:18.971] [INFO] [KanataDaemonManager.swift:129 determineServiceManagementState()] â³ [KanataDaemonManager] State: SMAPPSERVICE_PENDING (approval needed)
[2025-11-22 13:37:18.971] [INFO] [LaunchDaemonInstaller.swift:429 createKanataLaunchDaemonViaSMAppService()] ğŸ” [LaunchDaemon] Current state: SMAppService (pending approval)
[2025-11-22 13:37:18.971] [INFO] [LaunchDaemonInstaller.swift:454 createKanataLaunchDaemonViaSMAppService()] âœ… [LaunchDaemon] Already managed by SMAppService (state: SMAppService (pending approval)) - skipping registration
Test Case '-[KeyPathTests.InstallerEngineFunctionalTests testCreateKanataLaunchDaemonAcknowledgesPendingApproval]' passed (0.002 seconds).
Test Case '-[KeyPathTests.InstallerEngineFunctionalTests testCreateKanataLaunchDaemonSkipsRegistrationWhenAlreadyManaged]' started.
[2025-11-22 13:37:18.973] [INFO] [LaunchDaemonInstaller.swift:412 createKanataLaunchDaemon()] ğŸ”§ [LaunchDaemon] Creating Kanata LaunchDaemon service via SMAppService
[2025-11-22 13:37:18.973] [INFO] [LaunchDaemonInstaller.swift:420 createKanataLaunchDaemonViaSMAppService()] ğŸ“± [LaunchDaemon] Registering Kanata daemon via SMAppService
[2025-11-22 13:37:18.973] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:37:18.973] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:37:18.973] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 1 (SMAppServiceStatus(rawValue: 1))
[2025-11-22 13:37:18.973] [INFO] [KanataDaemonManager.swift:126 determineServiceManagementState()] âœ… [KanataDaemonManager] State: SMAPPSERVICE_ACTIVE
[2025-11-22 13:37:18.973] [INFO] [LaunchDaemonInstaller.swift:429 createKanataLaunchDaemonViaSMAppService()] ğŸ” [LaunchDaemon] Current state: SMAppService (active)
[2025-11-22 13:37:18.973] [INFO] [LaunchDaemonInstaller.swift:454 createKanataLaunchDaemonViaSMAppService()] âœ… [LaunchDaemon] Already managed by SMAppService (state: SMAppService (active)) - skipping registration
Test Case '-[KeyPathTests.InstallerEngineFunctionalTests testCreateKanataLaunchDaemonSkipsRegistrationWhenAlreadyManaged]' passed (0.002 seconds).
Test Case '-[KeyPathTests.InstallerEngineFunctionalTests testFirstTimeInstallProvisioningFlow]' started.
[2025-11-22 13:37:18.975] [INFO] [LaunchDaemonInstaller.swift:312 createAllLaunchDaemonServices()] ğŸ”§ [LaunchDaemon] Creating all LaunchDaemon services
[2025-11-22 13:37:18.976] [INFO] [ConfigurationService.swift:483 createInitialConfigIfNeeded()] âœ… [ConfigService] Config directory created at /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-281B17EC-494E-4BF9-81BA-42BB9AE7B21E/Users/tester/.config/keypath
[2025-11-22 13:37:18.976] [INFO] [ConfigurationService.swift:488 createInitialConfigIfNeeded()] âš ï¸ [ConfigService] No existing config found at /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-281B17EC-494E-4BF9-81BA-42BB9AE7B21E/Users/tester/.config/keypath/keypath.kbd
[2025-11-22 13:37:18.976] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:37:18.976] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:37:18.976] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 725 characters
[2025-11-22 13:37:18.976] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:37:18.976] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 10 src keys, 10 layer keys, deduplicated to 10 unique mappings
[2025-11-22 13:37:18.976] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:37:18.976] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:37:18.976] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 0 mappings
[2025-11-22 13:37:18.976] [INFO] [ConfigurationService.swift:492 createInitialConfigIfNeeded()] âœ… [ConfigService] Created initial empty configuration
[2025-11-22 13:37:18.976] [INFO] [LaunchDaemonInstaller.swift:945 ensureDefaultUserConfigExists()] âœ… [LaunchDaemon] Created default user config at /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-281B17EC-494E-4BF9-81BA-42BB9AE7B21E/Users/tester/.config/keypath/keypath.kbd
[2025-11-22 13:37:18.976] [INFO] [LaunchDaemonInstaller.swift:232 getKanataBinaryPath()] âŒ [LaunchDaemon] Bundled Kanata binary not found at: /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata
[2025-11-22 13:37:18.976] [INFO] [LaunchDaemonInstaller.swift:233 getKanataBinaryPath()] ğŸ’¡ [LaunchDaemon] User may need to reinstall Kanata components before proceeding
[2025-11-22 13:37:18.976] [INFO] [LaunchDaemonInstaller.swift:2689 buildKanataPlistArguments(binaryPath:)] ğŸ“¡ [LaunchDaemon] TCP server enabled on port 45000
[2025-11-22 13:37:18.976] [INFO] [LaunchDaemonInstaller.swift:2705 buildKanataPlistArguments(binaryPath:)] ğŸ”§ [LaunchDaemon] Built plist arguments: /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata --cfg /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-281B17EC-494E-4BF9-81BA-42BB9AE7B21E/Users/tester/.config/keypath/keypath.kbd --port 45000 --debug --log-layer-changes
[2025-11-22 13:37:18.978] [INFO] [LaunchDaemonInstaller.swift:361 createAllLaunchDaemonServices()] ğŸ§ª [LaunchDaemon] Test mode without auth-script override â€“ using local installer path
[2025-11-22 13:37:18.978] [INFO] [LaunchDaemonInstaller.swift:1089 executeAllWithAdminPrivileges(kanataTemp:vhidDaemonTemp:vhidManagerTemp:)] ğŸ”§ [LaunchDaemon] Requesting admin privileges to install all services
[2025-11-22 13:37:18.978] [INFO] [LaunchDaemonInstaller.swift:1104 executeAllWithAdminPrivileges(kanataTemp:vhidDaemonTemp:vhidManagerTemp:)] âœ… [LaunchDaemon] (test) Installed all plists to /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-281B17EC-494E-4BF9-81BA-42BB9AE7B21E/Library/LaunchDaemons
[2025-11-22 13:37:18.978] [INFO] [LaunchDaemonInstaller.swift:566 loadServices()] ğŸ”§ [LaunchDaemon] Loading all KeyPath LaunchDaemon services
[2025-11-22 13:37:18.978] [INFO] [LaunchDaemonInstaller.swift:586 loadService(serviceID:)] ğŸ”§ [LaunchDaemon] Loading service: com.keypath.kanata
[2025-11-22 13:37:18.978] [INFO] [LaunchDaemonInstaller.swift:586 loadService(serviceID:)] ğŸ”§ [LaunchDaemon] Loading service: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:37:18.979] [INFO] [LaunchDaemonInstaller.swift:586 loadService(serviceID:)] ğŸ”§ [LaunchDaemon] Loading service: com.keypath.karabiner-vhidmanager
[2025-11-22 13:37:18.979] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:37:18.979] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: true
[2025-11-22 13:37:18.979] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 0 (SMAppServiceStatus(rawValue: 0))
[2025-11-22 13:37:18.979] [INFO] [KanataDaemonManager.swift:119 determineServiceManagementState()] âœ… [KanataDaemonManager] State: LEGACY_ACTIVE (plist exists)
[2025-11-22 13:37:18.979] [INFO] [LaunchDaemonInstaller.swift:664 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (test) Kanata service loaded via file existence: true
[2025-11-22 13:37:18.979] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:37:18.979] [INFO] [LaunchDaemonInstaller.swift:740 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] (test) Service com.keypath.kanata considered healthy: true
[2025-11-22 13:37:18.979] [INFO] [LaunchDaemonInstaller.swift:704 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (test) Service com.keypath.karabiner-vhiddaemon considered loaded: true
[2025-11-22 13:37:18.979] [INFO] [LaunchDaemonInstaller.swift:704 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (test) Service com.keypath.karabiner-vhidmanager considered loaded: true
[2025-11-22 13:37:18.979] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:37:18.979] [INFO] [LaunchDaemonInstaller.swift:740 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] (test) Service com.keypath.karabiner-vhiddaemon considered healthy: true
[2025-11-22 13:37:18.979] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhidmanager
[2025-11-22 13:37:18.979] [INFO] [LaunchDaemonInstaller.swift:740 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] (test) Service com.keypath.karabiner-vhidmanager considered healthy: true
Test Case '-[KeyPathTests.InstallerEngineFunctionalTests testFirstTimeInstallProvisioningFlow]' passed (0.006 seconds).
Test Case '-[KeyPathTests.InstallerEngineFunctionalTests testInstallerFailureWhenLaunchDaemonDirectoryIsInvalid]' started.
[2025-11-22 13:37:18.982] [INFO] [LaunchDaemonInstaller.swift:312 createAllLaunchDaemonServices()] ğŸ”§ [LaunchDaemon] Creating all LaunchDaemon services
[2025-11-22 13:37:18.982] [INFO] [ConfigurationService.swift:483 createInitialConfigIfNeeded()] âœ… [ConfigService] Config directory created at /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-20759249-6862-4ABC-A6B6-DA0E155728CD/Users/tester/.config/keypath
[2025-11-22 13:37:18.982] [INFO] [ConfigurationService.swift:488 createInitialConfigIfNeeded()] âš ï¸ [ConfigService] No existing config found at /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-20759249-6862-4ABC-A6B6-DA0E155728CD/Users/tester/.config/keypath/keypath.kbd
[2025-11-22 13:37:18.982] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:37:18.982] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:37:18.982] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 725 characters
[2025-11-22 13:37:18.982] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:37:18.982] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 10 src keys, 10 layer keys, deduplicated to 10 unique mappings
[2025-11-22 13:37:18.983] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:37:18.983] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:37:18.983] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 0 mappings
[2025-11-22 13:37:18.983] [INFO] [ConfigurationService.swift:492 createInitialConfigIfNeeded()] âœ… [ConfigService] Created initial empty configuration
[2025-11-22 13:37:18.983] [INFO] [LaunchDaemonInstaller.swift:945 ensureDefaultUserConfigExists()] âœ… [LaunchDaemon] Created default user config at /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-20759249-6862-4ABC-A6B6-DA0E155728CD/Users/tester/.config/keypath/keypath.kbd
[2025-11-22 13:37:18.983] [INFO] [LaunchDaemonInstaller.swift:232 getKanataBinaryPath()] âŒ [LaunchDaemon] Bundled Kanata binary not found at: /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata
[2025-11-22 13:37:18.983] [INFO] [LaunchDaemonInstaller.swift:233 getKanataBinaryPath()] ğŸ’¡ [LaunchDaemon] User may need to reinstall Kanata components before proceeding
[2025-11-22 13:37:18.983] [INFO] [LaunchDaemonInstaller.swift:2689 buildKanataPlistArguments(binaryPath:)] ğŸ“¡ [LaunchDaemon] TCP server enabled on port 45000
[2025-11-22 13:37:18.983] [INFO] [LaunchDaemonInstaller.swift:2705 buildKanataPlistArguments(binaryPath:)] ğŸ”§ [LaunchDaemon] Built plist arguments: /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata --cfg /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-20759249-6862-4ABC-A6B6-DA0E155728CD/Users/tester/.config/keypath/keypath.kbd --port 45000 --debug --log-layer-changes
[2025-11-22 13:37:18.984] [INFO] [LaunchDaemonInstaller.swift:361 createAllLaunchDaemonServices()] ğŸ§ª [LaunchDaemon] Test mode without auth-script override â€“ using local installer path
[2025-11-22 13:37:18.984] [INFO] [LaunchDaemonInstaller.swift:1089 executeAllWithAdminPrivileges(kanataTemp:vhidDaemonTemp:vhidManagerTemp:)] ğŸ”§ [LaunchDaemon] Requesting admin privileges to install all services
[2025-11-22 13:37:18.986] [INFO] [LaunchDaemonInstaller.swift:1109 executeAllWithAdminPrivileges(kanataTemp:vhidDaemonTemp:vhidManagerTemp:)] âŒ [LaunchDaemon] (test) Failed to install plists: Error Domain=NSCocoaErrorDomain Code=516 "The file â€œLaunchDaemonsâ€ couldnâ€™t be saved in the folder â€œLibraryâ€ because a file with the same name already exists." UserInfo={NSFilePath=/var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-20759249-6862-4ABC-A6B6-DA0E155728CD/Library/LaunchDaemons, NSURL=file:///var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-20759249-6862-4ABC-A6B6-DA0E155728CD/Library/LaunchDaemons, NSUnderlyingError=0x76c96a790 {Error Domain=NSPOSIXErrorDomain Code=17 "File exists"}}
[2025-11-22 13:37:18.986] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:37:18.986] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:37:18.986] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 0 (SMAppServiceStatus(rawValue: 0))
[2025-11-22 13:37:18.986] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:37:18.986] [INFO] [LaunchDaemonInstaller.swift:664 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (test) Kanata service loaded via file existence: false
[2025-11-22 13:37:18.986] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:37:18.986] [INFO] [LaunchDaemonInstaller.swift:740 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] (test) Service com.keypath.kanata considered healthy: false
[2025-11-22 13:37:18.986] [INFO] [LaunchDaemonInstaller.swift:704 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (test) Service com.keypath.karabiner-vhiddaemon considered loaded: false
[2025-11-22 13:37:18.987] [INFO] [LaunchDaemonInstaller.swift:704 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (test) Service com.keypath.karabiner-vhidmanager considered loaded: false
[2025-11-22 13:37:18.987] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:37:18.987] [INFO] [LaunchDaemonInstaller.swift:740 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] (test) Service com.keypath.karabiner-vhiddaemon considered healthy: false
[2025-11-22 13:37:18.987] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhidmanager
[2025-11-22 13:37:18.987] [INFO] [LaunchDaemonInstaller.swift:740 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] (test) Service com.keypath.karabiner-vhidmanager considered healthy: false
Test Case '-[KeyPathTests.InstallerEngineFunctionalTests testInstallerFailureWhenLaunchDaemonDirectoryIsInvalid]' passed (0.009 seconds).
Test Case '-[KeyPathTests.InstallerEngineFunctionalTests testInstallerFailureWhenLaunchDaemonsDirectoryIsReadOnly]' started.
[2025-11-22 13:37:18.991] [INFO] [LaunchDaemonInstaller.swift:312 createAllLaunchDaemonServices()] ğŸ”§ [LaunchDaemon] Creating all LaunchDaemon services
[2025-11-22 13:37:18.991] [INFO] [ConfigurationService.swift:483 createInitialConfigIfNeeded()] âœ… [ConfigService] Config directory created at /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-753B3DD7-614D-4A33-8364-58153243F57C/Users/tester/.config/keypath
[2025-11-22 13:37:18.991] [INFO] [ConfigurationService.swift:488 createInitialConfigIfNeeded()] âš ï¸ [ConfigService] No existing config found at /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-753B3DD7-614D-4A33-8364-58153243F57C/Users/tester/.config/keypath/keypath.kbd
[2025-11-22 13:37:18.991] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:37:18.991] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:37:18.991] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 725 characters
[2025-11-22 13:37:18.991] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:37:18.991] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 10 src keys, 10 layer keys, deduplicated to 10 unique mappings
[2025-11-22 13:37:18.991] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:37:18.991] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:37:18.991] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 0 mappings
[2025-11-22 13:37:18.991] [INFO] [ConfigurationService.swift:492 createInitialConfigIfNeeded()] âœ… [ConfigService] Created initial empty configuration
[2025-11-22 13:37:18.991] [INFO] [LaunchDaemonInstaller.swift:945 ensureDefaultUserConfigExists()] âœ… [LaunchDaemon] Created default user config at /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-753B3DD7-614D-4A33-8364-58153243F57C/Users/tester/.config/keypath/keypath.kbd
[2025-11-22 13:37:18.992] [INFO] [LaunchDaemonInstaller.swift:232 getKanataBinaryPath()] âŒ [LaunchDaemon] Bundled Kanata binary not found at: /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata
[2025-11-22 13:37:18.992] [INFO] [LaunchDaemonInstaller.swift:233 getKanataBinaryPath()] ğŸ’¡ [LaunchDaemon] User may need to reinstall Kanata components before proceeding
[2025-11-22 13:37:18.992] [INFO] [LaunchDaemonInstaller.swift:2689 buildKanataPlistArguments(binaryPath:)] ğŸ“¡ [LaunchDaemon] TCP server enabled on port 45000
[2025-11-22 13:37:18.992] [INFO] [LaunchDaemonInstaller.swift:2705 buildKanataPlistArguments(binaryPath:)] ğŸ”§ [LaunchDaemon] Built plist arguments: /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata --cfg /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-753B3DD7-614D-4A33-8364-58153243F57C/Users/tester/.config/keypath/keypath.kbd --port 45000 --debug --log-layer-changes
[2025-11-22 13:37:18.993] [INFO] [LaunchDaemonInstaller.swift:361 createAllLaunchDaemonServices()] ğŸ§ª [LaunchDaemon] Test mode without auth-script override â€“ using local installer path
[2025-11-22 13:37:18.993] [INFO] [LaunchDaemonInstaller.swift:1089 executeAllWithAdminPrivileges(kanataTemp:vhidDaemonTemp:vhidManagerTemp:)] ğŸ”§ [LaunchDaemon] Requesting admin privileges to install all services
[2025-11-22 13:37:18.994] [INFO] [LaunchDaemonInstaller.swift:1109 executeAllWithAdminPrivileges(kanataTemp:vhidDaemonTemp:vhidManagerTemp:)] âŒ [LaunchDaemon] (test) Failed to install plists: Error Domain=NSCocoaErrorDomain Code=513 "â€œcom.keypath.kanata.7E1D5BDE-C033-402C-8985-33379A231947.plistâ€ couldnâ€™t be copied because you donâ€™t have permission to access â€œLaunchDaemonsâ€." UserInfo={NSSourceFilePathErrorKey=/var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/com.keypath.kanata.7E1D5BDE-C033-402C-8985-33379A231947.plist, NSUserStringVariant=(
    Copy
), NSDestinationFilePath=/var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-753B3DD7-614D-4A33-8364-58153243F57C/Library/LaunchDaemons/com.keypath.kanata.plist, NSFilePath=/var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/com.keypath.kanata.7E1D5BDE-C033-402C-8985-33379A231947.plist, NSURL=file:///var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/com.keypath.kanata.7E1D5BDE-C033-402C-8985-33379A231947.plist, NSUnderlyingError=0x76c96aac0 {Error Domain=NSPOSIXErrorDomain Code=13 "Permission denied"}}
Test Case '-[KeyPathTests.InstallerEngineFunctionalTests testInstallerFailureWhenLaunchDaemonsDirectoryIsReadOnly]' passed (0.005 seconds).
Test Case '-[KeyPathTests.InstallerEngineFunctionalTests testInstallerLogsPermissionDeniedWhenConfigDirectoryCannotBeCreated]' started.
[2025-11-22 13:37:18.996] [INFO] [LaunchDaemonInstaller.swift:312 createAllLaunchDaemonServices()] ğŸ”§ [LaunchDaemon] Creating all LaunchDaemon services
[2025-11-22 13:37:18.996] [INFO] [LaunchDaemonInstaller.swift:947 ensureDefaultUserConfigExists()] âŒ [LaunchDaemon] Failed to create default user config: Error Domain=NSCocoaErrorDomain Code=513 "You donâ€™t have permission to save the file â€œkeypathâ€ in the folder â€œ.configâ€." UserInfo={NSFilePath=/var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-5C31ED0E-6EED-4219-B72B-46E6C08A8C6E/Users/tester/.config/keypath, NSURL=file:///var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-5C31ED0E-6EED-4219-B72B-46E6C08A8C6E/Users/tester/.config/keypath, NSUnderlyingError=0x76c969860 {Error Domain=NSPOSIXErrorDomain Code=13 "Permission denied"}}
[2025-11-22 13:37:18.996] [INFO] [LaunchDaemonInstaller.swift:232 getKanataBinaryPath()] âŒ [LaunchDaemon] Bundled Kanata binary not found at: /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata
[2025-11-22 13:37:18.997] [INFO] [LaunchDaemonInstaller.swift:233 getKanataBinaryPath()] ğŸ’¡ [LaunchDaemon] User may need to reinstall Kanata components before proceeding
[2025-11-22 13:37:18.997] [INFO] [LaunchDaemonInstaller.swift:2689 buildKanataPlistArguments(binaryPath:)] ğŸ“¡ [LaunchDaemon] TCP server enabled on port 45000
[2025-11-22 13:37:18.997] [INFO] [LaunchDaemonInstaller.swift:2705 buildKanataPlistArguments(binaryPath:)] ğŸ”§ [LaunchDaemon] Built plist arguments: /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata --cfg /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-5C31ED0E-6EED-4219-B72B-46E6C08A8C6E/Users/tester/.config/keypath/keypath.kbd --port 45000 --debug --log-layer-changes
[2025-11-22 13:37:18.997] [INFO] [LaunchDaemonInstaller.swift:361 createAllLaunchDaemonServices()] ğŸ§ª [LaunchDaemon] Test mode without auth-script override â€“ using local installer path
[2025-11-22 13:37:18.997] [INFO] [LaunchDaemonInstaller.swift:1089 executeAllWithAdminPrivileges(kanataTemp:vhidDaemonTemp:vhidManagerTemp:)] ğŸ”§ [LaunchDaemon] Requesting admin privileges to install all services
[2025-11-22 13:37:18.998] [INFO] [LaunchDaemonInstaller.swift:1104 executeAllWithAdminPrivileges(kanataTemp:vhidDaemonTemp:vhidManagerTemp:)] âœ… [LaunchDaemon] (test) Installed all plists to /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-5C31ED0E-6EED-4219-B72B-46E6C08A8C6E/Library/LaunchDaemons
Test Case '-[KeyPathTests.InstallerEngineFunctionalTests testInstallerLogsPermissionDeniedWhenConfigDirectoryCannotBeCreated]' passed (0.110 seconds).
Test Case '-[KeyPathTests.InstallerEngineFunctionalTests testInstallOnlyAttemptsKanataInstallWhenUninstalled]' started.
[2025-11-22 13:37:19.106] [INFO] [LaunchDaemonInstaller.swift:1869 createAllLaunchDaemonServicesInstallOnly()] ğŸ”§ [LaunchDaemon] Installing service files only (no load/start)...
[2025-11-22 13:37:19.106] [INFO] [ConfigurationService.swift:483 createInitialConfigIfNeeded()] âœ… [ConfigService] Config directory created at /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-FD677881-59A6-4ED2-A439-0176D3FD10E8/Users/tester/.config/keypath
[2025-11-22 13:37:19.106] [INFO] [ConfigurationService.swift:488 createInitialConfigIfNeeded()] âš ï¸ [ConfigService] No existing config found at /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-FD677881-59A6-4ED2-A439-0176D3FD10E8/Users/tester/.config/keypath/keypath.kbd
[2025-11-22 13:37:19.107] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:37:19.107] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:37:19.107] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 725 characters
[2025-11-22 13:37:19.107] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:37:19.107] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 10 src keys, 10 layer keys, deduplicated to 10 unique mappings
[2025-11-22 13:37:19.107] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:37:19.107] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:37:19.107] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 0 mappings
[2025-11-22 13:37:19.107] [INFO] [ConfigurationService.swift:492 createInitialConfigIfNeeded()] âœ… [ConfigService] Created initial empty configuration
[2025-11-22 13:37:19.107] [INFO] [LaunchDaemonInstaller.swift:945 ensureDefaultUserConfigExists()] âœ… [LaunchDaemon] Created default user config at /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-FD677881-59A6-4ED2-A439-0176D3FD10E8/Users/tester/.config/keypath/keypath.kbd
[2025-11-22 13:37:19.107] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:37:19.107] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:37:19.107] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 0 (SMAppServiceStatus(rawValue: 0))
[2025-11-22 13:37:19.107] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:37:19.107] [INFO] [LaunchDaemonInstaller.swift:1875 createAllLaunchDaemonServicesInstallOnly()] ğŸ” [LaunchDaemon] Current state: Uninstalled
[2025-11-22 13:37:19.175] [INFO] [LaunchDaemonInstaller.swift:1884 createAllLaunchDaemonServicesInstallOnly()] ğŸ” [LaunchDaemon] Install-only check: state=Uninstalled, shouldSkipKanata=false
[2025-11-22 13:37:19.175] [INFO] [LaunchDaemonInstaller.swift:412 createKanataLaunchDaemon()] ğŸ”§ [LaunchDaemon] Creating Kanata LaunchDaemon service via SMAppService
[2025-11-22 13:37:19.175] [INFO] [LaunchDaemonInstaller.swift:420 createKanataLaunchDaemonViaSMAppService()] ğŸ“± [LaunchDaemon] Registering Kanata daemon via SMAppService
[2025-11-22 13:37:19.175] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:37:19.175] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:37:19.175] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 0 (SMAppServiceStatus(rawValue: 0))
[2025-11-22 13:37:19.175] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:37:19.175] [INFO] [LaunchDaemonInstaller.swift:429 createKanataLaunchDaemonViaSMAppService()] ğŸ” [LaunchDaemon] Current state: Uninstalled
[2025-11-22 13:37:19.175] [INFO] [LaunchDaemonInstaller.swift:461 createKanataLaunchDaemonViaSMAppService()] ğŸ”§ [LaunchDaemon] Calling KanataDaemonManager.shared.register()...
[2025-11-22 13:37:19.175] [INFO] [KanataDaemonManager.swift:45 init()] ğŸ”§ [KanataDaemonManager] Initialized
[2025-11-22 13:37:19.175] [INFO] [KanataDaemonManager.swift:323 register()] ğŸ”§ [KanataDaemonManager] *** ENTRY POINT *** Registering Kanata daemon via SMAppService
[2025-11-22 13:37:19.175] [INFO] [KanataDaemonManager.swift:325 register()] ğŸ” [KanataDaemonManager] macOS version check: Version 26.0.1 (Build 25A362)
[2025-11-22 13:37:19.175] [INFO] [KanataDaemonManager.swift:332 register()] âœ… [KanataDaemonManager] macOS version OK for SMAppService
[2025-11-22 13:37:19.175] [INFO] [KanataDaemonManager.swift:335 register()] ğŸ§ª [KanataDaemonManager] Test mode detected â€“ bypassing bundle validation
[2025-11-22 13:37:19.175] [INFO] [KanataDaemonManager.swift:339 register()] âœ… [KanataDaemonManager] Test registration completed
[2025-11-22 13:37:19.175] [INFO] [LaunchDaemonInstaller.swift:463 createKanataLaunchDaemonViaSMAppService()] âœ… [LaunchDaemon] Kanata daemon registered via SMAppService - SUCCESS
[2025-11-22 13:37:19.175] [INFO] [LaunchDaemonInstaller.swift:479 createVHIDDaemonService()] ğŸ”§ [LaunchDaemon] Creating VHIDDevice Daemon LaunchDaemon service
[2025-11-22 13:37:19.175] [INFO] [LaunchDaemonInstaller.swift:954 installPlist(content:path:serviceID:)] ğŸ”§ [LaunchDaemon] Installing plist: /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-FD677881-59A6-4ED2-A439-0176D3FD10E8/Library/LaunchDaemons/com.keypath.karabiner-vhiddaemon.plist
[2025-11-22 13:37:19.176] [INFO] [LaunchDaemonInstaller.swift:489 createVHIDManagerService()] ğŸ”§ [LaunchDaemon] Creating VHIDDevice Manager LaunchDaemon service
[2025-11-22 13:37:19.176] [INFO] [LaunchDaemonInstaller.swift:954 installPlist(content:path:serviceID:)] ğŸ”§ [LaunchDaemon] Installing plist: /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-FD677881-59A6-4ED2-A439-0176D3FD10E8/Library/LaunchDaemons/com.keypath.karabiner-vhidmanager.plist
[2025-11-22 13:37:19.177] [INFO] [LaunchDaemonInstaller.swift:1902 createAllLaunchDaemonServicesInstallOnly()] ğŸ”§ [LaunchDaemon] Install-only result: kanata=true, vhidDaemon=true, vhidManager=true, overall=true
Test Case '-[KeyPathTests.InstallerEngineFunctionalTests testInstallOnlyAttemptsKanataInstallWhenUninstalled]' passed (0.073 seconds).
Test Case '-[KeyPathTests.InstallerEngineFunctionalTests testInstallOnlyLogsSkipWhenSMAppServiceActive]' started.
[2025-11-22 13:37:19.179] [INFO] [LaunchDaemonInstaller.swift:1869 createAllLaunchDaemonServicesInstallOnly()] ğŸ”§ [LaunchDaemon] Installing service files only (no load/start)...
[2025-11-22 13:37:19.179] [INFO] [ConfigurationService.swift:483 createInitialConfigIfNeeded()] âœ… [ConfigService] Config directory created at /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-31829832-FBB6-4116-A872-D7115C8790BD/Users/tester/.config/keypath
[2025-11-22 13:37:19.179] [INFO] [ConfigurationService.swift:488 createInitialConfigIfNeeded()] âš ï¸ [ConfigService] No existing config found at /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-31829832-FBB6-4116-A872-D7115C8790BD/Users/tester/.config/keypath/keypath.kbd
[2025-11-22 13:37:19.179] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:37:19.179] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:37:19.180] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 725 characters
[2025-11-22 13:37:19.180] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:37:19.180] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 10 src keys, 10 layer keys, deduplicated to 10 unique mappings
[2025-11-22 13:37:19.180] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:37:19.180] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:37:19.180] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 0 mappings
[2025-11-22 13:37:19.180] [INFO] [ConfigurationService.swift:492 createInitialConfigIfNeeded()] âœ… [ConfigService] Created initial empty configuration
[2025-11-22 13:37:19.180] [INFO] [LaunchDaemonInstaller.swift:945 ensureDefaultUserConfigExists()] âœ… [LaunchDaemon] Created default user config at /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-31829832-FBB6-4116-A872-D7115C8790BD/Users/tester/.config/keypath/keypath.kbd
[2025-11-22 13:37:19.180] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:37:19.180] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:37:19.180] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 1 (SMAppServiceStatus(rawValue: 1))
[2025-11-22 13:37:19.180] [INFO] [KanataDaemonManager.swift:126 determineServiceManagementState()] âœ… [KanataDaemonManager] State: SMAPPSERVICE_ACTIVE
[2025-11-22 13:37:19.180] [INFO] [LaunchDaemonInstaller.swift:1875 createAllLaunchDaemonServicesInstallOnly()] ğŸ” [LaunchDaemon] Current state: SMAppService (active)
[2025-11-22 13:37:19.247] [INFO] [LaunchDaemonInstaller.swift:1884 createAllLaunchDaemonServicesInstallOnly()] ğŸ” [LaunchDaemon] Install-only check: state=SMAppService (active), shouldSkipKanata=true
[2025-11-22 13:37:19.247] [INFO] [LaunchDaemonInstaller.swift:1891 createAllLaunchDaemonServicesInstallOnly()] âš ï¸ [LaunchDaemon] Skipping Kanata installation - SMAppService is active or migrated (state: SMAppService (active))
[2025-11-22 13:37:19.247] [INFO] [LaunchDaemonInstaller.swift:479 createVHIDDaemonService()] ğŸ”§ [LaunchDaemon] Creating VHIDDevice Daemon LaunchDaemon service
[2025-11-22 13:37:19.247] [INFO] [LaunchDaemonInstaller.swift:954 installPlist(content:path:serviceID:)] ğŸ”§ [LaunchDaemon] Installing plist: /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-31829832-FBB6-4116-A872-D7115C8790BD/Library/LaunchDaemons/com.keypath.karabiner-vhiddaemon.plist
[2025-11-22 13:37:19.248] [INFO] [LaunchDaemonInstaller.swift:489 createVHIDManagerService()] ğŸ”§ [LaunchDaemon] Creating VHIDDevice Manager LaunchDaemon service
[2025-11-22 13:37:19.248] [INFO] [LaunchDaemonInstaller.swift:954 installPlist(content:path:serviceID:)] ğŸ”§ [LaunchDaemon] Installing plist: /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-31829832-FBB6-4116-A872-D7115C8790BD/Library/LaunchDaemons/com.keypath.karabiner-vhidmanager.plist
[2025-11-22 13:37:19.249] [INFO] [LaunchDaemonInstaller.swift:1902 createAllLaunchDaemonServicesInstallOnly()] ğŸ”§ [LaunchDaemon] Install-only result: kanata=true, vhidDaemon=true, vhidManager=true, overall=true
Test Case '-[KeyPathTests.InstallerEngineFunctionalTests testInstallOnlyLogsSkipWhenSMAppServiceActive]' passed (0.074 seconds).
Test Case '-[KeyPathTests.InstallerEngineFunctionalTests testInstallOnlySkipsKanataWhenSMAppServiceActive]' started.
[2025-11-22 13:37:19.256] [INFO] [LaunchDaemonInstaller.swift:1869 createAllLaunchDaemonServicesInstallOnly()] ğŸ”§ [LaunchDaemon] Installing service files only (no load/start)...
[2025-11-22 13:37:19.257] [INFO] [ConfigurationService.swift:483 createInitialConfigIfNeeded()] âœ… [ConfigService] Config directory created at /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-457209B1-89F6-4F13-9C5A-CB9ABBD75ED2/Users/tester/.config/keypath
[2025-11-22 13:37:19.257] [INFO] [ConfigurationService.swift:488 createInitialConfigIfNeeded()] âš ï¸ [ConfigService] No existing config found at /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-457209B1-89F6-4F13-9C5A-CB9ABBD75ED2/Users/tester/.config/keypath/keypath.kbd
[2025-11-22 13:37:19.257] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:37:19.257] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:37:19.257] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 725 characters
[2025-11-22 13:37:19.257] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:37:19.257] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 10 src keys, 10 layer keys, deduplicated to 10 unique mappings
[2025-11-22 13:37:19.257] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:37:19.257] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:37:19.257] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 0 mappings
[2025-11-22 13:37:19.257] [INFO] [ConfigurationService.swift:492 createInitialConfigIfNeeded()] âœ… [ConfigService] Created initial empty configuration
[2025-11-22 13:37:19.257] [INFO] [LaunchDaemonInstaller.swift:945 ensureDefaultUserConfigExists()] âœ… [LaunchDaemon] Created default user config at /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-457209B1-89F6-4F13-9C5A-CB9ABBD75ED2/Users/tester/.config/keypath/keypath.kbd
[2025-11-22 13:37:19.257] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:37:19.257] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:37:19.257] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 1 (SMAppServiceStatus(rawValue: 1))
[2025-11-22 13:37:19.257] [INFO] [KanataDaemonManager.swift:126 determineServiceManagementState()] âœ… [KanataDaemonManager] State: SMAPPSERVICE_ACTIVE
[2025-11-22 13:37:19.257] [INFO] [LaunchDaemonInstaller.swift:1875 createAllLaunchDaemonServicesInstallOnly()] ğŸ” [LaunchDaemon] Current state: SMAppService (active)
[2025-11-22 13:37:19.325] [INFO] [LaunchDaemonInstaller.swift:1884 createAllLaunchDaemonServicesInstallOnly()] ğŸ” [LaunchDaemon] Install-only check: state=SMAppService (active), shouldSkipKanata=true
[2025-11-22 13:37:19.325] [INFO] [LaunchDaemonInstaller.swift:1891 createAllLaunchDaemonServicesInstallOnly()] âš ï¸ [LaunchDaemon] Skipping Kanata installation - SMAppService is active or migrated (state: SMAppService (active))
[2025-11-22 13:37:19.325] [INFO] [LaunchDaemonInstaller.swift:479 createVHIDDaemonService()] ğŸ”§ [LaunchDaemon] Creating VHIDDevice Daemon LaunchDaemon service
[2025-11-22 13:37:19.325] [INFO] [LaunchDaemonInstaller.swift:954 installPlist(content:path:serviceID:)] ğŸ”§ [LaunchDaemon] Installing plist: /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-457209B1-89F6-4F13-9C5A-CB9ABBD75ED2/Library/LaunchDaemons/com.keypath.karabiner-vhiddaemon.plist
[2025-11-22 13:37:19.326] [INFO] [LaunchDaemonInstaller.swift:489 createVHIDManagerService()] ğŸ”§ [LaunchDaemon] Creating VHIDDevice Manager LaunchDaemon service
[2025-11-22 13:37:19.326] [INFO] [LaunchDaemonInstaller.swift:954 installPlist(content:path:serviceID:)] ğŸ”§ [LaunchDaemon] Installing plist: /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-457209B1-89F6-4F13-9C5A-CB9ABBD75ED2/Library/LaunchDaemons/com.keypath.karabiner-vhidmanager.plist
[2025-11-22 13:37:19.326] [INFO] [LaunchDaemonInstaller.swift:1902 createAllLaunchDaemonServicesInstallOnly()] ğŸ”§ [LaunchDaemon] Install-only result: kanata=true, vhidDaemon=true, vhidManager=true, overall=true
Test Case '-[KeyPathTests.InstallerEngineFunctionalTests testInstallOnlySkipsKanataWhenSMAppServiceActive]' passed (0.076 seconds).
Test Case '-[KeyPathTests.InstallerEngineFunctionalTests testKanataPlistInstalledReflectsFilesystem]' started.
[2025-11-22 13:37:19.329] [INFO] [LaunchDaemonInstaller.swift:312 createAllLaunchDaemonServices()] ğŸ”§ [LaunchDaemon] Creating all LaunchDaemon services
[2025-11-22 13:37:19.329] [INFO] [ConfigurationService.swift:483 createInitialConfigIfNeeded()] âœ… [ConfigService] Config directory created at /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-6615C7AB-1F64-4247-AE71-AB7690ACA7EB/Users/tester/.config/keypath
[2025-11-22 13:37:19.330] [INFO] [ConfigurationService.swift:488 createInitialConfigIfNeeded()] âš ï¸ [ConfigService] No existing config found at /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-6615C7AB-1F64-4247-AE71-AB7690ACA7EB/Users/tester/.config/keypath/keypath.kbd
[2025-11-22 13:37:19.330] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:37:19.330] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:37:19.330] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 725 characters
[2025-11-22 13:37:19.330] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:37:19.330] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 10 src keys, 10 layer keys, deduplicated to 10 unique mappings
[2025-11-22 13:37:19.330] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:37:19.330] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:37:19.330] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 0 mappings
[2025-11-22 13:37:19.330] [INFO] [ConfigurationService.swift:492 createInitialConfigIfNeeded()] âœ… [ConfigService] Created initial empty configuration
[2025-11-22 13:37:19.330] [INFO] [LaunchDaemonInstaller.swift:945 ensureDefaultUserConfigExists()] âœ… [LaunchDaemon] Created default user config at /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-6615C7AB-1F64-4247-AE71-AB7690ACA7EB/Users/tester/.config/keypath/keypath.kbd
[2025-11-22 13:37:19.330] [INFO] [LaunchDaemonInstaller.swift:232 getKanataBinaryPath()] âŒ [LaunchDaemon] Bundled Kanata binary not found at: /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata
[2025-11-22 13:37:19.330] [INFO] [LaunchDaemonInstaller.swift:233 getKanataBinaryPath()] ğŸ’¡ [LaunchDaemon] User may need to reinstall Kanata components before proceeding
[2025-11-22 13:37:19.330] [INFO] [LaunchDaemonInstaller.swift:2689 buildKanataPlistArguments(binaryPath:)] ğŸ“¡ [LaunchDaemon] TCP server enabled on port 45000
[2025-11-22 13:37:19.330] [INFO] [LaunchDaemonInstaller.swift:2705 buildKanataPlistArguments(binaryPath:)] ğŸ”§ [LaunchDaemon] Built plist arguments: /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata --cfg /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-6615C7AB-1F64-4247-AE71-AB7690ACA7EB/Users/tester/.config/keypath/keypath.kbd --port 45000 --debug --log-layer-changes
[2025-11-22 13:37:19.331] [INFO] [LaunchDaemonInstaller.swift:361 createAllLaunchDaemonServices()] ğŸ§ª [LaunchDaemon] Test mode without auth-script override â€“ using local installer path
[2025-11-22 13:37:19.331] [INFO] [LaunchDaemonInstaller.swift:1089 executeAllWithAdminPrivileges(kanataTemp:vhidDaemonTemp:vhidManagerTemp:)] ğŸ”§ [LaunchDaemon] Requesting admin privileges to install all services
[2025-11-22 13:37:19.332] [INFO] [LaunchDaemonInstaller.swift:1104 executeAllWithAdminPrivileges(kanataTemp:vhidDaemonTemp:vhidManagerTemp:)] âœ… [LaunchDaemon] (test) Installed all plists to /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-6615C7AB-1F64-4247-AE71-AB7690ACA7EB/Library/LaunchDaemons
Test Case '-[KeyPathTests.InstallerEngineFunctionalTests testKanataPlistInstalledReflectsFilesystem]' passed (0.006 seconds).
Test Case '-[KeyPathTests.InstallerEngineFunctionalTests testKanataPlistMigrationExpandsTildePath]' started.
[2025-11-22 13:37:19.335] [INFO] [LaunchDaemonInstaller.swift:312 createAllLaunchDaemonServices()] ğŸ”§ [LaunchDaemon] Creating all LaunchDaemon services
[2025-11-22 13:37:19.335] [INFO] [ConfigurationService.swift:483 createInitialConfigIfNeeded()] âœ… [ConfigService] Config directory created at /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-2004C2A8-8256-4503-9401-6DED0DA0205B/Users/tester/.config/keypath
[2025-11-22 13:37:19.335] [INFO] [ConfigurationService.swift:488 createInitialConfigIfNeeded()] âš ï¸ [ConfigService] No existing config found at /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-2004C2A8-8256-4503-9401-6DED0DA0205B/Users/tester/.config/keypath/keypath.kbd
[2025-11-22 13:37:19.335] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:37:19.335] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:37:19.335] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 725 characters
[2025-11-22 13:37:19.335] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:37:19.335] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 10 src keys, 10 layer keys, deduplicated to 10 unique mappings
[2025-11-22 13:37:19.335] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:37:19.335] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:37:19.335] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 0 mappings
[2025-11-22 13:37:19.335] [INFO] [ConfigurationService.swift:492 createInitialConfigIfNeeded()] âœ… [ConfigService] Created initial empty configuration
[2025-11-22 13:37:19.335] [INFO] [LaunchDaemonInstaller.swift:945 ensureDefaultUserConfigExists()] âœ… [LaunchDaemon] Created default user config at /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-2004C2A8-8256-4503-9401-6DED0DA0205B/Users/tester/.config/keypath/keypath.kbd
[2025-11-22 13:37:19.336] [INFO] [LaunchDaemonInstaller.swift:232 getKanataBinaryPath()] âŒ [LaunchDaemon] Bundled Kanata binary not found at: /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata
[2025-11-22 13:37:19.336] [INFO] [LaunchDaemonInstaller.swift:233 getKanataBinaryPath()] ğŸ’¡ [LaunchDaemon] User may need to reinstall Kanata components before proceeding
[2025-11-22 13:37:19.336] [INFO] [LaunchDaemonInstaller.swift:2689 buildKanataPlistArguments(binaryPath:)] ğŸ“¡ [LaunchDaemon] TCP server enabled on port 45000
[2025-11-22 13:37:19.336] [INFO] [LaunchDaemonInstaller.swift:2705 buildKanataPlistArguments(binaryPath:)] ğŸ”§ [LaunchDaemon] Built plist arguments: /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata --cfg /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-2004C2A8-8256-4503-9401-6DED0DA0205B/Users/tester/.config/keypath/keypath.kbd --port 45000 --debug --log-layer-changes
[2025-11-22 13:37:19.337] [INFO] [LaunchDaemonInstaller.swift:361 createAllLaunchDaemonServices()] ğŸ§ª [LaunchDaemon] Test mode without auth-script override â€“ using local installer path
[2025-11-22 13:37:19.337] [INFO] [LaunchDaemonInstaller.swift:1089 executeAllWithAdminPrivileges(kanataTemp:vhidDaemonTemp:vhidManagerTemp:)] ğŸ”§ [LaunchDaemon] Requesting admin privileges to install all services
[2025-11-22 13:37:19.337] [INFO] [LaunchDaemonInstaller.swift:1104 executeAllWithAdminPrivileges(kanataTemp:vhidDaemonTemp:vhidManagerTemp:)] âœ… [LaunchDaemon] (test) Installed all plists to /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-2004C2A8-8256-4503-9401-6DED0DA0205B/Library/LaunchDaemons
[2025-11-22 13:37:19.338] [INFO] [LaunchDaemonInstaller.swift:1995 restartUnhealthyServices()] ğŸ”§ [LaunchDaemon] Starting comprehensive service health fix
[2025-11-22 13:37:19.338] [INFO] [LaunchDaemonInstaller.swift:1043 migrateKanataConfigPathIfNeeded()] ğŸ”§ [LaunchDaemon] Rewriting Kanata plist config path from '~' to /Users/malpern/test/path
[2025-11-22 13:37:19.338] [INFO] [PrivilegedOperationsCoordinator.swift:839 sudoExecuteCommand(_:description:)] ğŸ”§ [PrivCoordinator] Executing admin command: update Kanata LaunchDaemon config path
[2025-11-22 13:37:20.077] [INFO] [HelperManager.swift:248 getHelperVersion()] âš ï¸ [HelperManager] getVersion timed out - clearing connection cache
[2025-11-22 13:37:20.077] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:37:20.077] [INFO] [SystemValidator.swift:328 checkHelper()] ğŸ” [SystemValidator] Helper state: registeredButUnresponsive Helper registered but XPC communication failed
[2025-11-22 13:37:20.077] [INFO] [SystemValidator.swift:202 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 1 (Helper) completed in 6.769s
[2025-11-22 13:37:20.077] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 100% (5/5 steps)
[2025-11-22 13:37:20.077] [INFO] [SystemValidator.swift:283 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 COMPLETE: Total duration 6.769s
[2025-11-22 13:37:20.077] [INFO] [SystemValidator.swift:297 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Validation #1 complete in 6.769s
[2025-11-22 13:37:20.077] [INFO] [SystemValidator.swift:299 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Result: ready=false, blocking=9, total=9
[2025-11-22 13:37:20.077] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:37:20.077] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:37:20.077] [INFO] [SystemRequirements.swift:135 validateSystemCompatibility()] ğŸ” [SystemRequirements] Validating system compatibility
[2025-11-22 13:37:20.077] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:37:20.077] [INFO] [SystemRequirements.swift:147 validateSystemCompatibility()] âœ… [SystemRequirements] Modern macOS detected: 26.0.1
[2025-11-22 13:37:20.077] [INFO] [SystemRequirements.swift:190 validateSystemCompatibility()] ğŸ” [SystemRequirements] Compatibility check complete: âœ… Compatible
[2025-11-22 13:37:20.077] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:37:20.077] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:37:20.077] [INFO] [InstallerEngine.swift:78 inspectSystem()] âœ… [InstallerEngine] inspectSystem() complete - ready=false, blocking=9
[2025-11-22 13:37:20.077] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: repair, context:)
[2025-11-22 13:37:20.077] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: repair
[2025-11-22 13:37:20.077] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:37:20.077] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:37:20.077] [INFO] [InstallerEngine.swift:194 execute(plan:using:)] âš™ï¸ [InstallerEngine] Starting execute(plan:, using:)
[2025-11-22 13:37:20.077] [INFO] [InstallerEngine.swift:213 execute(plan:using:)] âš™ï¸ [InstallerEngine] Executing recipe: install-bundled-kanata (type: installComponent)
[2025-11-22 13:37:20.077] [INFO] [PrivilegedOperationsCoordinator.swift:359 installBundledKanata()] ğŸ” [PrivCoordinator] Installing bundled Kanata binary
[2025-11-22 13:37:20.077] [INFO] [LaunchDaemonInstaller.swift:2898 installBundledKanataBinaryOnly()] ğŸ”§ [LaunchDaemon] Installing bundled kanata binary to system location
[2025-11-22 13:37:20.077] [INFO] [LaunchDaemonInstaller.swift:2906 installBundledKanataBinaryOnly()] âŒ [LaunchDaemon] CRITICAL: Bundled kanata binary not found at: /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata
[2025-11-22 13:37:20.077] [INFO] [LaunchDaemonInstaller.swift:2908 installBundledKanataBinaryOnly()] âŒ [LaunchDaemon] This indicates a packaging issue - the app bundle is missing the kanata binary
[2025-11-22 13:37:20.078] [INFO] [InstallerEngine.swift:255 execute(plan:using:)] âŒ [InstallerEngine] Recipe install-bundled-kanata failed: Operation failed: Bundled Kanata installation failed
[2025-11-22 13:37:20.078] [INFO] [InstallerEngine.swift:274 execute(plan:using:)] âœ… [InstallerEngine] execute() complete - success: false, recipes executed: 1
[2025-11-22 13:37:20.078] [INFO] [InstallerEngine.swift:432 run(intent:using:)] âœ… [InstallerEngine] run() complete - success: false
[2025-11-22 13:37:58.250] [INFO] [PrivilegedOperationsCoordinator.swift:844 sudoExecuteCommand(_:description:)] âœ… [PrivCoordinator] Successfully executed: update Kanata LaunchDaemon config path
[2025-11-22 13:37:58.250] [INFO] [LaunchDaemonInstaller.swift:1071 migrateKanataConfigPathIfNeeded()] âœ… [LaunchDaemon] Kanata plist config path migrated to /Users/malpern/test/path
[2025-11-22 13:37:58.250] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:37:58.250] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: true
[2025-11-22 13:37:58.250] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 0 (SMAppServiceStatus(rawValue: 0))
[2025-11-22 13:37:58.250] [INFO] [KanataDaemonManager.swift:119 determineServiceManagementState()] âœ… [KanataDaemonManager] State: LEGACY_ACTIVE (plist exists)
[2025-11-22 13:37:58.251] [INFO] [LaunchDaemonInstaller.swift:664 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (test) Kanata service loaded via file existence: true
[2025-11-22 13:37:58.251] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:37:58.251] [INFO] [LaunchDaemonInstaller.swift:740 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] (test) Service com.keypath.kanata considered healthy: true
[2025-11-22 13:37:58.251] [INFO] [LaunchDaemonInstaller.swift:704 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (test) Service com.keypath.karabiner-vhiddaemon considered loaded: true
[2025-11-22 13:37:58.251] [INFO] [LaunchDaemonInstaller.swift:704 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (test) Service com.keypath.karabiner-vhidmanager considered loaded: true
[2025-11-22 13:37:58.251] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:37:58.251] [INFO] [LaunchDaemonInstaller.swift:740 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] (test) Service com.keypath.karabiner-vhiddaemon considered healthy: true
[2025-11-22 13:37:58.251] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhidmanager
[2025-11-22 13:37:58.251] [INFO] [LaunchDaemonInstaller.swift:740 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] (test) Service com.keypath.karabiner-vhidmanager considered healthy: true
[2025-11-22 13:37:58.251] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:37:58.251] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: true
[2025-11-22 13:37:58.252] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 0 (SMAppServiceStatus(rawValue: 0))
[2025-11-22 13:37:58.252] [INFO] [KanataDaemonManager.swift:119 determineServiceManagementState()] âœ… [KanataDaemonManager] State: LEGACY_ACTIVE (plist exists)
[2025-11-22 13:37:58.252] [INFO] [LaunchDaemonInstaller.swift:2030 restartUnhealthyServices()] ğŸ” [LaunchDaemon] Current state: Legacy launchctl
[2025-11-22 13:37:58.252] [INFO] [LaunchDaemonInstaller.swift:2034 restartUnhealthyServices()] ğŸ”„ [LaunchDaemon] Legacy plist detected - auto-resolving by removing legacy
[2025-11-22 13:37:58.252] [INFO] [PrivilegedOperationsCoordinator.swift:839 sudoExecuteCommand(_:description:)] ğŸ”§ [PrivCoordinator] Executing admin command: Remove legacy plist
[2025-11-22 13:38:08.953] [INFO] [PrivilegedOperationsCoordinator.swift:844 sudoExecuteCommand(_:description:)] âœ… [PrivCoordinator] Successfully executed: Remove legacy plist
[2025-11-22 13:38:08.953] [INFO] [LaunchDaemonInstaller.swift:2046 restartUnhealthyServices()] âœ… [LaunchDaemon] Legacy plist removed
[2025-11-22 13:38:08.953] [INFO] [LaunchDaemonInstaller.swift:2134 restartUnhealthyServices()] ğŸ” [LaunchDaemon] Installation check: needsInstallation=false
[2025-11-22 13:38:08.953] [INFO] [LaunchDaemonInstaller.swift:2136 restartUnhealthyServices()] ğŸ” [LaunchDaemon] Services to install after state check: []
[2025-11-22 13:38:08.953] [INFO] [LaunchDaemonInstaller.swift:2153 restartUnhealthyServices()] ğŸ” [LaunchDaemon] No installation/migration needed - services using correct method
[2025-11-22 13:38:08.953] [INFO] [LaunchDaemonInstaller.swift:2159 restartUnhealthyServices()] ğŸ” [LaunchDaemon] No unhealthy services found to restart
Test Case '-[KeyPathTests.InstallerEngineFunctionalTests testKanataPlistMigrationExpandsTildePath]' passed (49.622 seconds).
Test Case '-[KeyPathTests.InstallerEngineFunctionalTests testLoadServicesFailsWhenServiceDefinitionMissing]' started.
[2025-11-22 13:38:08.959] [INFO] [LaunchDaemonInstaller.swift:312 createAllLaunchDaemonServices()] ğŸ”§ [LaunchDaemon] Creating all LaunchDaemon services
[2025-11-22 13:38:08.959] [INFO] [ConfigurationService.swift:483 createInitialConfigIfNeeded()] âœ… [ConfigService] Config directory created at /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-5E0A8C41-1AF3-42F2-BCE7-8ABD74163EFD/Users/tester/.config/keypath
[2025-11-22 13:38:08.959] [INFO] [ConfigurationService.swift:488 createInitialConfigIfNeeded()] âš ï¸ [ConfigService] No existing config found at /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-5E0A8C41-1AF3-42F2-BCE7-8ABD74163EFD/Users/tester/.config/keypath/keypath.kbd
[2025-11-22 13:38:08.959] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:38:08.959] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:38:08.959] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 725 characters
[2025-11-22 13:38:08.959] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:38:08.959] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 10 src keys, 10 layer keys, deduplicated to 10 unique mappings
[2025-11-22 13:38:08.959] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:38:08.959] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:38:08.960] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 0 mappings
[2025-11-22 13:38:08.960] [INFO] [ConfigurationService.swift:492 createInitialConfigIfNeeded()] âœ… [ConfigService] Created initial empty configuration
[2025-11-22 13:38:08.960] [INFO] [LaunchDaemonInstaller.swift:945 ensureDefaultUserConfigExists()] âœ… [LaunchDaemon] Created default user config at /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-5E0A8C41-1AF3-42F2-BCE7-8ABD74163EFD/Users/tester/.config/keypath/keypath.kbd
[2025-11-22 13:38:08.960] [INFO] [LaunchDaemonInstaller.swift:232 getKanataBinaryPath()] âŒ [LaunchDaemon] Bundled Kanata binary not found at: /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata
[2025-11-22 13:38:08.960] [INFO] [LaunchDaemonInstaller.swift:233 getKanataBinaryPath()] ğŸ’¡ [LaunchDaemon] User may need to reinstall Kanata components before proceeding
[2025-11-22 13:38:08.960] [INFO] [LaunchDaemonInstaller.swift:2689 buildKanataPlistArguments(binaryPath:)] ğŸ“¡ [LaunchDaemon] TCP server enabled on port 45000
[2025-11-22 13:38:08.960] [INFO] [LaunchDaemonInstaller.swift:2705 buildKanataPlistArguments(binaryPath:)] ğŸ”§ [LaunchDaemon] Built plist arguments: /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata --cfg /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-5E0A8C41-1AF3-42F2-BCE7-8ABD74163EFD/Users/tester/.config/keypath/keypath.kbd --port 45000 --debug --log-layer-changes
[2025-11-22 13:38:08.962] [INFO] [LaunchDaemonInstaller.swift:361 createAllLaunchDaemonServices()] ğŸ§ª [LaunchDaemon] Test mode without auth-script override â€“ using local installer path
[2025-11-22 13:38:08.962] [INFO] [LaunchDaemonInstaller.swift:1089 executeAllWithAdminPrivileges(kanataTemp:vhidDaemonTemp:vhidManagerTemp:)] ğŸ”§ [LaunchDaemon] Requesting admin privileges to install all services
[2025-11-22 13:38:08.963] [INFO] [LaunchDaemonInstaller.swift:1104 executeAllWithAdminPrivileges(kanataTemp:vhidDaemonTemp:vhidManagerTemp:)] âœ… [LaunchDaemon] (test) Installed all plists to /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-5E0A8C41-1AF3-42F2-BCE7-8ABD74163EFD/Library/LaunchDaemons
[2025-11-22 13:38:08.963] [INFO] [LaunchDaemonInstaller.swift:566 loadServices()] ğŸ”§ [LaunchDaemon] Loading all KeyPath LaunchDaemon services
[2025-11-22 13:38:08.963] [INFO] [LaunchDaemonInstaller.swift:586 loadService(serviceID:)] ğŸ”§ [LaunchDaemon] Loading service: com.keypath.kanata
[2025-11-22 13:38:08.963] [INFO] [LaunchDaemonInstaller.swift:575 loadServices()] âŒ [LaunchDaemon] Failed to load service: com.keypath.kanata
[2025-11-22 13:38:08.963] [INFO] [LaunchDaemonInstaller.swift:586 loadService(serviceID:)] ğŸ”§ [LaunchDaemon] Loading service: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:38:08.963] [INFO] [LaunchDaemonInstaller.swift:586 loadService(serviceID:)] ğŸ”§ [LaunchDaemon] Loading service: com.keypath.karabiner-vhidmanager
[2025-11-22 13:38:08.963] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:38:08.963] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:38:08.963] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 0 (SMAppServiceStatus(rawValue: 0))
[2025-11-22 13:38:08.963] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:38:08.964] [INFO] [LaunchDaemonInstaller.swift:664 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (test) Kanata service loaded via file existence: false
[2025-11-22 13:38:08.964] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:38:08.964] [INFO] [LaunchDaemonInstaller.swift:740 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] (test) Service com.keypath.kanata considered healthy: false
[2025-11-22 13:38:08.964] [INFO] [LaunchDaemonInstaller.swift:704 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (test) Service com.keypath.karabiner-vhiddaemon considered loaded: true
[2025-11-22 13:38:08.964] [INFO] [LaunchDaemonInstaller.swift:704 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (test) Service com.keypath.karabiner-vhidmanager considered loaded: true
[2025-11-22 13:38:08.964] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:38:08.964] [INFO] [LaunchDaemonInstaller.swift:740 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] (test) Service com.keypath.karabiner-vhiddaemon considered healthy: true
[2025-11-22 13:38:08.964] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhidmanager
[2025-11-22 13:38:08.964] [INFO] [LaunchDaemonInstaller.swift:740 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] (test) Service com.keypath.karabiner-vhidmanager considered healthy: true
Test Case '-[KeyPathTests.InstallerEngineFunctionalTests testLoadServicesFailsWhenServiceDefinitionMissing]' passed (0.013 seconds).
Test Case '-[KeyPathTests.InstallerEngineFunctionalTests testMissingKanataServiceTriggersReinstall]' started.
[2025-11-22 13:38:08.970] [INFO] [LaunchDaemonInstaller.swift:312 createAllLaunchDaemonServices()] ğŸ”§ [LaunchDaemon] Creating all LaunchDaemon services
[2025-11-22 13:38:08.970] [INFO] [ConfigurationService.swift:483 createInitialConfigIfNeeded()] âœ… [ConfigService] Config directory created at /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-A9B9748D-8610-4809-9129-8BDC11E14A89/Users/tester/.config/keypath
[2025-11-22 13:38:08.970] [INFO] [ConfigurationService.swift:488 createInitialConfigIfNeeded()] âš ï¸ [ConfigService] No existing config found at /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-A9B9748D-8610-4809-9129-8BDC11E14A89/Users/tester/.config/keypath/keypath.kbd
[2025-11-22 13:38:08.971] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:38:08.971] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:38:08.971] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 725 characters
[2025-11-22 13:38:08.971] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:38:08.971] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 10 src keys, 10 layer keys, deduplicated to 10 unique mappings
[2025-11-22 13:38:08.971] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:38:08.971] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:38:08.971] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 0 mappings
[2025-11-22 13:38:08.971] [INFO] [ConfigurationService.swift:492 createInitialConfigIfNeeded()] âœ… [ConfigService] Created initial empty configuration
[2025-11-22 13:38:08.971] [INFO] [LaunchDaemonInstaller.swift:945 ensureDefaultUserConfigExists()] âœ… [LaunchDaemon] Created default user config at /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-A9B9748D-8610-4809-9129-8BDC11E14A89/Users/tester/.config/keypath/keypath.kbd
[2025-11-22 13:38:08.971] [INFO] [LaunchDaemonInstaller.swift:232 getKanataBinaryPath()] âŒ [LaunchDaemon] Bundled Kanata binary not found at: /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata
[2025-11-22 13:38:08.971] [INFO] [LaunchDaemonInstaller.swift:233 getKanataBinaryPath()] ğŸ’¡ [LaunchDaemon] User may need to reinstall Kanata components before proceeding
[2025-11-22 13:38:08.971] [INFO] [LaunchDaemonInstaller.swift:2689 buildKanataPlistArguments(binaryPath:)] ğŸ“¡ [LaunchDaemon] TCP server enabled on port 45000
[2025-11-22 13:38:08.971] [INFO] [LaunchDaemonInstaller.swift:2705 buildKanataPlistArguments(binaryPath:)] ğŸ”§ [LaunchDaemon] Built plist arguments: /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata --cfg /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-A9B9748D-8610-4809-9129-8BDC11E14A89/Users/tester/.config/keypath/keypath.kbd --port 45000 --debug --log-layer-changes
[2025-11-22 13:38:08.972] [INFO] [LaunchDaemonInstaller.swift:361 createAllLaunchDaemonServices()] ğŸ§ª [LaunchDaemon] Test mode without auth-script override â€“ using local installer path
[2025-11-22 13:38:08.972] [INFO] [LaunchDaemonInstaller.swift:1089 executeAllWithAdminPrivileges(kanataTemp:vhidDaemonTemp:vhidManagerTemp:)] ğŸ”§ [LaunchDaemon] Requesting admin privileges to install all services
[2025-11-22 13:38:08.973] [INFO] [LaunchDaemonInstaller.swift:1104 executeAllWithAdminPrivileges(kanataTemp:vhidDaemonTemp:vhidManagerTemp:)] âœ… [LaunchDaemon] (test) Installed all plists to /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-A9B9748D-8610-4809-9129-8BDC11E14A89/Library/LaunchDaemons
[2025-11-22 13:38:08.973] [INFO] [LaunchDaemonInstaller.swift:312 createAllLaunchDaemonServices()] ğŸ”§ [LaunchDaemon] Creating all LaunchDaemon services
[2025-11-22 13:38:08.973] [INFO] [LaunchDaemonInstaller.swift:232 getKanataBinaryPath()] âŒ [LaunchDaemon] Bundled Kanata binary not found at: /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata
[2025-11-22 13:38:08.973] [INFO] [LaunchDaemonInstaller.swift:233 getKanataBinaryPath()] ğŸ’¡ [LaunchDaemon] User may need to reinstall Kanata components before proceeding
[2025-11-22 13:38:08.973] [INFO] [LaunchDaemonInstaller.swift:2689 buildKanataPlistArguments(binaryPath:)] ğŸ“¡ [LaunchDaemon] TCP server enabled on port 45000
[2025-11-22 13:38:08.973] [INFO] [LaunchDaemonInstaller.swift:2705 buildKanataPlistArguments(binaryPath:)] ğŸ”§ [LaunchDaemon] Built plist arguments: /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata --cfg /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-A9B9748D-8610-4809-9129-8BDC11E14A89/Users/tester/.config/keypath/keypath.kbd --port 45000 --debug --log-layer-changes
[2025-11-22 13:38:08.974] [INFO] [LaunchDaemonInstaller.swift:361 createAllLaunchDaemonServices()] ğŸ§ª [LaunchDaemon] Test mode without auth-script override â€“ using local installer path
[2025-11-22 13:38:08.974] [INFO] [LaunchDaemonInstaller.swift:1089 executeAllWithAdminPrivileges(kanataTemp:vhidDaemonTemp:vhidManagerTemp:)] ğŸ”§ [LaunchDaemon] Requesting admin privileges to install all services
[2025-11-22 13:38:08.975] [INFO] [LaunchDaemonInstaller.swift:1104 executeAllWithAdminPrivileges(kanataTemp:vhidDaemonTemp:vhidManagerTemp:)] âœ… [LaunchDaemon] (test) Installed all plists to /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-A9B9748D-8610-4809-9129-8BDC11E14A89/Library/LaunchDaemons
Test Case '-[KeyPathTests.InstallerEngineFunctionalTests testMissingKanataServiceTriggersReinstall]' passed (0.007 seconds).
Test Case '-[KeyPathTests.InstallerEngineFunctionalTests testMissingVirtualHIDServiceTriggersReinstall]' started.
[2025-11-22 13:38:08.977] [INFO] [LaunchDaemonInstaller.swift:312 createAllLaunchDaemonServices()] ğŸ”§ [LaunchDaemon] Creating all LaunchDaemon services
[2025-11-22 13:38:08.977] [INFO] [ConfigurationService.swift:483 createInitialConfigIfNeeded()] âœ… [ConfigService] Config directory created at /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-71475379-6ACB-4958-9AB6-1C7F55586CE2/Users/tester/.config/keypath
[2025-11-22 13:38:08.977] [INFO] [ConfigurationService.swift:488 createInitialConfigIfNeeded()] âš ï¸ [ConfigService] No existing config found at /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-71475379-6ACB-4958-9AB6-1C7F55586CE2/Users/tester/.config/keypath/keypath.kbd
[2025-11-22 13:38:08.978] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:38:08.978] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:38:08.978] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 725 characters
[2025-11-22 13:38:08.978] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:38:08.978] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 10 src keys, 10 layer keys, deduplicated to 10 unique mappings
[2025-11-22 13:38:08.978] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:38:08.978] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:38:08.978] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 0 mappings
[2025-11-22 13:38:08.978] [INFO] [ConfigurationService.swift:492 createInitialConfigIfNeeded()] âœ… [ConfigService] Created initial empty configuration
[2025-11-22 13:38:08.978] [INFO] [LaunchDaemonInstaller.swift:945 ensureDefaultUserConfigExists()] âœ… [LaunchDaemon] Created default user config at /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-71475379-6ACB-4958-9AB6-1C7F55586CE2/Users/tester/.config/keypath/keypath.kbd
[2025-11-22 13:38:08.978] [INFO] [LaunchDaemonInstaller.swift:232 getKanataBinaryPath()] âŒ [LaunchDaemon] Bundled Kanata binary not found at: /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata
[2025-11-22 13:38:08.978] [INFO] [LaunchDaemonInstaller.swift:233 getKanataBinaryPath()] ğŸ’¡ [LaunchDaemon] User may need to reinstall Kanata components before proceeding
[2025-11-22 13:38:08.978] [INFO] [LaunchDaemonInstaller.swift:2689 buildKanataPlistArguments(binaryPath:)] ğŸ“¡ [LaunchDaemon] TCP server enabled on port 45000
[2025-11-22 13:38:08.978] [INFO] [LaunchDaemonInstaller.swift:2705 buildKanataPlistArguments(binaryPath:)] ğŸ”§ [LaunchDaemon] Built plist arguments: /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata --cfg /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-71475379-6ACB-4958-9AB6-1C7F55586CE2/Users/tester/.config/keypath/keypath.kbd --port 45000 --debug --log-layer-changes
[2025-11-22 13:38:08.979] [INFO] [LaunchDaemonInstaller.swift:361 createAllLaunchDaemonServices()] ğŸ§ª [LaunchDaemon] Test mode without auth-script override â€“ using local installer path
[2025-11-22 13:38:08.979] [INFO] [LaunchDaemonInstaller.swift:1089 executeAllWithAdminPrivileges(kanataTemp:vhidDaemonTemp:vhidManagerTemp:)] ğŸ”§ [LaunchDaemon] Requesting admin privileges to install all services
[2025-11-22 13:38:08.979] [INFO] [LaunchDaemonInstaller.swift:1104 executeAllWithAdminPrivileges(kanataTemp:vhidDaemonTemp:vhidManagerTemp:)] âœ… [LaunchDaemon] (test) Installed all plists to /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-71475379-6ACB-4958-9AB6-1C7F55586CE2/Library/LaunchDaemons
[2025-11-22 13:38:08.979] [INFO] [LaunchDaemonInstaller.swift:312 createAllLaunchDaemonServices()] ğŸ”§ [LaunchDaemon] Creating all LaunchDaemon services
[2025-11-22 13:38:08.980] [INFO] [LaunchDaemonInstaller.swift:232 getKanataBinaryPath()] âŒ [LaunchDaemon] Bundled Kanata binary not found at: /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata
[2025-11-22 13:38:08.980] [INFO] [LaunchDaemonInstaller.swift:233 getKanataBinaryPath()] ğŸ’¡ [LaunchDaemon] User may need to reinstall Kanata components before proceeding
[2025-11-22 13:38:08.980] [INFO] [LaunchDaemonInstaller.swift:2689 buildKanataPlistArguments(binaryPath:)] ğŸ“¡ [LaunchDaemon] TCP server enabled on port 45000
[2025-11-22 13:38:08.980] [INFO] [LaunchDaemonInstaller.swift:2705 buildKanataPlistArguments(binaryPath:)] ğŸ”§ [LaunchDaemon] Built plist arguments: /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata --cfg /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-71475379-6ACB-4958-9AB6-1C7F55586CE2/Users/tester/.config/keypath/keypath.kbd --port 45000 --debug --log-layer-changes
[2025-11-22 13:38:08.980] [INFO] [LaunchDaemonInstaller.swift:361 createAllLaunchDaemonServices()] ğŸ§ª [LaunchDaemon] Test mode without auth-script override â€“ using local installer path
[2025-11-22 13:38:08.980] [INFO] [LaunchDaemonInstaller.swift:1089 executeAllWithAdminPrivileges(kanataTemp:vhidDaemonTemp:vhidManagerTemp:)] ğŸ”§ [LaunchDaemon] Requesting admin privileges to install all services
[2025-11-22 13:38:08.981] [INFO] [LaunchDaemonInstaller.swift:1104 executeAllWithAdminPrivileges(kanataTemp:vhidDaemonTemp:vhidManagerTemp:)] âœ… [LaunchDaemon] (test) Installed all plists to /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-71475379-6ACB-4958-9AB6-1C7F55586CE2/Library/LaunchDaemons
Test Case '-[KeyPathTests.InstallerEngineFunctionalTests testMissingVirtualHIDServiceTriggersReinstall]' passed (0.006 seconds).
Test Case '-[KeyPathTests.InstallerEngineFunctionalTests testRepairFlowRestoresMissingVhidServices]' started.
[2025-11-22 13:38:08.983] [INFO] [LaunchDaemonInstaller.swift:312 createAllLaunchDaemonServices()] ğŸ”§ [LaunchDaemon] Creating all LaunchDaemon services
[2025-11-22 13:38:08.983] [INFO] [ConfigurationService.swift:483 createInitialConfigIfNeeded()] âœ… [ConfigService] Config directory created at /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-4549DB3B-F998-4E9E-BC3C-E607B58FF571/Users/tester/.config/keypath
[2025-11-22 13:38:08.983] [INFO] [ConfigurationService.swift:488 createInitialConfigIfNeeded()] âš ï¸ [ConfigService] No existing config found at /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-4549DB3B-F998-4E9E-BC3C-E607B58FF571/Users/tester/.config/keypath/keypath.kbd
[2025-11-22 13:38:08.983] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:38:08.983] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:38:08.983] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 725 characters
[2025-11-22 13:38:08.983] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:38:08.983] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 10 src keys, 10 layer keys, deduplicated to 10 unique mappings
[2025-11-22 13:38:08.983] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:38:08.983] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:38:08.984] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 0 mappings
[2025-11-22 13:38:08.984] [INFO] [ConfigurationService.swift:492 createInitialConfigIfNeeded()] âœ… [ConfigService] Created initial empty configuration
[2025-11-22 13:38:08.984] [INFO] [LaunchDaemonInstaller.swift:945 ensureDefaultUserConfigExists()] âœ… [LaunchDaemon] Created default user config at /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-4549DB3B-F998-4E9E-BC3C-E607B58FF571/Users/tester/.config/keypath/keypath.kbd
[2025-11-22 13:38:08.984] [INFO] [LaunchDaemonInstaller.swift:232 getKanataBinaryPath()] âŒ [LaunchDaemon] Bundled Kanata binary not found at: /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata
[2025-11-22 13:38:08.984] [INFO] [LaunchDaemonInstaller.swift:233 getKanataBinaryPath()] ğŸ’¡ [LaunchDaemon] User may need to reinstall Kanata components before proceeding
[2025-11-22 13:38:08.984] [INFO] [LaunchDaemonInstaller.swift:2689 buildKanataPlistArguments(binaryPath:)] ğŸ“¡ [LaunchDaemon] TCP server enabled on port 45000
[2025-11-22 13:38:08.984] [INFO] [LaunchDaemonInstaller.swift:2705 buildKanataPlistArguments(binaryPath:)] ğŸ”§ [LaunchDaemon] Built plist arguments: /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata --cfg /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-4549DB3B-F998-4E9E-BC3C-E607B58FF571/Users/tester/.config/keypath/keypath.kbd --port 45000 --debug --log-layer-changes
[2025-11-22 13:38:08.984] [INFO] [LaunchDaemonInstaller.swift:361 createAllLaunchDaemonServices()] ğŸ§ª [LaunchDaemon] Test mode without auth-script override â€“ using local installer path
[2025-11-22 13:38:08.984] [INFO] [LaunchDaemonInstaller.swift:1089 executeAllWithAdminPrivileges(kanataTemp:vhidDaemonTemp:vhidManagerTemp:)] ğŸ”§ [LaunchDaemon] Requesting admin privileges to install all services
[2025-11-22 13:38:08.985] [INFO] [LaunchDaemonInstaller.swift:1104 executeAllWithAdminPrivileges(kanataTemp:vhidDaemonTemp:vhidManagerTemp:)] âœ… [LaunchDaemon] (test) Installed all plists to /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-4549DB3B-F998-4E9E-BC3C-E607B58FF571/Library/LaunchDaemons
[2025-11-22 13:38:08.985] [INFO] [LaunchDaemonInstaller.swift:566 loadServices()] ğŸ”§ [LaunchDaemon] Loading all KeyPath LaunchDaemon services
[2025-11-22 13:38:08.985] [INFO] [LaunchDaemonInstaller.swift:586 loadService(serviceID:)] ğŸ”§ [LaunchDaemon] Loading service: com.keypath.kanata
[2025-11-22 13:38:08.985] [INFO] [LaunchDaemonInstaller.swift:586 loadService(serviceID:)] ğŸ”§ [LaunchDaemon] Loading service: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:38:08.985] [INFO] [LaunchDaemonInstaller.swift:586 loadService(serviceID:)] ğŸ”§ [LaunchDaemon] Loading service: com.keypath.karabiner-vhidmanager
[2025-11-22 13:38:08.986] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:38:08.986] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: true
[2025-11-22 13:38:08.986] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 0 (SMAppServiceStatus(rawValue: 0))
[2025-11-22 13:38:08.986] [INFO] [KanataDaemonManager.swift:119 determineServiceManagementState()] âœ… [KanataDaemonManager] State: LEGACY_ACTIVE (plist exists)
[2025-11-22 13:38:08.986] [INFO] [LaunchDaemonInstaller.swift:664 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (test) Kanata service loaded via file existence: true
[2025-11-22 13:38:08.986] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:38:08.986] [INFO] [LaunchDaemonInstaller.swift:740 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] (test) Service com.keypath.kanata considered healthy: true
[2025-11-22 13:38:08.986] [INFO] [LaunchDaemonInstaller.swift:704 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (test) Service com.keypath.karabiner-vhiddaemon considered loaded: false
[2025-11-22 13:38:08.986] [INFO] [LaunchDaemonInstaller.swift:704 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (test) Service com.keypath.karabiner-vhidmanager considered loaded: false
[2025-11-22 13:38:08.986] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:38:08.986] [INFO] [LaunchDaemonInstaller.swift:740 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] (test) Service com.keypath.karabiner-vhiddaemon considered healthy: false
[2025-11-22 13:38:08.986] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhidmanager
[2025-11-22 13:38:08.986] [INFO] [LaunchDaemonInstaller.swift:740 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] (test) Service com.keypath.karabiner-vhidmanager considered healthy: false
[2025-11-22 13:38:08.986] [INFO] [LaunchDaemonInstaller.swift:312 createAllLaunchDaemonServices()] ğŸ”§ [LaunchDaemon] Creating all LaunchDaemon services
[2025-11-22 13:38:08.986] [INFO] [LaunchDaemonInstaller.swift:232 getKanataBinaryPath()] âŒ [LaunchDaemon] Bundled Kanata binary not found at: /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata
[2025-11-22 13:38:08.986] [INFO] [LaunchDaemonInstaller.swift:233 getKanataBinaryPath()] ğŸ’¡ [LaunchDaemon] User may need to reinstall Kanata components before proceeding
[2025-11-22 13:38:08.986] [INFO] [LaunchDaemonInstaller.swift:2689 buildKanataPlistArguments(binaryPath:)] ğŸ“¡ [LaunchDaemon] TCP server enabled on port 45000
[2025-11-22 13:38:08.986] [INFO] [LaunchDaemonInstaller.swift:2705 buildKanataPlistArguments(binaryPath:)] ğŸ”§ [LaunchDaemon] Built plist arguments: /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata --cfg /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-4549DB3B-F998-4E9E-BC3C-E607B58FF571/Users/tester/.config/keypath/keypath.kbd --port 45000 --debug --log-layer-changes
[2025-11-22 13:38:08.987] [INFO] [LaunchDaemonInstaller.swift:361 createAllLaunchDaemonServices()] ğŸ§ª [LaunchDaemon] Test mode without auth-script override â€“ using local installer path
[2025-11-22 13:38:08.987] [INFO] [LaunchDaemonInstaller.swift:1089 executeAllWithAdminPrivileges(kanataTemp:vhidDaemonTemp:vhidManagerTemp:)] ğŸ”§ [LaunchDaemon] Requesting admin privileges to install all services
[2025-11-22 13:38:08.987] [INFO] [LaunchDaemonInstaller.swift:1104 executeAllWithAdminPrivileges(kanataTemp:vhidDaemonTemp:vhidManagerTemp:)] âœ… [LaunchDaemon] (test) Installed all plists to /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-4549DB3B-F998-4E9E-BC3C-E607B58FF571/Library/LaunchDaemons
[2025-11-22 13:38:08.987] [INFO] [LaunchDaemonInstaller.swift:566 loadServices()] ğŸ”§ [LaunchDaemon] Loading all KeyPath LaunchDaemon services
[2025-11-22 13:38:08.988] [INFO] [LaunchDaemonInstaller.swift:586 loadService(serviceID:)] ğŸ”§ [LaunchDaemon] Loading service: com.keypath.kanata
[2025-11-22 13:38:08.988] [INFO] [LaunchDaemonInstaller.swift:586 loadService(serviceID:)] ğŸ”§ [LaunchDaemon] Loading service: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:38:08.988] [INFO] [LaunchDaemonInstaller.swift:586 loadService(serviceID:)] ğŸ”§ [LaunchDaemon] Loading service: com.keypath.karabiner-vhidmanager
[2025-11-22 13:38:08.988] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:38:08.988] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: true
[2025-11-22 13:38:08.988] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 0 (SMAppServiceStatus(rawValue: 0))
[2025-11-22 13:38:08.988] [INFO] [KanataDaemonManager.swift:119 determineServiceManagementState()] âœ… [KanataDaemonManager] State: LEGACY_ACTIVE (plist exists)
[2025-11-22 13:38:08.988] [INFO] [LaunchDaemonInstaller.swift:664 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (test) Kanata service loaded via file existence: true
[2025-11-22 13:38:08.988] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:38:08.988] [INFO] [LaunchDaemonInstaller.swift:740 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] (test) Service com.keypath.kanata considered healthy: true
[2025-11-22 13:38:08.988] [INFO] [LaunchDaemonInstaller.swift:704 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (test) Service com.keypath.karabiner-vhiddaemon considered loaded: true
[2025-11-22 13:38:08.988] [INFO] [LaunchDaemonInstaller.swift:704 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (test) Service com.keypath.karabiner-vhidmanager considered loaded: true
[2025-11-22 13:38:08.988] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:38:08.988] [INFO] [LaunchDaemonInstaller.swift:740 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] (test) Service com.keypath.karabiner-vhiddaemon considered healthy: true
[2025-11-22 13:38:08.988] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhidmanager
[2025-11-22 13:38:08.988] [INFO] [LaunchDaemonInstaller.swift:740 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] (test) Service com.keypath.karabiner-vhidmanager considered healthy: true
Test Case '-[KeyPathTests.InstallerEngineFunctionalTests testRepairFlowRestoresMissingVhidServices]' passed (0.008 seconds).
Test Case '-[KeyPathTests.InstallerEngineFunctionalTests testReRunningInstallerDoesNotChangeExistingServiceDefinitions]' started.
[2025-11-22 13:38:08.992] [INFO] [LaunchDaemonInstaller.swift:312 createAllLaunchDaemonServices()] ğŸ”§ [LaunchDaemon] Creating all LaunchDaemon services
[2025-11-22 13:38:08.994] [INFO] [ConfigurationService.swift:483 createInitialConfigIfNeeded()] âœ… [ConfigService] Config directory created at /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-EB25015C-8BDE-4573-AB1F-71497CAFF99A/Users/tester/.config/keypath
[2025-11-22 13:38:08.994] [INFO] [ConfigurationService.swift:488 createInitialConfigIfNeeded()] âš ï¸ [ConfigService] No existing config found at /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-EB25015C-8BDE-4573-AB1F-71497CAFF99A/Users/tester/.config/keypath/keypath.kbd
[2025-11-22 13:38:08.994] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:38:08.994] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:38:08.994] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 725 characters
[2025-11-22 13:38:08.994] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:38:08.994] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 10 src keys, 10 layer keys, deduplicated to 10 unique mappings
[2025-11-22 13:38:08.994] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:38:08.994] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:38:08.994] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 0 mappings
[2025-11-22 13:38:08.994] [INFO] [ConfigurationService.swift:492 createInitialConfigIfNeeded()] âœ… [ConfigService] Created initial empty configuration
[2025-11-22 13:38:08.994] [INFO] [LaunchDaemonInstaller.swift:945 ensureDefaultUserConfigExists()] âœ… [LaunchDaemon] Created default user config at /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-EB25015C-8BDE-4573-AB1F-71497CAFF99A/Users/tester/.config/keypath/keypath.kbd
[2025-11-22 13:38:08.995] [INFO] [LaunchDaemonInstaller.swift:232 getKanataBinaryPath()] âŒ [LaunchDaemon] Bundled Kanata binary not found at: /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata
[2025-11-22 13:38:08.995] [INFO] [LaunchDaemonInstaller.swift:233 getKanataBinaryPath()] ğŸ’¡ [LaunchDaemon] User may need to reinstall Kanata components before proceeding
[2025-11-22 13:38:08.995] [INFO] [LaunchDaemonInstaller.swift:2689 buildKanataPlistArguments(binaryPath:)] ğŸ“¡ [LaunchDaemon] TCP server enabled on port 45000
[2025-11-22 13:38:08.995] [INFO] [LaunchDaemonInstaller.swift:2705 buildKanataPlistArguments(binaryPath:)] ğŸ”§ [LaunchDaemon] Built plist arguments: /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata --cfg /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-EB25015C-8BDE-4573-AB1F-71497CAFF99A/Users/tester/.config/keypath/keypath.kbd --port 45000 --debug --log-layer-changes
[2025-11-22 13:38:08.995] [INFO] [LaunchDaemonInstaller.swift:361 createAllLaunchDaemonServices()] ğŸ§ª [LaunchDaemon] Test mode without auth-script override â€“ using local installer path
[2025-11-22 13:38:08.995] [INFO] [LaunchDaemonInstaller.swift:1089 executeAllWithAdminPrivileges(kanataTemp:vhidDaemonTemp:vhidManagerTemp:)] ğŸ”§ [LaunchDaemon] Requesting admin privileges to install all services
[2025-11-22 13:38:08.996] [INFO] [LaunchDaemonInstaller.swift:1104 executeAllWithAdminPrivileges(kanataTemp:vhidDaemonTemp:vhidManagerTemp:)] âœ… [LaunchDaemon] (test) Installed all plists to /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-EB25015C-8BDE-4573-AB1F-71497CAFF99A/Library/LaunchDaemons
[2025-11-22 13:38:08.996] [INFO] [LaunchDaemonInstaller.swift:312 createAllLaunchDaemonServices()] ğŸ”§ [LaunchDaemon] Creating all LaunchDaemon services
[2025-11-22 13:38:08.996] [INFO] [LaunchDaemonInstaller.swift:232 getKanataBinaryPath()] âŒ [LaunchDaemon] Bundled Kanata binary not found at: /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata
[2025-11-22 13:38:08.996] [INFO] [LaunchDaemonInstaller.swift:233 getKanataBinaryPath()] ğŸ’¡ [LaunchDaemon] User may need to reinstall Kanata components before proceeding
[2025-11-22 13:38:08.997] [INFO] [LaunchDaemonInstaller.swift:2689 buildKanataPlistArguments(binaryPath:)] ğŸ“¡ [LaunchDaemon] TCP server enabled on port 45000
[2025-11-22 13:38:08.997] [INFO] [LaunchDaemonInstaller.swift:2705 buildKanataPlistArguments(binaryPath:)] ğŸ”§ [LaunchDaemon] Built plist arguments: /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata --cfg /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-EB25015C-8BDE-4573-AB1F-71497CAFF99A/Users/tester/.config/keypath/keypath.kbd --port 45000 --debug --log-layer-changes
[2025-11-22 13:38:08.997] [INFO] [LaunchDaemonInstaller.swift:361 createAllLaunchDaemonServices()] ğŸ§ª [LaunchDaemon] Test mode without auth-script override â€“ using local installer path
[2025-11-22 13:38:08.997] [INFO] [LaunchDaemonInstaller.swift:1089 executeAllWithAdminPrivileges(kanataTemp:vhidDaemonTemp:vhidManagerTemp:)] ğŸ”§ [LaunchDaemon] Requesting admin privileges to install all services
[2025-11-22 13:38:08.998] [INFO] [LaunchDaemonInstaller.swift:1104 executeAllWithAdminPrivileges(kanataTemp:vhidDaemonTemp:vhidManagerTemp:)] âœ… [LaunchDaemon] (test) Installed all plists to /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-EB25015C-8BDE-4573-AB1F-71497CAFF99A/Library/LaunchDaemons
Test Case '-[KeyPathTests.InstallerEngineFunctionalTests testReRunningInstallerDoesNotChangeExistingServiceDefinitions]' passed (0.010 seconds).
Test Case '-[KeyPathTests.InstallerEngineFunctionalTests testReRunningInstallerFailsWhenDuplicatePlistDirectoryExists]' started.
[2025-11-22 13:38:09.000] [INFO] [LaunchDaemonInstaller.swift:312 createAllLaunchDaemonServices()] ğŸ”§ [LaunchDaemon] Creating all LaunchDaemon services
[2025-11-22 13:38:09.001] [INFO] [ConfigurationService.swift:483 createInitialConfigIfNeeded()] âœ… [ConfigService] Config directory created at /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-FA76B5F0-B353-404C-8D0D-8CB00F4513BB/Users/tester/.config/keypath
[2025-11-22 13:38:09.001] [INFO] [ConfigurationService.swift:488 createInitialConfigIfNeeded()] âš ï¸ [ConfigService] No existing config found at /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-FA76B5F0-B353-404C-8D0D-8CB00F4513BB/Users/tester/.config/keypath/keypath.kbd
[2025-11-22 13:38:09.001] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:38:09.001] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:38:09.001] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 725 characters
[2025-11-22 13:38:09.001] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:38:09.001] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 10 src keys, 10 layer keys, deduplicated to 10 unique mappings
[2025-11-22 13:38:09.001] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:38:09.001] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:38:09.001] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 0 mappings
[2025-11-22 13:38:09.001] [INFO] [ConfigurationService.swift:492 createInitialConfigIfNeeded()] âœ… [ConfigService] Created initial empty configuration
[2025-11-22 13:38:09.001] [INFO] [LaunchDaemonInstaller.swift:945 ensureDefaultUserConfigExists()] âœ… [LaunchDaemon] Created default user config at /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-FA76B5F0-B353-404C-8D0D-8CB00F4513BB/Users/tester/.config/keypath/keypath.kbd
[2025-11-22 13:38:09.001] [INFO] [LaunchDaemonInstaller.swift:232 getKanataBinaryPath()] âŒ [LaunchDaemon] Bundled Kanata binary not found at: /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata
[2025-11-22 13:38:09.001] [INFO] [LaunchDaemonInstaller.swift:233 getKanataBinaryPath()] ğŸ’¡ [LaunchDaemon] User may need to reinstall Kanata components before proceeding
[2025-11-22 13:38:09.001] [INFO] [LaunchDaemonInstaller.swift:2689 buildKanataPlistArguments(binaryPath:)] ğŸ“¡ [LaunchDaemon] TCP server enabled on port 45000
[2025-11-22 13:38:09.001] [INFO] [LaunchDaemonInstaller.swift:2705 buildKanataPlistArguments(binaryPath:)] ğŸ”§ [LaunchDaemon] Built plist arguments: /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata --cfg /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-FA76B5F0-B353-404C-8D0D-8CB00F4513BB/Users/tester/.config/keypath/keypath.kbd --port 45000 --debug --log-layer-changes
[2025-11-22 13:38:09.002] [INFO] [LaunchDaemonInstaller.swift:361 createAllLaunchDaemonServices()] ğŸ§ª [LaunchDaemon] Test mode without auth-script override â€“ using local installer path
[2025-11-22 13:38:09.002] [INFO] [LaunchDaemonInstaller.swift:1089 executeAllWithAdminPrivileges(kanataTemp:vhidDaemonTemp:vhidManagerTemp:)] ğŸ”§ [LaunchDaemon] Requesting admin privileges to install all services
[2025-11-22 13:38:09.002] [INFO] [LaunchDaemonInstaller.swift:1104 executeAllWithAdminPrivileges(kanataTemp:vhidDaemonTemp:vhidManagerTemp:)] âœ… [LaunchDaemon] (test) Installed all plists to /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-FA76B5F0-B353-404C-8D0D-8CB00F4513BB/Library/LaunchDaemons
[2025-11-22 13:38:09.003] [INFO] [LaunchDaemonInstaller.swift:312 createAllLaunchDaemonServices()] ğŸ”§ [LaunchDaemon] Creating all LaunchDaemon services
[2025-11-22 13:38:09.003] [INFO] [LaunchDaemonInstaller.swift:232 getKanataBinaryPath()] âŒ [LaunchDaemon] Bundled Kanata binary not found at: /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata
[2025-11-22 13:38:09.003] [INFO] [LaunchDaemonInstaller.swift:233 getKanataBinaryPath()] ğŸ’¡ [LaunchDaemon] User may need to reinstall Kanata components before proceeding
[2025-11-22 13:38:09.003] [INFO] [LaunchDaemonInstaller.swift:2689 buildKanataPlistArguments(binaryPath:)] ğŸ“¡ [LaunchDaemon] TCP server enabled on port 45000
[2025-11-22 13:38:09.003] [INFO] [LaunchDaemonInstaller.swift:2705 buildKanataPlistArguments(binaryPath:)] ğŸ”§ [LaunchDaemon] Built plist arguments: /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata --cfg /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-FA76B5F0-B353-404C-8D0D-8CB00F4513BB/Users/tester/.config/keypath/keypath.kbd --port 45000 --debug --log-layer-changes
[2025-11-22 13:38:09.004] [INFO] [LaunchDaemonInstaller.swift:361 createAllLaunchDaemonServices()] ğŸ§ª [LaunchDaemon] Test mode without auth-script override â€“ using local installer path
[2025-11-22 13:38:09.004] [INFO] [LaunchDaemonInstaller.swift:1089 executeAllWithAdminPrivileges(kanataTemp:vhidDaemonTemp:vhidManagerTemp:)] ğŸ”§ [LaunchDaemon] Requesting admin privileges to install all services
[2025-11-22 13:38:09.005] [INFO] [LaunchDaemonInstaller.swift:1109 executeAllWithAdminPrivileges(kanataTemp:vhidDaemonTemp:vhidManagerTemp:)] âŒ [LaunchDaemon] (test) Failed to install plists: Error Domain=NSCocoaErrorDomain Code=516 "The file â€œLaunchDaemonsâ€ couldnâ€™t be saved in the folder â€œLibraryâ€ because a file with the same name already exists." UserInfo={NSFilePath=/var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-FA76B5F0-B353-404C-8D0D-8CB00F4513BB/Library/LaunchDaemons, NSURL=file:///var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-FA76B5F0-B353-404C-8D0D-8CB00F4513BB/Library/LaunchDaemons, NSUnderlyingError=0x76c96a250 {Error Domain=NSPOSIXErrorDomain Code=17 "File exists"}}
Test Case '-[KeyPathTests.InstallerEngineFunctionalTests testReRunningInstallerFailsWhenDuplicatePlistDirectoryExists]' passed (0.109 seconds).
Test Case '-[KeyPathTests.InstallerEngineFunctionalTests testReRunningInstallerFailsWhenLaunchDaemonDirectoryReadOnly]' started.
[2025-11-22 13:38:09.110] [INFO] [LaunchDaemonInstaller.swift:312 createAllLaunchDaemonServices()] ğŸ”§ [LaunchDaemon] Creating all LaunchDaemon services
[2025-11-22 13:38:09.110] [INFO] [ConfigurationService.swift:483 createInitialConfigIfNeeded()] âœ… [ConfigService] Config directory created at /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-4179A6FD-A8AB-4A45-BDA9-F1B8425585B7/Users/tester/.config/keypath
[2025-11-22 13:38:09.110] [INFO] [ConfigurationService.swift:488 createInitialConfigIfNeeded()] âš ï¸ [ConfigService] No existing config found at /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-4179A6FD-A8AB-4A45-BDA9-F1B8425585B7/Users/tester/.config/keypath/keypath.kbd
[2025-11-22 13:38:09.110] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:38:09.110] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:38:09.110] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 725 characters
[2025-11-22 13:38:09.110] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:38:09.110] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 10 src keys, 10 layer keys, deduplicated to 10 unique mappings
[2025-11-22 13:38:09.110] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:38:09.110] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:38:09.111] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 0 mappings
[2025-11-22 13:38:09.111] [INFO] [ConfigurationService.swift:492 createInitialConfigIfNeeded()] âœ… [ConfigService] Created initial empty configuration
[2025-11-22 13:38:09.111] [INFO] [LaunchDaemonInstaller.swift:945 ensureDefaultUserConfigExists()] âœ… [LaunchDaemon] Created default user config at /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-4179A6FD-A8AB-4A45-BDA9-F1B8425585B7/Users/tester/.config/keypath/keypath.kbd
[2025-11-22 13:38:09.111] [INFO] [LaunchDaemonInstaller.swift:232 getKanataBinaryPath()] âŒ [LaunchDaemon] Bundled Kanata binary not found at: /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata
[2025-11-22 13:38:09.111] [INFO] [LaunchDaemonInstaller.swift:233 getKanataBinaryPath()] ğŸ’¡ [LaunchDaemon] User may need to reinstall Kanata components before proceeding
[2025-11-22 13:38:09.111] [INFO] [LaunchDaemonInstaller.swift:2689 buildKanataPlistArguments(binaryPath:)] ğŸ“¡ [LaunchDaemon] TCP server enabled on port 45000
[2025-11-22 13:38:09.111] [INFO] [LaunchDaemonInstaller.swift:2705 buildKanataPlistArguments(binaryPath:)] ğŸ”§ [LaunchDaemon] Built plist arguments: /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata --cfg /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-4179A6FD-A8AB-4A45-BDA9-F1B8425585B7/Users/tester/.config/keypath/keypath.kbd --port 45000 --debug --log-layer-changes
[2025-11-22 13:38:09.111] [INFO] [LaunchDaemonInstaller.swift:361 createAllLaunchDaemonServices()] ğŸ§ª [LaunchDaemon] Test mode without auth-script override â€“ using local installer path
[2025-11-22 13:38:09.111] [INFO] [LaunchDaemonInstaller.swift:1089 executeAllWithAdminPrivileges(kanataTemp:vhidDaemonTemp:vhidManagerTemp:)] ğŸ”§ [LaunchDaemon] Requesting admin privileges to install all services
[2025-11-22 13:38:09.112] [INFO] [LaunchDaemonInstaller.swift:1104 executeAllWithAdminPrivileges(kanataTemp:vhidDaemonTemp:vhidManagerTemp:)] âœ… [LaunchDaemon] (test) Installed all plists to /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-4179A6FD-A8AB-4A45-BDA9-F1B8425585B7/Library/LaunchDaemons
[2025-11-22 13:38:09.113] [INFO] [LaunchDaemonInstaller.swift:312 createAllLaunchDaemonServices()] ğŸ”§ [LaunchDaemon] Creating all LaunchDaemon services
[2025-11-22 13:38:09.113] [INFO] [LaunchDaemonInstaller.swift:232 getKanataBinaryPath()] âŒ [LaunchDaemon] Bundled Kanata binary not found at: /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata
[2025-11-22 13:38:09.113] [INFO] [LaunchDaemonInstaller.swift:233 getKanataBinaryPath()] ğŸ’¡ [LaunchDaemon] User may need to reinstall Kanata components before proceeding
[2025-11-22 13:38:09.113] [INFO] [LaunchDaemonInstaller.swift:2689 buildKanataPlistArguments(binaryPath:)] ğŸ“¡ [LaunchDaemon] TCP server enabled on port 45000
[2025-11-22 13:38:09.113] [INFO] [LaunchDaemonInstaller.swift:2705 buildKanataPlistArguments(binaryPath:)] ğŸ”§ [LaunchDaemon] Built plist arguments: /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata --cfg /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-4179A6FD-A8AB-4A45-BDA9-F1B8425585B7/Users/tester/.config/keypath/keypath.kbd --port 45000 --debug --log-layer-changes
[2025-11-22 13:38:09.114] [INFO] [LaunchDaemonInstaller.swift:361 createAllLaunchDaemonServices()] ğŸ§ª [LaunchDaemon] Test mode without auth-script override â€“ using local installer path
[2025-11-22 13:38:09.114] [INFO] [LaunchDaemonInstaller.swift:1089 executeAllWithAdminPrivileges(kanataTemp:vhidDaemonTemp:vhidManagerTemp:)] ğŸ”§ [LaunchDaemon] Requesting admin privileges to install all services
[2025-11-22 13:38:09.115] [INFO] [LaunchDaemonInstaller.swift:1109 executeAllWithAdminPrivileges(kanataTemp:vhidDaemonTemp:vhidManagerTemp:)] âŒ [LaunchDaemon] (test) Failed to install plists: Error Domain=NSCocoaErrorDomain Code=516 "â€œcom.keypath.kanata.E18B1753-D275-49F4-83B7-326B3916171B.plistâ€ couldnâ€™t be copied to â€œLaunchDaemonsâ€ because an item with the same name already exists." UserInfo={NSSourceFilePathErrorKey=/var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/com.keypath.kanata.E18B1753-D275-49F4-83B7-326B3916171B.plist, NSUserStringVariant=(
    Copy
), NSDestinationFilePath=/var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-4179A6FD-A8AB-4A45-BDA9-F1B8425585B7/Library/LaunchDaemons/com.keypath.kanata.plist, NSFilePath=/var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/com.keypath.kanata.E18B1753-D275-49F4-83B7-326B3916171B.plist, NSURL=file:///var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/com.keypath.kanata.E18B1753-D275-49F4-83B7-326B3916171B.plist, NSUnderlyingError=0x76c9694a0 {Error Domain=NSPOSIXErrorDomain Code=17 "File exists"}}
Test Case '-[KeyPathTests.InstallerEngineFunctionalTests testReRunningInstallerFailsWhenLaunchDaemonDirectoryReadOnly]' passed (0.113 seconds).
Test Case '-[KeyPathTests.InstallerEngineFunctionalTests testRestartUnhealthyServicesRepairsMissingVhidServices]' started.
[2025-11-22 13:38:09.223] [INFO] [LaunchDaemonInstaller.swift:312 createAllLaunchDaemonServices()] ğŸ”§ [LaunchDaemon] Creating all LaunchDaemon services
[2025-11-22 13:38:09.223] [INFO] [ConfigurationService.swift:483 createInitialConfigIfNeeded()] âœ… [ConfigService] Config directory created at /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-0399B753-4430-4380-9BC9-7D290FE4F48A/Users/tester/.config/keypath
[2025-11-22 13:38:09.223] [INFO] [ConfigurationService.swift:488 createInitialConfigIfNeeded()] âš ï¸ [ConfigService] No existing config found at /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-0399B753-4430-4380-9BC9-7D290FE4F48A/Users/tester/.config/keypath/keypath.kbd
[2025-11-22 13:38:09.224] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:38:09.224] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:38:09.224] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 725 characters
[2025-11-22 13:38:09.224] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:38:09.224] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 10 src keys, 10 layer keys, deduplicated to 10 unique mappings
[2025-11-22 13:38:09.224] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:38:09.224] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:38:09.224] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 0 mappings
[2025-11-22 13:38:09.224] [INFO] [ConfigurationService.swift:492 createInitialConfigIfNeeded()] âœ… [ConfigService] Created initial empty configuration
[2025-11-22 13:38:09.224] [INFO] [LaunchDaemonInstaller.swift:945 ensureDefaultUserConfigExists()] âœ… [LaunchDaemon] Created default user config at /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-0399B753-4430-4380-9BC9-7D290FE4F48A/Users/tester/.config/keypath/keypath.kbd
[2025-11-22 13:38:09.224] [INFO] [LaunchDaemonInstaller.swift:232 getKanataBinaryPath()] âŒ [LaunchDaemon] Bundled Kanata binary not found at: /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata
[2025-11-22 13:38:09.225] [INFO] [LaunchDaemonInstaller.swift:233 getKanataBinaryPath()] ğŸ’¡ [LaunchDaemon] User may need to reinstall Kanata components before proceeding
[2025-11-22 13:38:09.225] [INFO] [LaunchDaemonInstaller.swift:2689 buildKanataPlistArguments(binaryPath:)] ğŸ“¡ [LaunchDaemon] TCP server enabled on port 45000
[2025-11-22 13:38:09.225] [INFO] [LaunchDaemonInstaller.swift:2705 buildKanataPlistArguments(binaryPath:)] ğŸ”§ [LaunchDaemon] Built plist arguments: /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata --cfg /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-0399B753-4430-4380-9BC9-7D290FE4F48A/Users/tester/.config/keypath/keypath.kbd --port 45000 --debug --log-layer-changes
[2025-11-22 13:38:09.226] [INFO] [LaunchDaemonInstaller.swift:361 createAllLaunchDaemonServices()] ğŸ§ª [LaunchDaemon] Test mode without auth-script override â€“ using local installer path
[2025-11-22 13:38:09.226] [INFO] [LaunchDaemonInstaller.swift:1089 executeAllWithAdminPrivileges(kanataTemp:vhidDaemonTemp:vhidManagerTemp:)] ğŸ”§ [LaunchDaemon] Requesting admin privileges to install all services
[2025-11-22 13:38:09.227] [INFO] [LaunchDaemonInstaller.swift:1104 executeAllWithAdminPrivileges(kanataTemp:vhidDaemonTemp:vhidManagerTemp:)] âœ… [LaunchDaemon] (test) Installed all plists to /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-0399B753-4430-4380-9BC9-7D290FE4F48A/Library/LaunchDaemons
[2025-11-22 13:38:09.227] [INFO] [LaunchDaemonInstaller.swift:566 loadServices()] ğŸ”§ [LaunchDaemon] Loading all KeyPath LaunchDaemon services
[2025-11-22 13:38:09.227] [INFO] [LaunchDaemonInstaller.swift:586 loadService(serviceID:)] ğŸ”§ [LaunchDaemon] Loading service: com.keypath.kanata
[2025-11-22 13:38:09.227] [INFO] [LaunchDaemonInstaller.swift:586 loadService(serviceID:)] ğŸ”§ [LaunchDaemon] Loading service: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:38:09.227] [INFO] [LaunchDaemonInstaller.swift:586 loadService(serviceID:)] ğŸ”§ [LaunchDaemon] Loading service: com.keypath.karabiner-vhidmanager
[2025-11-22 13:38:09.228] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:38:09.228] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: true
[2025-11-22 13:38:09.228] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 0 (SMAppServiceStatus(rawValue: 0))
[2025-11-22 13:38:09.228] [INFO] [KanataDaemonManager.swift:119 determineServiceManagementState()] âœ… [KanataDaemonManager] State: LEGACY_ACTIVE (plist exists)
[2025-11-22 13:38:09.228] [INFO] [LaunchDaemonInstaller.swift:664 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (test) Kanata service loaded via file existence: true
[2025-11-22 13:38:09.228] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:38:09.228] [INFO] [LaunchDaemonInstaller.swift:740 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] (test) Service com.keypath.kanata considered healthy: true
[2025-11-22 13:38:09.228] [INFO] [LaunchDaemonInstaller.swift:704 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (test) Service com.keypath.karabiner-vhiddaemon considered loaded: false
[2025-11-22 13:38:09.228] [INFO] [LaunchDaemonInstaller.swift:704 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (test) Service com.keypath.karabiner-vhidmanager considered loaded: false
[2025-11-22 13:38:09.228] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:38:09.228] [INFO] [LaunchDaemonInstaller.swift:740 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] (test) Service com.keypath.karabiner-vhiddaemon considered healthy: false
[2025-11-22 13:38:09.228] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhidmanager
[2025-11-22 13:38:09.228] [INFO] [LaunchDaemonInstaller.swift:740 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] (test) Service com.keypath.karabiner-vhidmanager considered healthy: false
[2025-11-22 13:38:09.228] [INFO] [LaunchDaemonInstaller.swift:1995 restartUnhealthyServices()] ğŸ”§ [LaunchDaemon] Starting comprehensive service health fix
[2025-11-22 13:38:09.228] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:38:09.228] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: true
[2025-11-22 13:38:09.228] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 0 (SMAppServiceStatus(rawValue: 0))
[2025-11-22 13:38:09.228] [INFO] [KanataDaemonManager.swift:119 determineServiceManagementState()] âœ… [KanataDaemonManager] State: LEGACY_ACTIVE (plist exists)
[2025-11-22 13:38:09.229] [INFO] [LaunchDaemonInstaller.swift:664 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (test) Kanata service loaded via file existence: true
[2025-11-22 13:38:09.229] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:38:09.229] [INFO] [LaunchDaemonInstaller.swift:740 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] (test) Service com.keypath.kanata considered healthy: true
[2025-11-22 13:38:09.229] [INFO] [LaunchDaemonInstaller.swift:704 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (test) Service com.keypath.karabiner-vhiddaemon considered loaded: false
[2025-11-22 13:38:09.229] [INFO] [LaunchDaemonInstaller.swift:704 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (test) Service com.keypath.karabiner-vhidmanager considered loaded: false
[2025-11-22 13:38:09.229] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:38:09.229] [INFO] [LaunchDaemonInstaller.swift:740 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] (test) Service com.keypath.karabiner-vhiddaemon considered healthy: false
[2025-11-22 13:38:09.229] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhidmanager
[2025-11-22 13:38:09.229] [INFO] [LaunchDaemonInstaller.swift:740 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] (test) Service com.keypath.karabiner-vhidmanager considered healthy: false
[2025-11-22 13:38:09.229] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:38:09.229] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: true
[2025-11-22 13:38:09.229] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 0 (SMAppServiceStatus(rawValue: 0))
[2025-11-22 13:38:09.229] [INFO] [KanataDaemonManager.swift:119 determineServiceManagementState()] âœ… [KanataDaemonManager] State: LEGACY_ACTIVE (plist exists)
[2025-11-22 13:38:09.229] [INFO] [LaunchDaemonInstaller.swift:2030 restartUnhealthyServices()] ğŸ” [LaunchDaemon] Current state: Legacy launchctl
[2025-11-22 13:38:09.229] [INFO] [LaunchDaemonInstaller.swift:2034 restartUnhealthyServices()] ğŸ”„ [LaunchDaemon] Legacy plist detected - auto-resolving by removing legacy
[2025-11-22 13:38:09.229] [INFO] [PrivilegedOperationsCoordinator.swift:839 sudoExecuteCommand(_:description:)] ğŸ”§ [PrivCoordinator] Executing admin command: Remove legacy plist
[2025-11-22 13:38:22.280] [INFO] [PrivilegedOperationsCoordinator.swift:844 sudoExecuteCommand(_:description:)] âœ… [PrivCoordinator] Successfully executed: Remove legacy plist
[2025-11-22 13:38:22.280] [INFO] [LaunchDaemonInstaller.swift:2046 restartUnhealthyServices()] âœ… [LaunchDaemon] Legacy plist removed
[2025-11-22 13:38:22.280] [INFO] [LaunchDaemonInstaller.swift:2134 restartUnhealthyServices()] ğŸ” [LaunchDaemon] Installation check: needsInstallation=true
[2025-11-22 13:38:22.280] [INFO] [LaunchDaemonInstaller.swift:2136 restartUnhealthyServices()] ğŸ” [LaunchDaemon] Services to install after state check: ["com.keypath.karabiner-vhiddaemon", "com.keypath.karabiner-vhidmanager"]
[2025-11-22 13:38:22.280] [INFO] [LaunchDaemonInstaller.swift:2142 restartUnhealthyServices()] ğŸ”§ [LaunchDaemon] Installing missing services: ["com.keypath.karabiner-vhiddaemon", "com.keypath.karabiner-vhidmanager"]
[2025-11-22 13:38:22.280] [INFO] [LaunchDaemonInstaller.swift:502 createConfigureAndLoadAllServices()] ğŸ”§ [LaunchDaemon] Creating, configuring, and loading all services
[2025-11-22 13:38:22.280] [INFO] [LaunchDaemonInstaller.swift:503 createConfigureAndLoadAllServices()] ğŸ“± [LaunchDaemon] Using SMAppService for Kanata, launchctl for VirtualHID
[2025-11-22 13:38:22.280] [INFO] [LaunchDaemonInstaller.swift:511 createConfigureAndLoadAllServicesWithSMAppService()] ğŸ“± [LaunchDaemon] Installing VirtualHID via launchctl, Kanata via SMAppService
[2025-11-22 13:38:22.282] [INFO] [LaunchDaemonInstaller.swift:1631 executeConsolidatedInstallationForVHIDOnly()] ğŸ”§ [LaunchDaemon] Installing VirtualHID services via privileged helper
[2025-11-22 13:38:22.282] [INFO] [PrivilegedOperationsCoordinator.swift:217 repairVHIDDaemonServices()] ğŸ” [PrivCoordinator] Repairing VHID daemon services
[2025-11-22 13:38:22.282] [INFO] [LaunchDaemonInstaller.swift:2453 repairVHIDDaemonServices()] ğŸ”§ [LaunchDaemon] Repairing VHID LaunchDaemon services (DriverKit paths)
[2025-11-22 13:38:22.282] [INFO] [LaunchDaemonInstaller.swift:624 unloadService(serviceID:)] ğŸ”§ [LaunchDaemon] Unloading service: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:38:22.283] [INFO] [LaunchDaemonInstaller.swift:624 unloadService(serviceID:)] ğŸ”§ [LaunchDaemon] Unloading service: com.keypath.karabiner-vhidmanager
[2025-11-22 13:38:22.284] [INFO] [LaunchDaemonInstaller.swift:954 installPlist(content:path:serviceID:)] ğŸ”§ [LaunchDaemon] Installing plist: /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-0399B753-4430-4380-9BC9-7D290FE4F48A/Library/LaunchDaemons/com.keypath.karabiner-vhiddaemon.plist
[2025-11-22 13:38:22.286] [INFO] [LaunchDaemonInstaller.swift:954 installPlist(content:path:serviceID:)] ğŸ”§ [LaunchDaemon] Installing plist: /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-0399B753-4430-4380-9BC9-7D290FE4F48A/Library/LaunchDaemons/com.keypath.karabiner-vhidmanager.plist
[2025-11-22 13:38:22.287] [INFO] [LaunchDaemonInstaller.swift:586 loadService(serviceID:)] ğŸ”§ [LaunchDaemon] Loading service: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:38:22.287] [INFO] [LaunchDaemonInstaller.swift:586 loadService(serviceID:)] ğŸ”§ [LaunchDaemon] Loading service: com.keypath.karabiner-vhidmanager
[2025-11-22 13:38:22.287] [INFO] [LaunchDaemonInstaller.swift:1919 isVHIDDaemonConfiguredCorrectly()] ğŸ” [LaunchDaemon] VHID plist ProgramArguments[0]=/Library/Application Support/org.pqrs/Karabiner-DriverKit-VirtualHIDDevice/Applications/Karabiner-VirtualHIDDevice-Daemon.app/Contents/MacOS/Karabiner-VirtualHIDDevice-Daemon | expected=/Library/Application Support/org.pqrs/Karabiner-DriverKit-VirtualHIDDevice/Applications/Karabiner-VirtualHIDDevice-Daemon.app/Contents/MacOS/Karabiner-VirtualHIDDevice-Daemon | ok=true
[2025-11-22 13:38:22.288] [INFO] [LaunchDaemonInstaller.swift:1919 isVHIDDaemonConfiguredCorrectly()] ğŸ” [LaunchDaemon] VHID plist ProgramArguments[0]=/Library/Application Support/org.pqrs/Karabiner-DriverKit-VirtualHIDDevice/Applications/Karabiner-VirtualHIDDevice-Daemon.app/Contents/MacOS/Karabiner-VirtualHIDDevice-Daemon | expected=/Library/Application Support/org.pqrs/Karabiner-DriverKit-VirtualHIDDevice/Applications/Karabiner-VirtualHIDDevice-Daemon.app/Contents/MacOS/Karabiner-VirtualHIDDevice-Daemon | ok=true
[2025-11-22 13:38:22.288] [INFO] [LaunchDaemonInstaller.swift:2482 repairVHIDDaemonServices()] ğŸ” [LaunchDaemon] Repair result: loadedDaemon=true, loadedManager=true, configured=true
[2025-11-22 13:38:22.288] [INFO] [LaunchDaemonInstaller.swift:1634 executeConsolidatedInstallationForVHIDOnly()] âœ… [LaunchDaemon] VirtualHID services installed via helper path
[2025-11-22 13:38:22.288] [INFO] [LaunchDaemonInstaller.swift:540 createConfigureAndLoadAllServicesWithSMAppService()] ğŸ“± [LaunchDaemon] Installing Kanata via SMAppService...
[2025-11-22 13:38:22.288] [INFO] [LaunchDaemonInstaller.swift:412 createKanataLaunchDaemon()] ğŸ”§ [LaunchDaemon] Creating Kanata LaunchDaemon service via SMAppService
[2025-11-22 13:38:22.288] [INFO] [LaunchDaemonInstaller.swift:420 createKanataLaunchDaemonViaSMAppService()] ğŸ“± [LaunchDaemon] Registering Kanata daemon via SMAppService
[2025-11-22 13:38:22.288] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:38:22.288] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:38:22.288] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 0 (SMAppServiceStatus(rawValue: 0))
[2025-11-22 13:38:22.288] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:38:22.288] [INFO] [LaunchDaemonInstaller.swift:429 createKanataLaunchDaemonViaSMAppService()] ğŸ” [LaunchDaemon] Current state: Uninstalled
[2025-11-22 13:38:22.288] [INFO] [LaunchDaemonInstaller.swift:461 createKanataLaunchDaemonViaSMAppService()] ğŸ”§ [LaunchDaemon] Calling KanataDaemonManager.shared.register()...
[2025-11-22 13:38:22.288] [INFO] [KanataDaemonManager.swift:323 register()] ğŸ”§ [KanataDaemonManager] *** ENTRY POINT *** Registering Kanata daemon via SMAppService
[2025-11-22 13:38:22.288] [INFO] [KanataDaemonManager.swift:325 register()] ğŸ” [KanataDaemonManager] macOS version check: Version 26.0.1 (Build 25A362)
[2025-11-22 13:38:22.288] [INFO] [KanataDaemonManager.swift:332 register()] âœ… [KanataDaemonManager] macOS version OK for SMAppService
[2025-11-22 13:38:22.288] [INFO] [KanataDaemonManager.swift:335 register()] ğŸ§ª [KanataDaemonManager] Test mode detected â€“ bypassing bundle validation
[2025-11-22 13:38:22.288] [INFO] [KanataDaemonManager.swift:339 register()] âœ… [KanataDaemonManager] Test registration completed
[2025-11-22 13:38:22.288] [INFO] [LaunchDaemonInstaller.swift:463 createKanataLaunchDaemonViaSMAppService()] âœ… [LaunchDaemon] Kanata daemon registered via SMAppService - SUCCESS
[2025-11-22 13:38:22.288] [INFO] [LaunchDaemonInstaller.swift:552 createConfigureAndLoadAllServicesWithSMAppService()] âœ… [LaunchDaemon] All services installed (VirtualHID via launchctl, Kanata via SMAppService)
[2025-11-22 13:38:22.288] [INFO] [LaunchDaemonInstaller.swift:2148 restartUnhealthyServices()] âœ… [LaunchDaemon] Successfully installed services
[2025-11-22 13:38:24.373] [INFO] [LaunchDaemonInstaller.swift:2159 restartUnhealthyServices()] ğŸ” [LaunchDaemon] No unhealthy services found to restart
[2025-11-22 13:38:24.374] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:38:24.374] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:38:24.374] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 1 (SMAppServiceStatus(rawValue: 1))
[2025-11-22 13:38:24.374] [INFO] [KanataDaemonManager.swift:126 determineServiceManagementState()] âœ… [KanataDaemonManager] State: SMAPPSERVICE_ACTIVE
[2025-11-22 13:38:24.443] [INFO] [LaunchDaemonInstaller.swift:1836 getServiceStatus()] ğŸ” [LaunchDaemon] Kanata SMAppService-managed: loaded=true, healthy=false
[2025-11-22 13:38:24.443] [INFO] [LaunchDaemonInstaller.swift:704 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (test) Service com.keypath.karabiner-vhiddaemon considered loaded: true
[2025-11-22 13:38:24.443] [INFO] [LaunchDaemonInstaller.swift:704 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (test) Service com.keypath.karabiner-vhidmanager considered loaded: true
[2025-11-22 13:38:24.443] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:38:24.443] [INFO] [LaunchDaemonInstaller.swift:740 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] (test) Service com.keypath.karabiner-vhiddaemon considered healthy: true
[2025-11-22 13:38:24.443] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhidmanager
[2025-11-22 13:38:24.443] [INFO] [LaunchDaemonInstaller.swift:740 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] (test) Service com.keypath.karabiner-vhidmanager considered healthy: true
Test Case '-[KeyPathTests.InstallerEngineFunctionalTests testRestartUnhealthyServicesRepairsMissingVhidServices]' passed (15.224 seconds).
Test Case '-[KeyPathTests.InstallerEngineFunctionalTests testServiceStatusDetectsMissingVhidManager]' started.
[2025-11-22 13:38:24.447] [INFO] [LaunchDaemonInstaller.swift:312 createAllLaunchDaemonServices()] ğŸ”§ [LaunchDaemon] Creating all LaunchDaemon services
[2025-11-22 13:38:24.448] [INFO] [ConfigurationService.swift:483 createInitialConfigIfNeeded()] âœ… [ConfigService] Config directory created at /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-35F74EE7-F6BD-4F46-B0A0-FFA90A70A3FD/Users/tester/.config/keypath
[2025-11-22 13:38:24.448] [INFO] [ConfigurationService.swift:488 createInitialConfigIfNeeded()] âš ï¸ [ConfigService] No existing config found at /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-35F74EE7-F6BD-4F46-B0A0-FFA90A70A3FD/Users/tester/.config/keypath/keypath.kbd
[2025-11-22 13:38:24.448] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:38:24.448] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:38:24.448] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 725 characters
[2025-11-22 13:38:24.448] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:38:24.448] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 10 src keys, 10 layer keys, deduplicated to 10 unique mappings
[2025-11-22 13:38:24.448] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:38:24.448] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:38:24.448] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 0 mappings
[2025-11-22 13:38:24.448] [INFO] [ConfigurationService.swift:492 createInitialConfigIfNeeded()] âœ… [ConfigService] Created initial empty configuration
[2025-11-22 13:38:24.448] [INFO] [LaunchDaemonInstaller.swift:945 ensureDefaultUserConfigExists()] âœ… [LaunchDaemon] Created default user config at /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-35F74EE7-F6BD-4F46-B0A0-FFA90A70A3FD/Users/tester/.config/keypath/keypath.kbd
[2025-11-22 13:38:24.449] [INFO] [LaunchDaemonInstaller.swift:232 getKanataBinaryPath()] âŒ [LaunchDaemon] Bundled Kanata binary not found at: /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata
[2025-11-22 13:38:24.449] [INFO] [LaunchDaemonInstaller.swift:233 getKanataBinaryPath()] ğŸ’¡ [LaunchDaemon] User may need to reinstall Kanata components before proceeding
[2025-11-22 13:38:24.449] [INFO] [LaunchDaemonInstaller.swift:2689 buildKanataPlistArguments(binaryPath:)] ğŸ“¡ [LaunchDaemon] TCP server enabled on port 45000
[2025-11-22 13:38:24.449] [INFO] [LaunchDaemonInstaller.swift:2705 buildKanataPlistArguments(binaryPath:)] ğŸ”§ [LaunchDaemon] Built plist arguments: /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata --cfg /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-35F74EE7-F6BD-4F46-B0A0-FFA90A70A3FD/Users/tester/.config/keypath/keypath.kbd --port 45000 --debug --log-layer-changes
[2025-11-22 13:38:24.450] [INFO] [LaunchDaemonInstaller.swift:361 createAllLaunchDaemonServices()] ğŸ§ª [LaunchDaemon] Test mode without auth-script override â€“ using local installer path
[2025-11-22 13:38:24.450] [INFO] [LaunchDaemonInstaller.swift:1089 executeAllWithAdminPrivileges(kanataTemp:vhidDaemonTemp:vhidManagerTemp:)] ğŸ”§ [LaunchDaemon] Requesting admin privileges to install all services
[2025-11-22 13:38:24.450] [INFO] [LaunchDaemonInstaller.swift:1104 executeAllWithAdminPrivileges(kanataTemp:vhidDaemonTemp:vhidManagerTemp:)] âœ… [LaunchDaemon] (test) Installed all plists to /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-35F74EE7-F6BD-4F46-B0A0-FFA90A70A3FD/Library/LaunchDaemons
[2025-11-22 13:38:24.451] [INFO] [LaunchDaemonInstaller.swift:566 loadServices()] ğŸ”§ [LaunchDaemon] Loading all KeyPath LaunchDaemon services
[2025-11-22 13:38:24.451] [INFO] [LaunchDaemonInstaller.swift:586 loadService(serviceID:)] ğŸ”§ [LaunchDaemon] Loading service: com.keypath.kanata
[2025-11-22 13:38:24.451] [INFO] [LaunchDaemonInstaller.swift:586 loadService(serviceID:)] ğŸ”§ [LaunchDaemon] Loading service: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:38:24.451] [INFO] [LaunchDaemonInstaller.swift:586 loadService(serviceID:)] ğŸ”§ [LaunchDaemon] Loading service: com.keypath.karabiner-vhidmanager
[2025-11-22 13:38:24.451] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:38:24.451] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: true
[2025-11-22 13:38:24.451] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 0 (SMAppServiceStatus(rawValue: 0))
[2025-11-22 13:38:24.451] [INFO] [KanataDaemonManager.swift:119 determineServiceManagementState()] âœ… [KanataDaemonManager] State: LEGACY_ACTIVE (plist exists)
[2025-11-22 13:38:24.451] [INFO] [LaunchDaemonInstaller.swift:664 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (test) Kanata service loaded via file existence: true
[2025-11-22 13:38:24.451] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:38:24.451] [INFO] [LaunchDaemonInstaller.swift:740 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] (test) Service com.keypath.kanata considered healthy: true
[2025-11-22 13:38:24.451] [INFO] [LaunchDaemonInstaller.swift:704 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (test) Service com.keypath.karabiner-vhiddaemon considered loaded: true
[2025-11-22 13:38:24.451] [INFO] [LaunchDaemonInstaller.swift:704 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (test) Service com.keypath.karabiner-vhidmanager considered loaded: false
[2025-11-22 13:38:24.451] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:38:24.452] [INFO] [LaunchDaemonInstaller.swift:740 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] (test) Service com.keypath.karabiner-vhiddaemon considered healthy: true
[2025-11-22 13:38:24.452] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhidmanager
[2025-11-22 13:38:24.452] [INFO] [LaunchDaemonInstaller.swift:740 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] (test) Service com.keypath.karabiner-vhidmanager considered healthy: false
Test Case '-[KeyPathTests.InstallerEngineFunctionalTests testServiceStatusDetectsMissingVhidManager]' passed (0.007 seconds).
Test Case '-[KeyPathTests.InstallerEngineFunctionalTests testSMAppServicePendingApprovalTriggersNotification]' started.
[2025-11-22 13:38:24.454] [INFO] [PrivilegedOperationsCoordinator.swift:157 installServicesIfUninstalled(context:)] [ServiceInstallGuard] pending-flow: state=SMAppService (pending approval)
[2025-11-22 13:38:24.454] [INFO] [PrivilegedOperationsCoordinator.swift:893 notifySMAppServiceApprovalRequired(context:)] âš ï¸ [ServiceInstallGuard] pending-flow: SMAppService pending approval - notifying UI
[2025-11-22 13:38:24.454] [INFO] [PrivilegedOperationsCoordinator.swift:161 installServicesIfUninstalled(context:)] [ServiceInstallGuard] pending-flow: approval pending - skipping install/refresh
Test Case '-[KeyPathTests.InstallerEngineFunctionalTests testSMAppServicePendingApprovalTriggersNotification]' passed (0.002 seconds).
Test Case '-[KeyPathTests.InstallerEngineFunctionalTests testSMAppServiceRegistrationFailureIsSurfaced]' started.
[2025-11-22 13:38:24.456] [INFO] [LaunchDaemonInstaller.swift:412 createKanataLaunchDaemon()] ğŸ”§ [LaunchDaemon] Creating Kanata LaunchDaemon service via SMAppService
[2025-11-22 13:38:24.456] [INFO] [LaunchDaemonInstaller.swift:420 createKanataLaunchDaemonViaSMAppService()] ğŸ“± [LaunchDaemon] Registering Kanata daemon via SMAppService
[2025-11-22 13:38:24.456] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:38:24.456] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:38:24.456] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 0 (SMAppServiceStatus(rawValue: 0))
[2025-11-22 13:38:24.456] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:38:24.456] [INFO] [LaunchDaemonInstaller.swift:429 createKanataLaunchDaemonViaSMAppService()] ğŸ” [LaunchDaemon] Current state: Uninstalled
[2025-11-22 13:38:24.456] [INFO] [LaunchDaemonInstaller.swift:461 createKanataLaunchDaemonViaSMAppService()] ğŸ”§ [LaunchDaemon] Calling KanataDaemonManager.shared.register()...
[2025-11-22 13:38:24.456] [INFO] [KanataDaemonManager.swift:323 register()] ğŸ”§ [KanataDaemonManager] *** ENTRY POINT *** Registering Kanata daemon via SMAppService
[2025-11-22 13:38:24.456] [INFO] [KanataDaemonManager.swift:325 register()] ğŸ” [KanataDaemonManager] macOS version check: Version 26.0.1 (Build 25A362)
[2025-11-22 13:38:24.456] [INFO] [KanataDaemonManager.swift:332 register()] âœ… [KanataDaemonManager] macOS version OK for SMAppService
[2025-11-22 13:38:24.456] [INFO] [KanataDaemonManager.swift:335 register()] ğŸ§ª [KanataDaemonManager] Test mode detected â€“ bypassing bundle validation
[2025-11-22 13:38:24.458] [INFO] [LaunchDaemonInstaller.swift:467 createKanataLaunchDaemonViaSMAppService()] âŒ [LaunchDaemon] SMAppService registration failed: The operation couldnâ€™t be completed. (TestSMAppService error 1.)
[2025-11-22 13:38:24.458] [INFO] [LaunchDaemonInstaller.swift:469 createKanataLaunchDaemonViaSMAppService()] ğŸ’¡ [LaunchDaemon] User may need to approve in System Settings
Test Case '-[KeyPathTests.InstallerEngineFunctionalTests testSMAppServiceRegistrationFailureIsSurfaced]' passed (0.004 seconds).
Test Case '-[KeyPathTests.InstallerEngineFunctionalTests testSMAppServiceStateReportsKanataLoadedWithoutLegacyPlist]' started.
[2025-11-22 13:38:24.460] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:38:24.460] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:38:24.460] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 1 (SMAppServiceStatus(rawValue: 1))
[2025-11-22 13:38:24.460] [INFO] [KanataDaemonManager.swift:126 determineServiceManagementState()] âœ… [KanataDaemonManager] State: SMAPPSERVICE_ACTIVE
[2025-11-22 13:38:24.528] [INFO] [LaunchDaemonInstaller.swift:1836 getServiceStatus()] ğŸ” [LaunchDaemon] Kanata SMAppService-managed: loaded=true, healthy=false
[2025-11-22 13:38:24.528] [INFO] [LaunchDaemonInstaller.swift:704 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (test) Service com.keypath.karabiner-vhiddaemon considered loaded: false
[2025-11-22 13:38:24.529] [INFO] [LaunchDaemonInstaller.swift:704 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (test) Service com.keypath.karabiner-vhidmanager considered loaded: false
[2025-11-22 13:38:24.529] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:38:24.529] [INFO] [LaunchDaemonInstaller.swift:740 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] (test) Service com.keypath.karabiner-vhiddaemon considered healthy: false
[2025-11-22 13:38:24.529] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhidmanager
[2025-11-22 13:38:24.529] [INFO] [LaunchDaemonInstaller.swift:740 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] (test) Service com.keypath.karabiner-vhidmanager considered healthy: false
Test Case '-[KeyPathTests.InstallerEngineFunctionalTests testSMAppServiceStateReportsKanataLoadedWithoutLegacyPlist]' passed (0.076 seconds).
Test Case '-[KeyPathTests.InstallerEngineFunctionalTests testVhidConfigurationDetection]' started.
[2025-11-22 13:38:24.537] [INFO] [LaunchDaemonInstaller.swift:312 createAllLaunchDaemonServices()] ğŸ”§ [LaunchDaemon] Creating all LaunchDaemon services
[2025-11-22 13:38:24.537] [INFO] [ConfigurationService.swift:483 createInitialConfigIfNeeded()] âœ… [ConfigService] Config directory created at /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-A4248B97-B771-4709-BD76-4D8E2F3B18F5/Users/tester/.config/keypath
[2025-11-22 13:38:24.537] [INFO] [ConfigurationService.swift:488 createInitialConfigIfNeeded()] âš ï¸ [ConfigService] No existing config found at /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-A4248B97-B771-4709-BD76-4D8E2F3B18F5/Users/tester/.config/keypath/keypath.kbd
[2025-11-22 13:38:24.537] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:38:24.537] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:38:24.538] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 725 characters
[2025-11-22 13:38:24.538] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:38:24.538] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 10 src keys, 10 layer keys, deduplicated to 10 unique mappings
[2025-11-22 13:38:24.538] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:38:24.538] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:38:24.538] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 0 mappings
[2025-11-22 13:38:24.538] [INFO] [ConfigurationService.swift:492 createInitialConfigIfNeeded()] âœ… [ConfigService] Created initial empty configuration
[2025-11-22 13:38:24.538] [INFO] [LaunchDaemonInstaller.swift:945 ensureDefaultUserConfigExists()] âœ… [LaunchDaemon] Created default user config at /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-A4248B97-B771-4709-BD76-4D8E2F3B18F5/Users/tester/.config/keypath/keypath.kbd
[2025-11-22 13:38:24.538] [INFO] [LaunchDaemonInstaller.swift:232 getKanataBinaryPath()] âŒ [LaunchDaemon] Bundled Kanata binary not found at: /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata
[2025-11-22 13:38:24.538] [INFO] [LaunchDaemonInstaller.swift:233 getKanataBinaryPath()] ğŸ’¡ [LaunchDaemon] User may need to reinstall Kanata components before proceeding
[2025-11-22 13:38:24.538] [INFO] [LaunchDaemonInstaller.swift:2689 buildKanataPlistArguments(binaryPath:)] ğŸ“¡ [LaunchDaemon] TCP server enabled on port 45000
[2025-11-22 13:38:24.538] [INFO] [LaunchDaemonInstaller.swift:2705 buildKanataPlistArguments(binaryPath:)] ğŸ”§ [LaunchDaemon] Built plist arguments: /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata --cfg /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-A4248B97-B771-4709-BD76-4D8E2F3B18F5/Users/tester/.config/keypath/keypath.kbd --port 45000 --debug --log-layer-changes
[2025-11-22 13:38:24.540] [INFO] [LaunchDaemonInstaller.swift:361 createAllLaunchDaemonServices()] ğŸ§ª [LaunchDaemon] Test mode without auth-script override â€“ using local installer path
[2025-11-22 13:38:24.540] [INFO] [LaunchDaemonInstaller.swift:1089 executeAllWithAdminPrivileges(kanataTemp:vhidDaemonTemp:vhidManagerTemp:)] ğŸ”§ [LaunchDaemon] Requesting admin privileges to install all services
[2025-11-22 13:38:24.541] [INFO] [LaunchDaemonInstaller.swift:1104 executeAllWithAdminPrivileges(kanataTemp:vhidDaemonTemp:vhidManagerTemp:)] âœ… [LaunchDaemon] (test) Installed all plists to /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/installer-engine-A4248B97-B771-4709-BD76-4D8E2F3B18F5/Library/LaunchDaemons
[2025-11-22 13:38:24.542] [INFO] [LaunchDaemonInstaller.swift:1919 isVHIDDaemonConfiguredCorrectly()] ğŸ” [LaunchDaemon] VHID plist ProgramArguments[0]=/Library/Application Support/org.pqrs/Karabiner-DriverKit-VirtualHIDDevice/Applications/Karabiner-VirtualHIDDevice-Daemon.app/Contents/MacOS/Karabiner-VirtualHIDDevice-Daemon | expected=/Library/Application Support/org.pqrs/Karabiner-DriverKit-VirtualHIDDevice/Applications/Karabiner-VirtualHIDDevice-Daemon.app/Contents/MacOS/Karabiner-VirtualHIDDevice-Daemon | ok=true
[2025-11-22 13:38:24.542] [INFO] [LaunchDaemonInstaller.swift:1919 isVHIDDaemonConfiguredCorrectly()] ğŸ” [LaunchDaemon] VHID plist ProgramArguments[0]=/tmp/bad-path | expected=/Library/Application Support/org.pqrs/Karabiner-DriverKit-VirtualHIDDevice/Applications/Karabiner-VirtualHIDDevice-Daemon.app/Contents/MacOS/Karabiner-VirtualHIDDevice-Daemon | ok=false
Test Case '-[KeyPathTests.InstallerEngineFunctionalTests testVhidConfigurationDetection]' passed (0.009 seconds).
Test Suite 'InstallerEngineFunctionalTests' passed at 2025-11-22 13:38:24.544.
	 Executed 27 tests, with 0 failures (0 unexpected) in 65.654 (65.657) seconds
Test Suite 'InstallerEnginePerformanceTests' started at 2025-11-22 13:38:24.544.
Test Case '-[KeyPathTests.InstallerEnginePerformanceTests testInspectSystemPerformance]' started.
[2025-11-22 13:38:24.544] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:38:24.544] [INFO] [SystemValidator.swift:63 init(launchDaemonInstaller:vhidDeviceManager:processLifecycleManager:kanataManager:)] ğŸ” [SystemValidator] Initialized (stateless, no cache)
[2025-11-22 13:38:24.544] [INFO] [InstallerEngine.swift:35 init(processLifecycleManager:kanataManager:)] ğŸ”§ [InstallerEngine] Initialized
[2025-11-22 13:38:24.544] [INFO] [InstallerEngine.swift:53 inspectSystem()] ğŸ” [InstallerEngine] Starting inspectSystem()
[2025-11-22 13:38:24.544] [INFO] [SystemValidator.swift:143 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Starting validation #1
[2025-11-22 13:38:24.544] [INFO] [SystemValidator.swift:174 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 START: 1763847504.544
[2025-11-22 13:38:24.544] [INFO] [SystemValidator.swift:312 checkHelper()] ğŸ” [SystemValidator] Checking privileged helper
[2025-11-22 13:38:24.544] [INFO] [SystemValidator.swift:344 checkPermissions()] ğŸ” [SystemValidator] Checking permissions via Oracle
[2025-11-22 13:38:24.544] [INFO] [SystemValidator.swift:372 checkComponents()] ğŸ” [SystemValidator] Checking components
[2025-11-22 13:38:24.544] [INFO] [KanataBinaryDetector.swift:66 detectCurrentStatus()] ğŸ” [KanataBinaryDetector] Starting unified kanata binary detection
[2025-11-22 13:38:24.544] [INFO] [PermissionOracle.swift:173 currentSnapshot()] ğŸ”® [Oracle] Test mode snapshot generated (non-blocking)
[2025-11-22 13:38:24.544] [INFO] [KanataBinaryDetector.swift:81 detectCurrentStatus()] âŒ [KanataBinaryDetector] No kanata binary found
[2025-11-22 13:38:24.544] [INFO] [VHIDDeviceManager.swift:50 detectInstallation()] ğŸ” [VHIDManager] Manager app exists at /Applications/.Karabiner-VirtualHIDDevice-Manager.app/Contents/MacOS/Karabiner-VirtualHIDDevice-Manager: true
[2025-11-22 13:38:24.550] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:38:24.554] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:38:24.573] [INFO] [HelperManager.swift:830 verifyEmbeddedHelperSignature()] ğŸ”’ [HelperManager] Embedded helper signature looks valid
[2025-11-22 13:38:24.573] [INFO] [HelperManager.swift:105 getConnection()] ğŸ”— [HelperManager] Creating XPC connection to com.keypath.helper
[2025-11-22 13:38:24.573] [INFO] [HelperManager.swift:129 getConnection()] âœ… [HelperManager] XPC connection established (PID: 0)
[2025-11-22 13:38:24.573] [INFO] [HelperManager.swift:228 getHelperVersion()] ğŸ“¤ [HelperManager] Calling proxy.getVersion()
[2025-11-22 13:38:24.574] [INFO] [HelperManager.swift:243 getHelperVersion()] ğŸ“¤ [HelperManager] proxy.getVersion() call dispatched, waiting for callback
[2025-11-22 13:38:24.578] [INFO] [HelperManager.swift:121 getConnection()] âš ï¸ [HelperManager] XPC connection interrupted - will reconnect
[2025-11-22 13:38:24.578] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:38:24.578] [INFO] [HelperManager.swift:578 getRemoteProxy(errorHandler:)] âŒ [HelperManager] XPC proxy error: Couldnâ€™t communicate with a helper application.
[2025-11-22 13:38:24.578] [INFO] [HelperManager.swift:584 getRemoteProxy(errorHandler:)] âš ï¸ [HelperManager] XPC connection interrupted - this may indicate:
[2025-11-22 13:38:24.578] [INFO] [HelperManager.swift:585 getRemoteProxy(errorHandler:)]    1. Helper signature validation failed (app updated but not restarted)
[2025-11-22 13:38:24.578] [INFO] [HelperManager.swift:587 getRemoteProxy(errorHandler:)]    2. Helper process crashed
[2025-11-22 13:38:24.578] [INFO] [HelperManager.swift:588 getRemoteProxy(errorHandler:)]    3. Helper was killed by the system
[2025-11-22 13:38:24.578] [INFO] [HelperManager.swift:589 getRemoteProxy(errorHandler:)] ğŸ’¡ If you just updated KeyPath, try restarting the app
[2025-11-22 13:38:24.578] [INFO] [HelperManager.swift:116 getConnection()] âŒ [HelperManager] XPC connection invalidated
[2025-11-22 13:38:24.578] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:38:24.611] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.067s)
[2025-11-22 13:38:24.612] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:38:25.185] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.068s)
[2025-11-22 13:38:25.185] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:38:25.185] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:38:25.186] [INFO] [VHIDDeviceManager.swift:343 getInstalledVersion()] ğŸ” [VHIDManager] Installed daemon version: 5.0.0
[2025-11-22 13:38:25.187] [INFO] [VHIDDeviceManager.swift:374 hasVersionMismatch()] âœ… [VHIDManager] Version compatible: v5.0.0
[2025-11-22 13:38:25.187] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:38:25.255] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:38:25.255] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:38:25.256] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:38:25.256] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:38:25.256] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:38:25.256] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:38:25.256] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:38:25.256] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:38:25.256] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:38:25.256] [INFO] [LaunchDaemonInstaller.swift:669 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Kanata service state: Uninstalled
[2025-11-22 13:38:25.256] [INFO] [LaunchDaemonInstaller.swift:696 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Service not installed (state: Uninstalled)
[2025-11-22 13:38:25.256] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:38:25.324] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:38:25.392] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhiddaemon loaded: false
[2025-11-22 13:38:25.457] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhidmanager loaded: false
[2025-11-22 13:38:25.457] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:38:25.526] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:38:25.526] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhidmanager
[2025-11-22 13:38:25.594] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhidmanager not found in system domain
[2025-11-22 13:38:25.594] [INFO] [SystemValidator.swift:400 checkComponents()] ğŸ” [SystemValidator] Components: kanata=false, driver=true, daemon=false, vhid=false, vhidVersionMismatch=false
[2025-11-22 13:38:25.594] [INFO] [SystemValidator.swift:418 checkConflicts()] ğŸ” [SystemValidator] Checking for conflicts
[2025-11-22 13:38:25.594] [INFO] [SystemValidator.swift:220 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 3 (Components) completed in 1.050s
[2025-11-22 13:38:25.594] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 20% (1/5 steps)
[2025-11-22 13:38:25.594] [INFO] [ProcessLifecycleManager.swift:117 detectConflicts()] ğŸ” [ProcessLifecycleManager] Detecting conflicts...
[2025-11-22 13:38:25.594] [INFO] [ProcessLifecycleManager.swift:121 detectConflicts()] ğŸ§ª [TestEnvironment] Skipping process conflict detection - returning clean state
[2025-11-22 13:38:25.594] [INFO] [SystemValidator.swift:443 checkConflicts()] ğŸ” [SystemValidator] Total conflicts: 0 (0 kanata, 0 karabiner)
[2025-11-22 13:38:25.594] [INFO] [SystemValidator.swift:484 checkHealth()] ğŸ” [SystemValidator] Checking system health
[2025-11-22 13:38:25.594] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:38:25.594] [INFO] [SystemValidator.swift:229 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 4 (Conflicts) completed in 1.050s
[2025-11-22 13:38:25.594] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 40% (2/5 steps)
[2025-11-22 13:38:25.662] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:38:25.662] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:38:25.726] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:38:25.793] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.066s)
[2025-11-22 13:38:25.793] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:38:26.366] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.067s)
[2025-11-22 13:38:26.366] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:38:26.366] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:38:26.366] [INFO] [SystemValidator.swift:494 checkHealth()] ğŸ” [SystemValidator] Health: kanata=false, daemon=false (launchctl), vhid=false
[2025-11-22 13:38:26.366] [INFO] [SystemValidator.swift:238 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 5 (Health) completed in 1.822s
[2025-11-22 13:38:26.366] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 60% (3/5 steps)
[2025-11-22 13:38:26.366] [INFO] [SystemValidator.swift:362 checkPermissions()] ğŸ” [SystemValidator] Oracle snapshot: ready=false, age=1.822s
[2025-11-22 13:38:26.366] [INFO] [SystemValidator.swift:211 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 2 (Permissions) completed in 1.822s
[2025-11-22 13:38:26.367] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 80% (4/5 steps)
[2025-11-22 13:38:27.649] [INFO] [HelperManager.swift:248 getHelperVersion()] âš ï¸ [HelperManager] getVersion timed out - clearing connection cache
[2025-11-22 13:38:27.649] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:38:27.649] [INFO] [SystemValidator.swift:328 checkHelper()] ğŸ” [SystemValidator] Helper state: registeredButUnresponsive Helper registered but XPC communication failed
[2025-11-22 13:38:27.649] [INFO] [SystemValidator.swift:202 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 1 (Helper) completed in 3.105s
[2025-11-22 13:38:27.649] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 100% (5/5 steps)
[2025-11-22 13:38:27.649] [INFO] [SystemValidator.swift:283 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 COMPLETE: Total duration 3.105s
[2025-11-22 13:38:27.649] [INFO] [SystemValidator.swift:297 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Validation #1 complete in 3.105s
[2025-11-22 13:38:27.649] [INFO] [SystemValidator.swift:299 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Result: ready=false, blocking=9, total=9
[2025-11-22 13:38:27.649] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:38:27.649] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:38:27.649] [INFO] [SystemRequirements.swift:135 validateSystemCompatibility()] ğŸ” [SystemRequirements] Validating system compatibility
[2025-11-22 13:38:27.649] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:38:27.649] [INFO] [SystemRequirements.swift:147 validateSystemCompatibility()] âœ… [SystemRequirements] Modern macOS detected: 26.0.1
[2025-11-22 13:38:27.649] [INFO] [SystemRequirements.swift:190 validateSystemCompatibility()] ğŸ” [SystemRequirements] Compatibility check complete: âœ… Compatible
[2025-11-22 13:38:27.649] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:38:27.649] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:38:27.649] [INFO] [InstallerEngine.swift:78 inspectSystem()] âœ… [InstallerEngine] inspectSystem() complete - ready=false, blocking=9
[2025-11-22 13:38:27.649] [INFO] [InstallerEngine.swift:53 inspectSystem()] ğŸ” [InstallerEngine] Starting inspectSystem()
[2025-11-22 13:38:27.649] [INFO] [SystemValidator.swift:143 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Starting validation #1
[2025-11-22 13:38:27.649] [INFO] [SystemValidator.swift:174 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 START: 1763847507.649
[2025-11-22 13:38:27.650] [INFO] [SystemValidator.swift:312 checkHelper()] ğŸ” [SystemValidator] Checking privileged helper
[2025-11-22 13:38:27.650] [INFO] [SystemValidator.swift:344 checkPermissions()] ğŸ” [SystemValidator] Checking permissions via Oracle
[2025-11-22 13:38:27.650] [INFO] [SystemValidator.swift:372 checkComponents()] ğŸ” [SystemValidator] Checking components
[2025-11-22 13:38:27.650] [INFO] [KanataBinaryDetector.swift:66 detectCurrentStatus()] ğŸ” [KanataBinaryDetector] Starting unified kanata binary detection
[2025-11-22 13:38:27.650] [INFO] [PermissionOracle.swift:173 currentSnapshot()] ğŸ”® [Oracle] Test mode snapshot generated (non-blocking)
[2025-11-22 13:38:27.650] [INFO] [KanataBinaryDetector.swift:81 detectCurrentStatus()] âŒ [KanataBinaryDetector] No kanata binary found
[2025-11-22 13:38:27.650] [INFO] [VHIDDeviceManager.swift:50 detectInstallation()] ğŸ” [VHIDManager] Manager app exists at /Applications/.Karabiner-VirtualHIDDevice-Manager.app/Contents/MacOS/Karabiner-VirtualHIDDevice-Manager: true
[2025-11-22 13:38:27.661] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:38:27.670] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:38:27.692] [INFO] [HelperManager.swift:830 verifyEmbeddedHelperSignature()] ğŸ”’ [HelperManager] Embedded helper signature looks valid
[2025-11-22 13:38:27.692] [INFO] [HelperManager.swift:105 getConnection()] ğŸ”— [HelperManager] Creating XPC connection to com.keypath.helper
[2025-11-22 13:38:27.692] [INFO] [HelperManager.swift:129 getConnection()] âœ… [HelperManager] XPC connection established (PID: 0)
[2025-11-22 13:38:27.692] [INFO] [HelperManager.swift:228 getHelperVersion()] ğŸ“¤ [HelperManager] Calling proxy.getVersion()
[2025-11-22 13:38:27.692] [INFO] [HelperManager.swift:243 getHelperVersion()] ğŸ“¤ [HelperManager] proxy.getVersion() call dispatched, waiting for callback
[2025-11-22 13:38:27.693] [INFO] [HelperManager.swift:121 getConnection()] âš ï¸ [HelperManager] XPC connection interrupted - will reconnect
[2025-11-22 13:38:27.693] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:38:27.693] [INFO] [HelperManager.swift:578 getRemoteProxy(errorHandler:)] âŒ [HelperManager] XPC proxy error: Couldnâ€™t communicate with a helper application.
[2025-11-22 13:38:27.693] [INFO] [HelperManager.swift:584 getRemoteProxy(errorHandler:)] âš ï¸ [HelperManager] XPC connection interrupted - this may indicate:
[2025-11-22 13:38:27.693] [INFO] [HelperManager.swift:585 getRemoteProxy(errorHandler:)]    1. Helper signature validation failed (app updated but not restarted)
[2025-11-22 13:38:27.693] [INFO] [HelperManager.swift:587 getRemoteProxy(errorHandler:)]    2. Helper process crashed
[2025-11-22 13:38:27.693] [INFO] [HelperManager.swift:588 getRemoteProxy(errorHandler:)]    3. Helper was killed by the system
[2025-11-22 13:38:27.693] [INFO] [HelperManager.swift:589 getRemoteProxy(errorHandler:)] ğŸ’¡ If you just updated KeyPath, try restarting the app
[2025-11-22 13:38:27.693] [INFO] [HelperManager.swift:116 getConnection()] âŒ [HelperManager] XPC connection invalidated
[2025-11-22 13:38:27.693] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:38:27.718] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.068s)
[2025-11-22 13:38:27.718] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:38:28.292] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.068s)
[2025-11-22 13:38:28.292] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:38:28.292] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:38:28.292] [INFO] [VHIDDeviceManager.swift:343 getInstalledVersion()] ğŸ” [VHIDManager] Installed daemon version: 5.0.0
[2025-11-22 13:38:28.292] [INFO] [VHIDDeviceManager.swift:374 hasVersionMismatch()] âœ… [VHIDManager] Version compatible: v5.0.0
[2025-11-22 13:38:28.292] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:38:28.360] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:38:28.361] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:38:28.361] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:38:28.361] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:38:28.361] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:38:28.361] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:38:28.361] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:38:28.361] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:38:28.361] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:38:28.361] [INFO] [LaunchDaemonInstaller.swift:669 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Kanata service state: Uninstalled
[2025-11-22 13:38:28.361] [INFO] [LaunchDaemonInstaller.swift:696 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Service not installed (state: Uninstalled)
[2025-11-22 13:38:28.361] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:38:28.428] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:38:28.496] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhiddaemon loaded: false
[2025-11-22 13:38:28.564] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhidmanager loaded: false
[2025-11-22 13:38:28.564] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:38:28.633] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:38:28.633] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhidmanager
[2025-11-22 13:38:28.699] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhidmanager not found in system domain
[2025-11-22 13:38:28.699] [INFO] [SystemValidator.swift:400 checkComponents()] ğŸ” [SystemValidator] Components: kanata=false, driver=true, daemon=false, vhid=false, vhidVersionMismatch=false
[2025-11-22 13:38:28.699] [INFO] [SystemValidator.swift:220 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 3 (Components) completed in 1.050s
[2025-11-22 13:38:28.699] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 20% (1/5 steps)
[2025-11-22 13:38:28.699] [INFO] [SystemValidator.swift:418 checkConflicts()] ğŸ” [SystemValidator] Checking for conflicts
[2025-11-22 13:38:28.699] [INFO] [ProcessLifecycleManager.swift:117 detectConflicts()] ğŸ” [ProcessLifecycleManager] Detecting conflicts...
[2025-11-22 13:38:28.699] [INFO] [ProcessLifecycleManager.swift:121 detectConflicts()] ğŸ§ª [TestEnvironment] Skipping process conflict detection - returning clean state
[2025-11-22 13:38:28.699] [INFO] [SystemValidator.swift:443 checkConflicts()] ğŸ” [SystemValidator] Total conflicts: 0 (0 kanata, 0 karabiner)
[2025-11-22 13:38:28.699] [INFO] [SystemValidator.swift:484 checkHealth()] ğŸ” [SystemValidator] Checking system health
[2025-11-22 13:38:28.699] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:38:28.700] [INFO] [SystemValidator.swift:229 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 4 (Conflicts) completed in 1.050s
[2025-11-22 13:38:28.700] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 40% (2/5 steps)
[2025-11-22 13:38:28.768] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:38:28.768] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:38:28.836] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:38:28.905] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.068s)
[2025-11-22 13:38:28.905] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:38:29.479] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.068s)
[2025-11-22 13:38:29.479] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:38:29.479] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:38:29.479] [INFO] [SystemValidator.swift:494 checkHealth()] ğŸ” [SystemValidator] Health: kanata=false, daemon=false (launchctl), vhid=false
[2025-11-22 13:38:29.479] [INFO] [SystemValidator.swift:238 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 5 (Health) completed in 1.829s
[2025-11-22 13:38:29.479] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 60% (3/5 steps)
[2025-11-22 13:38:29.479] [INFO] [SystemValidator.swift:362 checkPermissions()] ğŸ” [SystemValidator] Oracle snapshot: ready=false, age=1.829s
[2025-11-22 13:38:29.479] [INFO] [SystemValidator.swift:211 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 2 (Permissions) completed in 1.829s
[2025-11-22 13:38:29.479] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 80% (4/5 steps)
[2025-11-22 13:38:30.759] [INFO] [HelperManager.swift:248 getHelperVersion()] âš ï¸ [HelperManager] getVersion timed out - clearing connection cache
[2025-11-22 13:38:30.759] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:38:30.759] [INFO] [SystemValidator.swift:328 checkHelper()] ğŸ” [SystemValidator] Helper state: registeredButUnresponsive Helper registered but XPC communication failed
[2025-11-22 13:38:30.760] [INFO] [SystemValidator.swift:202 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 1 (Helper) completed in 3.110s
[2025-11-22 13:38:30.760] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 100% (5/5 steps)
[2025-11-22 13:38:30.760] [INFO] [SystemValidator.swift:283 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 COMPLETE: Total duration 3.110s
[2025-11-22 13:38:30.760] [INFO] [SystemValidator.swift:297 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Validation #1 complete in 3.110s
[2025-11-22 13:38:30.760] [INFO] [SystemValidator.swift:299 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Result: ready=false, blocking=9, total=9
[2025-11-22 13:38:30.760] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:38:30.760] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:38:30.760] [INFO] [SystemRequirements.swift:135 validateSystemCompatibility()] ğŸ” [SystemRequirements] Validating system compatibility
[2025-11-22 13:38:30.760] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:38:30.760] [INFO] [SystemRequirements.swift:147 validateSystemCompatibility()] âœ… [SystemRequirements] Modern macOS detected: 26.0.1
[2025-11-22 13:38:30.760] [INFO] [SystemRequirements.swift:190 validateSystemCompatibility()] ğŸ” [SystemRequirements] Compatibility check complete: âœ… Compatible
[2025-11-22 13:38:30.760] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:38:30.760] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:38:30.760] [INFO] [InstallerEngine.swift:78 inspectSystem()] âœ… [InstallerEngine] inspectSystem() complete - ready=false, blocking=9
[2025-11-22 13:38:30.760] [INFO] [InstallerEngine.swift:53 inspectSystem()] ğŸ” [InstallerEngine] Starting inspectSystem()
[2025-11-22 13:38:30.760] [INFO] [SystemValidator.swift:143 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Starting validation #1
[2025-11-22 13:38:30.760] [INFO] [SystemValidator.swift:174 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 START: 1763847510.760
[2025-11-22 13:38:30.760] [INFO] [SystemValidator.swift:312 checkHelper()] ğŸ” [SystemValidator] Checking privileged helper
[2025-11-22 13:38:30.761] [INFO] [SystemValidator.swift:344 checkPermissions()] ğŸ” [SystemValidator] Checking permissions via Oracle
[2025-11-22 13:38:30.761] [INFO] [SystemValidator.swift:372 checkComponents()] ğŸ” [SystemValidator] Checking components
[2025-11-22 13:38:30.761] [INFO] [KanataBinaryDetector.swift:66 detectCurrentStatus()] ğŸ” [KanataBinaryDetector] Starting unified kanata binary detection
[2025-11-22 13:38:30.761] [INFO] [PermissionOracle.swift:173 currentSnapshot()] ğŸ”® [Oracle] Test mode snapshot generated (non-blocking)
[2025-11-22 13:38:30.761] [INFO] [KanataBinaryDetector.swift:81 detectCurrentStatus()] âŒ [KanataBinaryDetector] No kanata binary found
[2025-11-22 13:38:30.761] [INFO] [VHIDDeviceManager.swift:50 detectInstallation()] ğŸ” [VHIDManager] Manager app exists at /Applications/.Karabiner-VirtualHIDDevice-Manager.app/Contents/MacOS/Karabiner-VirtualHIDDevice-Manager: true
[2025-11-22 13:38:30.774] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:38:30.784] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:38:30.808] [INFO] [HelperManager.swift:830 verifyEmbeddedHelperSignature()] ğŸ”’ [HelperManager] Embedded helper signature looks valid
[2025-11-22 13:38:30.808] [INFO] [HelperManager.swift:105 getConnection()] ğŸ”— [HelperManager] Creating XPC connection to com.keypath.helper
[2025-11-22 13:38:30.808] [INFO] [HelperManager.swift:129 getConnection()] âœ… [HelperManager] XPC connection established (PID: 0)
[2025-11-22 13:38:30.808] [INFO] [HelperManager.swift:228 getHelperVersion()] ğŸ“¤ [HelperManager] Calling proxy.getVersion()
[2025-11-22 13:38:30.808] [INFO] [HelperManager.swift:243 getHelperVersion()] ğŸ“¤ [HelperManager] proxy.getVersion() call dispatched, waiting for callback
[2025-11-22 13:38:30.809] [INFO] [HelperManager.swift:121 getConnection()] âš ï¸ [HelperManager] XPC connection interrupted - will reconnect
[2025-11-22 13:38:30.809] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:38:30.809] [INFO] [HelperManager.swift:578 getRemoteProxy(errorHandler:)] âŒ [HelperManager] XPC proxy error: Couldnâ€™t communicate with a helper application.
[2025-11-22 13:38:30.809] [INFO] [HelperManager.swift:584 getRemoteProxy(errorHandler:)] âš ï¸ [HelperManager] XPC connection interrupted - this may indicate:
[2025-11-22 13:38:30.809] [INFO] [HelperManager.swift:585 getRemoteProxy(errorHandler:)]    1. Helper signature validation failed (app updated but not restarted)
[2025-11-22 13:38:30.809] [INFO] [HelperManager.swift:587 getRemoteProxy(errorHandler:)]    2. Helper process crashed
[2025-11-22 13:38:30.809] [INFO] [HelperManager.swift:588 getRemoteProxy(errorHandler:)]    3. Helper was killed by the system
[2025-11-22 13:38:30.809] [INFO] [HelperManager.swift:589 getRemoteProxy(errorHandler:)] ğŸ’¡ If you just updated KeyPath, try restarting the app
[2025-11-22 13:38:30.809] [INFO] [HelperManager.swift:116 getConnection()] âŒ [HelperManager] XPC connection invalidated
[2025-11-22 13:38:30.809] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:38:30.827] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.066s)
[2025-11-22 13:38:30.827] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:38:33.867] [INFO] [HelperManager.swift:248 getHelperVersion()] âš ï¸ [HelperManager] getVersion timed out - clearing connection cache
[2025-11-22 13:38:33.868] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:38:34.401] [INFO] [VHIDDeviceManager.swift:168 evaluateDaemonProcess()] âš ï¸ [VHIDManager] VHIDDevice process check timed out after 3s - fallback launchctl says running=false
[2025-11-22 13:38:34.471] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:38:34.471] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:38:34.471] [INFO] [VHIDDeviceManager.swift:343 getInstalledVersion()] ğŸ” [VHIDManager] Installed daemon version: 5.0.0
[2025-11-22 13:38:34.471] [INFO] [VHIDDeviceManager.swift:374 hasVersionMismatch()] âœ… [VHIDManager] Version compatible: v5.0.0
[2025-11-22 13:38:34.471] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:38:34.539] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:38:34.540] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:38:34.540] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:38:34.540] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:38:34.540] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:38:34.541] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:38:34.541] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:38:34.541] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:38:34.541] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:38:34.541] [INFO] [LaunchDaemonInstaller.swift:669 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Kanata service state: Uninstalled
[2025-11-22 13:38:34.541] [INFO] [LaunchDaemonInstaller.swift:696 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Service not installed (state: Uninstalled)
[2025-11-22 13:38:34.541] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:38:34.609] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:38:34.677] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhiddaemon loaded: false
[2025-11-22 13:38:34.745] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhidmanager loaded: false
[2025-11-22 13:38:34.745] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:38:34.812] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:38:34.812] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhidmanager
[2025-11-22 13:38:34.881] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhidmanager not found in system domain
[2025-11-22 13:38:34.881] [INFO] [SystemValidator.swift:400 checkComponents()] ğŸ” [SystemValidator] Components: kanata=false, driver=true, daemon=false, vhid=false, vhidVersionMismatch=false
[2025-11-22 13:38:34.881] [INFO] [SystemValidator.swift:220 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 3 (Components) completed in 4.121s
[2025-11-22 13:38:34.881] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 20% (1/5 steps)
[2025-11-22 13:38:34.881] [INFO] [SystemValidator.swift:418 checkConflicts()] ğŸ” [SystemValidator] Checking for conflicts
[2025-11-22 13:38:34.881] [INFO] [ProcessLifecycleManager.swift:117 detectConflicts()] ğŸ” [ProcessLifecycleManager] Detecting conflicts...
[2025-11-22 13:38:34.881] [INFO] [ProcessLifecycleManager.swift:121 detectConflicts()] ğŸ§ª [TestEnvironment] Skipping process conflict detection - returning clean state
[2025-11-22 13:38:34.881] [INFO] [SystemValidator.swift:443 checkConflicts()] ğŸ” [SystemValidator] Total conflicts: 0 (0 kanata, 0 karabiner)
[2025-11-22 13:38:34.881] [INFO] [SystemValidator.swift:484 checkHealth()] ğŸ” [SystemValidator] Checking system health
[2025-11-22 13:38:34.881] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:38:34.881] [INFO] [SystemValidator.swift:229 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 4 (Conflicts) completed in 4.121s
[2025-11-22 13:38:34.881] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 40% (2/5 steps)
[2025-11-22 13:38:34.950] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:38:34.950] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:38:35.018] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:38:35.086] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.068s)
[2025-11-22 13:38:35.086] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:38:35.660] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.068s)
[2025-11-22 13:38:35.660] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:38:35.660] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:38:35.660] [INFO] [SystemValidator.swift:494 checkHealth()] ğŸ” [SystemValidator] Health: kanata=false, daemon=false (launchctl), vhid=false
[2025-11-22 13:38:35.660] [INFO] [SystemValidator.swift:238 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 5 (Health) completed in 4.899s
[2025-11-22 13:38:35.660] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 60% (3/5 steps)
[2025-11-22 13:38:35.660] [INFO] [SystemValidator.swift:362 checkPermissions()] ğŸ” [SystemValidator] Oracle snapshot: ready=false, age=4.899s
[2025-11-22 13:38:35.660] [INFO] [SystemValidator.swift:328 checkHelper()] ğŸ” [SystemValidator] Helper state: registeredButUnresponsive Helper registered but XPC communication failed
[2025-11-22 13:38:35.660] [INFO] [SystemValidator.swift:211 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 2 (Permissions) completed in 4.900s
[2025-11-22 13:38:35.660] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 80% (4/5 steps)
[2025-11-22 13:38:35.660] [INFO] [SystemValidator.swift:202 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 1 (Helper) completed in 4.900s
[2025-11-22 13:38:35.660] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 100% (5/5 steps)
[2025-11-22 13:38:35.660] [INFO] [SystemValidator.swift:283 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 COMPLETE: Total duration 4.900s
[2025-11-22 13:38:35.660] [INFO] [SystemValidator.swift:297 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Validation #1 complete in 4.900s
[2025-11-22 13:38:35.660] [INFO] [SystemValidator.swift:299 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Result: ready=false, blocking=9, total=9
[2025-11-22 13:38:35.660] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:38:35.660] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:38:35.660] [INFO] [SystemRequirements.swift:135 validateSystemCompatibility()] ğŸ” [SystemRequirements] Validating system compatibility
[2025-11-22 13:38:35.660] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:38:35.660] [INFO] [SystemRequirements.swift:147 validateSystemCompatibility()] âœ… [SystemRequirements] Modern macOS detected: 26.0.1
[2025-11-22 13:38:35.660] [INFO] [SystemRequirements.swift:190 validateSystemCompatibility()] ğŸ” [SystemRequirements] Compatibility check complete: âœ… Compatible
[2025-11-22 13:38:35.660] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:38:35.660] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:38:35.660] [INFO] [InstallerEngine.swift:78 inspectSystem()] âœ… [InstallerEngine] inspectSystem() complete - ready=false, blocking=9
[2025-11-22 13:38:35.660] [INFO] [InstallerEngine.swift:53 inspectSystem()] ğŸ” [InstallerEngine] Starting inspectSystem()
[2025-11-22 13:38:35.660] [INFO] [SystemValidator.swift:143 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Starting validation #1
[2025-11-22 13:38:35.660] [INFO] [SystemValidator.swift:174 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 START: 1763847515.660
[2025-11-22 13:38:35.660] [INFO] [SystemValidator.swift:312 checkHelper()] ğŸ” [SystemValidator] Checking privileged helper
[2025-11-22 13:38:35.660] [INFO] [SystemValidator.swift:344 checkPermissions()] ğŸ” [SystemValidator] Checking permissions via Oracle
[2025-11-22 13:38:35.660] [INFO] [SystemValidator.swift:372 checkComponents()] ğŸ” [SystemValidator] Checking components
[2025-11-22 13:38:35.661] [INFO] [KanataBinaryDetector.swift:66 detectCurrentStatus()] ğŸ” [KanataBinaryDetector] Starting unified kanata binary detection
[2025-11-22 13:38:35.661] [INFO] [PermissionOracle.swift:173 currentSnapshot()] ğŸ”® [Oracle] Test mode snapshot generated (non-blocking)
[2025-11-22 13:38:35.661] [INFO] [KanataBinaryDetector.swift:81 detectCurrentStatus()] âŒ [KanataBinaryDetector] No kanata binary found
[2025-11-22 13:38:35.661] [INFO] [VHIDDeviceManager.swift:50 detectInstallation()] ğŸ” [VHIDManager] Manager app exists at /Applications/.Karabiner-VirtualHIDDevice-Manager.app/Contents/MacOS/Karabiner-VirtualHIDDevice-Manager: true
[2025-11-22 13:38:35.668] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:38:35.672] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:38:35.689] [INFO] [HelperManager.swift:830 verifyEmbeddedHelperSignature()] ğŸ”’ [HelperManager] Embedded helper signature looks valid
[2025-11-22 13:38:35.689] [INFO] [HelperManager.swift:105 getConnection()] ğŸ”— [HelperManager] Creating XPC connection to com.keypath.helper
[2025-11-22 13:38:35.689] [INFO] [HelperManager.swift:129 getConnection()] âœ… [HelperManager] XPC connection established (PID: 0)
[2025-11-22 13:38:35.689] [INFO] [HelperManager.swift:228 getHelperVersion()] ğŸ“¤ [HelperManager] Calling proxy.getVersion()
[2025-11-22 13:38:35.689] [INFO] [HelperManager.swift:243 getHelperVersion()] ğŸ“¤ [HelperManager] proxy.getVersion() call dispatched, waiting for callback
[2025-11-22 13:38:35.692] [INFO] [HelperManager.swift:121 getConnection()] âš ï¸ [HelperManager] XPC connection interrupted - will reconnect
[2025-11-22 13:38:35.692] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:38:35.692] [INFO] [HelperManager.swift:578 getRemoteProxy(errorHandler:)] âŒ [HelperManager] XPC proxy error: Couldnâ€™t communicate with a helper application.
[2025-11-22 13:38:35.692] [INFO] [HelperManager.swift:584 getRemoteProxy(errorHandler:)] âš ï¸ [HelperManager] XPC connection interrupted - this may indicate:
[2025-11-22 13:38:35.692] [INFO] [HelperManager.swift:585 getRemoteProxy(errorHandler:)]    1. Helper signature validation failed (app updated but not restarted)
[2025-11-22 13:38:35.692] [INFO] [HelperManager.swift:587 getRemoteProxy(errorHandler:)]    2. Helper process crashed
[2025-11-22 13:38:35.692] [INFO] [HelperManager.swift:588 getRemoteProxy(errorHandler:)]    3. Helper was killed by the system
[2025-11-22 13:38:35.692] [INFO] [HelperManager.swift:589 getRemoteProxy(errorHandler:)] ğŸ’¡ If you just updated KeyPath, try restarting the app
[2025-11-22 13:38:35.692] [INFO] [HelperManager.swift:116 getConnection()] âŒ [HelperManager] XPC connection invalidated
[2025-11-22 13:38:35.692] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:38:38.729] [INFO] [VHIDDeviceManager.swift:168 evaluateDaemonProcess()] âš ï¸ [VHIDManager] VHIDDevice process check timed out after 3s - fallback launchctl says running=false
[2025-11-22 13:38:38.764] [INFO] [HelperManager.swift:248 getHelperVersion()] âš ï¸ [HelperManager] getVersion timed out - clearing connection cache
[2025-11-22 13:38:38.765] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:38:38.798] [INFO] [VHIDDeviceManager.swift:88 detectRunning()] â³ [VHIDManager] Timeout while checking daemon; retrying to avoid false negatives
[2025-11-22 13:38:39.373] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.069s)
[2025-11-22 13:38:39.373] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:38:39.373] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:38:39.373] [INFO] [VHIDDeviceManager.swift:343 getInstalledVersion()] ğŸ” [VHIDManager] Installed daemon version: 5.0.0
[2025-11-22 13:38:39.373] [INFO] [VHIDDeviceManager.swift:374 hasVersionMismatch()] âœ… [VHIDManager] Version compatible: v5.0.0
[2025-11-22 13:38:39.373] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:38:39.441] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:38:39.442] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:38:39.442] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:38:39.442] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:38:39.442] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:38:39.442] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:38:39.442] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:38:39.443] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:38:39.443] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:38:39.443] [INFO] [LaunchDaemonInstaller.swift:669 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Kanata service state: Uninstalled
[2025-11-22 13:38:39.443] [INFO] [LaunchDaemonInstaller.swift:696 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Service not installed (state: Uninstalled)
[2025-11-22 13:38:39.443] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:38:39.512] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:38:39.581] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhiddaemon loaded: false
[2025-11-22 13:38:39.650] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhidmanager loaded: false
[2025-11-22 13:38:39.650] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:38:39.716] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:38:39.716] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhidmanager
[2025-11-22 13:38:39.783] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhidmanager not found in system domain
[2025-11-22 13:38:39.783] [INFO] [SystemValidator.swift:400 checkComponents()] ğŸ” [SystemValidator] Components: kanata=false, driver=true, daemon=false, vhid=false, vhidVersionMismatch=false
[2025-11-22 13:38:39.783] [INFO] [SystemValidator.swift:220 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 3 (Components) completed in 4.122s
[2025-11-22 13:38:39.783] [INFO] [SystemValidator.swift:418 checkConflicts()] ğŸ” [SystemValidator] Checking for conflicts
[2025-11-22 13:38:39.783] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 20% (1/5 steps)
[2025-11-22 13:38:39.783] [INFO] [ProcessLifecycleManager.swift:117 detectConflicts()] ğŸ” [ProcessLifecycleManager] Detecting conflicts...
[2025-11-22 13:38:39.783] [INFO] [ProcessLifecycleManager.swift:121 detectConflicts()] ğŸ§ª [TestEnvironment] Skipping process conflict detection - returning clean state
[2025-11-22 13:38:39.783] [INFO] [SystemValidator.swift:443 checkConflicts()] ğŸ” [SystemValidator] Total conflicts: 0 (0 kanata, 0 karabiner)
[2025-11-22 13:38:39.783] [INFO] [SystemValidator.swift:484 checkHealth()] ğŸ” [SystemValidator] Checking system health
[2025-11-22 13:38:39.783] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:38:39.783] [INFO] [SystemValidator.swift:229 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 4 (Conflicts) completed in 4.123s
[2025-11-22 13:38:39.783] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 40% (2/5 steps)
[2025-11-22 13:38:39.850] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:38:39.850] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:38:39.918] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:38:39.985] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.067s)
[2025-11-22 13:38:39.985] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:38:40.558] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.067s)
[2025-11-22 13:38:40.558] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:38:40.558] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:38:40.558] [INFO] [SystemValidator.swift:494 checkHealth()] ğŸ” [SystemValidator] Health: kanata=false, daemon=false (launchctl), vhid=false
[2025-11-22 13:38:40.558] [INFO] [SystemValidator.swift:238 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 5 (Health) completed in 4.898s
[2025-11-22 13:38:40.558] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 60% (3/5 steps)
[2025-11-22 13:38:40.558] [INFO] [SystemValidator.swift:362 checkPermissions()] ğŸ” [SystemValidator] Oracle snapshot: ready=false, age=4.898s
[2025-11-22 13:38:40.558] [INFO] [SystemValidator.swift:328 checkHelper()] ğŸ” [SystemValidator] Helper state: registeredButUnresponsive Helper registered but XPC communication failed
[2025-11-22 13:38:40.558] [INFO] [SystemValidator.swift:211 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 2 (Permissions) completed in 4.898s
[2025-11-22 13:38:40.558] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 80% (4/5 steps)
[2025-11-22 13:38:40.558] [INFO] [SystemValidator.swift:202 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 1 (Helper) completed in 4.898s
[2025-11-22 13:38:40.558] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 100% (5/5 steps)
[2025-11-22 13:38:40.559] [INFO] [SystemValidator.swift:283 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 COMPLETE: Total duration 4.898s
[2025-11-22 13:38:40.559] [INFO] [SystemValidator.swift:297 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Validation #1 complete in 4.898s
[2025-11-22 13:38:40.559] [INFO] [SystemValidator.swift:299 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Result: ready=false, blocking=9, total=9
[2025-11-22 13:38:40.559] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:38:40.559] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:38:40.559] [INFO] [SystemRequirements.swift:135 validateSystemCompatibility()] ğŸ” [SystemRequirements] Validating system compatibility
[2025-11-22 13:38:40.559] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:38:40.559] [INFO] [SystemRequirements.swift:147 validateSystemCompatibility()] âœ… [SystemRequirements] Modern macOS detected: 26.0.1
[2025-11-22 13:38:40.559] [INFO] [SystemRequirements.swift:190 validateSystemCompatibility()] ğŸ” [SystemRequirements] Compatibility check complete: âœ… Compatible
[2025-11-22 13:38:40.559] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:38:40.559] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:38:40.559] [INFO] [InstallerEngine.swift:78 inspectSystem()] âœ… [InstallerEngine] inspectSystem() complete - ready=false, blocking=9
[2025-11-22 13:38:40.559] [INFO] [InstallerEngine.swift:53 inspectSystem()] ğŸ” [InstallerEngine] Starting inspectSystem()
[2025-11-22 13:38:40.559] [INFO] [SystemValidator.swift:143 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Starting validation #1
[2025-11-22 13:38:40.559] [INFO] [SystemValidator.swift:174 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 START: 1763847520.559
[2025-11-22 13:38:40.559] [INFO] [SystemValidator.swift:312 checkHelper()] ğŸ” [SystemValidator] Checking privileged helper
[2025-11-22 13:38:40.559] [INFO] [SystemValidator.swift:372 checkComponents()] ğŸ” [SystemValidator] Checking components
[2025-11-22 13:38:40.559] [INFO] [KanataBinaryDetector.swift:66 detectCurrentStatus()] ğŸ” [KanataBinaryDetector] Starting unified kanata binary detection
[2025-11-22 13:38:40.559] [INFO] [KanataBinaryDetector.swift:81 detectCurrentStatus()] âŒ [KanataBinaryDetector] No kanata binary found
[2025-11-22 13:38:40.559] [INFO] [VHIDDeviceManager.swift:50 detectInstallation()] ğŸ” [VHIDManager] Manager app exists at /Applications/.Karabiner-VirtualHIDDevice-Manager.app/Contents/MacOS/Karabiner-VirtualHIDDevice-Manager: true
[2025-11-22 13:38:40.566] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:38:40.572] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:38:40.591] [INFO] [HelperManager.swift:830 verifyEmbeddedHelperSignature()] ğŸ”’ [HelperManager] Embedded helper signature looks valid
[2025-11-22 13:38:40.591] [INFO] [HelperManager.swift:105 getConnection()] ğŸ”— [HelperManager] Creating XPC connection to com.keypath.helper
[2025-11-22 13:38:40.591] [INFO] [HelperManager.swift:129 getConnection()] âœ… [HelperManager] XPC connection established (PID: 0)
[2025-11-22 13:38:40.591] [INFO] [HelperManager.swift:228 getHelperVersion()] ğŸ“¤ [HelperManager] Calling proxy.getVersion()
[2025-11-22 13:38:40.592] [INFO] [HelperManager.swift:243 getHelperVersion()] ğŸ“¤ [HelperManager] proxy.getVersion() call dispatched, waiting for callback
[2025-11-22 13:38:40.592] [INFO] [HelperManager.swift:121 getConnection()] âš ï¸ [HelperManager] XPC connection interrupted - will reconnect
[2025-11-22 13:38:40.592] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:38:40.592] [INFO] [HelperManager.swift:578 getRemoteProxy(errorHandler:)] âŒ [HelperManager] XPC proxy error: Couldnâ€™t communicate with a helper application.
[2025-11-22 13:38:40.592] [INFO] [HelperManager.swift:584 getRemoteProxy(errorHandler:)] âš ï¸ [HelperManager] XPC connection interrupted - this may indicate:
[2025-11-22 13:38:40.592] [INFO] [HelperManager.swift:585 getRemoteProxy(errorHandler:)]    1. Helper signature validation failed (app updated but not restarted)
[2025-11-22 13:38:40.592] [INFO] [HelperManager.swift:587 getRemoteProxy(errorHandler:)]    2. Helper process crashed
[2025-11-22 13:38:40.592] [INFO] [HelperManager.swift:588 getRemoteProxy(errorHandler:)]    3. Helper was killed by the system
[2025-11-22 13:38:40.592] [INFO] [HelperManager.swift:589 getRemoteProxy(errorHandler:)] ğŸ’¡ If you just updated KeyPath, try restarting the app
[2025-11-22 13:38:40.592] [INFO] [HelperManager.swift:116 getConnection()] âŒ [HelperManager] XPC connection invalidated
[2025-11-22 13:38:40.592] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:38:43.628] [INFO] [VHIDDeviceManager.swift:168 evaluateDaemonProcess()] âš ï¸ [VHIDManager] VHIDDevice process check timed out after 3s - fallback launchctl says running=false
[2025-11-22 13:38:43.666] [INFO] [HelperManager.swift:248 getHelperVersion()] âš ï¸ [HelperManager] getVersion timed out - clearing connection cache
[2025-11-22 13:38:43.666] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:38:43.696] [INFO] [VHIDDeviceManager.swift:88 detectRunning()] â³ [VHIDManager] Timeout while checking daemon; retrying to avoid false negatives
[2025-11-22 13:38:47.271] [INFO] [VHIDDeviceManager.swift:168 evaluateDaemonProcess()] âš ï¸ [VHIDManager] VHIDDevice process check timed out after 3s - fallback launchctl says running=false
[2025-11-22 13:38:47.339] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:38:47.339] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:38:47.339] [INFO] [VHIDDeviceManager.swift:343 getInstalledVersion()] ğŸ” [VHIDManager] Installed daemon version: 5.0.0
[2025-11-22 13:38:47.339] [INFO] [VHIDDeviceManager.swift:374 hasVersionMismatch()] âœ… [VHIDManager] Version compatible: v5.0.0
[2025-11-22 13:38:47.340] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:38:47.408] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:38:47.409] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:38:47.409] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:38:47.409] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:38:47.409] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:38:47.409] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:38:47.409] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:38:47.409] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:38:47.409] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:38:47.409] [INFO] [LaunchDaemonInstaller.swift:669 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Kanata service state: Uninstalled
[2025-11-22 13:38:47.409] [INFO] [LaunchDaemonInstaller.swift:696 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Service not installed (state: Uninstalled)
[2025-11-22 13:38:47.409] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:38:47.476] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:38:47.542] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhiddaemon loaded: false
[2025-11-22 13:38:47.610] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhidmanager loaded: false
[2025-11-22 13:38:47.610] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:38:47.678] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:38:47.678] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhidmanager
[2025-11-22 13:38:47.745] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhidmanager not found in system domain
[2025-11-22 13:38:47.745] [INFO] [SystemValidator.swift:400 checkComponents()] ğŸ” [SystemValidator] Components: kanata=false, driver=true, daemon=false, vhid=false, vhidVersionMismatch=false
[2025-11-22 13:38:47.745] [INFO] [SystemValidator.swift:220 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 3 (Components) completed in 7.186s
[2025-11-22 13:38:47.745] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 20% (1/5 steps)
[2025-11-22 13:38:47.745] [INFO] [SystemValidator.swift:344 checkPermissions()] ğŸ” [SystemValidator] Checking permissions via Oracle
[2025-11-22 13:38:47.745] [INFO] [SystemValidator.swift:484 checkHealth()] ğŸ” [SystemValidator] Checking system health
[2025-11-22 13:38:47.745] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:38:47.745] [INFO] [PermissionOracle.swift:173 currentSnapshot()] ğŸ”® [Oracle] Test mode snapshot generated (non-blocking)
[2025-11-22 13:38:47.814] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:38:47.814] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:38:47.882] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:38:47.950] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.067s)
[2025-11-22 13:38:47.950] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:38:48.524] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.068s)
[2025-11-22 13:38:48.524] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:38:48.524] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:38:48.524] [INFO] [SystemValidator.swift:494 checkHealth()] ğŸ” [SystemValidator] Health: kanata=false, daemon=false (launchctl), vhid=false
[2025-11-22 13:38:48.524] [INFO] [SystemValidator.swift:238 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 5 (Health) completed in 7.965s
[2025-11-22 13:38:48.524] [INFO] [SystemValidator.swift:418 checkConflicts()] ğŸ” [SystemValidator] Checking for conflicts
[2025-11-22 13:38:48.524] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 40% (2/5 steps)
[2025-11-22 13:38:48.524] [INFO] [ProcessLifecycleManager.swift:117 detectConflicts()] ğŸ” [ProcessLifecycleManager] Detecting conflicts...
[2025-11-22 13:38:48.524] [INFO] [ProcessLifecycleManager.swift:121 detectConflicts()] ğŸ§ª [TestEnvironment] Skipping process conflict detection - returning clean state
[2025-11-22 13:38:48.524] [INFO] [SystemValidator.swift:443 checkConflicts()] ğŸ” [SystemValidator] Total conflicts: 0 (0 kanata, 0 karabiner)
[2025-11-22 13:38:48.524] [INFO] [SystemValidator.swift:229 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 4 (Conflicts) completed in 7.965s
[2025-11-22 13:38:48.524] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 60% (3/5 steps)
[2025-11-22 13:38:48.524] [INFO] [SystemValidator.swift:328 checkHelper()] ğŸ” [SystemValidator] Helper state: registeredButUnresponsive Helper registered but XPC communication failed
[2025-11-22 13:38:48.524] [INFO] [SystemValidator.swift:202 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 1 (Helper) completed in 7.965s
[2025-11-22 13:38:48.524] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 80% (4/5 steps)
[2025-11-22 13:38:48.524] [INFO] [SystemValidator.swift:362 checkPermissions()] ğŸ” [SystemValidator] Oracle snapshot: ready=false, age=0.779s
[2025-11-22 13:38:48.524] [INFO] [SystemValidator.swift:211 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 2 (Permissions) completed in 7.965s
[2025-11-22 13:38:48.524] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 100% (5/5 steps)
[2025-11-22 13:38:48.524] [INFO] [SystemValidator.swift:283 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 COMPLETE: Total duration 7.966s
[2025-11-22 13:38:48.524] [INFO] [SystemValidator.swift:297 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Validation #1 complete in 7.966s
[2025-11-22 13:38:48.525] [INFO] [SystemValidator.swift:299 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Result: ready=false, blocking=9, total=9
[2025-11-22 13:38:48.525] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:38:48.525] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:38:48.525] [INFO] [SystemRequirements.swift:135 validateSystemCompatibility()] ğŸ” [SystemRequirements] Validating system compatibility
[2025-11-22 13:38:48.525] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:38:48.525] [INFO] [SystemRequirements.swift:147 validateSystemCompatibility()] âœ… [SystemRequirements] Modern macOS detected: 26.0.1
[2025-11-22 13:38:48.525] [INFO] [SystemRequirements.swift:190 validateSystemCompatibility()] ğŸ” [SystemRequirements] Compatibility check complete: âœ… Compatible
[2025-11-22 13:38:48.525] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:38:48.525] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:38:48.525] [INFO] [InstallerEngine.swift:78 inspectSystem()] âœ… [InstallerEngine] inspectSystem() complete - ready=false, blocking=9
[2025-11-22 13:38:48.525] [INFO] [InstallerEngine.swift:53 inspectSystem()] ğŸ” [InstallerEngine] Starting inspectSystem()
[2025-11-22 13:38:48.525] [INFO] [SystemValidator.swift:143 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Starting validation #1
[2025-11-22 13:38:48.525] [INFO] [SystemValidator.swift:174 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 START: 1763847528.525
[2025-11-22 13:38:48.525] [INFO] [SystemValidator.swift:312 checkHelper()] ğŸ” [SystemValidator] Checking privileged helper
[2025-11-22 13:38:48.525] [INFO] [SystemValidator.swift:344 checkPermissions()] ğŸ” [SystemValidator] Checking permissions via Oracle
[2025-11-22 13:38:48.525] [INFO] [SystemValidator.swift:372 checkComponents()] ğŸ” [SystemValidator] Checking components
[2025-11-22 13:38:48.525] [INFO] [KanataBinaryDetector.swift:66 detectCurrentStatus()] ğŸ” [KanataBinaryDetector] Starting unified kanata binary detection
[2025-11-22 13:38:48.525] [INFO] [PermissionOracle.swift:158 currentSnapshot()] ğŸ”® [Oracle] (Test) Returning cached snapshot
[2025-11-22 13:38:48.525] [INFO] [KanataBinaryDetector.swift:81 detectCurrentStatus()] âŒ [KanataBinaryDetector] No kanata binary found
[2025-11-22 13:38:48.525] [INFO] [VHIDDeviceManager.swift:50 detectInstallation()] ğŸ” [VHIDManager] Manager app exists at /Applications/.Karabiner-VirtualHIDDevice-Manager.app/Contents/MacOS/Karabiner-VirtualHIDDevice-Manager: true
[2025-11-22 13:38:48.532] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:38:48.538] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:38:48.556] [INFO] [HelperManager.swift:830 verifyEmbeddedHelperSignature()] ğŸ”’ [HelperManager] Embedded helper signature looks valid
[2025-11-22 13:38:48.556] [INFO] [HelperManager.swift:105 getConnection()] ğŸ”— [HelperManager] Creating XPC connection to com.keypath.helper
[2025-11-22 13:38:48.556] [INFO] [HelperManager.swift:129 getConnection()] âœ… [HelperManager] XPC connection established (PID: 0)
[2025-11-22 13:38:48.556] [INFO] [HelperManager.swift:228 getHelperVersion()] ğŸ“¤ [HelperManager] Calling proxy.getVersion()
[2025-11-22 13:38:48.556] [INFO] [HelperManager.swift:243 getHelperVersion()] ğŸ“¤ [HelperManager] proxy.getVersion() call dispatched, waiting for callback
[2025-11-22 13:38:48.557] [INFO] [HelperManager.swift:121 getConnection()] âš ï¸ [HelperManager] XPC connection interrupted - will reconnect
[2025-11-22 13:38:48.557] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:38:48.557] [INFO] [HelperManager.swift:578 getRemoteProxy(errorHandler:)] âŒ [HelperManager] XPC proxy error: Couldnâ€™t communicate with a helper application.
[2025-11-22 13:38:48.557] [INFO] [HelperManager.swift:584 getRemoteProxy(errorHandler:)] âš ï¸ [HelperManager] XPC connection interrupted - this may indicate:
[2025-11-22 13:38:48.557] [INFO] [HelperManager.swift:585 getRemoteProxy(errorHandler:)]    1. Helper signature validation failed (app updated but not restarted)
[2025-11-22 13:38:48.557] [INFO] [HelperManager.swift:587 getRemoteProxy(errorHandler:)]    2. Helper process crashed
[2025-11-22 13:38:48.557] [INFO] [HelperManager.swift:588 getRemoteProxy(errorHandler:)]    3. Helper was killed by the system
[2025-11-22 13:38:48.557] [INFO] [HelperManager.swift:589 getRemoteProxy(errorHandler:)] ğŸ’¡ If you just updated KeyPath, try restarting the app
[2025-11-22 13:38:48.557] [INFO] [HelperManager.swift:116 getConnection()] âŒ [HelperManager] XPC connection invalidated
[2025-11-22 13:38:48.557] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:38:48.593] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.067s)
[2025-11-22 13:38:48.593] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:38:51.605] [INFO] [HelperManager.swift:248 getHelperVersion()] âš ï¸ [HelperManager] getVersion timed out - clearing connection cache
[2025-11-22 13:38:51.605] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:38:52.169] [INFO] [VHIDDeviceManager.swift:168 evaluateDaemonProcess()] âš ï¸ [VHIDManager] VHIDDevice process check timed out after 3s - fallback launchctl says running=false
[2025-11-22 13:38:52.238] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:38:52.238] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:38:52.238] [INFO] [VHIDDeviceManager.swift:343 getInstalledVersion()] ğŸ” [VHIDManager] Installed daemon version: 5.0.0
[2025-11-22 13:38:52.238] [INFO] [VHIDDeviceManager.swift:374 hasVersionMismatch()] âœ… [VHIDManager] Version compatible: v5.0.0
[2025-11-22 13:38:52.238] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:38:52.306] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:38:52.306] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:38:52.306] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:38:52.306] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:38:52.307] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:38:52.307] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:38:52.307] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:38:52.307] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:38:52.307] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:38:52.307] [INFO] [LaunchDaemonInstaller.swift:669 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Kanata service state: Uninstalled
[2025-11-22 13:38:52.307] [INFO] [LaunchDaemonInstaller.swift:696 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Service not installed (state: Uninstalled)
[2025-11-22 13:38:52.307] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:38:52.376] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:38:52.443] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhiddaemon loaded: false
[2025-11-22 13:38:52.511] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhidmanager loaded: false
[2025-11-22 13:38:52.511] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:38:52.579] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:38:52.579] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhidmanager
[2025-11-22 13:38:52.648] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhidmanager not found in system domain
[2025-11-22 13:38:52.648] [INFO] [SystemValidator.swift:400 checkComponents()] ğŸ” [SystemValidator] Components: kanata=false, driver=true, daemon=false, vhid=false, vhidVersionMismatch=false
[2025-11-22 13:38:52.648] [INFO] [SystemValidator.swift:220 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 3 (Components) completed in 4.123s
[2025-11-22 13:38:52.648] [INFO] [SystemValidator.swift:484 checkHealth()] ğŸ” [SystemValidator] Checking system health
[2025-11-22 13:38:52.648] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:38:52.648] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 20% (1/5 steps)
[2025-11-22 13:38:52.715] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:38:52.715] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:38:52.783] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:38:52.851] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.067s)
[2025-11-22 13:38:52.851] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:38:53.425] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.068s)
[2025-11-22 13:38:53.425] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:38:53.425] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:38:53.425] [INFO] [SystemValidator.swift:494 checkHealth()] ğŸ” [SystemValidator] Health: kanata=false, daemon=false (launchctl), vhid=false
[2025-11-22 13:38:53.425] [INFO] [SystemValidator.swift:418 checkConflicts()] ğŸ” [SystemValidator] Checking for conflicts
[2025-11-22 13:38:53.425] [INFO] [SystemValidator.swift:238 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 5 (Health) completed in 4.900s
[2025-11-22 13:38:53.425] [INFO] [ProcessLifecycleManager.swift:117 detectConflicts()] ğŸ” [ProcessLifecycleManager] Detecting conflicts...
[2025-11-22 13:38:53.425] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 40% (2/5 steps)
[2025-11-22 13:38:53.425] [INFO] [ProcessLifecycleManager.swift:121 detectConflicts()] ğŸ§ª [TestEnvironment] Skipping process conflict detection - returning clean state
[2025-11-22 13:38:53.425] [INFO] [SystemValidator.swift:443 checkConflicts()] ğŸ” [SystemValidator] Total conflicts: 0 (0 kanata, 0 karabiner)
[2025-11-22 13:38:53.425] [INFO] [SystemValidator.swift:229 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 4 (Conflicts) completed in 4.900s
[2025-11-22 13:38:53.425] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 60% (3/5 steps)
[2025-11-22 13:38:53.425] [INFO] [SystemValidator.swift:359 checkPermissions()] âš ï¸ [SystemValidator] Oracle snapshot is 5.7s old (ignored in tests)
[2025-11-22 13:38:53.425] [INFO] [SystemValidator.swift:362 checkPermissions()] ğŸ” [SystemValidator] Oracle snapshot: ready=false, age=5.680s
[2025-11-22 13:38:53.425] [INFO] [SystemValidator.swift:328 checkHelper()] ğŸ” [SystemValidator] Helper state: registeredButUnresponsive Helper registered but XPC communication failed
[2025-11-22 13:38:53.425] [INFO] [SystemValidator.swift:211 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 2 (Permissions) completed in 4.900s
[2025-11-22 13:38:53.425] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 80% (4/5 steps)
[2025-11-22 13:38:53.425] [INFO] [SystemValidator.swift:202 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 1 (Helper) completed in 4.900s
[2025-11-22 13:38:53.425] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 100% (5/5 steps)
[2025-11-22 13:38:53.425] [INFO] [SystemValidator.swift:283 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 COMPLETE: Total duration 4.901s
[2025-11-22 13:38:53.425] [INFO] [SystemValidator.swift:297 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Validation #1 complete in 4.901s
[2025-11-22 13:38:53.425] [INFO] [SystemValidator.swift:299 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Result: ready=false, blocking=9, total=9
[2025-11-22 13:38:53.425] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:38:53.426] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:38:53.426] [INFO] [SystemRequirements.swift:135 validateSystemCompatibility()] ğŸ” [SystemRequirements] Validating system compatibility
[2025-11-22 13:38:53.426] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:38:53.426] [INFO] [SystemRequirements.swift:147 validateSystemCompatibility()] âœ… [SystemRequirements] Modern macOS detected: 26.0.1
[2025-11-22 13:38:53.426] [INFO] [SystemRequirements.swift:190 validateSystemCompatibility()] ğŸ” [SystemRequirements] Compatibility check complete: âœ… Compatible
[2025-11-22 13:38:53.426] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:38:53.426] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:38:53.426] [INFO] [InstallerEngine.swift:78 inspectSystem()] âœ… [InstallerEngine] inspectSystem() complete - ready=false, blocking=9
Average inspectSystem() time: 5.155241179466247 seconds
/Users/malpern/local-code/KeyPath/Tests/KeyPathTests/InstallationEngine/InstallerEnginePerformanceTests.swift:27: error: -[KeyPathTests.InstallerEnginePerformanceTests testInspectSystemPerformance] : XCTAssertLessThan failed: ("5.155241179466247") is not less than ("1.0") - inspectSystem() is too slow
Test Case '-[KeyPathTests.InstallerEnginePerformanceTests testInspectSystemPerformance]' failed (28.885 seconds).
Test Case '-[KeyPathTests.InstallerEnginePerformanceTests testMakePlanPerformance]' started.
[2025-11-22 13:38:53.430] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:38:53.430] [INFO] [SystemValidator.swift:63 init(launchDaemonInstaller:vhidDeviceManager:processLifecycleManager:kanataManager:)] ğŸ” [SystemValidator] Initialized (stateless, no cache)
[2025-11-22 13:38:53.430] [INFO] [InstallerEngine.swift:35 init(processLifecycleManager:kanataManager:)] ğŸ”§ [InstallerEngine] Initialized
[2025-11-22 13:38:53.430] [INFO] [InstallerEngine.swift:53 inspectSystem()] ğŸ” [InstallerEngine] Starting inspectSystem()
[2025-11-22 13:38:53.430] [INFO] [SystemValidator.swift:143 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Starting validation #1
[2025-11-22 13:38:53.430] [INFO] [SystemValidator.swift:174 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 START: 1763847533.430
[2025-11-22 13:38:53.430] [INFO] [SystemValidator.swift:312 checkHelper()] ğŸ” [SystemValidator] Checking privileged helper
[2025-11-22 13:38:53.430] [INFO] [SystemValidator.swift:344 checkPermissions()] ğŸ” [SystemValidator] Checking permissions via Oracle
[2025-11-22 13:38:53.430] [INFO] [SystemValidator.swift:372 checkComponents()] ğŸ” [SystemValidator] Checking components
[2025-11-22 13:38:53.430] [INFO] [KanataBinaryDetector.swift:66 detectCurrentStatus()] ğŸ” [KanataBinaryDetector] Starting unified kanata binary detection
[2025-11-22 13:38:53.430] [INFO] [PermissionOracle.swift:173 currentSnapshot()] ğŸ”® [Oracle] Test mode snapshot generated (non-blocking)
[2025-11-22 13:38:53.430] [INFO] [KanataBinaryDetector.swift:81 detectCurrentStatus()] âŒ [KanataBinaryDetector] No kanata binary found
[2025-11-22 13:38:53.430] [INFO] [VHIDDeviceManager.swift:50 detectInstallation()] ğŸ” [VHIDManager] Manager app exists at /Applications/.Karabiner-VirtualHIDDevice-Manager.app/Contents/MacOS/Karabiner-VirtualHIDDevice-Manager: true
[2025-11-22 13:38:53.436] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:38:53.441] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:38:53.460] [INFO] [HelperManager.swift:830 verifyEmbeddedHelperSignature()] ğŸ”’ [HelperManager] Embedded helper signature looks valid
[2025-11-22 13:38:53.460] [INFO] [HelperManager.swift:105 getConnection()] ğŸ”— [HelperManager] Creating XPC connection to com.keypath.helper
[2025-11-22 13:38:53.460] [INFO] [HelperManager.swift:129 getConnection()] âœ… [HelperManager] XPC connection established (PID: 0)
[2025-11-22 13:38:53.460] [INFO] [HelperManager.swift:228 getHelperVersion()] ğŸ“¤ [HelperManager] Calling proxy.getVersion()
[2025-11-22 13:38:53.460] [INFO] [HelperManager.swift:243 getHelperVersion()] ğŸ“¤ [HelperManager] proxy.getVersion() call dispatched, waiting for callback
[2025-11-22 13:38:53.461] [INFO] [HelperManager.swift:121 getConnection()] âš ï¸ [HelperManager] XPC connection interrupted - will reconnect
[2025-11-22 13:38:53.461] [INFO] [HelperManager.swift:578 getRemoteProxy(errorHandler:)] âŒ [HelperManager] XPC proxy error: Couldnâ€™t communicate with a helper application.
[2025-11-22 13:38:53.461] [INFO] [HelperManager.swift:584 getRemoteProxy(errorHandler:)] âš ï¸ [HelperManager] XPC connection interrupted - this may indicate:
[2025-11-22 13:38:53.461] [INFO] [HelperManager.swift:585 getRemoteProxy(errorHandler:)]    1. Helper signature validation failed (app updated but not restarted)
[2025-11-22 13:38:53.461] [INFO] [HelperManager.swift:587 getRemoteProxy(errorHandler:)]    2. Helper process crashed
[2025-11-22 13:38:53.461] [INFO] [HelperManager.swift:588 getRemoteProxy(errorHandler:)]    3. Helper was killed by the system
[2025-11-22 13:38:53.461] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:38:53.461] [INFO] [HelperManager.swift:589 getRemoteProxy(errorHandler:)] ğŸ’¡ If you just updated KeyPath, try restarting the app
[2025-11-22 13:38:53.461] [INFO] [HelperManager.swift:116 getConnection()] âŒ [HelperManager] XPC connection invalidated
[2025-11-22 13:38:53.461] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:38:53.498] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.068s)
[2025-11-22 13:38:53.498] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:38:56.535] [INFO] [HelperManager.swift:248 getHelperVersion()] âš ï¸ [HelperManager] getVersion timed out - clearing connection cache
[2025-11-22 13:38:56.535] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:38:57.072] [INFO] [VHIDDeviceManager.swift:168 evaluateDaemonProcess()] âš ï¸ [VHIDManager] VHIDDevice process check timed out after 3s - fallback launchctl says running=false
[2025-11-22 13:38:57.141] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:38:57.141] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:38:57.141] [INFO] [VHIDDeviceManager.swift:343 getInstalledVersion()] ğŸ” [VHIDManager] Installed daemon version: 5.0.0
[2025-11-22 13:38:57.141] [INFO] [VHIDDeviceManager.swift:374 hasVersionMismatch()] âœ… [VHIDManager] Version compatible: v5.0.0
[2025-11-22 13:38:57.141] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:38:57.208] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:38:57.209] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:38:57.209] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:38:57.209] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:38:57.209] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:38:57.210] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:38:57.210] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:38:57.210] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:38:57.210] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:38:57.210] [INFO] [LaunchDaemonInstaller.swift:669 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Kanata service state: Uninstalled
[2025-11-22 13:38:57.210] [INFO] [LaunchDaemonInstaller.swift:696 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Service not installed (state: Uninstalled)
[2025-11-22 13:38:57.210] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:38:57.278] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:38:57.345] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhiddaemon loaded: false
[2025-11-22 13:38:57.412] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhidmanager loaded: false
[2025-11-22 13:38:57.412] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:38:57.480] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:38:57.481] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhidmanager
[2025-11-22 13:38:57.550] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhidmanager not found in system domain
[2025-11-22 13:38:57.554] [INFO] [SystemValidator.swift:400 checkComponents()] ğŸ” [SystemValidator] Components: kanata=false, driver=true, daemon=false, vhid=false, vhidVersionMismatch=false
[2025-11-22 13:38:57.554] [INFO] [SystemValidator.swift:418 checkConflicts()] ğŸ” [SystemValidator] Checking for conflicts
[2025-11-22 13:38:57.554] [INFO] [ProcessLifecycleManager.swift:117 detectConflicts()] ğŸ” [ProcessLifecycleManager] Detecting conflicts...
[2025-11-22 13:38:57.554] [INFO] [ProcessLifecycleManager.swift:121 detectConflicts()] ğŸ§ª [TestEnvironment] Skipping process conflict detection - returning clean state
[2025-11-22 13:38:57.554] [INFO] [SystemValidator.swift:443 checkConflicts()] ğŸ” [SystemValidator] Total conflicts: 0 (0 kanata, 0 karabiner)
[2025-11-22 13:38:57.554] [INFO] [SystemValidator.swift:484 checkHealth()] ğŸ” [SystemValidator] Checking system health
[2025-11-22 13:38:57.554] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:38:57.554] [INFO] [SystemValidator.swift:220 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 3 (Components) completed in 4.125s
[2025-11-22 13:38:57.555] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 20% (1/5 steps)
[2025-11-22 13:38:57.555] [INFO] [SystemValidator.swift:229 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 4 (Conflicts) completed in 4.125s
[2025-11-22 13:38:57.555] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 40% (2/5 steps)
[2025-11-22 13:38:57.622] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:38:57.622] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:38:57.690] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:39:00.758] [INFO] [VHIDDeviceManager.swift:168 evaluateDaemonProcess()] âš ï¸ [VHIDManager] VHIDDevice process check timed out after 3s - fallback launchctl says running=false
[2025-11-22 13:39:00.828] [INFO] [VHIDDeviceManager.swift:88 detectRunning()] â³ [VHIDManager] Timeout while checking daemon; retrying to avoid false negatives
[2025-11-22 13:39:01.402] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.069s)
[2025-11-22 13:39:01.402] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:39:01.402] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:39:01.402] [INFO] [SystemValidator.swift:494 checkHealth()] ğŸ” [SystemValidator] Health: kanata=false, daemon=false (launchctl), vhid=false
[2025-11-22 13:39:01.402] [INFO] [SystemValidator.swift:238 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 5 (Health) completed in 7.973s
[2025-11-22 13:39:01.403] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 60% (3/5 steps)
[2025-11-22 13:39:01.403] [INFO] [SystemValidator.swift:359 checkPermissions()] âš ï¸ [SystemValidator] Oracle snapshot is 8.0s old (ignored in tests)
[2025-11-22 13:39:01.403] [INFO] [SystemValidator.swift:362 checkPermissions()] ğŸ” [SystemValidator] Oracle snapshot: ready=false, age=7.973s
[2025-11-22 13:39:01.403] [INFO] [SystemValidator.swift:328 checkHelper()] ğŸ” [SystemValidator] Helper state: registeredButUnresponsive Helper registered but XPC communication failed
[2025-11-22 13:39:01.403] [INFO] [SystemValidator.swift:211 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 2 (Permissions) completed in 7.973s
[2025-11-22 13:39:01.403] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 80% (4/5 steps)
[2025-11-22 13:39:01.403] [INFO] [SystemValidator.swift:202 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 1 (Helper) completed in 7.973s
[2025-11-22 13:39:01.403] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 100% (5/5 steps)
[2025-11-22 13:39:01.403] [INFO] [SystemValidator.swift:283 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 COMPLETE: Total duration 7.973s
[2025-11-22 13:39:01.403] [INFO] [SystemValidator.swift:297 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Validation #1 complete in 7.973s
[2025-11-22 13:39:01.403] [INFO] [SystemValidator.swift:299 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Result: ready=false, blocking=9, total=9
[2025-11-22 13:39:01.403] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:39:01.403] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:39:01.403] [INFO] [SystemRequirements.swift:135 validateSystemCompatibility()] ğŸ” [SystemRequirements] Validating system compatibility
[2025-11-22 13:39:01.403] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:39:01.403] [INFO] [SystemRequirements.swift:147 validateSystemCompatibility()] âœ… [SystemRequirements] Modern macOS detected: 26.0.1
[2025-11-22 13:39:01.403] [INFO] [SystemRequirements.swift:190 validateSystemCompatibility()] ğŸ” [SystemRequirements] Compatibility check complete: âœ… Compatible
[2025-11-22 13:39:01.403] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:39:01.403] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:39:01.403] [INFO] [InstallerEngine.swift:78 inspectSystem()] âœ… [InstallerEngine] inspectSystem() complete - ready=false, blocking=9
[2025-11-22 13:39:01.403] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.403] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.403] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.403] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.403] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.403] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.403] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.403] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.403] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.403] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.403] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.403] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.403] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.403] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.403] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.403] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.403] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.403] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.403] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.403] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.403] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.403] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.403] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.403] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.403] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.403] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.403] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.403] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.403] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.404] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.405] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.406] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.407] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.407] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.407] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.407] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.407] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.407] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.407] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.407] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.407] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.407] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.407] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.407] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.407] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.407] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.407] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.407] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.407] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.407] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.407] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.407] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.407] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.407] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.407] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.407] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.407] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.407] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.407] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.407] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.407] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.407] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.407] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.407] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.407] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.407] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.407] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.407] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.407] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.407] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.407] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.407] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.407] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.407] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.407] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.407] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.407] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.407] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.407] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.407] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.407] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.407] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.407] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.407] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.407] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.407] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.407] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.407] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.407] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.407] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.407] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.407] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.407] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.407] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.407] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.407] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.407] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.407] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.407] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.407] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.407] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.407] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.407] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.407] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.407] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.407] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.408] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.408] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.408] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.408] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.408] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.408] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.408] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.408] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.408] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.408] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:01.408] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:01.408] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:01.408] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:01.408] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
Average makePlan() time: 4.4230222702026364e-05 seconds
Test Case '-[KeyPathTests.InstallerEnginePerformanceTests testMakePlanPerformance]' passed (7.979 seconds).
Test Suite 'InstallerEnginePerformanceTests' failed at 2025-11-22 13:39:01.408.
	 Executed 2 tests, with 1 failure (0 unexpected) in 36.864 (36.864) seconds
Test Suite 'InstallerEngineTests' started at 2025-11-22 13:39:01.408.
Test Case '-[KeyPathTests.InstallerEngineTests testAllAutoFixActionsHaveRecipes]' started.
[2025-11-22 13:39:01.408] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:39:01.408] [INFO] [SystemValidator.swift:63 init(launchDaemonInstaller:vhidDeviceManager:processLifecycleManager:kanataManager:)] ğŸ” [SystemValidator] Initialized (stateless, no cache)
[2025-11-22 13:39:01.408] [INFO] [InstallerEngine.swift:35 init(processLifecycleManager:kanataManager:)] ğŸ”§ [InstallerEngine] Initialized
[2025-11-22 13:39:01.408] [INFO] [InstallerEngine.swift:53 inspectSystem()] ğŸ” [InstallerEngine] Starting inspectSystem()
[2025-11-22 13:39:01.408] [INFO] [SystemValidator.swift:143 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Starting validation #1
[2025-11-22 13:39:01.408] [INFO] [SystemValidator.swift:174 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 START: 1763847541.408
[2025-11-22 13:39:01.409] [INFO] [SystemValidator.swift:312 checkHelper()] ğŸ” [SystemValidator] Checking privileged helper
[2025-11-22 13:39:01.409] [INFO] [SystemValidator.swift:344 checkPermissions()] ğŸ” [SystemValidator] Checking permissions via Oracle
[2025-11-22 13:39:01.409] [INFO] [SystemValidator.swift:372 checkComponents()] ğŸ” [SystemValidator] Checking components
[2025-11-22 13:39:01.409] [INFO] [KanataBinaryDetector.swift:66 detectCurrentStatus()] ğŸ” [KanataBinaryDetector] Starting unified kanata binary detection
[2025-11-22 13:39:01.409] [INFO] [PermissionOracle.swift:173 currentSnapshot()] ğŸ”® [Oracle] Test mode snapshot generated (non-blocking)
[2025-11-22 13:39:01.409] [INFO] [KanataBinaryDetector.swift:81 detectCurrentStatus()] âŒ [KanataBinaryDetector] No kanata binary found
[2025-11-22 13:39:01.409] [INFO] [VHIDDeviceManager.swift:50 detectInstallation()] ğŸ” [VHIDManager] Manager app exists at /Applications/.Karabiner-VirtualHIDDevice-Manager.app/Contents/MacOS/Karabiner-VirtualHIDDevice-Manager: true
[2025-11-22 13:39:01.414] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:39:01.419] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:39:01.437] [INFO] [HelperManager.swift:830 verifyEmbeddedHelperSignature()] ğŸ”’ [HelperManager] Embedded helper signature looks valid
[2025-11-22 13:39:01.437] [INFO] [HelperManager.swift:105 getConnection()] ğŸ”— [HelperManager] Creating XPC connection to com.keypath.helper
[2025-11-22 13:39:01.438] [INFO] [HelperManager.swift:129 getConnection()] âœ… [HelperManager] XPC connection established (PID: 0)
[2025-11-22 13:39:01.438] [INFO] [HelperManager.swift:228 getHelperVersion()] ğŸ“¤ [HelperManager] Calling proxy.getVersion()
[2025-11-22 13:39:01.438] [INFO] [HelperManager.swift:243 getHelperVersion()] ğŸ“¤ [HelperManager] proxy.getVersion() call dispatched, waiting for callback
[2025-11-22 13:39:01.438] [INFO] [HelperManager.swift:121 getConnection()] âš ï¸ [HelperManager] XPC connection interrupted - will reconnect
[2025-11-22 13:39:01.438] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:39:01.438] [INFO] [HelperManager.swift:578 getRemoteProxy(errorHandler:)] âŒ [HelperManager] XPC proxy error: Couldnâ€™t communicate with a helper application.
[2025-11-22 13:39:01.438] [INFO] [HelperManager.swift:584 getRemoteProxy(errorHandler:)] âš ï¸ [HelperManager] XPC connection interrupted - this may indicate:
[2025-11-22 13:39:01.438] [INFO] [HelperManager.swift:585 getRemoteProxy(errorHandler:)]    1. Helper signature validation failed (app updated but not restarted)
[2025-11-22 13:39:01.438] [INFO] [HelperManager.swift:587 getRemoteProxy(errorHandler:)]    2. Helper process crashed
[2025-11-22 13:39:01.438] [INFO] [HelperManager.swift:588 getRemoteProxy(errorHandler:)]    3. Helper was killed by the system
[2025-11-22 13:39:01.438] [INFO] [HelperManager.swift:589 getRemoteProxy(errorHandler:)] ğŸ’¡ If you just updated KeyPath, try restarting the app
[2025-11-22 13:39:01.438] [INFO] [HelperManager.swift:116 getConnection()] âŒ [HelperManager] XPC connection invalidated
[2025-11-22 13:39:01.438] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:39:01.477] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.068s)
[2025-11-22 13:39:01.477] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:39:02.051] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.069s)
[2025-11-22 13:39:02.051] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:39:02.051] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:39:02.052] [INFO] [VHIDDeviceManager.swift:343 getInstalledVersion()] ğŸ” [VHIDManager] Installed daemon version: 5.0.0
[2025-11-22 13:39:02.052] [INFO] [VHIDDeviceManager.swift:374 hasVersionMismatch()] âœ… [VHIDManager] Version compatible: v5.0.0
[2025-11-22 13:39:02.052] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:39:02.118] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:39:02.119] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:39:02.119] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:39:02.119] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:39:02.119] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:39:02.119] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:39:02.119] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:39:02.119] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:39:02.119] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:39:02.120] [INFO] [LaunchDaemonInstaller.swift:669 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Kanata service state: Uninstalled
[2025-11-22 13:39:02.120] [INFO] [LaunchDaemonInstaller.swift:696 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Service not installed (state: Uninstalled)
[2025-11-22 13:39:02.120] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:39:02.187] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:39:02.255] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhiddaemon loaded: false
[2025-11-22 13:39:02.323] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhidmanager loaded: false
[2025-11-22 13:39:02.323] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:39:02.390] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:39:02.390] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhidmanager
[2025-11-22 13:39:02.458] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhidmanager not found in system domain
[2025-11-22 13:39:02.458] [INFO] [SystemValidator.swift:400 checkComponents()] ğŸ” [SystemValidator] Components: kanata=false, driver=true, daemon=false, vhid=false, vhidVersionMismatch=false
[2025-11-22 13:39:02.458] [INFO] [SystemValidator.swift:220 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 3 (Components) completed in 1.050s
[2025-11-22 13:39:02.458] [INFO] [SystemValidator.swift:418 checkConflicts()] ğŸ” [SystemValidator] Checking for conflicts
[2025-11-22 13:39:02.458] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 20% (1/5 steps)
[2025-11-22 13:39:02.458] [INFO] [ProcessLifecycleManager.swift:117 detectConflicts()] ğŸ” [ProcessLifecycleManager] Detecting conflicts...
[2025-11-22 13:39:02.458] [INFO] [ProcessLifecycleManager.swift:121 detectConflicts()] ğŸ§ª [TestEnvironment] Skipping process conflict detection - returning clean state
[2025-11-22 13:39:02.458] [INFO] [SystemValidator.swift:443 checkConflicts()] ğŸ” [SystemValidator] Total conflicts: 0 (0 kanata, 0 karabiner)
[2025-11-22 13:39:02.458] [INFO] [SystemValidator.swift:484 checkHealth()] ğŸ” [SystemValidator] Checking system health
[2025-11-22 13:39:02.458] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:39:02.458] [INFO] [SystemValidator.swift:229 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 4 (Conflicts) completed in 1.050s
[2025-11-22 13:39:02.458] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 40% (2/5 steps)
[2025-11-22 13:39:02.525] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:39:02.525] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:39:02.593] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:39:04.513] [INFO] [HelperManager.swift:248 getHelperVersion()] âš ï¸ [HelperManager] getVersion timed out - clearing connection cache
[2025-11-22 13:39:04.513] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:39:05.664] [INFO] [VHIDDeviceManager.swift:168 evaluateDaemonProcess()] âš ï¸ [VHIDManager] VHIDDevice process check timed out after 3s - fallback launchctl says running=false
[2025-11-22 13:39:05.732] [INFO] [VHIDDeviceManager.swift:88 detectRunning()] â³ [VHIDManager] Timeout while checking daemon; retrying to avoid false negatives
[2025-11-22 13:39:06.305] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.070s)
[2025-11-22 13:39:06.305] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:39:06.305] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:39:06.305] [INFO] [SystemValidator.swift:494 checkHealth()] ğŸ” [SystemValidator] Health: kanata=false, daemon=false (launchctl), vhid=false
[2025-11-22 13:39:06.305] [INFO] [SystemValidator.swift:238 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 5 (Health) completed in 4.896s
[2025-11-22 13:39:06.305] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 60% (3/5 steps)
[2025-11-22 13:39:06.305] [INFO] [SystemValidator.swift:362 checkPermissions()] ğŸ” [SystemValidator] Oracle snapshot: ready=false, age=4.896s
[2025-11-22 13:39:06.305] [INFO] [SystemValidator.swift:328 checkHelper()] ğŸ” [SystemValidator] Helper state: registeredButUnresponsive Helper registered but XPC communication failed
[2025-11-22 13:39:06.305] [INFO] [SystemValidator.swift:211 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 2 (Permissions) completed in 4.896s
[2025-11-22 13:39:06.305] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 80% (4/5 steps)
[2025-11-22 13:39:06.305] [INFO] [SystemValidator.swift:202 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 1 (Helper) completed in 4.896s
[2025-11-22 13:39:06.305] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 100% (5/5 steps)
[2025-11-22 13:39:06.305] [INFO] [SystemValidator.swift:283 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 COMPLETE: Total duration 4.897s
[2025-11-22 13:39:06.305] [INFO] [SystemValidator.swift:297 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Validation #1 complete in 4.897s
[2025-11-22 13:39:06.305] [INFO] [SystemValidator.swift:299 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Result: ready=false, blocking=9, total=9
[2025-11-22 13:39:06.305] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:39:06.305] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:39:06.305] [INFO] [SystemRequirements.swift:135 validateSystemCompatibility()] ğŸ” [SystemRequirements] Validating system compatibility
[2025-11-22 13:39:06.305] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:39:06.305] [INFO] [SystemRequirements.swift:147 validateSystemCompatibility()] âœ… [SystemRequirements] Modern macOS detected: 26.0.1
[2025-11-22 13:39:06.305] [INFO] [SystemRequirements.swift:190 validateSystemCompatibility()] ğŸ” [SystemRequirements] Compatibility check complete: âœ… Compatible
[2025-11-22 13:39:06.305] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:39:06.305] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:39:06.305] [INFO] [InstallerEngine.swift:78 inspectSystem()] âœ… [InstallerEngine] inspectSystem() complete - ready=false, blocking=9
Test Case '-[KeyPathTests.InstallerEngineTests testAllAutoFixActionsHaveRecipes]' passed (4.899 seconds).
Test Case '-[KeyPathTests.InstallerEngineTests testExecuteExecutesRecipesInOrder]' started.
[2025-11-22 13:39:06.307] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:39:06.307] [INFO] [SystemValidator.swift:63 init(launchDaemonInstaller:vhidDeviceManager:processLifecycleManager:kanataManager:)] ğŸ” [SystemValidator] Initialized (stateless, no cache)
[2025-11-22 13:39:06.307] [INFO] [InstallerEngine.swift:35 init(processLifecycleManager:kanataManager:)] ğŸ”§ [InstallerEngine] Initialized
[2025-11-22 13:39:06.307] [INFO] [InstallerEngine.swift:53 inspectSystem()] ğŸ” [InstallerEngine] Starting inspectSystem()
[2025-11-22 13:39:06.307] [INFO] [SystemValidator.swift:143 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Starting validation #1
[2025-11-22 13:39:06.307] [INFO] [SystemValidator.swift:174 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 START: 1763847546.307
[2025-11-22 13:39:06.307] [INFO] [SystemValidator.swift:344 checkPermissions()] ğŸ” [SystemValidator] Checking permissions via Oracle
[2025-11-22 13:39:06.307] [INFO] [SystemValidator.swift:372 checkComponents()] ğŸ” [SystemValidator] Checking components
[2025-11-22 13:39:06.307] [INFO] [KanataBinaryDetector.swift:66 detectCurrentStatus()] ğŸ” [KanataBinaryDetector] Starting unified kanata binary detection
[2025-11-22 13:39:06.307] [INFO] [PermissionOracle.swift:173 currentSnapshot()] ğŸ”® [Oracle] Test mode snapshot generated (non-blocking)
[2025-11-22 13:39:06.307] [INFO] [KanataBinaryDetector.swift:81 detectCurrentStatus()] âŒ [KanataBinaryDetector] No kanata binary found
[2025-11-22 13:39:06.307] [INFO] [VHIDDeviceManager.swift:50 detectInstallation()] ğŸ” [VHIDManager] Manager app exists at /Applications/.Karabiner-VirtualHIDDevice-Manager.app/Contents/MacOS/Karabiner-VirtualHIDDevice-Manager: true
[2025-11-22 13:39:06.374] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.067s)
[2025-11-22 13:39:06.374] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:39:06.942] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.067s)
[2025-11-22 13:39:06.942] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:39:06.942] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:39:06.942] [INFO] [VHIDDeviceManager.swift:343 getInstalledVersion()] ğŸ” [VHIDManager] Installed daemon version: 5.0.0
[2025-11-22 13:39:06.943] [INFO] [VHIDDeviceManager.swift:374 hasVersionMismatch()] âœ… [VHIDManager] Version compatible: v5.0.0
[2025-11-22 13:39:06.943] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:39:07.008] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:39:07.009] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:39:07.009] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:39:07.009] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:39:07.010] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:39:07.010] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:39:07.010] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:39:07.010] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:39:07.010] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:39:07.010] [INFO] [LaunchDaemonInstaller.swift:669 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Kanata service state: Uninstalled
[2025-11-22 13:39:07.010] [INFO] [LaunchDaemonInstaller.swift:696 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Service not installed (state: Uninstalled)
[2025-11-22 13:39:07.010] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:39:07.078] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:39:07.146] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhiddaemon loaded: false
[2025-11-22 13:39:07.214] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhidmanager loaded: false
[2025-11-22 13:39:07.214] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:39:07.282] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:39:07.282] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhidmanager
[2025-11-22 13:39:07.350] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhidmanager not found in system domain
[2025-11-22 13:39:07.350] [INFO] [SystemValidator.swift:400 checkComponents()] ğŸ” [SystemValidator] Components: kanata=false, driver=true, daemon=false, vhid=false, vhidVersionMismatch=false
[2025-11-22 13:39:07.350] [INFO] [SystemValidator.swift:220 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 3 (Components) completed in 1.043s
[2025-11-22 13:39:07.350] [INFO] [SystemValidator.swift:418 checkConflicts()] ğŸ” [SystemValidator] Checking for conflicts
[2025-11-22 13:39:07.350] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 20% (1/5 steps)
[2025-11-22 13:39:07.350] [INFO] [ProcessLifecycleManager.swift:117 detectConflicts()] ğŸ” [ProcessLifecycleManager] Detecting conflicts...
[2025-11-22 13:39:07.350] [INFO] [ProcessLifecycleManager.swift:121 detectConflicts()] ğŸ§ª [TestEnvironment] Skipping process conflict detection - returning clean state
[2025-11-22 13:39:07.350] [INFO] [SystemValidator.swift:443 checkConflicts()] ğŸ” [SystemValidator] Total conflicts: 0 (0 kanata, 0 karabiner)
[2025-11-22 13:39:07.350] [INFO] [SystemValidator.swift:484 checkHealth()] ğŸ” [SystemValidator] Checking system health
[2025-11-22 13:39:07.350] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:39:07.350] [INFO] [SystemValidator.swift:229 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 4 (Conflicts) completed in 1.043s
[2025-11-22 13:39:07.350] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 40% (2/5 steps)
[2025-11-22 13:39:07.418] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:39:07.418] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:39:07.486] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:39:07.553] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.067s)
[2025-11-22 13:39:07.553] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:39:08.126] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.067s)
[2025-11-22 13:39:08.126] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:39:08.126] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:39:08.126] [INFO] [SystemValidator.swift:494 checkHealth()] ğŸ” [SystemValidator] Health: kanata=false, daemon=false (launchctl), vhid=false
[2025-11-22 13:39:08.126] [INFO] [SystemValidator.swift:238 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 5 (Health) completed in 1.819s
[2025-11-22 13:39:08.126] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 60% (3/5 steps)
[2025-11-22 13:39:08.126] [INFO] [SystemValidator.swift:312 checkHelper()] ğŸ” [SystemValidator] Checking privileged helper
[2025-11-22 13:39:08.126] [INFO] [SystemValidator.swift:362 checkPermissions()] ğŸ” [SystemValidator] Oracle snapshot: ready=false, age=1.819s
[2025-11-22 13:39:08.126] [INFO] [SystemValidator.swift:211 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 2 (Permissions) completed in 1.819s
[2025-11-22 13:39:08.126] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 80% (4/5 steps)
[2025-11-22 13:39:08.134] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:39:08.139] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:39:08.159] [INFO] [HelperManager.swift:830 verifyEmbeddedHelperSignature()] ğŸ”’ [HelperManager] Embedded helper signature looks valid
[2025-11-22 13:39:08.159] [INFO] [HelperManager.swift:105 getConnection()] ğŸ”— [HelperManager] Creating XPC connection to com.keypath.helper
[2025-11-22 13:39:08.159] [INFO] [HelperManager.swift:129 getConnection()] âœ… [HelperManager] XPC connection established (PID: 0)
[2025-11-22 13:39:08.159] [INFO] [HelperManager.swift:228 getHelperVersion()] ğŸ“¤ [HelperManager] Calling proxy.getVersion()
[2025-11-22 13:39:08.159] [INFO] [HelperManager.swift:243 getHelperVersion()] ğŸ“¤ [HelperManager] proxy.getVersion() call dispatched, waiting for callback
[2025-11-22 13:39:08.160] [INFO] [HelperManager.swift:121 getConnection()] âš ï¸ [HelperManager] XPC connection interrupted - will reconnect
[2025-11-22 13:39:08.160] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:39:08.160] [INFO] [HelperManager.swift:578 getRemoteProxy(errorHandler:)] âŒ [HelperManager] XPC proxy error: Couldnâ€™t communicate with a helper application.
[2025-11-22 13:39:08.160] [INFO] [HelperManager.swift:584 getRemoteProxy(errorHandler:)] âš ï¸ [HelperManager] XPC connection interrupted - this may indicate:
[2025-11-22 13:39:08.160] [INFO] [HelperManager.swift:585 getRemoteProxy(errorHandler:)]    1. Helper signature validation failed (app updated but not restarted)
[2025-11-22 13:39:08.160] [INFO] [HelperManager.swift:587 getRemoteProxy(errorHandler:)]    2. Helper process crashed
[2025-11-22 13:39:08.160] [INFO] [HelperManager.swift:588 getRemoteProxy(errorHandler:)]    3. Helper was killed by the system
[2025-11-22 13:39:08.160] [INFO] [HelperManager.swift:589 getRemoteProxy(errorHandler:)] ğŸ’¡ If you just updated KeyPath, try restarting the app
[2025-11-22 13:39:08.160] [INFO] [HelperManager.swift:116 getConnection()] âŒ [HelperManager] XPC connection invalidated
[2025-11-22 13:39:08.160] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:39:11.206] [INFO] [HelperManager.swift:248 getHelperVersion()] âš ï¸ [HelperManager] getVersion timed out - clearing connection cache
[2025-11-22 13:39:11.207] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:39:11.207] [INFO] [SystemValidator.swift:328 checkHelper()] ğŸ” [SystemValidator] Helper state: registeredButUnresponsive Helper registered but XPC communication failed
[2025-11-22 13:39:11.207] [INFO] [SystemValidator.swift:202 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 1 (Helper) completed in 4.900s
[2025-11-22 13:39:11.207] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 100% (5/5 steps)
[2025-11-22 13:39:11.207] [INFO] [SystemValidator.swift:283 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 COMPLETE: Total duration 4.900s
[2025-11-22 13:39:11.207] [INFO] [SystemValidator.swift:297 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Validation #1 complete in 4.900s
[2025-11-22 13:39:11.208] [INFO] [SystemValidator.swift:299 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Result: ready=false, blocking=9, total=9
[2025-11-22 13:39:11.208] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:39:11.208] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:39:11.208] [INFO] [SystemRequirements.swift:135 validateSystemCompatibility()] ğŸ” [SystemRequirements] Validating system compatibility
[2025-11-22 13:39:11.208] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:39:11.208] [INFO] [SystemRequirements.swift:147 validateSystemCompatibility()] âœ… [SystemRequirements] Modern macOS detected: 26.0.1
[2025-11-22 13:39:11.208] [INFO] [SystemRequirements.swift:190 validateSystemCompatibility()] ğŸ” [SystemRequirements] Compatibility check complete: âœ… Compatible
[2025-11-22 13:39:11.208] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:39:11.208] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:39:11.208] [INFO] [InstallerEngine.swift:78 inspectSystem()] âœ… [InstallerEngine] inspectSystem() complete - ready=false, blocking=9
[2025-11-22 13:39:11.208] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:11.208] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:11.208] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:11.208] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:11.209] [INFO] [InstallerEngine.swift:194 execute(plan:using:)] âš™ï¸ [InstallerEngine] Starting execute(plan:, using:)
[2025-11-22 13:39:11.209] [INFO] [InstallerEngine.swift:213 execute(plan:using:)] âš™ï¸ [InstallerEngine] Executing recipe: install-bundled-kanata (type: installComponent)
[2025-11-22 13:39:11.209] [INFO] [PrivilegedOperationsCoordinator.swift:359 installBundledKanata()] ğŸ” [PrivCoordinator] Installing bundled Kanata binary
[2025-11-22 13:39:11.209] [INFO] [LaunchDaemonInstaller.swift:2898 installBundledKanataBinaryOnly()] ğŸ”§ [LaunchDaemon] Installing bundled kanata binary to system location
[2025-11-22 13:39:11.209] [INFO] [LaunchDaemonInstaller.swift:2906 installBundledKanataBinaryOnly()] âŒ [LaunchDaemon] CRITICAL: Bundled kanata binary not found at: /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata
[2025-11-22 13:39:11.209] [INFO] [LaunchDaemonInstaller.swift:2908 installBundledKanataBinaryOnly()] âŒ [LaunchDaemon] This indicates a packaging issue - the app bundle is missing the kanata binary
[2025-11-22 13:39:11.209] [INFO] [InstallerEngine.swift:255 execute(plan:using:)] âŒ [InstallerEngine] Recipe install-bundled-kanata failed: Operation failed: Bundled Kanata installation failed
[2025-11-22 13:39:11.209] [INFO] [InstallerEngine.swift:274 execute(plan:using:)] âœ… [InstallerEngine] execute() complete - success: false, recipes executed: 1
Test Case '-[KeyPathTests.InstallerEngineTests testExecuteExecutesRecipesInOrder]' passed (4.904 seconds).
Test Case '-[KeyPathTests.InstallerEngineTests testExecuteHandlesBlockedPlan]' started.
[2025-11-22 13:39:11.211] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:39:11.211] [INFO] [SystemValidator.swift:63 init(launchDaemonInstaller:vhidDeviceManager:processLifecycleManager:kanataManager:)] ğŸ” [SystemValidator] Initialized (stateless, no cache)
[2025-11-22 13:39:11.211] [INFO] [InstallerEngine.swift:35 init(processLifecycleManager:kanataManager:)] ğŸ”§ [InstallerEngine] Initialized
[2025-11-22 13:39:11.211] [INFO] [InstallerEngine.swift:194 execute(plan:using:)] âš™ï¸ [InstallerEngine] Starting execute(plan:, using:)
[2025-11-22 13:39:11.211] [INFO] [InstallerEngine.swift:198 execute(plan:using:)] âš ï¸ [InstallerEngine] Plan is blocked by requirement: Test requirement
Test Case '-[KeyPathTests.InstallerEngineTests testExecuteHandlesBlockedPlan]' passed (0.001 seconds).
Test Case '-[KeyPathTests.InstallerEngineTests testExecuteRecordsRecipeResults]' started.
[2025-11-22 13:39:11.212] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:39:11.212] [INFO] [SystemValidator.swift:63 init(launchDaemonInstaller:vhidDeviceManager:processLifecycleManager:kanataManager:)] ğŸ” [SystemValidator] Initialized (stateless, no cache)
[2025-11-22 13:39:11.212] [INFO] [InstallerEngine.swift:35 init(processLifecycleManager:kanataManager:)] ğŸ”§ [InstallerEngine] Initialized
[2025-11-22 13:39:11.212] [INFO] [InstallerEngine.swift:53 inspectSystem()] ğŸ” [InstallerEngine] Starting inspectSystem()
[2025-11-22 13:39:11.212] [INFO] [SystemValidator.swift:143 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Starting validation #1
[2025-11-22 13:39:11.212] [INFO] [SystemValidator.swift:174 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 START: 1763847551.212
[2025-11-22 13:39:11.212] [INFO] [SystemValidator.swift:312 checkHelper()] ğŸ” [SystemValidator] Checking privileged helper
[2025-11-22 13:39:11.212] [INFO] [SystemValidator.swift:344 checkPermissions()] ğŸ” [SystemValidator] Checking permissions via Oracle
[2025-11-22 13:39:11.212] [INFO] [SystemValidator.swift:372 checkComponents()] ğŸ” [SystemValidator] Checking components
[2025-11-22 13:39:11.212] [INFO] [KanataBinaryDetector.swift:66 detectCurrentStatus()] ğŸ” [KanataBinaryDetector] Starting unified kanata binary detection
[2025-11-22 13:39:11.212] [INFO] [PermissionOracle.swift:173 currentSnapshot()] ğŸ”® [Oracle] Test mode snapshot generated (non-blocking)
[2025-11-22 13:39:11.213] [INFO] [KanataBinaryDetector.swift:81 detectCurrentStatus()] âŒ [KanataBinaryDetector] No kanata binary found
[2025-11-22 13:39:11.213] [INFO] [VHIDDeviceManager.swift:50 detectInstallation()] ğŸ” [VHIDManager] Manager app exists at /Applications/.Karabiner-VirtualHIDDevice-Manager.app/Contents/MacOS/Karabiner-VirtualHIDDevice-Manager: true
[2025-11-22 13:39:11.228] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:39:11.236] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:39:11.257] [INFO] [HelperManager.swift:830 verifyEmbeddedHelperSignature()] ğŸ”’ [HelperManager] Embedded helper signature looks valid
[2025-11-22 13:39:11.257] [INFO] [HelperManager.swift:105 getConnection()] ğŸ”— [HelperManager] Creating XPC connection to com.keypath.helper
[2025-11-22 13:39:11.257] [INFO] [HelperManager.swift:129 getConnection()] âœ… [HelperManager] XPC connection established (PID: 0)
[2025-11-22 13:39:11.257] [INFO] [HelperManager.swift:228 getHelperVersion()] ğŸ“¤ [HelperManager] Calling proxy.getVersion()
[2025-11-22 13:39:11.257] [INFO] [HelperManager.swift:243 getHelperVersion()] ğŸ“¤ [HelperManager] proxy.getVersion() call dispatched, waiting for callback
[2025-11-22 13:39:11.258] [INFO] [HelperManager.swift:121 getConnection()] âš ï¸ [HelperManager] XPC connection interrupted - will reconnect
[2025-11-22 13:39:11.258] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:39:11.258] [INFO] [HelperManager.swift:578 getRemoteProxy(errorHandler:)] âŒ [HelperManager] XPC proxy error: Couldnâ€™t communicate with a helper application.
[2025-11-22 13:39:11.258] [INFO] [HelperManager.swift:584 getRemoteProxy(errorHandler:)] âš ï¸ [HelperManager] XPC connection interrupted - this may indicate:
[2025-11-22 13:39:11.258] [INFO] [HelperManager.swift:585 getRemoteProxy(errorHandler:)]    1. Helper signature validation failed (app updated but not restarted)
[2025-11-22 13:39:11.258] [INFO] [HelperManager.swift:587 getRemoteProxy(errorHandler:)]    2. Helper process crashed
[2025-11-22 13:39:11.258] [INFO] [HelperManager.swift:588 getRemoteProxy(errorHandler:)]    3. Helper was killed by the system
[2025-11-22 13:39:11.258] [INFO] [HelperManager.swift:589 getRemoteProxy(errorHandler:)] ğŸ’¡ If you just updated KeyPath, try restarting the app
[2025-11-22 13:39:11.258] [INFO] [HelperManager.swift:116 getConnection()] âŒ [HelperManager] XPC connection invalidated
[2025-11-22 13:39:11.258] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:39:11.282] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.069s)
[2025-11-22 13:39:11.282] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:39:11.857] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.069s)
[2025-11-22 13:39:11.857] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:39:11.857] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:39:11.857] [INFO] [VHIDDeviceManager.swift:343 getInstalledVersion()] ğŸ” [VHIDManager] Installed daemon version: 5.0.0
[2025-11-22 13:39:11.857] [INFO] [VHIDDeviceManager.swift:374 hasVersionMismatch()] âœ… [VHIDManager] Version compatible: v5.0.0
[2025-11-22 13:39:11.857] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:39:11.925] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:39:11.925] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:39:11.925] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:39:11.925] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:39:11.925] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:39:11.926] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:39:11.926] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:39:11.926] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:39:11.926] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:39:11.926] [INFO] [LaunchDaemonInstaller.swift:669 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Kanata service state: Uninstalled
[2025-11-22 13:39:11.926] [INFO] [LaunchDaemonInstaller.swift:696 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Service not installed (state: Uninstalled)
[2025-11-22 13:39:11.926] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:39:11.994] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:39:12.062] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhiddaemon loaded: false
[2025-11-22 13:39:12.129] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhidmanager loaded: false
[2025-11-22 13:39:12.129] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:39:12.197] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:39:12.197] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhidmanager
[2025-11-22 13:39:12.266] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhidmanager not found in system domain
[2025-11-22 13:39:12.266] [INFO] [SystemValidator.swift:400 checkComponents()] ğŸ” [SystemValidator] Components: kanata=false, driver=true, daemon=false, vhid=false, vhidVersionMismatch=false
[2025-11-22 13:39:12.266] [INFO] [SystemValidator.swift:418 checkConflicts()] ğŸ” [SystemValidator] Checking for conflicts
[2025-11-22 13:39:12.266] [INFO] [SystemValidator.swift:220 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 3 (Components) completed in 1.054s
[2025-11-22 13:39:12.266] [INFO] [ProcessLifecycleManager.swift:117 detectConflicts()] ğŸ” [ProcessLifecycleManager] Detecting conflicts...
[2025-11-22 13:39:12.266] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 20% (1/5 steps)
[2025-11-22 13:39:12.266] [INFO] [ProcessLifecycleManager.swift:121 detectConflicts()] ğŸ§ª [TestEnvironment] Skipping process conflict detection - returning clean state
[2025-11-22 13:39:12.266] [INFO] [SystemValidator.swift:443 checkConflicts()] ğŸ” [SystemValidator] Total conflicts: 0 (0 kanata, 0 karabiner)
[2025-11-22 13:39:12.266] [INFO] [SystemValidator.swift:484 checkHealth()] ğŸ” [SystemValidator] Checking system health
[2025-11-22 13:39:12.266] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:39:12.266] [INFO] [SystemValidator.swift:229 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 4 (Conflicts) completed in 1.054s
[2025-11-22 13:39:12.266] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 40% (2/5 steps)
[2025-11-22 13:39:12.334] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:39:12.334] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:39:12.401] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:39:12.469] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.068s)
[2025-11-22 13:39:12.469] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:39:13.043] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.068s)
[2025-11-22 13:39:13.043] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:39:13.043] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:39:13.043] [INFO] [SystemValidator.swift:494 checkHealth()] ğŸ” [SystemValidator] Health: kanata=false, daemon=false (launchctl), vhid=false
[2025-11-22 13:39:13.043] [INFO] [SystemValidator.swift:238 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 5 (Health) completed in 1.831s
[2025-11-22 13:39:13.043] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 60% (3/5 steps)
[2025-11-22 13:39:13.043] [INFO] [SystemValidator.swift:362 checkPermissions()] ğŸ” [SystemValidator] Oracle snapshot: ready=false, age=1.831s
[2025-11-22 13:39:13.043] [INFO] [SystemValidator.swift:211 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 2 (Permissions) completed in 1.831s
[2025-11-22 13:39:13.043] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 80% (4/5 steps)
[2025-11-22 13:39:14.332] [INFO] [HelperManager.swift:248 getHelperVersion()] âš ï¸ [HelperManager] getVersion timed out - clearing connection cache
[2025-11-22 13:39:14.333] [INFO] [SystemValidator.swift:328 checkHelper()] ğŸ” [SystemValidator] Helper state: registeredButUnresponsive Helper registered but XPC communication failed
[2025-11-22 13:39:14.334] [INFO] [SystemValidator.swift:202 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 1 (Helper) completed in 3.122s
[2025-11-22 13:39:14.334] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 100% (5/5 steps)
[2025-11-22 13:39:14.335] [INFO] [SystemValidator.swift:283 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 COMPLETE: Total duration 3.123s
[2025-11-22 13:39:14.335] [INFO] [SystemValidator.swift:297 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Validation #1 complete in 3.123s
[2025-11-22 13:39:14.335] [INFO] [SystemValidator.swift:299 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Result: ready=false, blocking=9, total=9
[2025-11-22 13:39:14.335] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:39:14.335] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:39:14.335] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:39:14.335] [INFO] [SystemRequirements.swift:135 validateSystemCompatibility()] ğŸ” [SystemRequirements] Validating system compatibility
[2025-11-22 13:39:14.335] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:39:14.335] [INFO] [SystemRequirements.swift:147 validateSystemCompatibility()] âœ… [SystemRequirements] Modern macOS detected: 26.0.1
[2025-11-22 13:39:14.335] [INFO] [SystemRequirements.swift:190 validateSystemCompatibility()] ğŸ” [SystemRequirements] Compatibility check complete: âœ… Compatible
[2025-11-22 13:39:14.335] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:39:14.335] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:39:14.335] [INFO] [InstallerEngine.swift:78 inspectSystem()] âœ… [InstallerEngine] inspectSystem() complete - ready=false, blocking=9
[2025-11-22 13:39:14.335] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:14.335] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:14.335] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:14.335] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:14.335] [INFO] [InstallerEngine.swift:194 execute(plan:using:)] âš™ï¸ [InstallerEngine] Starting execute(plan:, using:)
[2025-11-22 13:39:14.335] [INFO] [InstallerEngine.swift:213 execute(plan:using:)] âš™ï¸ [InstallerEngine] Executing recipe: install-bundled-kanata (type: installComponent)
[2025-11-22 13:39:14.335] [INFO] [PrivilegedOperationsCoordinator.swift:359 installBundledKanata()] ğŸ” [PrivCoordinator] Installing bundled Kanata binary
[2025-11-22 13:39:14.335] [INFO] [LaunchDaemonInstaller.swift:2898 installBundledKanataBinaryOnly()] ğŸ”§ [LaunchDaemon] Installing bundled kanata binary to system location
[2025-11-22 13:39:14.336] [INFO] [LaunchDaemonInstaller.swift:2906 installBundledKanataBinaryOnly()] âŒ [LaunchDaemon] CRITICAL: Bundled kanata binary not found at: /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata
[2025-11-22 13:39:14.336] [INFO] [LaunchDaemonInstaller.swift:2908 installBundledKanataBinaryOnly()] âŒ [LaunchDaemon] This indicates a packaging issue - the app bundle is missing the kanata binary
[2025-11-22 13:39:14.336] [INFO] [InstallerEngine.swift:255 execute(plan:using:)] âŒ [InstallerEngine] Recipe install-bundled-kanata failed: Operation failed: Bundled Kanata installation failed
[2025-11-22 13:39:14.336] [INFO] [InstallerEngine.swift:274 execute(plan:using:)] âœ… [InstallerEngine] execute() complete - success: false, recipes executed: 1
Test Case '-[KeyPathTests.InstallerEngineTests testExecuteRecordsRecipeResults]' passed (3.126 seconds).
Test Case '-[KeyPathTests.InstallerEngineTests testExecuteReturnsInstallerReport]' started.
[2025-11-22 13:39:14.338] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:39:14.338] [INFO] [SystemValidator.swift:63 init(launchDaemonInstaller:vhidDeviceManager:processLifecycleManager:kanataManager:)] ğŸ” [SystemValidator] Initialized (stateless, no cache)
[2025-11-22 13:39:14.338] [INFO] [InstallerEngine.swift:35 init(processLifecycleManager:kanataManager:)] ğŸ”§ [InstallerEngine] Initialized
[2025-11-22 13:39:14.338] [INFO] [InstallerEngine.swift:53 inspectSystem()] ğŸ” [InstallerEngine] Starting inspectSystem()
[2025-11-22 13:39:14.338] [INFO] [SystemValidator.swift:143 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Starting validation #1
[2025-11-22 13:39:14.338] [INFO] [SystemValidator.swift:174 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 START: 1763847554.338
[2025-11-22 13:39:14.338] [INFO] [SystemValidator.swift:312 checkHelper()] ğŸ” [SystemValidator] Checking privileged helper
[2025-11-22 13:39:14.338] [INFO] [SystemValidator.swift:344 checkPermissions()] ğŸ” [SystemValidator] Checking permissions via Oracle
[2025-11-22 13:39:14.338] [INFO] [SystemValidator.swift:372 checkComponents()] ğŸ” [SystemValidator] Checking components
[2025-11-22 13:39:14.338] [INFO] [KanataBinaryDetector.swift:66 detectCurrentStatus()] ğŸ” [KanataBinaryDetector] Starting unified kanata binary detection
[2025-11-22 13:39:14.338] [INFO] [PermissionOracle.swift:173 currentSnapshot()] ğŸ”® [Oracle] Test mode snapshot generated (non-blocking)
[2025-11-22 13:39:14.338] [INFO] [KanataBinaryDetector.swift:81 detectCurrentStatus()] âŒ [KanataBinaryDetector] No kanata binary found
[2025-11-22 13:39:14.338] [INFO] [VHIDDeviceManager.swift:50 detectInstallation()] ğŸ” [VHIDManager] Manager app exists at /Applications/.Karabiner-VirtualHIDDevice-Manager.app/Contents/MacOS/Karabiner-VirtualHIDDevice-Manager: true
[2025-11-22 13:39:14.351] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:39:14.361] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:39:14.384] [INFO] [HelperManager.swift:830 verifyEmbeddedHelperSignature()] ğŸ”’ [HelperManager] Embedded helper signature looks valid
[2025-11-22 13:39:14.384] [INFO] [HelperManager.swift:105 getConnection()] ğŸ”— [HelperManager] Creating XPC connection to com.keypath.helper
[2025-11-22 13:39:14.384] [INFO] [HelperManager.swift:129 getConnection()] âœ… [HelperManager] XPC connection established (PID: 0)
[2025-11-22 13:39:14.384] [INFO] [HelperManager.swift:228 getHelperVersion()] ğŸ“¤ [HelperManager] Calling proxy.getVersion()
[2025-11-22 13:39:14.384] [INFO] [HelperManager.swift:243 getHelperVersion()] ğŸ“¤ [HelperManager] proxy.getVersion() call dispatched, waiting for callback
[2025-11-22 13:39:14.385] [INFO] [HelperManager.swift:121 getConnection()] âš ï¸ [HelperManager] XPC connection interrupted - will reconnect
[2025-11-22 13:39:14.385] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:39:14.385] [INFO] [HelperManager.swift:578 getRemoteProxy(errorHandler:)] âŒ [HelperManager] XPC proxy error: Couldnâ€™t communicate with a helper application.
[2025-11-22 13:39:14.385] [INFO] [HelperManager.swift:584 getRemoteProxy(errorHandler:)] âš ï¸ [HelperManager] XPC connection interrupted - this may indicate:
[2025-11-22 13:39:14.385] [INFO] [HelperManager.swift:585 getRemoteProxy(errorHandler:)]    1. Helper signature validation failed (app updated but not restarted)
[2025-11-22 13:39:14.385] [INFO] [HelperManager.swift:587 getRemoteProxy(errorHandler:)]    2. Helper process crashed
[2025-11-22 13:39:14.385] [INFO] [HelperManager.swift:588 getRemoteProxy(errorHandler:)]    3. Helper was killed by the system
[2025-11-22 13:39:14.385] [INFO] [HelperManager.swift:589 getRemoteProxy(errorHandler:)] ğŸ’¡ If you just updated KeyPath, try restarting the app
[2025-11-22 13:39:14.385] [INFO] [HelperManager.swift:116 getConnection()] âŒ [HelperManager] XPC connection invalidated
[2025-11-22 13:39:14.385] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:39:14.405] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.066s)
[2025-11-22 13:39:14.405] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:39:14.979] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.069s)
[2025-11-22 13:39:14.979] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:39:14.979] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:39:14.980] [INFO] [VHIDDeviceManager.swift:343 getInstalledVersion()] ğŸ” [VHIDManager] Installed daemon version: 5.0.0
[2025-11-22 13:39:14.980] [INFO] [VHIDDeviceManager.swift:374 hasVersionMismatch()] âœ… [VHIDManager] Version compatible: v5.0.0
[2025-11-22 13:39:14.980] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:39:15.047] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:39:15.048] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:39:15.048] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:39:15.048] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:39:15.048] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:39:15.049] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:39:15.049] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:39:15.049] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:39:15.049] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:39:15.049] [INFO] [LaunchDaemonInstaller.swift:669 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Kanata service state: Uninstalled
[2025-11-22 13:39:15.049] [INFO] [LaunchDaemonInstaller.swift:696 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Service not installed (state: Uninstalled)
[2025-11-22 13:39:15.049] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:39:15.114] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:39:15.182] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhiddaemon loaded: false
[2025-11-22 13:39:15.250] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhidmanager loaded: false
[2025-11-22 13:39:15.250] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:39:15.317] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:39:15.317] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhidmanager
[2025-11-22 13:39:15.385] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhidmanager not found in system domain
[2025-11-22 13:39:15.385] [INFO] [SystemValidator.swift:400 checkComponents()] ğŸ” [SystemValidator] Components: kanata=false, driver=true, daemon=false, vhid=false, vhidVersionMismatch=false
[2025-11-22 13:39:15.385] [INFO] [SystemValidator.swift:418 checkConflicts()] ğŸ” [SystemValidator] Checking for conflicts
[2025-11-22 13:39:15.385] [INFO] [ProcessLifecycleManager.swift:117 detectConflicts()] ğŸ” [ProcessLifecycleManager] Detecting conflicts...
[2025-11-22 13:39:15.385] [INFO] [SystemValidator.swift:220 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 3 (Components) completed in 1.047s
[2025-11-22 13:39:15.385] [INFO] [ProcessLifecycleManager.swift:121 detectConflicts()] ğŸ§ª [TestEnvironment] Skipping process conflict detection - returning clean state
[2025-11-22 13:39:15.385] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 20% (1/5 steps)
[2025-11-22 13:39:15.385] [INFO] [SystemValidator.swift:443 checkConflicts()] ğŸ” [SystemValidator] Total conflicts: 0 (0 kanata, 0 karabiner)
[2025-11-22 13:39:15.385] [INFO] [SystemValidator.swift:484 checkHealth()] ğŸ” [SystemValidator] Checking system health
[2025-11-22 13:39:15.385] [INFO] [SystemValidator.swift:229 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 4 (Conflicts) completed in 1.047s
[2025-11-22 13:39:15.385] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:39:15.385] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 40% (2/5 steps)
[2025-11-22 13:39:15.450] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:39:15.450] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:39:15.518] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:39:17.459] [INFO] [HelperManager.swift:248 getHelperVersion()] âš ï¸ [HelperManager] getVersion timed out - clearing connection cache
[2025-11-22 13:39:17.459] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:39:18.590] [INFO] [VHIDDeviceManager.swift:168 evaluateDaemonProcess()] âš ï¸ [VHIDManager] VHIDDevice process check timed out after 3s - fallback launchctl says running=false
[2025-11-22 13:39:18.659] [INFO] [VHIDDeviceManager.swift:88 detectRunning()] â³ [VHIDManager] Timeout while checking daemon; retrying to avoid false negatives
[2025-11-22 13:39:19.232] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.067s)
[2025-11-22 13:39:19.232] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:39:19.232] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:39:19.232] [INFO] [SystemValidator.swift:494 checkHealth()] ğŸ” [SystemValidator] Health: kanata=false, daemon=false (launchctl), vhid=false
[2025-11-22 13:39:19.232] [INFO] [SystemValidator.swift:238 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 5 (Health) completed in 4.894s
[2025-11-22 13:39:19.232] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 60% (3/5 steps)
[2025-11-22 13:39:19.232] [INFO] [SystemValidator.swift:362 checkPermissions()] ğŸ” [SystemValidator] Oracle snapshot: ready=false, age=4.894s
[2025-11-22 13:39:19.232] [INFO] [SystemValidator.swift:328 checkHelper()] ğŸ” [SystemValidator] Helper state: registeredButUnresponsive Helper registered but XPC communication failed
[2025-11-22 13:39:19.232] [INFO] [SystemValidator.swift:211 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 2 (Permissions) completed in 4.894s
[2025-11-22 13:39:19.232] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 80% (4/5 steps)
[2025-11-22 13:39:19.232] [INFO] [SystemValidator.swift:202 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 1 (Helper) completed in 4.894s
[2025-11-22 13:39:19.232] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 100% (5/5 steps)
[2025-11-22 13:39:19.233] [INFO] [SystemValidator.swift:283 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 COMPLETE: Total duration 4.895s
[2025-11-22 13:39:19.233] [INFO] [SystemValidator.swift:297 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Validation #1 complete in 4.895s
[2025-11-22 13:39:19.233] [INFO] [SystemValidator.swift:299 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Result: ready=false, blocking=9, total=9
[2025-11-22 13:39:19.233] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:39:19.233] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:39:19.233] [INFO] [SystemRequirements.swift:135 validateSystemCompatibility()] ğŸ” [SystemRequirements] Validating system compatibility
[2025-11-22 13:39:19.233] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:39:19.233] [INFO] [SystemRequirements.swift:147 validateSystemCompatibility()] âœ… [SystemRequirements] Modern macOS detected: 26.0.1
[2025-11-22 13:39:19.233] [INFO] [SystemRequirements.swift:190 validateSystemCompatibility()] ğŸ” [SystemRequirements] Compatibility check complete: âœ… Compatible
[2025-11-22 13:39:19.233] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:39:19.233] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:39:19.233] [INFO] [InstallerEngine.swift:78 inspectSystem()] âœ… [InstallerEngine] inspectSystem() complete - ready=false, blocking=9
[2025-11-22 13:39:19.233] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:19.233] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:19.233] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:19.233] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:19.233] [INFO] [InstallerEngine.swift:194 execute(plan:using:)] âš™ï¸ [InstallerEngine] Starting execute(plan:, using:)
[2025-11-22 13:39:19.233] [INFO] [InstallerEngine.swift:213 execute(plan:using:)] âš™ï¸ [InstallerEngine] Executing recipe: install-bundled-kanata (type: installComponent)
[2025-11-22 13:39:19.233] [INFO] [PrivilegedOperationsCoordinator.swift:359 installBundledKanata()] ğŸ” [PrivCoordinator] Installing bundled Kanata binary
[2025-11-22 13:39:19.233] [INFO] [LaunchDaemonInstaller.swift:2898 installBundledKanataBinaryOnly()] ğŸ”§ [LaunchDaemon] Installing bundled kanata binary to system location
[2025-11-22 13:39:19.233] [INFO] [LaunchDaemonInstaller.swift:2906 installBundledKanataBinaryOnly()] âŒ [LaunchDaemon] CRITICAL: Bundled kanata binary not found at: /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata
[2025-11-22 13:39:19.233] [INFO] [LaunchDaemonInstaller.swift:2908 installBundledKanataBinaryOnly()] âŒ [LaunchDaemon] This indicates a packaging issue - the app bundle is missing the kanata binary
[2025-11-22 13:39:19.233] [INFO] [InstallerEngine.swift:255 execute(plan:using:)] âŒ [InstallerEngine] Recipe install-bundled-kanata failed: Operation failed: Bundled Kanata installation failed
[2025-11-22 13:39:19.233] [INFO] [InstallerEngine.swift:274 execute(plan:using:)] âœ… [InstallerEngine] execute() complete - success: false, recipes executed: 1
Test Case '-[KeyPathTests.InstallerEngineTests testExecuteReturnsInstallerReport]' passed (4.896 seconds).
Test Case '-[KeyPathTests.InstallerEngineTests testExecuteStopsOnFirstFailure]' started.
[2025-11-22 13:39:19.234] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:39:19.234] [INFO] [SystemValidator.swift:63 init(launchDaemonInstaller:vhidDeviceManager:processLifecycleManager:kanataManager:)] ğŸ” [SystemValidator] Initialized (stateless, no cache)
[2025-11-22 13:39:19.234] [INFO] [InstallerEngine.swift:35 init(processLifecycleManager:kanataManager:)] ğŸ”§ [InstallerEngine] Initialized
[2025-11-22 13:39:19.234] [INFO] [InstallerEngine.swift:53 inspectSystem()] ğŸ” [InstallerEngine] Starting inspectSystem()
[2025-11-22 13:39:19.234] [INFO] [SystemValidator.swift:143 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Starting validation #1
[2025-11-22 13:39:19.234] [INFO] [SystemValidator.swift:174 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 START: 1763847559.234
[2025-11-22 13:39:19.235] [INFO] [SystemValidator.swift:312 checkHelper()] ğŸ” [SystemValidator] Checking privileged helper
[2025-11-22 13:39:19.235] [INFO] [SystemValidator.swift:372 checkComponents()] ğŸ” [SystemValidator] Checking components
[2025-11-22 13:39:19.235] [INFO] [KanataBinaryDetector.swift:66 detectCurrentStatus()] ğŸ” [KanataBinaryDetector] Starting unified kanata binary detection
[2025-11-22 13:39:19.235] [INFO] [KanataBinaryDetector.swift:81 detectCurrentStatus()] âŒ [KanataBinaryDetector] No kanata binary found
[2025-11-22 13:39:19.235] [INFO] [VHIDDeviceManager.swift:50 detectInstallation()] ğŸ” [VHIDManager] Manager app exists at /Applications/.Karabiner-VirtualHIDDevice-Manager.app/Contents/MacOS/Karabiner-VirtualHIDDevice-Manager: true
[2025-11-22 13:39:19.241] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:39:19.246] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:39:19.261] [INFO] [HelperManager.swift:830 verifyEmbeddedHelperSignature()] ğŸ”’ [HelperManager] Embedded helper signature looks valid
[2025-11-22 13:39:19.261] [INFO] [HelperManager.swift:105 getConnection()] ğŸ”— [HelperManager] Creating XPC connection to com.keypath.helper
[2025-11-22 13:39:19.261] [INFO] [HelperManager.swift:129 getConnection()] âœ… [HelperManager] XPC connection established (PID: 0)
[2025-11-22 13:39:19.261] [INFO] [HelperManager.swift:228 getHelperVersion()] ğŸ“¤ [HelperManager] Calling proxy.getVersion()
[2025-11-22 13:39:19.261] [INFO] [HelperManager.swift:243 getHelperVersion()] ğŸ“¤ [HelperManager] proxy.getVersion() call dispatched, waiting for callback
[2025-11-22 13:39:19.262] [INFO] [HelperManager.swift:121 getConnection()] âš ï¸ [HelperManager] XPC connection interrupted - will reconnect
[2025-11-22 13:39:19.262] [INFO] [HelperManager.swift:578 getRemoteProxy(errorHandler:)] âŒ [HelperManager] XPC proxy error: Couldnâ€™t communicate with a helper application.
[2025-11-22 13:39:19.262] [INFO] [HelperManager.swift:584 getRemoteProxy(errorHandler:)] âš ï¸ [HelperManager] XPC connection interrupted - this may indicate:
[2025-11-22 13:39:19.262] [INFO] [HelperManager.swift:585 getRemoteProxy(errorHandler:)]    1. Helper signature validation failed (app updated but not restarted)
[2025-11-22 13:39:19.262] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:39:19.262] [INFO] [HelperManager.swift:587 getRemoteProxy(errorHandler:)]    2. Helper process crashed
[2025-11-22 13:39:19.262] [INFO] [HelperManager.swift:588 getRemoteProxy(errorHandler:)]    3. Helper was killed by the system
[2025-11-22 13:39:19.262] [INFO] [HelperManager.swift:589 getRemoteProxy(errorHandler:)] ğŸ’¡ If you just updated KeyPath, try restarting the app
[2025-11-22 13:39:19.262] [INFO] [HelperManager.swift:116 getConnection()] âŒ [HelperManager] XPC connection invalidated
[2025-11-22 13:39:19.262] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:39:22.302] [INFO] [VHIDDeviceManager.swift:168 evaluateDaemonProcess()] âš ï¸ [VHIDManager] VHIDDevice process check timed out after 3s - fallback launchctl says running=false
[2025-11-22 13:39:22.336] [INFO] [HelperManager.swift:248 getHelperVersion()] âš ï¸ [HelperManager] getVersion timed out - clearing connection cache
[2025-11-22 13:39:22.337] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:39:22.371] [INFO] [VHIDDeviceManager.swift:88 detectRunning()] â³ [VHIDManager] Timeout while checking daemon; retrying to avoid false negatives
[2025-11-22 13:39:22.945] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.068s)
[2025-11-22 13:39:22.945] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:39:22.945] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:39:22.945] [INFO] [VHIDDeviceManager.swift:343 getInstalledVersion()] ğŸ” [VHIDManager] Installed daemon version: 5.0.0
[2025-11-22 13:39:22.945] [INFO] [VHIDDeviceManager.swift:374 hasVersionMismatch()] âœ… [VHIDManager] Version compatible: v5.0.0
[2025-11-22 13:39:22.945] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:39:23.014] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:39:23.015] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:39:23.015] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:39:23.015] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:39:23.015] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:39:23.015] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:39:23.015] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:39:23.015] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:39:23.015] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:39:23.015] [INFO] [LaunchDaemonInstaller.swift:669 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Kanata service state: Uninstalled
[2025-11-22 13:39:23.015] [INFO] [LaunchDaemonInstaller.swift:696 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Service not installed (state: Uninstalled)
[2025-11-22 13:39:23.015] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:39:23.083] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:39:23.151] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhiddaemon loaded: false
[2025-11-22 13:39:23.219] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhidmanager loaded: false
[2025-11-22 13:39:23.219] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:39:23.286] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:39:23.286] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhidmanager
[2025-11-22 13:39:23.354] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhidmanager not found in system domain
[2025-11-22 13:39:23.354] [INFO] [SystemValidator.swift:400 checkComponents()] ğŸ” [SystemValidator] Components: kanata=false, driver=true, daemon=false, vhid=false, vhidVersionMismatch=false
[2025-11-22 13:39:23.354] [INFO] [SystemValidator.swift:220 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 3 (Components) completed in 4.120s
[2025-11-22 13:39:23.354] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 20% (1/5 steps)
[2025-11-22 13:39:23.354] [INFO] [SystemValidator.swift:418 checkConflicts()] ğŸ” [SystemValidator] Checking for conflicts
[2025-11-22 13:39:23.354] [INFO] [ProcessLifecycleManager.swift:117 detectConflicts()] ğŸ” [ProcessLifecycleManager] Detecting conflicts...
[2025-11-22 13:39:23.354] [INFO] [ProcessLifecycleManager.swift:121 detectConflicts()] ğŸ§ª [TestEnvironment] Skipping process conflict detection - returning clean state
[2025-11-22 13:39:23.354] [INFO] [SystemValidator.swift:443 checkConflicts()] ğŸ” [SystemValidator] Total conflicts: 0 (0 kanata, 0 karabiner)
[2025-11-22 13:39:23.354] [INFO] [SystemValidator.swift:484 checkHealth()] ğŸ” [SystemValidator] Checking system health
[2025-11-22 13:39:23.354] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:39:23.354] [INFO] [SystemValidator.swift:229 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 4 (Conflicts) completed in 4.120s
[2025-11-22 13:39:23.354] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 40% (2/5 steps)
[2025-11-22 13:39:23.422] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:39:23.422] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:39:23.488] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:39:23.557] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.068s)
[2025-11-22 13:39:23.557] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:39:24.131] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.068s)
[2025-11-22 13:39:24.131] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:39:24.131] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:39:24.131] [INFO] [SystemValidator.swift:494 checkHealth()] ğŸ” [SystemValidator] Health: kanata=false, daemon=false (launchctl), vhid=false
[2025-11-22 13:39:24.131] [INFO] [SystemValidator.swift:344 checkPermissions()] ğŸ” [SystemValidator] Checking permissions via Oracle
[2025-11-22 13:39:24.131] [INFO] [SystemValidator.swift:238 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 5 (Health) completed in 4.896s
[2025-11-22 13:39:24.131] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 60% (3/5 steps)
[2025-11-22 13:39:24.131] [INFO] [PermissionOracle.swift:173 currentSnapshot()] ğŸ”® [Oracle] Test mode snapshot generated (non-blocking)
[2025-11-22 13:39:24.131] [INFO] [SystemValidator.swift:328 checkHelper()] ğŸ” [SystemValidator] Helper state: registeredButUnresponsive Helper registered but XPC communication failed
[2025-11-22 13:39:24.131] [INFO] [SystemValidator.swift:202 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 1 (Helper) completed in 4.896s
[2025-11-22 13:39:24.131] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 80% (4/5 steps)
[2025-11-22 13:39:24.131] [INFO] [SystemValidator.swift:362 checkPermissions()] ğŸ” [SystemValidator] Oracle snapshot: ready=false, age=0.000s
[2025-11-22 13:39:24.131] [INFO] [SystemValidator.swift:211 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 2 (Permissions) completed in 4.896s
[2025-11-22 13:39:24.131] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 100% (5/5 steps)
[2025-11-22 13:39:24.131] [INFO] [SystemValidator.swift:283 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 COMPLETE: Total duration 4.897s
[2025-11-22 13:39:24.131] [INFO] [SystemValidator.swift:297 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Validation #1 complete in 4.897s
[2025-11-22 13:39:24.131] [INFO] [SystemValidator.swift:299 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Result: ready=false, blocking=9, total=9
[2025-11-22 13:39:24.131] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:39:24.131] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:39:24.131] [INFO] [SystemRequirements.swift:135 validateSystemCompatibility()] ğŸ” [SystemRequirements] Validating system compatibility
[2025-11-22 13:39:24.131] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:39:24.131] [INFO] [SystemRequirements.swift:147 validateSystemCompatibility()] âœ… [SystemRequirements] Modern macOS detected: 26.0.1
[2025-11-22 13:39:24.131] [INFO] [SystemRequirements.swift:190 validateSystemCompatibility()] ğŸ” [SystemRequirements] Compatibility check complete: âœ… Compatible
[2025-11-22 13:39:24.131] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:39:24.131] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:39:24.131] [INFO] [InstallerEngine.swift:78 inspectSystem()] âœ… [InstallerEngine] inspectSystem() complete - ready=false, blocking=9
[2025-11-22 13:39:24.131] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:24.131] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:24.131] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:24.131] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:39:24.131] [INFO] [InstallerEngine.swift:194 execute(plan:using:)] âš™ï¸ [InstallerEngine] Starting execute(plan:, using:)
[2025-11-22 13:39:24.131] [INFO] [InstallerEngine.swift:213 execute(plan:using:)] âš™ï¸ [InstallerEngine] Executing recipe: install-bundled-kanata (type: installComponent)
[2025-11-22 13:39:24.131] [INFO] [PrivilegedOperationsCoordinator.swift:359 installBundledKanata()] ğŸ” [PrivCoordinator] Installing bundled Kanata binary
[2025-11-22 13:39:24.131] [INFO] [LaunchDaemonInstaller.swift:2898 installBundledKanataBinaryOnly()] ğŸ”§ [LaunchDaemon] Installing bundled kanata binary to system location
[2025-11-22 13:39:24.132] [INFO] [LaunchDaemonInstaller.swift:2906 installBundledKanataBinaryOnly()] âŒ [LaunchDaemon] CRITICAL: Bundled kanata binary not found at: /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata
[2025-11-22 13:39:24.132] [INFO] [LaunchDaemonInstaller.swift:2908 installBundledKanataBinaryOnly()] âŒ [LaunchDaemon] This indicates a packaging issue - the app bundle is missing the kanata binary
[2025-11-22 13:39:24.132] [INFO] [InstallerEngine.swift:255 execute(plan:using:)] âŒ [InstallerEngine] Recipe install-bundled-kanata failed: Operation failed: Bundled Kanata installation failed
[2025-11-22 13:39:24.132] [INFO] [InstallerEngine.swift:274 execute(plan:using:)] âœ… [InstallerEngine] execute() complete - success: false, recipes executed: 1
Test Case '-[KeyPathTests.InstallerEngineTests testExecuteStopsOnFirstFailure]' passed (4.898 seconds).
Test Case '-[KeyPathTests.InstallerEngineTests testExecuteWithEmptyPlan]' started.
[2025-11-22 13:39:24.132] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:39:24.132] [INFO] [SystemValidator.swift:63 init(launchDaemonInstaller:vhidDeviceManager:processLifecycleManager:kanataManager:)] ğŸ” [SystemValidator] Initialized (stateless, no cache)
[2025-11-22 13:39:24.133] [INFO] [InstallerEngine.swift:35 init(processLifecycleManager:kanataManager:)] ğŸ”§ [InstallerEngine] Initialized
[2025-11-22 13:39:24.133] [INFO] [InstallerEngine.swift:194 execute(plan:using:)] âš™ï¸ [InstallerEngine] Starting execute(plan:, using:)
[2025-11-22 13:39:24.133] [INFO] [InstallerEngine.swift:274 execute(plan:using:)] âœ… [InstallerEngine] execute() complete - success: true, recipes executed: 0
Test Case '-[KeyPathTests.InstallerEngineTests testExecuteWithEmptyPlan]' passed (0.000 seconds).
Test Case '-[KeyPathTests.InstallerEngineTests testInspectSystemReturnsConsistentContext]' started.
[2025-11-22 13:39:24.133] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:39:24.133] [INFO] [SystemValidator.swift:63 init(launchDaemonInstaller:vhidDeviceManager:processLifecycleManager:kanataManager:)] ğŸ” [SystemValidator] Initialized (stateless, no cache)
[2025-11-22 13:39:24.133] [INFO] [InstallerEngine.swift:35 init(processLifecycleManager:kanataManager:)] ğŸ”§ [InstallerEngine] Initialized
[2025-11-22 13:39:24.133] [INFO] [InstallerEngine.swift:53 inspectSystem()] ğŸ” [InstallerEngine] Starting inspectSystem()
[2025-11-22 13:39:24.133] [INFO] [SystemValidator.swift:143 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Starting validation #1
[2025-11-22 13:39:24.133] [INFO] [SystemValidator.swift:174 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 START: 1763847564.133
[2025-11-22 13:39:24.133] [INFO] [SystemValidator.swift:312 checkHelper()] ğŸ” [SystemValidator] Checking privileged helper
[2025-11-22 13:39:24.133] [INFO] [SystemValidator.swift:344 checkPermissions()] ğŸ” [SystemValidator] Checking permissions via Oracle
[2025-11-22 13:39:24.133] [INFO] [SystemValidator.swift:372 checkComponents()] ğŸ” [SystemValidator] Checking components
[2025-11-22 13:39:24.133] [INFO] [KanataBinaryDetector.swift:66 detectCurrentStatus()] ğŸ” [KanataBinaryDetector] Starting unified kanata binary detection
[2025-11-22 13:39:24.133] [INFO] [PermissionOracle.swift:158 currentSnapshot()] ğŸ”® [Oracle] (Test) Returning cached snapshot
[2025-11-22 13:39:24.133] [INFO] [KanataBinaryDetector.swift:81 detectCurrentStatus()] âŒ [KanataBinaryDetector] No kanata binary found
[2025-11-22 13:39:24.134] [INFO] [VHIDDeviceManager.swift:50 detectInstallation()] ğŸ” [VHIDManager] Manager app exists at /Applications/.Karabiner-VirtualHIDDevice-Manager.app/Contents/MacOS/Karabiner-VirtualHIDDevice-Manager: true
[2025-11-22 13:39:24.141] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:39:24.146] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:39:24.163] [INFO] [HelperManager.swift:830 verifyEmbeddedHelperSignature()] ğŸ”’ [HelperManager] Embedded helper signature looks valid
[2025-11-22 13:39:24.163] [INFO] [HelperManager.swift:105 getConnection()] ğŸ”— [HelperManager] Creating XPC connection to com.keypath.helper
[2025-11-22 13:39:24.163] [INFO] [HelperManager.swift:129 getConnection()] âœ… [HelperManager] XPC connection established (PID: 0)
[2025-11-22 13:39:24.163] [INFO] [HelperManager.swift:228 getHelperVersion()] ğŸ“¤ [HelperManager] Calling proxy.getVersion()
[2025-11-22 13:39:24.163] [INFO] [HelperManager.swift:243 getHelperVersion()] ğŸ“¤ [HelperManager] proxy.getVersion() call dispatched, waiting for callback
[2025-11-22 13:39:24.164] [INFO] [HelperManager.swift:121 getConnection()] âš ï¸ [HelperManager] XPC connection interrupted - will reconnect
[2025-11-22 13:39:24.164] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:39:24.164] [INFO] [HelperManager.swift:578 getRemoteProxy(errorHandler:)] âŒ [HelperManager] XPC proxy error: Couldnâ€™t communicate with a helper application.
[2025-11-22 13:39:24.164] [INFO] [HelperManager.swift:584 getRemoteProxy(errorHandler:)] âš ï¸ [HelperManager] XPC connection interrupted - this may indicate:
[2025-11-22 13:39:24.164] [INFO] [HelperManager.swift:585 getRemoteProxy(errorHandler:)]    1. Helper signature validation failed (app updated but not restarted)
[2025-11-22 13:39:24.164] [INFO] [HelperManager.swift:587 getRemoteProxy(errorHandler:)]    2. Helper process crashed
[2025-11-22 13:39:24.164] [INFO] [HelperManager.swift:588 getRemoteProxy(errorHandler:)]    3. Helper was killed by the system
[2025-11-22 13:39:24.164] [INFO] [HelperManager.swift:589 getRemoteProxy(errorHandler:)] ğŸ’¡ If you just updated KeyPath, try restarting the app
[2025-11-22 13:39:24.164] [INFO] [HelperManager.swift:116 getConnection()] âŒ [HelperManager] XPC connection invalidated
[2025-11-22 13:39:24.164] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:39:24.202] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.068s)
[2025-11-22 13:39:24.202] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:39:24.776] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.069s)
[2025-11-22 13:39:24.776] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:39:24.776] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:39:24.777] [INFO] [VHIDDeviceManager.swift:343 getInstalledVersion()] ğŸ” [VHIDManager] Installed daemon version: 5.0.0
[2025-11-22 13:39:24.777] [INFO] [VHIDDeviceManager.swift:374 hasVersionMismatch()] âœ… [VHIDManager] Version compatible: v5.0.0
[2025-11-22 13:39:24.777] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:39:24.843] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:39:24.844] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:39:24.844] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:39:24.844] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:39:24.844] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:39:24.845] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:39:24.845] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:39:24.845] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:39:24.845] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:39:24.845] [INFO] [LaunchDaemonInstaller.swift:669 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Kanata service state: Uninstalled
[2025-11-22 13:39:24.845] [INFO] [LaunchDaemonInstaller.swift:696 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Service not installed (state: Uninstalled)
[2025-11-22 13:39:24.845] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:39:24.913] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:39:24.980] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhiddaemon loaded: false
[2025-11-22 13:39:25.049] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhidmanager loaded: false
[2025-11-22 13:39:25.049] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:39:25.115] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:39:25.115] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhidmanager
[2025-11-22 13:39:25.183] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhidmanager not found in system domain
[2025-11-22 13:39:25.183] [INFO] [SystemValidator.swift:400 checkComponents()] ğŸ” [SystemValidator] Components: kanata=false, driver=true, daemon=false, vhid=false, vhidVersionMismatch=false
[2025-11-22 13:39:25.183] [INFO] [SystemValidator.swift:220 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 3 (Components) completed in 1.050s
[2025-11-22 13:39:25.183] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 20% (1/5 steps)
[2025-11-22 13:39:25.183] [INFO] [SystemValidator.swift:418 checkConflicts()] ğŸ” [SystemValidator] Checking for conflicts
[2025-11-22 13:39:25.183] [INFO] [ProcessLifecycleManager.swift:117 detectConflicts()] ğŸ” [ProcessLifecycleManager] Detecting conflicts...
[2025-11-22 13:39:25.183] [INFO] [ProcessLifecycleManager.swift:121 detectConflicts()] ğŸ§ª [TestEnvironment] Skipping process conflict detection - returning clean state
[2025-11-22 13:39:25.183] [INFO] [SystemValidator.swift:443 checkConflicts()] ğŸ” [SystemValidator] Total conflicts: 0 (0 kanata, 0 karabiner)
[2025-11-22 13:39:25.183] [INFO] [SystemValidator.swift:484 checkHealth()] ğŸ” [SystemValidator] Checking system health
[2025-11-22 13:39:25.183] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:39:25.183] [INFO] [SystemValidator.swift:229 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 4 (Conflicts) completed in 1.050s
[2025-11-22 13:39:25.183] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 40% (2/5 steps)
[2025-11-22 13:39:25.251] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:39:25.251] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:39:25.318] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:39:27.223] [INFO] [HelperManager.swift:248 getHelperVersion()] âš ï¸ [HelperManager] getVersion timed out - clearing connection cache
[2025-11-22 13:39:27.223] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:39:28.385] [INFO] [VHIDDeviceManager.swift:168 evaluateDaemonProcess()] âš ï¸ [VHIDManager] VHIDDevice process check timed out after 3s - fallback launchctl says running=false
[2025-11-22 13:39:28.454] [INFO] [VHIDDeviceManager.swift:88 detectRunning()] â³ [VHIDManager] Timeout while checking daemon; retrying to avoid false negatives
[2025-11-22 13:39:32.027] [INFO] [VHIDDeviceManager.swift:168 evaluateDaemonProcess()] âš ï¸ [VHIDManager] VHIDDevice process check timed out after 3s - fallback launchctl says running=false
[2025-11-22 13:39:32.096] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:39:32.096] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:39:32.096] [INFO] [SystemValidator.swift:494 checkHealth()] ğŸ” [SystemValidator] Health: kanata=false, daemon=false (launchctl), vhid=false
[2025-11-22 13:39:32.096] [INFO] [SystemValidator.swift:238 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 5 (Health) completed in 7.963s
[2025-11-22 13:39:32.096] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 60% (3/5 steps)
[2025-11-22 13:39:32.096] [INFO] [SystemValidator.swift:359 checkPermissions()] âš ï¸ [SystemValidator] Oracle snapshot is 8.0s old (ignored in tests)
[2025-11-22 13:39:32.096] [INFO] [SystemValidator.swift:362 checkPermissions()] ğŸ” [SystemValidator] Oracle snapshot: ready=false, age=7.966s
[2025-11-22 13:39:32.096] [INFO] [SystemValidator.swift:328 checkHelper()] ğŸ” [SystemValidator] Helper state: registeredButUnresponsive Helper registered but XPC communication failed
[2025-11-22 13:39:32.096] [INFO] [SystemValidator.swift:211 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 2 (Permissions) completed in 7.963s
[2025-11-22 13:39:32.096] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 80% (4/5 steps)
[2025-11-22 13:39:32.096] [INFO] [SystemValidator.swift:202 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 1 (Helper) completed in 7.963s
[2025-11-22 13:39:32.096] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 100% (5/5 steps)
[2025-11-22 13:39:32.096] [INFO] [SystemValidator.swift:283 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 COMPLETE: Total duration 7.963s
[2025-11-22 13:39:32.096] [INFO] [SystemValidator.swift:297 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Validation #1 complete in 7.963s
[2025-11-22 13:39:32.096] [INFO] [SystemValidator.swift:299 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Result: ready=false, blocking=9, total=9
[2025-11-22 13:39:32.096] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:39:32.097] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:39:32.097] [INFO] [SystemRequirements.swift:135 validateSystemCompatibility()] ğŸ” [SystemRequirements] Validating system compatibility
[2025-11-22 13:39:32.097] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:39:32.097] [INFO] [SystemRequirements.swift:147 validateSystemCompatibility()] âœ… [SystemRequirements] Modern macOS detected: 26.0.1
[2025-11-22 13:39:32.097] [INFO] [SystemRequirements.swift:190 validateSystemCompatibility()] ğŸ” [SystemRequirements] Compatibility check complete: âœ… Compatible
[2025-11-22 13:39:32.097] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:39:32.097] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:39:32.097] [INFO] [InstallerEngine.swift:78 inspectSystem()] âœ… [InstallerEngine] inspectSystem() complete - ready=false, blocking=9
[2025-11-22 13:39:32.097] [INFO] [InstallerEngine.swift:53 inspectSystem()] ğŸ” [InstallerEngine] Starting inspectSystem()
[2025-11-22 13:39:32.097] [INFO] [SystemValidator.swift:143 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Starting validation #1
[2025-11-22 13:39:32.097] [INFO] [SystemValidator.swift:174 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 START: 1763847572.097
[2025-11-22 13:39:32.097] [INFO] [SystemValidator.swift:312 checkHelper()] ğŸ” [SystemValidator] Checking privileged helper
[2025-11-22 13:39:32.097] [INFO] [SystemValidator.swift:344 checkPermissions()] ğŸ” [SystemValidator] Checking permissions via Oracle
[2025-11-22 13:39:32.097] [INFO] [SystemValidator.swift:372 checkComponents()] ğŸ” [SystemValidator] Checking components
[2025-11-22 13:39:32.097] [INFO] [KanataBinaryDetector.swift:66 detectCurrentStatus()] ğŸ” [KanataBinaryDetector] Starting unified kanata binary detection
[2025-11-22 13:39:32.097] [INFO] [PermissionOracle.swift:173 currentSnapshot()] ğŸ”® [Oracle] Test mode snapshot generated (non-blocking)
[2025-11-22 13:39:32.097] [INFO] [KanataBinaryDetector.swift:81 detectCurrentStatus()] âŒ [KanataBinaryDetector] No kanata binary found
[2025-11-22 13:39:32.097] [INFO] [VHIDDeviceManager.swift:50 detectInstallation()] ğŸ” [VHIDManager] Manager app exists at /Applications/.Karabiner-VirtualHIDDevice-Manager.app/Contents/MacOS/Karabiner-VirtualHIDDevice-Manager: true
[2025-11-22 13:39:32.164] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.067s)
[2025-11-22 13:39:32.164] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:39:32.228] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:39:32.312] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:39:32.328] [INFO] [HelperManager.swift:830 verifyEmbeddedHelperSignature()] ğŸ”’ [HelperManager] Embedded helper signature looks valid
[2025-11-22 13:39:32.328] [INFO] [HelperManager.swift:105 getConnection()] ğŸ”— [HelperManager] Creating XPC connection to com.keypath.helper
[2025-11-22 13:39:32.328] [INFO] [HelperManager.swift:129 getConnection()] âœ… [HelperManager] XPC connection established (PID: 0)
[2025-11-22 13:39:32.328] [INFO] [HelperManager.swift:228 getHelperVersion()] ğŸ“¤ [HelperManager] Calling proxy.getVersion()
[2025-11-22 13:39:32.328] [INFO] [HelperManager.swift:243 getHelperVersion()] ğŸ“¤ [HelperManager] proxy.getVersion() call dispatched, waiting for callback
[2025-11-22 13:39:32.329] [INFO] [HelperManager.swift:121 getConnection()] âš ï¸ [HelperManager] XPC connection interrupted - will reconnect
[2025-11-22 13:39:32.329] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:39:32.329] [INFO] [HelperManager.swift:578 getRemoteProxy(errorHandler:)] âŒ [HelperManager] XPC proxy error: Couldnâ€™t communicate with a helper application.
[2025-11-22 13:39:32.329] [INFO] [HelperManager.swift:584 getRemoteProxy(errorHandler:)] âš ï¸ [HelperManager] XPC connection interrupted - this may indicate:
[2025-11-22 13:39:32.329] [INFO] [HelperManager.swift:585 getRemoteProxy(errorHandler:)]    1. Helper signature validation failed (app updated but not restarted)
[2025-11-22 13:39:32.329] [INFO] [HelperManager.swift:587 getRemoteProxy(errorHandler:)]    2. Helper process crashed
[2025-11-22 13:39:32.329] [INFO] [HelperManager.swift:588 getRemoteProxy(errorHandler:)]    3. Helper was killed by the system
[2025-11-22 13:39:32.329] [INFO] [HelperManager.swift:589 getRemoteProxy(errorHandler:)] ğŸ’¡ If you just updated KeyPath, try restarting the app
[2025-11-22 13:39:32.329] [INFO] [HelperManager.swift:116 getConnection()] âŒ [HelperManager] XPC connection invalidated
[2025-11-22 13:39:32.329] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:39:35.403] [INFO] [HelperManager.swift:248 getHelperVersion()] âš ï¸ [HelperManager] getVersion timed out - clearing connection cache
[2025-11-22 13:39:35.403] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:39:35.736] [INFO] [VHIDDeviceManager.swift:168 evaluateDaemonProcess()] âš ï¸ [VHIDManager] VHIDDevice process check timed out after 3s - fallback launchctl says running=false
[2025-11-22 13:39:35.805] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:39:35.805] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:39:35.805] [INFO] [VHIDDeviceManager.swift:343 getInstalledVersion()] ğŸ” [VHIDManager] Installed daemon version: 5.0.0
[2025-11-22 13:39:35.805] [INFO] [VHIDDeviceManager.swift:374 hasVersionMismatch()] âœ… [VHIDManager] Version compatible: v5.0.0
[2025-11-22 13:39:35.805] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:39:35.871] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:39:35.873] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:39:35.873] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:39:35.873] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:39:35.873] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:39:35.874] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:39:35.874] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:39:35.874] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:39:35.874] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:39:35.874] [INFO] [LaunchDaemonInstaller.swift:669 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Kanata service state: Uninstalled
[2025-11-22 13:39:35.874] [INFO] [LaunchDaemonInstaller.swift:696 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Service not installed (state: Uninstalled)
[2025-11-22 13:39:35.874] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:39:35.941] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:39:36.010] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhiddaemon loaded: false
[2025-11-22 13:39:36.082] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhidmanager loaded: false
[2025-11-22 13:39:36.082] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:39:36.150] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:39:36.150] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhidmanager
[2025-11-22 13:39:36.218] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhidmanager not found in system domain
[2025-11-22 13:39:36.218] [INFO] [SystemValidator.swift:400 checkComponents()] ğŸ” [SystemValidator] Components: kanata=false, driver=true, daemon=false, vhid=false, vhidVersionMismatch=false
[2025-11-22 13:39:36.218] [INFO] [SystemValidator.swift:220 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 3 (Components) completed in 4.121s
[2025-11-22 13:39:36.218] [INFO] [SystemValidator.swift:418 checkConflicts()] ğŸ” [SystemValidator] Checking for conflicts
[2025-11-22 13:39:36.218] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 20% (1/5 steps)
[2025-11-22 13:39:36.218] [INFO] [ProcessLifecycleManager.swift:117 detectConflicts()] ğŸ” [ProcessLifecycleManager] Detecting conflicts...
[2025-11-22 13:39:36.218] [INFO] [ProcessLifecycleManager.swift:121 detectConflicts()] ğŸ§ª [TestEnvironment] Skipping process conflict detection - returning clean state
[2025-11-22 13:39:36.218] [INFO] [SystemValidator.swift:443 checkConflicts()] ğŸ” [SystemValidator] Total conflicts: 0 (0 kanata, 0 karabiner)
[2025-11-22 13:39:36.218] [INFO] [SystemValidator.swift:484 checkHealth()] ğŸ” [SystemValidator] Checking system health
[2025-11-22 13:39:36.218] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:39:36.218] [INFO] [SystemValidator.swift:229 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 4 (Conflicts) completed in 4.121s
[2025-11-22 13:39:36.218] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 40% (2/5 steps)
[2025-11-22 13:39:36.289] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:39:36.289] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:39:36.358] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:39:39.424] [INFO] [VHIDDeviceManager.swift:168 evaluateDaemonProcess()] âš ï¸ [VHIDManager] VHIDDevice process check timed out after 3s - fallback launchctl says running=false
[2025-11-22 13:39:39.492] [INFO] [VHIDDeviceManager.swift:88 detectRunning()] â³ [VHIDManager] Timeout while checking daemon; retrying to avoid false negatives
[2025-11-22 13:39:40.065] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.067s)
[2025-11-22 13:39:40.065] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:39:40.065] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:39:40.065] [INFO] [SystemValidator.swift:494 checkHealth()] ğŸ” [SystemValidator] Health: kanata=false, daemon=false (launchctl), vhid=false
[2025-11-22 13:39:40.065] [INFO] [SystemValidator.swift:238 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 5 (Health) completed in 7.968s
[2025-11-22 13:39:40.065] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 60% (3/5 steps)
[2025-11-22 13:39:40.065] [INFO] [SystemValidator.swift:359 checkPermissions()] âš ï¸ [SystemValidator] Oracle snapshot is 8.0s old (ignored in tests)
[2025-11-22 13:39:40.065] [INFO] [SystemValidator.swift:362 checkPermissions()] ğŸ” [SystemValidator] Oracle snapshot: ready=false, age=7.968s
[2025-11-22 13:39:40.065] [INFO] [SystemValidator.swift:328 checkHelper()] ğŸ” [SystemValidator] Helper state: registeredButUnresponsive Helper registered but XPC communication failed
[2025-11-22 13:39:40.065] [INFO] [SystemValidator.swift:211 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 2 (Permissions) completed in 7.969s
[2025-11-22 13:39:40.065] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 80% (4/5 steps)
[2025-11-22 13:39:40.065] [INFO] [SystemValidator.swift:202 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 1 (Helper) completed in 7.969s
[2025-11-22 13:39:40.065] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 100% (5/5 steps)
[2025-11-22 13:39:40.065] [INFO] [SystemValidator.swift:283 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 COMPLETE: Total duration 7.969s
[2025-11-22 13:39:40.065] [INFO] [SystemValidator.swift:297 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Validation #1 complete in 7.969s
[2025-11-22 13:39:40.065] [INFO] [SystemValidator.swift:299 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Result: ready=false, blocking=9, total=9
[2025-11-22 13:39:40.065] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:39:40.065] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:39:40.065] [INFO] [SystemRequirements.swift:135 validateSystemCompatibility()] ğŸ” [SystemRequirements] Validating system compatibility
[2025-11-22 13:39:40.065] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:39:40.065] [INFO] [SystemRequirements.swift:147 validateSystemCompatibility()] âœ… [SystemRequirements] Modern macOS detected: 26.0.1
[2025-11-22 13:39:40.066] [INFO] [SystemRequirements.swift:190 validateSystemCompatibility()] ğŸ” [SystemRequirements] Compatibility check complete: âœ… Compatible
[2025-11-22 13:39:40.066] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:39:40.066] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:39:40.066] [INFO] [InstallerEngine.swift:78 inspectSystem()] âœ… [InstallerEngine] inspectSystem() complete - ready=false, blocking=9
Test Case '-[KeyPathTests.InstallerEngineTests testInspectSystemReturnsConsistentContext]' passed (15.934 seconds).
Test Case '-[KeyPathTests.InstallerEngineTests testInspectSystemReturnsSystemContext]' started.
[2025-11-22 13:39:40.067] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:39:40.067] [INFO] [SystemValidator.swift:63 init(launchDaemonInstaller:vhidDeviceManager:processLifecycleManager:kanataManager:)] ğŸ” [SystemValidator] Initialized (stateless, no cache)
[2025-11-22 13:39:40.067] [INFO] [InstallerEngine.swift:35 init(processLifecycleManager:kanataManager:)] ğŸ”§ [InstallerEngine] Initialized
[2025-11-22 13:39:40.067] [INFO] [InstallerEngine.swift:53 inspectSystem()] ğŸ” [InstallerEngine] Starting inspectSystem()
[2025-11-22 13:39:40.068] [INFO] [SystemValidator.swift:143 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Starting validation #1
[2025-11-22 13:39:40.068] [INFO] [SystemValidator.swift:174 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 START: 1763847580.068
[2025-11-22 13:39:40.068] [INFO] [SystemValidator.swift:312 checkHelper()] ğŸ” [SystemValidator] Checking privileged helper
[2025-11-22 13:39:40.068] [INFO] [SystemValidator.swift:344 checkPermissions()] ğŸ” [SystemValidator] Checking permissions via Oracle
[2025-11-22 13:39:40.068] [INFO] [SystemValidator.swift:372 checkComponents()] ğŸ” [SystemValidator] Checking components
[2025-11-22 13:39:40.068] [INFO] [KanataBinaryDetector.swift:66 detectCurrentStatus()] ğŸ” [KanataBinaryDetector] Starting unified kanata binary detection
[2025-11-22 13:39:40.068] [INFO] [PermissionOracle.swift:173 currentSnapshot()] ğŸ”® [Oracle] Test mode snapshot generated (non-blocking)
[2025-11-22 13:39:40.068] [INFO] [KanataBinaryDetector.swift:81 detectCurrentStatus()] âŒ [KanataBinaryDetector] No kanata binary found
[2025-11-22 13:39:40.068] [INFO] [VHIDDeviceManager.swift:50 detectInstallation()] ğŸ” [VHIDManager] Manager app exists at /Applications/.Karabiner-VirtualHIDDevice-Manager.app/Contents/MacOS/Karabiner-VirtualHIDDevice-Manager: true
[2025-11-22 13:39:40.075] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:39:40.080] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:39:40.098] [INFO] [HelperManager.swift:830 verifyEmbeddedHelperSignature()] ğŸ”’ [HelperManager] Embedded helper signature looks valid
[2025-11-22 13:39:40.098] [INFO] [HelperManager.swift:105 getConnection()] ğŸ”— [HelperManager] Creating XPC connection to com.keypath.helper
[2025-11-22 13:39:40.098] [INFO] [HelperManager.swift:129 getConnection()] âœ… [HelperManager] XPC connection established (PID: 0)
[2025-11-22 13:39:40.098] [INFO] [HelperManager.swift:228 getHelperVersion()] ğŸ“¤ [HelperManager] Calling proxy.getVersion()
[2025-11-22 13:39:40.098] [INFO] [HelperManager.swift:243 getHelperVersion()] ğŸ“¤ [HelperManager] proxy.getVersion() call dispatched, waiting for callback
[2025-11-22 13:39:40.099] [INFO] [HelperManager.swift:121 getConnection()] âš ï¸ [HelperManager] XPC connection interrupted - will reconnect
[2025-11-22 13:39:40.099] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:39:40.099] [INFO] [HelperManager.swift:578 getRemoteProxy(errorHandler:)] âŒ [HelperManager] XPC proxy error: Couldnâ€™t communicate with a helper application.
[2025-11-22 13:39:40.099] [INFO] [HelperManager.swift:584 getRemoteProxy(errorHandler:)] âš ï¸ [HelperManager] XPC connection interrupted - this may indicate:
[2025-11-22 13:39:40.099] [INFO] [HelperManager.swift:585 getRemoteProxy(errorHandler:)]    1. Helper signature validation failed (app updated but not restarted)
[2025-11-22 13:39:40.099] [INFO] [HelperManager.swift:587 getRemoteProxy(errorHandler:)]    2. Helper process crashed
[2025-11-22 13:39:40.099] [INFO] [HelperManager.swift:588 getRemoteProxy(errorHandler:)]    3. Helper was killed by the system
[2025-11-22 13:39:40.099] [INFO] [HelperManager.swift:589 getRemoteProxy(errorHandler:)] ğŸ’¡ If you just updated KeyPath, try restarting the app
[2025-11-22 13:39:40.100] [INFO] [HelperManager.swift:116 getConnection()] âŒ [HelperManager] XPC connection invalidated
[2025-11-22 13:39:40.100] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:39:40.136] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.068s)
[2025-11-22 13:39:40.136] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:39:43.173] [INFO] [HelperManager.swift:248 getHelperVersion()] âš ï¸ [HelperManager] getVersion timed out - clearing connection cache
[2025-11-22 13:39:43.174] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:39:43.709] [INFO] [VHIDDeviceManager.swift:168 evaluateDaemonProcess()] âš ï¸ [VHIDManager] VHIDDevice process check timed out after 3s - fallback launchctl says running=false
[2025-11-22 13:39:43.777] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:39:43.777] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:39:43.777] [INFO] [VHIDDeviceManager.swift:343 getInstalledVersion()] ğŸ” [VHIDManager] Installed daemon version: 5.0.0
[2025-11-22 13:39:43.777] [INFO] [VHIDDeviceManager.swift:374 hasVersionMismatch()] âœ… [VHIDManager] Version compatible: v5.0.0
[2025-11-22 13:39:43.777] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:39:43.844] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:39:43.845] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:39:43.845] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:39:43.845] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:39:43.845] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:39:43.846] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:39:43.846] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:39:43.846] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:39:43.846] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:39:43.846] [INFO] [LaunchDaemonInstaller.swift:669 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Kanata service state: Uninstalled
[2025-11-22 13:39:43.846] [INFO] [LaunchDaemonInstaller.swift:696 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Service not installed (state: Uninstalled)
[2025-11-22 13:39:43.846] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:39:43.913] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:39:43.981] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhiddaemon loaded: false
[2025-11-22 13:39:44.049] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhidmanager loaded: false
[2025-11-22 13:39:44.050] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:39:44.118] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:39:44.118] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhidmanager
[2025-11-22 13:39:44.186] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhidmanager not found in system domain
[2025-11-22 13:39:44.187] [INFO] [SystemValidator.swift:400 checkComponents()] ğŸ” [SystemValidator] Components: kanata=false, driver=true, daemon=false, vhid=false, vhidVersionMismatch=false
[2025-11-22 13:39:44.187] [INFO] [SystemValidator.swift:220 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 3 (Components) completed in 4.119s
[2025-11-22 13:39:44.187] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 20% (1/5 steps)
[2025-11-22 13:39:44.187] [INFO] [SystemValidator.swift:418 checkConflicts()] ğŸ” [SystemValidator] Checking for conflicts
[2025-11-22 13:39:44.187] [INFO] [ProcessLifecycleManager.swift:117 detectConflicts()] ğŸ” [ProcessLifecycleManager] Detecting conflicts...
[2025-11-22 13:39:44.187] [INFO] [ProcessLifecycleManager.swift:121 detectConflicts()] ğŸ§ª [TestEnvironment] Skipping process conflict detection - returning clean state
[2025-11-22 13:39:44.187] [INFO] [SystemValidator.swift:443 checkConflicts()] ğŸ” [SystemValidator] Total conflicts: 0 (0 kanata, 0 karabiner)
[2025-11-22 13:39:44.187] [INFO] [SystemValidator.swift:484 checkHealth()] ğŸ” [SystemValidator] Checking system health
[2025-11-22 13:39:44.187] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:39:44.187] [INFO] [SystemValidator.swift:229 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 4 (Conflicts) completed in 4.119s
[2025-11-22 13:39:44.187] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 40% (2/5 steps)
[2025-11-22 13:39:44.255] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:39:44.255] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:39:44.323] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:39:47.389] [INFO] [VHIDDeviceManager.swift:168 evaluateDaemonProcess()] âš ï¸ [VHIDManager] VHIDDevice process check timed out after 3s - fallback launchctl says running=false
[2025-11-22 13:39:47.458] [INFO] [VHIDDeviceManager.swift:88 detectRunning()] â³ [VHIDManager] Timeout while checking daemon; retrying to avoid false negatives
[2025-11-22 13:39:51.032] [INFO] [VHIDDeviceManager.swift:168 evaluateDaemonProcess()] âš ï¸ [VHIDManager] VHIDDevice process check timed out after 3s - fallback launchctl says running=false
[2025-11-22 13:39:51.098] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:39:51.098] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:39:51.098] [INFO] [SystemValidator.swift:494 checkHealth()] ğŸ” [SystemValidator] Health: kanata=false, daemon=false (launchctl), vhid=false
[2025-11-22 13:39:51.098] [INFO] [SystemValidator.swift:238 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 5 (Health) completed in 11.031s
[2025-11-22 13:39:51.098] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 60% (3/5 steps)
[2025-11-22 13:39:51.098] [INFO] [SystemValidator.swift:359 checkPermissions()] âš ï¸ [SystemValidator] Oracle snapshot is 11.0s old (ignored in tests)
[2025-11-22 13:39:51.098] [INFO] [SystemValidator.swift:362 checkPermissions()] ğŸ” [SystemValidator] Oracle snapshot: ready=false, age=11.031s
[2025-11-22 13:39:51.098] [INFO] [SystemValidator.swift:328 checkHelper()] ğŸ” [SystemValidator] Helper state: registeredButUnresponsive Helper registered but XPC communication failed
[2025-11-22 13:39:51.098] [INFO] [SystemValidator.swift:211 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 2 (Permissions) completed in 11.031s
[2025-11-22 13:39:51.098] [INFO] [SystemValidator.swift:202 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 1 (Helper) completed in 11.031s
[2025-11-22 13:39:51.098] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 80% (4/5 steps)
[2025-11-22 13:39:51.098] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 100% (5/5 steps)
[2025-11-22 13:39:51.098] [INFO] [SystemValidator.swift:283 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 COMPLETE: Total duration 11.031s
[2025-11-22 13:39:51.098] [INFO] [SystemValidator.swift:297 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Validation #1 complete in 11.031s
[2025-11-22 13:39:51.099] [INFO] [SystemValidator.swift:299 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Result: ready=false, blocking=9, total=9
[2025-11-22 13:39:51.099] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:39:51.099] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:39:51.099] [INFO] [SystemRequirements.swift:135 validateSystemCompatibility()] ğŸ” [SystemRequirements] Validating system compatibility
[2025-11-22 13:39:51.099] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:39:51.099] [INFO] [SystemRequirements.swift:147 validateSystemCompatibility()] âœ… [SystemRequirements] Modern macOS detected: 26.0.1
[2025-11-22 13:39:51.099] [INFO] [SystemRequirements.swift:190 validateSystemCompatibility()] ğŸ” [SystemRequirements] Compatibility check complete: âœ… Compatible
[2025-11-22 13:39:51.099] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:39:51.099] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:39:51.099] [INFO] [InstallerEngine.swift:78 inspectSystem()] âœ… [InstallerEngine] inspectSystem() complete - ready=false, blocking=9
Test Case '-[KeyPathTests.InstallerEngineTests testInspectSystemReturnsSystemContext]' passed (11.032 seconds).
Test Case '-[KeyPathTests.InstallerEngineTests testInstallerEngineCanBeInstantiated]' started.
[2025-11-22 13:39:51.100] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:39:51.100] [INFO] [SystemValidator.swift:63 init(launchDaemonInstaller:vhidDeviceManager:processLifecycleManager:kanataManager:)] ğŸ” [SystemValidator] Initialized (stateless, no cache)
[2025-11-22 13:39:51.100] [INFO] [InstallerEngine.swift:35 init(processLifecycleManager:kanataManager:)] ğŸ”§ [InstallerEngine] Initialized
[2025-11-22 13:39:51.100] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:39:51.100] [INFO] [SystemValidator.swift:63 init(launchDaemonInstaller:vhidDeviceManager:processLifecycleManager:kanataManager:)] ğŸ” [SystemValidator] Initialized (stateless, no cache)
[2025-11-22 13:39:51.100] [INFO] [InstallerEngine.swift:35 init(processLifecycleManager:kanataManager:)] ğŸ”§ [InstallerEngine] Initialized
Test Case '-[KeyPathTests.InstallerEngineTests testInstallerEngineCanBeInstantiated]' passed (0.001 seconds).
Test Case '-[KeyPathTests.InstallerEngineTests testMakePlanCanBeBlocked]' started.
[2025-11-22 13:39:51.100] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:39:51.100] [INFO] [SystemValidator.swift:63 init(launchDaemonInstaller:vhidDeviceManager:processLifecycleManager:kanataManager:)] ğŸ” [SystemValidator] Initialized (stateless, no cache)
[2025-11-22 13:39:51.100] [INFO] [InstallerEngine.swift:35 init(processLifecycleManager:kanataManager:)] ğŸ”§ [InstallerEngine] Initialized
[2025-11-22 13:39:51.100] [INFO] [InstallerEngine.swift:53 inspectSystem()] ğŸ” [InstallerEngine] Starting inspectSystem()
[2025-11-22 13:39:51.101] [INFO] [SystemValidator.swift:143 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Starting validation #1
[2025-11-22 13:39:51.101] [INFO] [SystemValidator.swift:174 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 START: 1763847591.101
[2025-11-22 13:39:51.101] [INFO] [SystemValidator.swift:312 checkHelper()] ğŸ” [SystemValidator] Checking privileged helper
[2025-11-22 13:39:51.101] [INFO] [SystemValidator.swift:344 checkPermissions()] ğŸ” [SystemValidator] Checking permissions via Oracle
[2025-11-22 13:39:51.101] [INFO] [SystemValidator.swift:418 checkConflicts()] ğŸ” [SystemValidator] Checking for conflicts
[2025-11-22 13:39:51.101] [INFO] [ProcessLifecycleManager.swift:117 detectConflicts()] ğŸ” [ProcessLifecycleManager] Detecting conflicts...
[2025-11-22 13:39:51.101] [INFO] [ProcessLifecycleManager.swift:121 detectConflicts()] ğŸ§ª [TestEnvironment] Skipping process conflict detection - returning clean state
[2025-11-22 13:39:51.101] [INFO] [SystemValidator.swift:443 checkConflicts()] ğŸ” [SystemValidator] Total conflicts: 0 (0 kanata, 0 karabiner)
[2025-11-22 13:39:51.101] [INFO] [SystemValidator.swift:484 checkHealth()] ğŸ” [SystemValidator] Checking system health
[2025-11-22 13:39:51.101] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:39:51.101] [INFO] [SystemValidator.swift:229 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 4 (Conflicts) completed in 0.000s
[2025-11-22 13:39:51.101] [INFO] [PermissionOracle.swift:173 currentSnapshot()] ğŸ”® [Oracle] Test mode snapshot generated (non-blocking)
[2025-11-22 13:39:51.101] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 20% (1/5 steps)
[2025-11-22 13:39:51.105] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:39:51.110] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:39:51.128] [INFO] [HelperManager.swift:830 verifyEmbeddedHelperSignature()] ğŸ”’ [HelperManager] Embedded helper signature looks valid
[2025-11-22 13:39:51.128] [INFO] [HelperManager.swift:105 getConnection()] ğŸ”— [HelperManager] Creating XPC connection to com.keypath.helper
[2025-11-22 13:39:51.128] [INFO] [HelperManager.swift:129 getConnection()] âœ… [HelperManager] XPC connection established (PID: 0)
[2025-11-22 13:39:51.128] [INFO] [HelperManager.swift:228 getHelperVersion()] ğŸ“¤ [HelperManager] Calling proxy.getVersion()
[2025-11-22 13:39:51.128] [INFO] [HelperManager.swift:243 getHelperVersion()] ğŸ“¤ [HelperManager] proxy.getVersion() call dispatched, waiting for callback
[2025-11-22 13:39:51.129] [INFO] [HelperManager.swift:121 getConnection()] âš ï¸ [HelperManager] XPC connection interrupted - will reconnect
[2025-11-22 13:39:51.129] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:39:51.129] [INFO] [HelperManager.swift:578 getRemoteProxy(errorHandler:)] âŒ [HelperManager] XPC proxy error: Couldnâ€™t communicate with a helper application.
[2025-11-22 13:39:51.129] [INFO] [HelperManager.swift:584 getRemoteProxy(errorHandler:)] âš ï¸ [HelperManager] XPC connection interrupted - this may indicate:
[2025-11-22 13:39:51.129] [INFO] [HelperManager.swift:585 getRemoteProxy(errorHandler:)]    1. Helper signature validation failed (app updated but not restarted)
[2025-11-22 13:39:51.129] [INFO] [HelperManager.swift:587 getRemoteProxy(errorHandler:)]    2. Helper process crashed
[2025-11-22 13:39:51.129] [INFO] [HelperManager.swift:588 getRemoteProxy(errorHandler:)]    3. Helper was killed by the system
[2025-11-22 13:39:51.129] [INFO] [HelperManager.swift:589 getRemoteProxy(errorHandler:)] ğŸ’¡ If you just updated KeyPath, try restarting the app
[2025-11-22 13:39:51.129] [INFO] [HelperManager.swift:116 getConnection()] âŒ [HelperManager] XPC connection invalidated
[2025-11-22 13:39:51.129] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:39:51.168] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:39:51.168] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:39:51.236] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:39:51.304] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.068s)
[2025-11-22 13:39:51.305] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:39:51.878] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.067s)
[2025-11-22 13:39:51.878] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:39:51.878] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:39:51.878] [INFO] [SystemValidator.swift:494 checkHealth()] ğŸ” [SystemValidator] Health: kanata=false, daemon=false (launchctl), vhid=false
[2025-11-22 13:39:51.878] [INFO] [SystemValidator.swift:372 checkComponents()] ğŸ” [SystemValidator] Checking components
[2025-11-22 13:39:51.878] [INFO] [SystemValidator.swift:238 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 5 (Health) completed in 0.777s
[2025-11-22 13:39:51.878] [INFO] [KanataBinaryDetector.swift:66 detectCurrentStatus()] ğŸ” [KanataBinaryDetector] Starting unified kanata binary detection
[2025-11-22 13:39:51.878] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 40% (2/5 steps)
[2025-11-22 13:39:51.878] [INFO] [KanataBinaryDetector.swift:81 detectCurrentStatus()] âŒ [KanataBinaryDetector] No kanata binary found
[2025-11-22 13:39:51.878] [INFO] [VHIDDeviceManager.swift:50 detectInstallation()] ğŸ” [VHIDManager] Manager app exists at /Applications/.Karabiner-VirtualHIDDevice-Manager.app/Contents/MacOS/Karabiner-VirtualHIDDevice-Manager: true
[2025-11-22 13:39:51.946] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.068s)
[2025-11-22 13:39:51.946] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:39:52.520] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.068s)
[2025-11-22 13:39:52.520] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:39:52.520] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:39:52.520] [INFO] [VHIDDeviceManager.swift:343 getInstalledVersion()] ğŸ” [VHIDManager] Installed daemon version: 5.0.0
[2025-11-22 13:39:52.520] [INFO] [VHIDDeviceManager.swift:374 hasVersionMismatch()] âœ… [VHIDManager] Version compatible: v5.0.0
[2025-11-22 13:39:52.520] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:39:52.588] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:39:52.589] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:39:52.589] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:39:52.589] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:39:52.589] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:39:52.590] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:39:52.590] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:39:52.590] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:39:52.590] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:39:52.590] [INFO] [LaunchDaemonInstaller.swift:669 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Kanata service state: Uninstalled
[2025-11-22 13:39:52.590] [INFO] [LaunchDaemonInstaller.swift:696 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Service not installed (state: Uninstalled)
[2025-11-22 13:39:52.590] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:39:52.656] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:39:52.724] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhiddaemon loaded: false
[2025-11-22 13:39:52.801] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhidmanager loaded: false
[2025-11-22 13:39:52.801] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:39:52.872] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:39:52.873] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhidmanager
[2025-11-22 13:39:52.940] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhidmanager not found in system domain
[2025-11-22 13:39:52.940] [INFO] [SystemValidator.swift:400 checkComponents()] ğŸ” [SystemValidator] Components: kanata=false, driver=true, daemon=false, vhid=false, vhidVersionMismatch=false
[2025-11-22 13:39:52.940] [INFO] [SystemValidator.swift:220 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 3 (Components) completed in 1.840s
[2025-11-22 13:39:52.940] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 60% (3/5 steps)
[2025-11-22 13:39:52.940] [INFO] [SystemValidator.swift:362 checkPermissions()] ğŸ” [SystemValidator] Oracle snapshot: ready=false, age=1.840s
[2025-11-22 13:39:52.940] [INFO] [SystemValidator.swift:211 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 2 (Permissions) completed in 1.840s
[2025-11-22 13:39:52.940] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 80% (4/5 steps)
[2025-11-22 13:39:54.196] [INFO] [HelperManager.swift:248 getHelperVersion()] âš ï¸ [HelperManager] getVersion timed out - clearing connection cache
[2025-11-22 13:39:54.196] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:39:54.196] [INFO] [SystemValidator.swift:328 checkHelper()] ğŸ” [SystemValidator] Helper state: registeredButUnresponsive Helper registered but XPC communication failed
[2025-11-22 13:39:54.196] [INFO] [SystemValidator.swift:202 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 1 (Helper) completed in 3.095s
[2025-11-22 13:39:54.196] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 100% (5/5 steps)
[2025-11-22 13:39:54.196] [INFO] [SystemValidator.swift:283 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 COMPLETE: Total duration 3.095s
[2025-11-22 13:39:54.196] [INFO] [SystemValidator.swift:297 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Validation #1 complete in 3.095s
[2025-11-22 13:39:54.196] [INFO] [SystemValidator.swift:299 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Result: ready=false, blocking=9, total=9
[2025-11-22 13:39:54.196] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:39:54.196] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:39:54.196] [INFO] [SystemRequirements.swift:135 validateSystemCompatibility()] ğŸ” [SystemRequirements] Validating system compatibility
[2025-11-22 13:39:54.196] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:39:54.196] [INFO] [SystemRequirements.swift:147 validateSystemCompatibility()] âœ… [SystemRequirements] Modern macOS detected: 26.0.1
[2025-11-22 13:39:54.196] [INFO] [SystemRequirements.swift:190 validateSystemCompatibility()] ğŸ” [SystemRequirements] Compatibility check complete: âœ… Compatible
[2025-11-22 13:39:54.196] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:39:54.196] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:39:54.196] [INFO] [InstallerEngine.swift:78 inspectSystem()] âœ… [InstallerEngine] inspectSystem() complete - ready=false, blocking=9
[2025-11-22 13:39:54.196] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:39:54.196] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:39:54.196] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:39:54.196] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
Test Case '-[KeyPathTests.InstallerEngineTests testMakePlanCanBeBlocked]' passed (3.096 seconds).
Test Case '-[KeyPathTests.InstallerEngineTests testMakePlanForInspectOnlyHasNoRecipes]' started.
[2025-11-22 13:39:54.197] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:39:54.197] [INFO] [SystemValidator.swift:63 init(launchDaemonInstaller:vhidDeviceManager:processLifecycleManager:kanataManager:)] ğŸ” [SystemValidator] Initialized (stateless, no cache)
[2025-11-22 13:39:54.197] [INFO] [InstallerEngine.swift:35 init(processLifecycleManager:kanataManager:)] ğŸ”§ [InstallerEngine] Initialized
[2025-11-22 13:39:54.197] [INFO] [InstallerEngine.swift:53 inspectSystem()] ğŸ” [InstallerEngine] Starting inspectSystem()
[2025-11-22 13:39:54.197] [INFO] [SystemValidator.swift:143 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Starting validation #1
[2025-11-22 13:39:54.197] [INFO] [SystemValidator.swift:174 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 START: 1763847594.197
[2025-11-22 13:39:54.197] [INFO] [SystemValidator.swift:312 checkHelper()] ğŸ” [SystemValidator] Checking privileged helper
[2025-11-22 13:39:54.197] [INFO] [SystemValidator.swift:344 checkPermissions()] ğŸ” [SystemValidator] Checking permissions via Oracle
[2025-11-22 13:39:54.197] [INFO] [SystemValidator.swift:372 checkComponents()] ğŸ” [SystemValidator] Checking components
[2025-11-22 13:39:54.197] [INFO] [KanataBinaryDetector.swift:66 detectCurrentStatus()] ğŸ” [KanataBinaryDetector] Starting unified kanata binary detection
[2025-11-22 13:39:54.197] [INFO] [PermissionOracle.swift:173 currentSnapshot()] ğŸ”® [Oracle] Test mode snapshot generated (non-blocking)
[2025-11-22 13:39:54.197] [INFO] [KanataBinaryDetector.swift:81 detectCurrentStatus()] âŒ [KanataBinaryDetector] No kanata binary found
[2025-11-22 13:39:54.197] [INFO] [VHIDDeviceManager.swift:50 detectInstallation()] ğŸ” [VHIDManager] Manager app exists at /Applications/.Karabiner-VirtualHIDDevice-Manager.app/Contents/MacOS/Karabiner-VirtualHIDDevice-Manager: true
[2025-11-22 13:39:54.204] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:39:54.210] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:39:54.226] [INFO] [HelperManager.swift:830 verifyEmbeddedHelperSignature()] ğŸ”’ [HelperManager] Embedded helper signature looks valid
[2025-11-22 13:39:54.226] [INFO] [HelperManager.swift:105 getConnection()] ğŸ”— [HelperManager] Creating XPC connection to com.keypath.helper
[2025-11-22 13:39:54.226] [INFO] [HelperManager.swift:129 getConnection()] âœ… [HelperManager] XPC connection established (PID: 0)
[2025-11-22 13:39:54.226] [INFO] [HelperManager.swift:228 getHelperVersion()] ğŸ“¤ [HelperManager] Calling proxy.getVersion()
[2025-11-22 13:39:54.226] [INFO] [HelperManager.swift:243 getHelperVersion()] ğŸ“¤ [HelperManager] proxy.getVersion() call dispatched, waiting for callback
[2025-11-22 13:39:54.226] [INFO] [HelperManager.swift:121 getConnection()] âš ï¸ [HelperManager] XPC connection interrupted - will reconnect
[2025-11-22 13:39:54.226] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:39:54.226] [INFO] [HelperManager.swift:578 getRemoteProxy(errorHandler:)] âŒ [HelperManager] XPC proxy error: Couldnâ€™t communicate with a helper application.
[2025-11-22 13:39:54.226] [INFO] [HelperManager.swift:584 getRemoteProxy(errorHandler:)] âš ï¸ [HelperManager] XPC connection interrupted - this may indicate:
[2025-11-22 13:39:54.226] [INFO] [HelperManager.swift:585 getRemoteProxy(errorHandler:)]    1. Helper signature validation failed (app updated but not restarted)
[2025-11-22 13:39:54.226] [INFO] [HelperManager.swift:587 getRemoteProxy(errorHandler:)]    2. Helper process crashed
[2025-11-22 13:39:54.226] [INFO] [HelperManager.swift:588 getRemoteProxy(errorHandler:)]    3. Helper was killed by the system
[2025-11-22 13:39:54.226] [INFO] [HelperManager.swift:589 getRemoteProxy(errorHandler:)] ğŸ’¡ If you just updated KeyPath, try restarting the app
[2025-11-22 13:39:54.226] [INFO] [HelperManager.swift:116 getConnection()] âŒ [HelperManager] XPC connection invalidated
[2025-11-22 13:39:54.226] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:39:54.266] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.068s)
[2025-11-22 13:39:54.266] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:39:54.838] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.067s)
[2025-11-22 13:39:54.838] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:39:54.838] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:39:54.838] [INFO] [VHIDDeviceManager.swift:343 getInstalledVersion()] ğŸ” [VHIDManager] Installed daemon version: 5.0.0
[2025-11-22 13:39:54.838] [INFO] [VHIDDeviceManager.swift:374 hasVersionMismatch()] âœ… [VHIDManager] Version compatible: v5.0.0
[2025-11-22 13:39:54.838] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:39:54.907] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:39:54.908] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:39:54.908] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:39:54.908] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:39:54.908] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:39:54.908] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:39:54.908] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:39:54.908] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:39:54.908] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:39:54.908] [INFO] [LaunchDaemonInstaller.swift:669 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Kanata service state: Uninstalled
[2025-11-22 13:39:54.908] [INFO] [LaunchDaemonInstaller.swift:696 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Service not installed (state: Uninstalled)
[2025-11-22 13:39:54.908] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:39:54.976] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:39:55.044] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhiddaemon loaded: false
[2025-11-22 13:39:55.113] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhidmanager loaded: false
[2025-11-22 13:39:55.113] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:39:55.181] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:39:55.181] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhidmanager
[2025-11-22 13:39:55.248] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhidmanager not found in system domain
[2025-11-22 13:39:55.248] [INFO] [SystemValidator.swift:400 checkComponents()] ğŸ” [SystemValidator] Components: kanata=false, driver=true, daemon=false, vhid=false, vhidVersionMismatch=false
[2025-11-22 13:39:55.248] [INFO] [SystemValidator.swift:220 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 3 (Components) completed in 1.051s
[2025-11-22 13:39:55.248] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 20% (1/5 steps)
[2025-11-22 13:39:55.248] [INFO] [SystemValidator.swift:418 checkConflicts()] ğŸ” [SystemValidator] Checking for conflicts
[2025-11-22 13:39:55.248] [INFO] [ProcessLifecycleManager.swift:117 detectConflicts()] ğŸ” [ProcessLifecycleManager] Detecting conflicts...
[2025-11-22 13:39:55.248] [INFO] [ProcessLifecycleManager.swift:121 detectConflicts()] ğŸ§ª [TestEnvironment] Skipping process conflict detection - returning clean state
[2025-11-22 13:39:55.248] [INFO] [SystemValidator.swift:443 checkConflicts()] ğŸ” [SystemValidator] Total conflicts: 0 (0 kanata, 0 karabiner)
[2025-11-22 13:39:55.248] [INFO] [SystemValidator.swift:484 checkHealth()] ğŸ” [SystemValidator] Checking system health
[2025-11-22 13:39:55.248] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:39:55.248] [INFO] [SystemValidator.swift:229 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 4 (Conflicts) completed in 1.051s
[2025-11-22 13:39:55.248] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 40% (2/5 steps)
[2025-11-22 13:39:55.316] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:39:55.316] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:39:55.385] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:39:55.454] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.069s)
[2025-11-22 13:39:55.454] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:39:56.026] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.068s)
[2025-11-22 13:39:56.026] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:39:56.026] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:39:56.026] [INFO] [SystemValidator.swift:494 checkHealth()] ğŸ” [SystemValidator] Health: kanata=false, daemon=false (launchctl), vhid=false
[2025-11-22 13:39:56.026] [INFO] [SystemValidator.swift:362 checkPermissions()] ğŸ” [SystemValidator] Oracle snapshot: ready=false, age=1.829s
[2025-11-22 13:39:56.026] [INFO] [SystemValidator.swift:238 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 5 (Health) completed in 1.829s
[2025-11-22 13:39:56.026] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 60% (3/5 steps)
[2025-11-22 13:39:56.026] [INFO] [SystemValidator.swift:211 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 2 (Permissions) completed in 1.829s
[2025-11-22 13:39:56.026] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 80% (4/5 steps)
[2025-11-22 13:39:57.242] [INFO] [HelperManager.swift:248 getHelperVersion()] âš ï¸ [HelperManager] getVersion timed out - clearing connection cache
[2025-11-22 13:39:57.242] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:39:57.242] [INFO] [SystemValidator.swift:328 checkHelper()] ğŸ” [SystemValidator] Helper state: registeredButUnresponsive Helper registered but XPC communication failed
[2025-11-22 13:39:57.242] [INFO] [SystemValidator.swift:202 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 1 (Helper) completed in 3.045s
[2025-11-22 13:39:57.242] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 100% (5/5 steps)
[2025-11-22 13:39:57.242] [INFO] [SystemValidator.swift:283 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 COMPLETE: Total duration 3.045s
[2025-11-22 13:39:57.242] [INFO] [SystemValidator.swift:297 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Validation #1 complete in 3.045s
[2025-11-22 13:39:57.242] [INFO] [SystemValidator.swift:299 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Result: ready=false, blocking=9, total=9
[2025-11-22 13:39:57.242] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:39:57.242] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:39:57.243] [INFO] [SystemRequirements.swift:135 validateSystemCompatibility()] ğŸ” [SystemRequirements] Validating system compatibility
[2025-11-22 13:39:57.243] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:39:57.243] [INFO] [SystemRequirements.swift:147 validateSystemCompatibility()] âœ… [SystemRequirements] Modern macOS detected: 26.0.1
[2025-11-22 13:39:57.243] [INFO] [SystemRequirements.swift:190 validateSystemCompatibility()] ğŸ” [SystemRequirements] Compatibility check complete: âœ… Compatible
[2025-11-22 13:39:57.243] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:39:57.243] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:39:57.243] [INFO] [InstallerEngine.swift:78 inspectSystem()] âœ… [InstallerEngine] inspectSystem() complete - ready=false, blocking=9
[2025-11-22 13:39:57.243] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: inspectOnly, context:)
[2025-11-22 13:39:57.243] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 0 actions for intent: inspectOnly
[2025-11-22 13:39:57.243] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 0 recipes
[2025-11-22 13:39:57.243] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 0
Test Case '-[KeyPathTests.InstallerEngineTests testMakePlanForInspectOnlyHasNoRecipes]' passed (3.046 seconds).
Test Case '-[KeyPathTests.InstallerEngineTests testMakePlanForInstallGeneratesRecipes]' started.
[2025-11-22 13:39:57.244] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:39:57.244] [INFO] [SystemValidator.swift:63 init(launchDaemonInstaller:vhidDeviceManager:processLifecycleManager:kanataManager:)] ğŸ” [SystemValidator] Initialized (stateless, no cache)
[2025-11-22 13:39:57.244] [INFO] [InstallerEngine.swift:35 init(processLifecycleManager:kanataManager:)] ğŸ”§ [InstallerEngine] Initialized
[2025-11-22 13:39:57.244] [INFO] [InstallerEngine.swift:53 inspectSystem()] ğŸ” [InstallerEngine] Starting inspectSystem()
[2025-11-22 13:39:57.244] [INFO] [SystemValidator.swift:143 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Starting validation #1
[2025-11-22 13:39:57.244] [INFO] [SystemValidator.swift:174 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 START: 1763847597.244
[2025-11-22 13:39:57.244] [INFO] [SystemValidator.swift:312 checkHelper()] ğŸ” [SystemValidator] Checking privileged helper
[2025-11-22 13:39:57.244] [INFO] [SystemValidator.swift:344 checkPermissions()] ğŸ” [SystemValidator] Checking permissions via Oracle
[2025-11-22 13:39:57.244] [INFO] [SystemValidator.swift:372 checkComponents()] ğŸ” [SystemValidator] Checking components
[2025-11-22 13:39:57.244] [INFO] [KanataBinaryDetector.swift:66 detectCurrentStatus()] ğŸ” [KanataBinaryDetector] Starting unified kanata binary detection
[2025-11-22 13:39:57.244] [INFO] [PermissionOracle.swift:173 currentSnapshot()] ğŸ”® [Oracle] Test mode snapshot generated (non-blocking)
[2025-11-22 13:39:57.245] [INFO] [KanataBinaryDetector.swift:81 detectCurrentStatus()] âŒ [KanataBinaryDetector] No kanata binary found
[2025-11-22 13:39:57.245] [INFO] [VHIDDeviceManager.swift:50 detectInstallation()] ğŸ” [VHIDManager] Manager app exists at /Applications/.Karabiner-VirtualHIDDevice-Manager.app/Contents/MacOS/Karabiner-VirtualHIDDevice-Manager: true
[2025-11-22 13:39:57.254] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:39:57.262] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:39:57.281] [INFO] [HelperManager.swift:830 verifyEmbeddedHelperSignature()] ğŸ”’ [HelperManager] Embedded helper signature looks valid
[2025-11-22 13:39:57.281] [INFO] [HelperManager.swift:105 getConnection()] ğŸ”— [HelperManager] Creating XPC connection to com.keypath.helper
[2025-11-22 13:39:57.281] [INFO] [HelperManager.swift:129 getConnection()] âœ… [HelperManager] XPC connection established (PID: 0)
[2025-11-22 13:39:57.281] [INFO] [HelperManager.swift:228 getHelperVersion()] ğŸ“¤ [HelperManager] Calling proxy.getVersion()
[2025-11-22 13:39:57.281] [INFO] [HelperManager.swift:243 getHelperVersion()] ğŸ“¤ [HelperManager] proxy.getVersion() call dispatched, waiting for callback
[2025-11-22 13:39:57.281] [INFO] [HelperManager.swift:121 getConnection()] âš ï¸ [HelperManager] XPC connection interrupted - will reconnect
[2025-11-22 13:39:57.281] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:39:57.281] [INFO] [HelperManager.swift:578 getRemoteProxy(errorHandler:)] âŒ [HelperManager] XPC proxy error: Couldnâ€™t communicate with a helper application.
[2025-11-22 13:39:57.281] [INFO] [HelperManager.swift:584 getRemoteProxy(errorHandler:)] âš ï¸ [HelperManager] XPC connection interrupted - this may indicate:
[2025-11-22 13:39:57.281] [INFO] [HelperManager.swift:585 getRemoteProxy(errorHandler:)]    1. Helper signature validation failed (app updated but not restarted)
[2025-11-22 13:39:57.281] [INFO] [HelperManager.swift:587 getRemoteProxy(errorHandler:)]    2. Helper process crashed
[2025-11-22 13:39:57.281] [INFO] [HelperManager.swift:588 getRemoteProxy(errorHandler:)]    3. Helper was killed by the system
[2025-11-22 13:39:57.281] [INFO] [HelperManager.swift:589 getRemoteProxy(errorHandler:)] ğŸ’¡ If you just updated KeyPath, try restarting the app
[2025-11-22 13:39:57.281] [INFO] [HelperManager.swift:116 getConnection()] âŒ [HelperManager] XPC connection invalidated
[2025-11-22 13:39:57.281] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:40:00.315] [INFO] [VHIDDeviceManager.swift:168 evaluateDaemonProcess()] âš ï¸ [VHIDManager] VHIDDevice process check timed out after 3s - fallback launchctl says running=false
[2025-11-22 13:40:00.338] [INFO] [HelperManager.swift:248 getHelperVersion()] âš ï¸ [HelperManager] getVersion timed out - clearing connection cache
[2025-11-22 13:40:00.339] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:40:00.383] [INFO] [VHIDDeviceManager.swift:88 detectRunning()] â³ [VHIDManager] Timeout while checking daemon; retrying to avoid false negatives
[2025-11-22 13:40:00.959] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.070s)
[2025-11-22 13:40:00.959] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:40:00.959] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:40:00.959] [INFO] [VHIDDeviceManager.swift:343 getInstalledVersion()] ğŸ” [VHIDManager] Installed daemon version: 5.0.0
[2025-11-22 13:40:00.959] [INFO] [VHIDDeviceManager.swift:374 hasVersionMismatch()] âœ… [VHIDManager] Version compatible: v5.0.0
[2025-11-22 13:40:00.959] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:40:01.026] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:40:01.027] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:40:01.027] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:40:01.027] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:40:01.027] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:40:01.028] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:40:01.028] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:40:01.028] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:40:01.028] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:40:01.028] [INFO] [LaunchDaemonInstaller.swift:669 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Kanata service state: Uninstalled
[2025-11-22 13:40:01.028] [INFO] [LaunchDaemonInstaller.swift:696 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Service not installed (state: Uninstalled)
[2025-11-22 13:40:01.028] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:40:01.096] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:40:01.165] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhiddaemon loaded: false
[2025-11-22 13:40:01.231] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhidmanager loaded: false
[2025-11-22 13:40:01.231] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:40:01.299] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:40:01.300] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhidmanager
[2025-11-22 13:40:01.368] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhidmanager not found in system domain
[2025-11-22 13:40:01.368] [INFO] [SystemValidator.swift:400 checkComponents()] ğŸ” [SystemValidator] Components: kanata=false, driver=true, daemon=false, vhid=false, vhidVersionMismatch=false
[2025-11-22 13:40:01.368] [INFO] [SystemValidator.swift:220 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 3 (Components) completed in 4.124s
[2025-11-22 13:40:01.368] [INFO] [SystemValidator.swift:418 checkConflicts()] ğŸ” [SystemValidator] Checking for conflicts
[2025-11-22 13:40:01.368] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 20% (1/5 steps)
[2025-11-22 13:40:01.368] [INFO] [ProcessLifecycleManager.swift:117 detectConflicts()] ğŸ” [ProcessLifecycleManager] Detecting conflicts...
[2025-11-22 13:40:01.368] [INFO] [ProcessLifecycleManager.swift:121 detectConflicts()] ğŸ§ª [TestEnvironment] Skipping process conflict detection - returning clean state
[2025-11-22 13:40:01.368] [INFO] [SystemValidator.swift:443 checkConflicts()] ğŸ” [SystemValidator] Total conflicts: 0 (0 kanata, 0 karabiner)
[2025-11-22 13:40:01.368] [INFO] [SystemValidator.swift:229 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 4 (Conflicts) completed in 4.124s
[2025-11-22 13:40:01.368] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 40% (2/5 steps)
[2025-11-22 13:40:01.368] [INFO] [SystemValidator.swift:484 checkHealth()] ğŸ” [SystemValidator] Checking system health
[2025-11-22 13:40:01.368] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:40:01.437] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:40:01.437] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:40:01.504] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:40:01.572] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.067s)
[2025-11-22 13:40:01.572] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:40:05.149] [INFO] [VHIDDeviceManager.swift:168 evaluateDaemonProcess()] âš ï¸ [VHIDManager] VHIDDevice process check timed out after 3s - fallback launchctl says running=false
[2025-11-22 13:40:05.218] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:40:05.219] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:40:05.219] [INFO] [SystemValidator.swift:494 checkHealth()] ğŸ” [SystemValidator] Health: kanata=false, daemon=false (launchctl), vhid=false
[2025-11-22 13:40:05.219] [INFO] [SystemValidator.swift:238 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 5 (Health) completed in 7.975s
[2025-11-22 13:40:05.219] [INFO] [SystemValidator.swift:359 checkPermissions()] âš ï¸ [SystemValidator] Oracle snapshot is 8.0s old (ignored in tests)
[2025-11-22 13:40:05.219] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 60% (3/5 steps)
[2025-11-22 13:40:05.219] [INFO] [SystemValidator.swift:362 checkPermissions()] ğŸ” [SystemValidator] Oracle snapshot: ready=false, age=7.975s
[2025-11-22 13:40:05.219] [INFO] [SystemValidator.swift:328 checkHelper()] ğŸ” [SystemValidator] Helper state: registeredButUnresponsive Helper registered but XPC communication failed
[2025-11-22 13:40:05.219] [INFO] [SystemValidator.swift:211 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 2 (Permissions) completed in 7.975s
[2025-11-22 13:40:05.219] [INFO] [SystemValidator.swift:202 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 1 (Helper) completed in 7.975s
[2025-11-22 13:40:05.219] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 80% (4/5 steps)
[2025-11-22 13:40:05.219] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 100% (5/5 steps)
[2025-11-22 13:40:05.219] [INFO] [SystemValidator.swift:283 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 COMPLETE: Total duration 7.975s
[2025-11-22 13:40:05.219] [INFO] [SystemValidator.swift:297 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Validation #1 complete in 7.975s
[2025-11-22 13:40:05.219] [INFO] [SystemValidator.swift:299 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Result: ready=false, blocking=9, total=9
[2025-11-22 13:40:05.219] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:40:05.219] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:40:05.219] [INFO] [SystemRequirements.swift:135 validateSystemCompatibility()] ğŸ” [SystemRequirements] Validating system compatibility
[2025-11-22 13:40:05.219] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:40:05.219] [INFO] [SystemRequirements.swift:147 validateSystemCompatibility()] âœ… [SystemRequirements] Modern macOS detected: 26.0.1
[2025-11-22 13:40:05.219] [INFO] [SystemRequirements.swift:190 validateSystemCompatibility()] ğŸ” [SystemRequirements] Compatibility check complete: âœ… Compatible
[2025-11-22 13:40:05.219] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:40:05.219] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:40:05.219] [INFO] [InstallerEngine.swift:78 inspectSystem()] âœ… [InstallerEngine] inspectSystem() complete - ready=false, blocking=9
[2025-11-22 13:40:05.220] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:40:05.220] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:40:05.220] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:40:05.220] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
Test Case '-[KeyPathTests.InstallerEngineTests testMakePlanForInstallGeneratesRecipes]' passed (7.977 seconds).
Test Case '-[KeyPathTests.InstallerEngineTests testMakePlanForRepairGeneratesRecipes]' started.
[2025-11-22 13:40:05.221] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:40:05.221] [INFO] [SystemValidator.swift:63 init(launchDaemonInstaller:vhidDeviceManager:processLifecycleManager:kanataManager:)] ğŸ” [SystemValidator] Initialized (stateless, no cache)
[2025-11-22 13:40:05.222] [INFO] [InstallerEngine.swift:35 init(processLifecycleManager:kanataManager:)] ğŸ”§ [InstallerEngine] Initialized
[2025-11-22 13:40:05.222] [INFO] [InstallerEngine.swift:53 inspectSystem()] ğŸ” [InstallerEngine] Starting inspectSystem()
[2025-11-22 13:40:05.222] [INFO] [SystemValidator.swift:143 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Starting validation #1
[2025-11-22 13:40:05.222] [INFO] [SystemValidator.swift:174 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 START: 1763847605.222
[2025-11-22 13:40:05.222] [INFO] [SystemValidator.swift:312 checkHelper()] ğŸ” [SystemValidator] Checking privileged helper
[2025-11-22 13:40:05.222] [INFO] [SystemValidator.swift:344 checkPermissions()] ğŸ” [SystemValidator] Checking permissions via Oracle
[2025-11-22 13:40:05.222] [INFO] [SystemValidator.swift:372 checkComponents()] ğŸ” [SystemValidator] Checking components
[2025-11-22 13:40:05.222] [INFO] [KanataBinaryDetector.swift:66 detectCurrentStatus()] ğŸ” [KanataBinaryDetector] Starting unified kanata binary detection
[2025-11-22 13:40:05.222] [INFO] [PermissionOracle.swift:173 currentSnapshot()] ğŸ”® [Oracle] Test mode snapshot generated (non-blocking)
[2025-11-22 13:40:05.222] [INFO] [KanataBinaryDetector.swift:81 detectCurrentStatus()] âŒ [KanataBinaryDetector] No kanata binary found
[2025-11-22 13:40:05.222] [INFO] [VHIDDeviceManager.swift:50 detectInstallation()] ğŸ” [VHIDManager] Manager app exists at /Applications/.Karabiner-VirtualHIDDevice-Manager.app/Contents/MacOS/Karabiner-VirtualHIDDevice-Manager: true
[2025-11-22 13:40:05.236] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:40:05.245] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:40:05.265] [INFO] [HelperManager.swift:830 verifyEmbeddedHelperSignature()] ğŸ”’ [HelperManager] Embedded helper signature looks valid
[2025-11-22 13:40:05.265] [INFO] [HelperManager.swift:105 getConnection()] ğŸ”— [HelperManager] Creating XPC connection to com.keypath.helper
[2025-11-22 13:40:05.265] [INFO] [HelperManager.swift:129 getConnection()] âœ… [HelperManager] XPC connection established (PID: 0)
[2025-11-22 13:40:05.265] [INFO] [HelperManager.swift:228 getHelperVersion()] ğŸ“¤ [HelperManager] Calling proxy.getVersion()
[2025-11-22 13:40:05.265] [INFO] [HelperManager.swift:243 getHelperVersion()] ğŸ“¤ [HelperManager] proxy.getVersion() call dispatched, waiting for callback
[2025-11-22 13:40:05.266] [INFO] [HelperManager.swift:121 getConnection()] âš ï¸ [HelperManager] XPC connection interrupted - will reconnect
[2025-11-22 13:40:05.266] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:40:05.266] [INFO] [HelperManager.swift:578 getRemoteProxy(errorHandler:)] âŒ [HelperManager] XPC proxy error: Couldnâ€™t communicate with a helper application.
[2025-11-22 13:40:05.266] [INFO] [HelperManager.swift:584 getRemoteProxy(errorHandler:)] âš ï¸ [HelperManager] XPC connection interrupted - this may indicate:
[2025-11-22 13:40:05.266] [INFO] [HelperManager.swift:585 getRemoteProxy(errorHandler:)]    1. Helper signature validation failed (app updated but not restarted)
[2025-11-22 13:40:05.266] [INFO] [HelperManager.swift:587 getRemoteProxy(errorHandler:)]    2. Helper process crashed
[2025-11-22 13:40:05.266] [INFO] [HelperManager.swift:588 getRemoteProxy(errorHandler:)]    3. Helper was killed by the system
[2025-11-22 13:40:05.266] [INFO] [HelperManager.swift:589 getRemoteProxy(errorHandler:)] ğŸ’¡ If you just updated KeyPath, try restarting the app
[2025-11-22 13:40:05.266] [INFO] [HelperManager.swift:116 getConnection()] âŒ [HelperManager] XPC connection invalidated
[2025-11-22 13:40:05.266] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:40:05.290] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.067s)
[2025-11-22 13:40:05.290] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:40:08.340] [INFO] [HelperManager.swift:248 getHelperVersion()] âš ï¸ [HelperManager] getVersion timed out - clearing connection cache
[2025-11-22 13:40:08.340] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:40:08.860] [INFO] [VHIDDeviceManager.swift:168 evaluateDaemonProcess()] âš ï¸ [VHIDManager] VHIDDevice process check timed out after 3s - fallback launchctl says running=false
[2025-11-22 13:40:08.927] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:40:08.927] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:40:08.927] [INFO] [VHIDDeviceManager.swift:343 getInstalledVersion()] ğŸ” [VHIDManager] Installed daemon version: 5.0.0
[2025-11-22 13:40:08.927] [INFO] [VHIDDeviceManager.swift:374 hasVersionMismatch()] âœ… [VHIDManager] Version compatible: v5.0.0
[2025-11-22 13:40:08.928] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:40:08.997] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:40:09.000] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:40:09.000] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:40:09.000] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:40:09.000] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:40:09.001] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:40:09.001] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:40:09.001] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:40:09.001] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:40:09.001] [INFO] [LaunchDaemonInstaller.swift:669 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Kanata service state: Uninstalled
[2025-11-22 13:40:09.001] [INFO] [LaunchDaemonInstaller.swift:696 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Service not installed (state: Uninstalled)
[2025-11-22 13:40:09.001] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:40:09.072] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:40:09.140] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhiddaemon loaded: false
[2025-11-22 13:40:09.208] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhidmanager loaded: false
[2025-11-22 13:40:09.208] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:40:09.275] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:40:09.275] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhidmanager
[2025-11-22 13:40:09.343] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhidmanager not found in system domain
[2025-11-22 13:40:09.343] [INFO] [SystemValidator.swift:400 checkComponents()] ğŸ” [SystemValidator] Components: kanata=false, driver=true, daemon=false, vhid=false, vhidVersionMismatch=false
[2025-11-22 13:40:09.343] [INFO] [SystemValidator.swift:418 checkConflicts()] ğŸ” [SystemValidator] Checking for conflicts
[2025-11-22 13:40:09.343] [INFO] [ProcessLifecycleManager.swift:117 detectConflicts()] ğŸ” [ProcessLifecycleManager] Detecting conflicts...
[2025-11-22 13:40:09.343] [INFO] [SystemValidator.swift:220 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 3 (Components) completed in 4.121s
[2025-11-22 13:40:09.343] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 20% (1/5 steps)
[2025-11-22 13:40:09.343] [INFO] [ProcessLifecycleManager.swift:121 detectConflicts()] ğŸ§ª [TestEnvironment] Skipping process conflict detection - returning clean state
[2025-11-22 13:40:09.343] [INFO] [SystemValidator.swift:443 checkConflicts()] ğŸ” [SystemValidator] Total conflicts: 0 (0 kanata, 0 karabiner)
[2025-11-22 13:40:09.343] [INFO] [SystemValidator.swift:484 checkHealth()] ğŸ” [SystemValidator] Checking system health
[2025-11-22 13:40:09.343] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:40:09.343] [INFO] [SystemValidator.swift:229 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 4 (Conflicts) completed in 4.121s
[2025-11-22 13:40:09.343] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 40% (2/5 steps)
[2025-11-22 13:40:09.410] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:40:09.410] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:40:09.477] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:40:12.546] [INFO] [VHIDDeviceManager.swift:168 evaluateDaemonProcess()] âš ï¸ [VHIDManager] VHIDDevice process check timed out after 3s - fallback launchctl says running=false
[2025-11-22 13:40:12.614] [INFO] [VHIDDeviceManager.swift:88 detectRunning()] â³ [VHIDManager] Timeout while checking daemon; retrying to avoid false negatives
[2025-11-22 13:40:16.187] [INFO] [VHIDDeviceManager.swift:168 evaluateDaemonProcess()] âš ï¸ [VHIDManager] VHIDDevice process check timed out after 3s - fallback launchctl says running=false
[2025-11-22 13:40:16.256] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:40:16.256] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:40:16.257] [INFO] [SystemValidator.swift:494 checkHealth()] ğŸ” [SystemValidator] Health: kanata=false, daemon=false (launchctl), vhid=false
[2025-11-22 13:40:16.257] [INFO] [SystemValidator.swift:359 checkPermissions()] âš ï¸ [SystemValidator] Oracle snapshot is 11.0s old (ignored in tests)
[2025-11-22 13:40:16.257] [INFO] [SystemValidator.swift:362 checkPermissions()] ğŸ” [SystemValidator] Oracle snapshot: ready=false, age=11.035s
[2025-11-22 13:40:16.257] [INFO] [SystemValidator.swift:328 checkHelper()] ğŸ” [SystemValidator] Helper state: registeredButUnresponsive Helper registered but XPC communication failed
[2025-11-22 13:40:16.257] [INFO] [SystemValidator.swift:238 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 5 (Health) completed in 11.035s
[2025-11-22 13:40:16.257] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 60% (3/5 steps)
[2025-11-22 13:40:16.257] [INFO] [SystemValidator.swift:211 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 2 (Permissions) completed in 11.035s
[2025-11-22 13:40:16.257] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 80% (4/5 steps)
[2025-11-22 13:40:16.257] [INFO] [SystemValidator.swift:202 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 1 (Helper) completed in 11.036s
[2025-11-22 13:40:16.257] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 100% (5/5 steps)
[2025-11-22 13:40:16.258] [INFO] [SystemValidator.swift:283 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 COMPLETE: Total duration 11.036s
[2025-11-22 13:40:16.258] [INFO] [SystemValidator.swift:297 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Validation #1 complete in 11.036s
[2025-11-22 13:40:16.258] [INFO] [SystemValidator.swift:299 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Result: ready=false, blocking=9, total=9
[2025-11-22 13:40:16.258] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:40:16.258] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:40:16.258] [INFO] [SystemRequirements.swift:135 validateSystemCompatibility()] ğŸ” [SystemRequirements] Validating system compatibility
[2025-11-22 13:40:16.258] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:40:16.258] [INFO] [SystemRequirements.swift:147 validateSystemCompatibility()] âœ… [SystemRequirements] Modern macOS detected: 26.0.1
[2025-11-22 13:40:16.258] [INFO] [SystemRequirements.swift:190 validateSystemCompatibility()] ğŸ” [SystemRequirements] Compatibility check complete: âœ… Compatible
[2025-11-22 13:40:16.258] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:40:16.258] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:40:16.258] [INFO] [InstallerEngine.swift:78 inspectSystem()] âœ… [InstallerEngine] inspectSystem() complete - ready=false, blocking=9
[2025-11-22 13:40:16.258] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: repair, context:)
[2025-11-22 13:40:16.258] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: repair
[2025-11-22 13:40:16.258] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:40:16.258] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
Test Case '-[KeyPathTests.InstallerEngineTests testMakePlanForRepairGeneratesRecipes]' passed (11.039 seconds).
Test Case '-[KeyPathTests.InstallerEngineTests testMakePlanHandlesAllIntents]' started.
[2025-11-22 13:40:16.260] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:40:16.261] [INFO] [SystemValidator.swift:63 init(launchDaemonInstaller:vhidDeviceManager:processLifecycleManager:kanataManager:)] ğŸ” [SystemValidator] Initialized (stateless, no cache)
[2025-11-22 13:40:16.261] [INFO] [InstallerEngine.swift:35 init(processLifecycleManager:kanataManager:)] ğŸ”§ [InstallerEngine] Initialized
[2025-11-22 13:40:16.261] [INFO] [InstallerEngine.swift:53 inspectSystem()] ğŸ” [InstallerEngine] Starting inspectSystem()
[2025-11-22 13:40:16.261] [INFO] [SystemValidator.swift:143 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Starting validation #1
[2025-11-22 13:40:16.261] [INFO] [SystemValidator.swift:174 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 START: 1763847616.261
[2025-11-22 13:40:16.261] [INFO] [SystemValidator.swift:312 checkHelper()] ğŸ” [SystemValidator] Checking privileged helper
[2025-11-22 13:40:16.261] [INFO] [SystemValidator.swift:344 checkPermissions()] ğŸ” [SystemValidator] Checking permissions via Oracle
[2025-11-22 13:40:16.261] [INFO] [SystemValidator.swift:372 checkComponents()] ğŸ” [SystemValidator] Checking components
[2025-11-22 13:40:16.261] [INFO] [KanataBinaryDetector.swift:66 detectCurrentStatus()] ğŸ” [KanataBinaryDetector] Starting unified kanata binary detection
[2025-11-22 13:40:16.261] [INFO] [PermissionOracle.swift:173 currentSnapshot()] ğŸ”® [Oracle] Test mode snapshot generated (non-blocking)
[2025-11-22 13:40:16.261] [INFO] [KanataBinaryDetector.swift:81 detectCurrentStatus()] âŒ [KanataBinaryDetector] No kanata binary found
[2025-11-22 13:40:16.261] [INFO] [VHIDDeviceManager.swift:50 detectInstallation()] ğŸ” [VHIDManager] Manager app exists at /Applications/.Karabiner-VirtualHIDDevice-Manager.app/Contents/MacOS/Karabiner-VirtualHIDDevice-Manager: true
[2025-11-22 13:40:16.280] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:40:16.286] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:40:16.306] [INFO] [HelperManager.swift:830 verifyEmbeddedHelperSignature()] ğŸ”’ [HelperManager] Embedded helper signature looks valid
[2025-11-22 13:40:16.306] [INFO] [HelperManager.swift:105 getConnection()] ğŸ”— [HelperManager] Creating XPC connection to com.keypath.helper
[2025-11-22 13:40:16.306] [INFO] [HelperManager.swift:129 getConnection()] âœ… [HelperManager] XPC connection established (PID: 0)
[2025-11-22 13:40:16.306] [INFO] [HelperManager.swift:228 getHelperVersion()] ğŸ“¤ [HelperManager] Calling proxy.getVersion()
[2025-11-22 13:40:16.306] [INFO] [HelperManager.swift:243 getHelperVersion()] ğŸ“¤ [HelperManager] proxy.getVersion() call dispatched, waiting for callback
[2025-11-22 13:40:16.307] [INFO] [HelperManager.swift:121 getConnection()] âš ï¸ [HelperManager] XPC connection interrupted - will reconnect
[2025-11-22 13:40:16.307] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:40:16.307] [INFO] [HelperManager.swift:578 getRemoteProxy(errorHandler:)] âŒ [HelperManager] XPC proxy error: Couldnâ€™t communicate with a helper application.
[2025-11-22 13:40:16.307] [INFO] [HelperManager.swift:584 getRemoteProxy(errorHandler:)] âš ï¸ [HelperManager] XPC connection interrupted - this may indicate:
[2025-11-22 13:40:16.307] [INFO] [HelperManager.swift:585 getRemoteProxy(errorHandler:)]    1. Helper signature validation failed (app updated but not restarted)
[2025-11-22 13:40:16.307] [INFO] [HelperManager.swift:587 getRemoteProxy(errorHandler:)]    2. Helper process crashed
[2025-11-22 13:40:16.307] [INFO] [HelperManager.swift:588 getRemoteProxy(errorHandler:)]    3. Helper was killed by the system
[2025-11-22 13:40:16.307] [INFO] [HelperManager.swift:589 getRemoteProxy(errorHandler:)] ğŸ’¡ If you just updated KeyPath, try restarting the app
[2025-11-22 13:40:16.307] [INFO] [HelperManager.swift:116 getConnection()] âŒ [HelperManager] XPC connection invalidated
[2025-11-22 13:40:16.307] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:40:19.333] [INFO] [VHIDDeviceManager.swift:168 evaluateDaemonProcess()] âš ï¸ [VHIDManager] VHIDDevice process check timed out after 3s - fallback launchctl says running=false
[2025-11-22 13:40:19.344] [INFO] [HelperManager.swift:248 getHelperVersion()] âš ï¸ [HelperManager] getVersion timed out - clearing connection cache
[2025-11-22 13:40:19.344] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:40:19.401] [INFO] [VHIDDeviceManager.swift:88 detectRunning()] â³ [VHIDManager] Timeout while checking daemon; retrying to avoid false negatives
[2025-11-22 13:40:19.973] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.067s)
[2025-11-22 13:40:19.973] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:40:19.973] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:40:19.974] [INFO] [VHIDDeviceManager.swift:343 getInstalledVersion()] ğŸ” [VHIDManager] Installed daemon version: 5.0.0
[2025-11-22 13:40:19.974] [INFO] [VHIDDeviceManager.swift:374 hasVersionMismatch()] âœ… [VHIDManager] Version compatible: v5.0.0
[2025-11-22 13:40:19.974] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:40:20.041] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:40:20.042] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:40:20.042] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:40:20.043] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:40:20.043] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:40:20.043] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:40:20.043] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:40:20.043] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:40:20.043] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:40:20.043] [INFO] [LaunchDaemonInstaller.swift:669 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Kanata service state: Uninstalled
[2025-11-22 13:40:20.043] [INFO] [LaunchDaemonInstaller.swift:696 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Service not installed (state: Uninstalled)
[2025-11-22 13:40:20.043] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:40:20.112] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:40:20.180] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhiddaemon loaded: false
[2025-11-22 13:40:20.248] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhidmanager loaded: false
[2025-11-22 13:40:20.249] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:40:20.317] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:40:20.318] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhidmanager
[2025-11-22 13:40:20.387] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhidmanager not found in system domain
[2025-11-22 13:40:20.387] [INFO] [SystemValidator.swift:400 checkComponents()] ğŸ” [SystemValidator] Components: kanata=false, driver=true, daemon=false, vhid=false, vhidVersionMismatch=false
[2025-11-22 13:40:20.388] [INFO] [SystemValidator.swift:418 checkConflicts()] ğŸ” [SystemValidator] Checking for conflicts
[2025-11-22 13:40:20.388] [INFO] [SystemValidator.swift:220 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 3 (Components) completed in 4.127s
[2025-11-22 13:40:20.388] [INFO] [ProcessLifecycleManager.swift:117 detectConflicts()] ğŸ” [ProcessLifecycleManager] Detecting conflicts...
[2025-11-22 13:40:20.388] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 20% (1/5 steps)
[2025-11-22 13:40:20.388] [INFO] [ProcessLifecycleManager.swift:121 detectConflicts()] ğŸ§ª [TestEnvironment] Skipping process conflict detection - returning clean state
[2025-11-22 13:40:20.388] [INFO] [SystemValidator.swift:443 checkConflicts()] ğŸ” [SystemValidator] Total conflicts: 0 (0 kanata, 0 karabiner)
[2025-11-22 13:40:20.388] [INFO] [SystemValidator.swift:484 checkHealth()] ğŸ” [SystemValidator] Checking system health
[2025-11-22 13:40:20.388] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:40:20.388] [INFO] [SystemValidator.swift:229 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 4 (Conflicts) completed in 4.127s
[2025-11-22 13:40:20.388] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 40% (2/5 steps)
[2025-11-22 13:40:20.456] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:40:20.456] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:40:20.525] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:40:20.594] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.069s)
[2025-11-22 13:40:20.594] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:40:21.168] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.068s)
[2025-11-22 13:40:21.168] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:40:21.168] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:40:21.168] [INFO] [SystemValidator.swift:494 checkHealth()] ğŸ” [SystemValidator] Health: kanata=false, daemon=false (launchctl), vhid=false
[2025-11-22 13:40:21.168] [INFO] [SystemValidator.swift:238 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 5 (Health) completed in 4.907s
[2025-11-22 13:40:21.168] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 60% (3/5 steps)
[2025-11-22 13:40:21.168] [INFO] [SystemValidator.swift:362 checkPermissions()] ğŸ” [SystemValidator] Oracle snapshot: ready=false, age=4.907s
[2025-11-22 13:40:21.168] [INFO] [SystemValidator.swift:328 checkHelper()] ğŸ” [SystemValidator] Helper state: registeredButUnresponsive Helper registered but XPC communication failed
[2025-11-22 13:40:21.168] [INFO] [SystemValidator.swift:211 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 2 (Permissions) completed in 4.907s
[2025-11-22 13:40:21.168] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 80% (4/5 steps)
[2025-11-22 13:40:21.168] [INFO] [SystemValidator.swift:202 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 1 (Helper) completed in 4.907s
[2025-11-22 13:40:21.168] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 100% (5/5 steps)
[2025-11-22 13:40:21.168] [INFO] [SystemValidator.swift:283 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 COMPLETE: Total duration 4.908s
[2025-11-22 13:40:21.168] [INFO] [SystemValidator.swift:297 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Validation #1 complete in 4.908s
[2025-11-22 13:40:21.168] [INFO] [SystemValidator.swift:299 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Result: ready=false, blocking=9, total=9
[2025-11-22 13:40:21.168] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:40:21.169] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:40:21.169] [INFO] [SystemRequirements.swift:135 validateSystemCompatibility()] ğŸ” [SystemRequirements] Validating system compatibility
[2025-11-22 13:40:21.169] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:40:21.169] [INFO] [SystemRequirements.swift:147 validateSystemCompatibility()] âœ… [SystemRequirements] Modern macOS detected: 26.0.1
[2025-11-22 13:40:21.169] [INFO] [SystemRequirements.swift:190 validateSystemCompatibility()] ğŸ” [SystemRequirements] Compatibility check complete: âœ… Compatible
[2025-11-22 13:40:21.169] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:40:21.169] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:40:21.169] [INFO] [InstallerEngine.swift:78 inspectSystem()] âœ… [InstallerEngine] inspectSystem() complete - ready=false, blocking=9
[2025-11-22 13:40:21.169] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:40:21.169] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:40:21.169] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:40:21.169] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:40:21.169] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: repair, context:)
[2025-11-22 13:40:21.169] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: repair
[2025-11-22 13:40:21.169] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:40:21.169] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:40:21.169] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: uninstall, context:)
[2025-11-22 13:40:21.169] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 0 actions for intent: uninstall
[2025-11-22 13:40:21.169] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 0 recipes
[2025-11-22 13:40:21.169] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 0
[2025-11-22 13:40:21.169] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: inspectOnly, context:)
[2025-11-22 13:40:21.169] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 0 actions for intent: inspectOnly
[2025-11-22 13:40:21.169] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 0 recipes
[2025-11-22 13:40:21.169] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 0
Test Case '-[KeyPathTests.InstallerEngineTests testMakePlanHandlesAllIntents]' passed (4.909 seconds).
Test Case '-[KeyPathTests.InstallerEngineTests testMakePlanRecipesHaveValidStructure]' started.
[2025-11-22 13:40:21.169] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:40:21.169] [INFO] [SystemValidator.swift:63 init(launchDaemonInstaller:vhidDeviceManager:processLifecycleManager:kanataManager:)] ğŸ” [SystemValidator] Initialized (stateless, no cache)
[2025-11-22 13:40:21.169] [INFO] [InstallerEngine.swift:35 init(processLifecycleManager:kanataManager:)] ğŸ”§ [InstallerEngine] Initialized
[2025-11-22 13:40:21.169] [INFO] [InstallerEngine.swift:53 inspectSystem()] ğŸ” [InstallerEngine] Starting inspectSystem()
[2025-11-22 13:40:21.169] [INFO] [SystemValidator.swift:143 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Starting validation #1
[2025-11-22 13:40:21.169] [INFO] [SystemValidator.swift:174 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 START: 1763847621.169
[2025-11-22 13:40:21.170] [INFO] [SystemValidator.swift:312 checkHelper()] ğŸ” [SystemValidator] Checking privileged helper
[2025-11-22 13:40:21.170] [INFO] [SystemValidator.swift:344 checkPermissions()] ğŸ” [SystemValidator] Checking permissions via Oracle
[2025-11-22 13:40:21.170] [INFO] [SystemValidator.swift:372 checkComponents()] ğŸ” [SystemValidator] Checking components
[2025-11-22 13:40:21.170] [INFO] [KanataBinaryDetector.swift:66 detectCurrentStatus()] ğŸ” [KanataBinaryDetector] Starting unified kanata binary detection
[2025-11-22 13:40:21.170] [INFO] [PermissionOracle.swift:173 currentSnapshot()] ğŸ”® [Oracle] Test mode snapshot generated (non-blocking)
[2025-11-22 13:40:21.170] [INFO] [KanataBinaryDetector.swift:81 detectCurrentStatus()] âŒ [KanataBinaryDetector] No kanata binary found
[2025-11-22 13:40:21.170] [INFO] [VHIDDeviceManager.swift:50 detectInstallation()] ğŸ” [VHIDManager] Manager app exists at /Applications/.Karabiner-VirtualHIDDevice-Manager.app/Contents/MacOS/Karabiner-VirtualHIDDevice-Manager: true
[2025-11-22 13:40:21.175] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:40:21.179] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:40:21.194] [INFO] [HelperManager.swift:830 verifyEmbeddedHelperSignature()] ğŸ”’ [HelperManager] Embedded helper signature looks valid
[2025-11-22 13:40:21.194] [INFO] [HelperManager.swift:105 getConnection()] ğŸ”— [HelperManager] Creating XPC connection to com.keypath.helper
[2025-11-22 13:40:21.195] [INFO] [HelperManager.swift:129 getConnection()] âœ… [HelperManager] XPC connection established (PID: 0)
[2025-11-22 13:40:21.195] [INFO] [HelperManager.swift:228 getHelperVersion()] ğŸ“¤ [HelperManager] Calling proxy.getVersion()
[2025-11-22 13:40:21.195] [INFO] [HelperManager.swift:243 getHelperVersion()] ğŸ“¤ [HelperManager] proxy.getVersion() call dispatched, waiting for callback
[2025-11-22 13:40:21.196] [INFO] [HelperManager.swift:121 getConnection()] âš ï¸ [HelperManager] XPC connection interrupted - will reconnect
[2025-11-22 13:40:21.196] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:40:21.196] [INFO] [HelperManager.swift:578 getRemoteProxy(errorHandler:)] âŒ [HelperManager] XPC proxy error: Couldnâ€™t communicate with a helper application.
[2025-11-22 13:40:21.196] [INFO] [HelperManager.swift:584 getRemoteProxy(errorHandler:)] âš ï¸ [HelperManager] XPC connection interrupted - this may indicate:
[2025-11-22 13:40:21.196] [INFO] [HelperManager.swift:585 getRemoteProxy(errorHandler:)]    1. Helper signature validation failed (app updated but not restarted)
[2025-11-22 13:40:21.196] [INFO] [HelperManager.swift:587 getRemoteProxy(errorHandler:)]    2. Helper process crashed
[2025-11-22 13:40:21.196] [INFO] [HelperManager.swift:588 getRemoteProxy(errorHandler:)]    3. Helper was killed by the system
[2025-11-22 13:40:21.196] [INFO] [HelperManager.swift:589 getRemoteProxy(errorHandler:)] ğŸ’¡ If you just updated KeyPath, try restarting the app
[2025-11-22 13:40:21.196] [INFO] [HelperManager.swift:116 getConnection()] âŒ [HelperManager] XPC connection invalidated
[2025-11-22 13:40:21.196] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:40:24.238] [INFO] [VHIDDeviceManager.swift:168 evaluateDaemonProcess()] âš ï¸ [VHIDManager] VHIDDevice process check timed out after 3s - fallback launchctl says running=false
[2025-11-22 13:40:24.256] [INFO] [HelperManager.swift:248 getHelperVersion()] âš ï¸ [HelperManager] getVersion timed out - clearing connection cache
[2025-11-22 13:40:24.256] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:40:24.306] [INFO] [VHIDDeviceManager.swift:88 detectRunning()] â³ [VHIDManager] Timeout while checking daemon; retrying to avoid false negatives
[2025-11-22 13:40:27.879] [INFO] [VHIDDeviceManager.swift:168 evaluateDaemonProcess()] âš ï¸ [VHIDManager] VHIDDevice process check timed out after 3s - fallback launchctl says running=false
[2025-11-22 13:40:27.947] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:40:27.948] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:40:27.948] [INFO] [VHIDDeviceManager.swift:343 getInstalledVersion()] ğŸ” [VHIDManager] Installed daemon version: 5.0.0
[2025-11-22 13:40:27.948] [INFO] [VHIDDeviceManager.swift:374 hasVersionMismatch()] âœ… [VHIDManager] Version compatible: v5.0.0
[2025-11-22 13:40:27.948] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:40:28.016] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:40:28.017] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:40:28.017] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:40:28.017] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:40:28.017] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:40:28.018] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:40:28.018] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:40:28.018] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:40:28.018] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:40:28.018] [INFO] [LaunchDaemonInstaller.swift:669 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Kanata service state: Uninstalled
[2025-11-22 13:40:28.018] [INFO] [LaunchDaemonInstaller.swift:696 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Service not installed (state: Uninstalled)
[2025-11-22 13:40:28.018] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:40:28.084] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:40:28.153] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhiddaemon loaded: false
[2025-11-22 13:40:28.221] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhidmanager loaded: false
[2025-11-22 13:40:28.221] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:40:28.289] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:40:28.290] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhidmanager
[2025-11-22 13:40:28.357] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhidmanager not found in system domain
[2025-11-22 13:40:28.357] [INFO] [SystemValidator.swift:400 checkComponents()] ğŸ” [SystemValidator] Components: kanata=false, driver=true, daemon=false, vhid=false, vhidVersionMismatch=false
[2025-11-22 13:40:28.357] [INFO] [SystemValidator.swift:220 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 3 (Components) completed in 7.188s
[2025-11-22 13:40:28.357] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 20% (1/5 steps)
[2025-11-22 13:40:28.357] [INFO] [SystemValidator.swift:418 checkConflicts()] ğŸ” [SystemValidator] Checking for conflicts
[2025-11-22 13:40:28.358] [INFO] [ProcessLifecycleManager.swift:117 detectConflicts()] ğŸ” [ProcessLifecycleManager] Detecting conflicts...
[2025-11-22 13:40:28.358] [INFO] [ProcessLifecycleManager.swift:121 detectConflicts()] ğŸ§ª [TestEnvironment] Skipping process conflict detection - returning clean state
[2025-11-22 13:40:28.358] [INFO] [SystemValidator.swift:443 checkConflicts()] ğŸ” [SystemValidator] Total conflicts: 0 (0 kanata, 0 karabiner)
[2025-11-22 13:40:28.358] [INFO] [SystemValidator.swift:484 checkHealth()] ğŸ” [SystemValidator] Checking system health
[2025-11-22 13:40:28.358] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:40:28.358] [INFO] [SystemValidator.swift:229 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 4 (Conflicts) completed in 7.188s
[2025-11-22 13:40:28.358] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 40% (2/5 steps)
[2025-11-22 13:40:28.425] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:40:28.425] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:40:28.492] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:40:31.563] [INFO] [VHIDDeviceManager.swift:168 evaluateDaemonProcess()] âš ï¸ [VHIDManager] VHIDDevice process check timed out after 3s - fallback launchctl says running=false
[2025-11-22 13:40:31.631] [INFO] [VHIDDeviceManager.swift:88 detectRunning()] â³ [VHIDManager] Timeout while checking daemon; retrying to avoid false negatives
[2025-11-22 13:40:32.204] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.067s)
[2025-11-22 13:40:32.204] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:40:32.204] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:40:32.204] [INFO] [SystemValidator.swift:494 checkHealth()] ğŸ” [SystemValidator] Health: kanata=false, daemon=false (launchctl), vhid=false
[2025-11-22 13:40:32.204] [INFO] [SystemValidator.swift:238 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 5 (Health) completed in 11.034s
[2025-11-22 13:40:32.204] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 60% (3/5 steps)
[2025-11-22 13:40:32.204] [INFO] [SystemValidator.swift:359 checkPermissions()] âš ï¸ [SystemValidator] Oracle snapshot is 11.0s old (ignored in tests)
[2025-11-22 13:40:32.204] [INFO] [SystemValidator.swift:362 checkPermissions()] ğŸ” [SystemValidator] Oracle snapshot: ready=false, age=11.034s
[2025-11-22 13:40:32.204] [INFO] [SystemValidator.swift:328 checkHelper()] ğŸ” [SystemValidator] Helper state: registeredButUnresponsive Helper registered but XPC communication failed
[2025-11-22 13:40:32.204] [INFO] [SystemValidator.swift:211 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 2 (Permissions) completed in 11.034s
[2025-11-22 13:40:32.204] [INFO] [SystemValidator.swift:202 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 1 (Helper) completed in 11.034s
[2025-11-22 13:40:32.204] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 80% (4/5 steps)
[2025-11-22 13:40:32.204] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 100% (5/5 steps)
[2025-11-22 13:40:32.204] [INFO] [SystemValidator.swift:283 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 COMPLETE: Total duration 11.035s
[2025-11-22 13:40:32.204] [INFO] [SystemValidator.swift:297 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Validation #1 complete in 11.035s
[2025-11-22 13:40:32.204] [INFO] [SystemValidator.swift:299 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Result: ready=false, blocking=9, total=9
[2025-11-22 13:40:32.204] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:40:32.204] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:40:32.204] [INFO] [SystemRequirements.swift:135 validateSystemCompatibility()] ğŸ” [SystemRequirements] Validating system compatibility
[2025-11-22 13:40:32.204] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:40:32.204] [INFO] [SystemRequirements.swift:147 validateSystemCompatibility()] âœ… [SystemRequirements] Modern macOS detected: 26.0.1
[2025-11-22 13:40:32.204] [INFO] [SystemRequirements.swift:190 validateSystemCompatibility()] ğŸ” [SystemRequirements] Compatibility check complete: âœ… Compatible
[2025-11-22 13:40:32.204] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:40:32.204] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:40:32.204] [INFO] [InstallerEngine.swift:78 inspectSystem()] âœ… [InstallerEngine] inspectSystem() complete - ready=false, blocking=9
[2025-11-22 13:40:32.204] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:40:32.204] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:40:32.204] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:40:32.204] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
Test Case '-[KeyPathTests.InstallerEngineTests testMakePlanRecipesHaveValidStructure]' passed (11.035 seconds).
Test Case '-[KeyPathTests.InstallerEngineTests testMakePlanReturnsInstallPlan]' started.
[2025-11-22 13:40:32.205] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:40:32.205] [INFO] [SystemValidator.swift:63 init(launchDaemonInstaller:vhidDeviceManager:processLifecycleManager:kanataManager:)] ğŸ” [SystemValidator] Initialized (stateless, no cache)
[2025-11-22 13:40:32.205] [INFO] [InstallerEngine.swift:35 init(processLifecycleManager:kanataManager:)] ğŸ”§ [InstallerEngine] Initialized
[2025-11-22 13:40:32.205] [INFO] [InstallerEngine.swift:53 inspectSystem()] ğŸ” [InstallerEngine] Starting inspectSystem()
[2025-11-22 13:40:32.205] [INFO] [SystemValidator.swift:143 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Starting validation #1
[2025-11-22 13:40:32.205] [INFO] [SystemValidator.swift:174 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 START: 1763847632.205
[2025-11-22 13:40:32.205] [INFO] [SystemValidator.swift:312 checkHelper()] ğŸ” [SystemValidator] Checking privileged helper
[2025-11-22 13:40:32.205] [INFO] [SystemValidator.swift:344 checkPermissions()] ğŸ” [SystemValidator] Checking permissions via Oracle
[2025-11-22 13:40:32.205] [INFO] [SystemValidator.swift:372 checkComponents()] ğŸ” [SystemValidator] Checking components
[2025-11-22 13:40:32.205] [INFO] [PermissionOracle.swift:173 currentSnapshot()] ğŸ”® [Oracle] Test mode snapshot generated (non-blocking)
[2025-11-22 13:40:32.205] [INFO] [KanataBinaryDetector.swift:66 detectCurrentStatus()] ğŸ” [KanataBinaryDetector] Starting unified kanata binary detection
[2025-11-22 13:40:32.206] [INFO] [KanataBinaryDetector.swift:81 detectCurrentStatus()] âŒ [KanataBinaryDetector] No kanata binary found
[2025-11-22 13:40:32.206] [INFO] [VHIDDeviceManager.swift:50 detectInstallation()] ğŸ” [VHIDManager] Manager app exists at /Applications/.Karabiner-VirtualHIDDevice-Manager.app/Contents/MacOS/Karabiner-VirtualHIDDevice-Manager: true
[2025-11-22 13:40:32.271] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.066s)
[2025-11-22 13:40:32.271] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:40:32.298] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:40:32.301] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:40:32.316] [INFO] [HelperManager.swift:830 verifyEmbeddedHelperSignature()] ğŸ”’ [HelperManager] Embedded helper signature looks valid
[2025-11-22 13:40:32.316] [INFO] [HelperManager.swift:105 getConnection()] ğŸ”— [HelperManager] Creating XPC connection to com.keypath.helper
[2025-11-22 13:40:32.316] [INFO] [HelperManager.swift:129 getConnection()] âœ… [HelperManager] XPC connection established (PID: 0)
[2025-11-22 13:40:32.316] [INFO] [HelperManager.swift:228 getHelperVersion()] ğŸ“¤ [HelperManager] Calling proxy.getVersion()
[2025-11-22 13:40:32.316] [INFO] [HelperManager.swift:243 getHelperVersion()] ğŸ“¤ [HelperManager] proxy.getVersion() call dispatched, waiting for callback
[2025-11-22 13:40:32.317] [INFO] [HelperManager.swift:121 getConnection()] âš ï¸ [HelperManager] XPC connection interrupted - will reconnect
[2025-11-22 13:40:32.317] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:40:32.317] [INFO] [HelperManager.swift:578 getRemoteProxy(errorHandler:)] âŒ [HelperManager] XPC proxy error: Couldnâ€™t communicate with a helper application.
[2025-11-22 13:40:32.317] [INFO] [HelperManager.swift:116 getConnection()] âŒ [HelperManager] XPC connection invalidated
[2025-11-22 13:40:32.317] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:40:32.845] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.068s)
[2025-11-22 13:40:32.845] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:40:32.845] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:40:32.846] [INFO] [VHIDDeviceManager.swift:343 getInstalledVersion()] ğŸ” [VHIDManager] Installed daemon version: 5.0.0
[2025-11-22 13:40:32.846] [INFO] [VHIDDeviceManager.swift:374 hasVersionMismatch()] âœ… [VHIDManager] Version compatible: v5.0.0
[2025-11-22 13:40:32.846] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:40:32.914] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:40:32.984] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:40:32.984] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:40:32.984] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:40:32.984] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:40:33.025] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:40:33.025] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:40:33.025] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:40:33.025] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:40:33.025] [INFO] [LaunchDaemonInstaller.swift:669 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Kanata service state: Uninstalled
[2025-11-22 13:40:33.025] [INFO] [LaunchDaemonInstaller.swift:696 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Service not installed (state: Uninstalled)
[2025-11-22 13:40:33.025] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:40:33.095] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:40:33.164] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhiddaemon loaded: false
[2025-11-22 13:40:33.232] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhidmanager loaded: false
[2025-11-22 13:40:33.232] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:40:33.301] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:40:33.301] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhidmanager
[2025-11-22 13:40:33.369] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhidmanager not found in system domain
[2025-11-22 13:40:33.369] [INFO] [SystemValidator.swift:400 checkComponents()] ğŸ” [SystemValidator] Components: kanata=false, driver=true, daemon=false, vhid=false, vhidVersionMismatch=false
[2025-11-22 13:40:33.369] [INFO] [SystemValidator.swift:220 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 3 (Components) completed in 1.164s
[2025-11-22 13:40:33.369] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 20% (1/5 steps)
[2025-11-22 13:40:33.370] [INFO] [SystemValidator.swift:418 checkConflicts()] ğŸ” [SystemValidator] Checking for conflicts
[2025-11-22 13:40:33.370] [INFO] [ProcessLifecycleManager.swift:117 detectConflicts()] ğŸ” [ProcessLifecycleManager] Detecting conflicts...
[2025-11-22 13:40:33.370] [INFO] [ProcessLifecycleManager.swift:121 detectConflicts()] ğŸ§ª [TestEnvironment] Skipping process conflict detection - returning clean state
[2025-11-22 13:40:33.370] [INFO] [SystemValidator.swift:443 checkConflicts()] ğŸ” [SystemValidator] Total conflicts: 0 (0 kanata, 0 karabiner)
[2025-11-22 13:40:33.370] [INFO] [SystemValidator.swift:484 checkHealth()] ğŸ” [SystemValidator] Checking system health
[2025-11-22 13:40:33.370] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:40:33.370] [INFO] [SystemValidator.swift:229 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 4 (Conflicts) completed in 1.165s
[2025-11-22 13:40:33.370] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 40% (2/5 steps)
[2025-11-22 13:40:33.438] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:40:33.439] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:40:33.508] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:40:33.575] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.067s)
[2025-11-22 13:40:33.575] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:40:34.147] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.067s)
[2025-11-22 13:40:34.147] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:40:34.147] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:40:34.147] [INFO] [SystemValidator.swift:494 checkHealth()] ğŸ” [SystemValidator] Health: kanata=false, daemon=false (launchctl), vhid=false
[2025-11-22 13:40:34.147] [INFO] [SystemValidator.swift:238 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 5 (Health) completed in 1.942s
[2025-11-22 13:40:34.147] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 60% (3/5 steps)
[2025-11-22 13:40:34.147] [INFO] [SystemValidator.swift:362 checkPermissions()] ğŸ” [SystemValidator] Oracle snapshot: ready=false, age=1.942s
[2025-11-22 13:40:34.147] [INFO] [SystemValidator.swift:211 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 2 (Permissions) completed in 1.942s
[2025-11-22 13:40:34.147] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 80% (4/5 steps)
[2025-11-22 13:40:35.321] [INFO] [HelperManager.swift:248 getHelperVersion()] âš ï¸ [HelperManager] getVersion timed out - clearing connection cache
[2025-11-22 13:40:35.321] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:40:35.321] [INFO] [SystemValidator.swift:328 checkHelper()] ğŸ” [SystemValidator] Helper state: registeredButUnresponsive Helper registered but XPC communication failed
[2025-11-22 13:40:35.321] [INFO] [SystemValidator.swift:202 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 1 (Helper) completed in 3.116s
[2025-11-22 13:40:35.321] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 100% (5/5 steps)
[2025-11-22 13:40:35.322] [INFO] [SystemValidator.swift:283 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 COMPLETE: Total duration 3.116s
[2025-11-22 13:40:35.322] [INFO] [SystemValidator.swift:297 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Validation #1 complete in 3.116s
[2025-11-22 13:40:35.322] [INFO] [SystemValidator.swift:299 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Result: ready=false, blocking=9, total=9
[2025-11-22 13:40:35.322] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:40:35.322] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:40:35.322] [INFO] [SystemRequirements.swift:135 validateSystemCompatibility()] ğŸ” [SystemRequirements] Validating system compatibility
[2025-11-22 13:40:35.322] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:40:35.322] [INFO] [SystemRequirements.swift:147 validateSystemCompatibility()] âœ… [SystemRequirements] Modern macOS detected: 26.0.1
[2025-11-22 13:40:35.322] [INFO] [SystemRequirements.swift:190 validateSystemCompatibility()] ğŸ” [SystemRequirements] Compatibility check complete: âœ… Compatible
[2025-11-22 13:40:35.322] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:40:35.322] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:40:35.322] [INFO] [InstallerEngine.swift:78 inspectSystem()] âœ… [InstallerEngine] inspectSystem() complete - ready=false, blocking=9
[2025-11-22 13:40:35.322] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:40:35.322] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:40:35.322] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:40:35.322] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
Test Case '-[KeyPathTests.InstallerEngineTests testMakePlanReturnsInstallPlan]' passed (3.118 seconds).
Test Case '-[KeyPathTests.InstallerEngineTests testRunChainsAllSteps]' started.
[2025-11-22 13:40:35.323] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:40:35.323] [INFO] [SystemValidator.swift:63 init(launchDaemonInstaller:vhidDeviceManager:processLifecycleManager:kanataManager:)] ğŸ” [SystemValidator] Initialized (stateless, no cache)
[2025-11-22 13:40:35.323] [INFO] [InstallerEngine.swift:35 init(processLifecycleManager:kanataManager:)] ğŸ”§ [InstallerEngine] Initialized
[2025-11-22 13:40:35.323] [INFO] [InstallerEngine.swift:419 run(intent:using:)] ğŸš€ [InstallerEngine] Starting run(intent: install, using:)
[2025-11-22 13:40:35.323] [INFO] [InstallerEngine.swift:53 inspectSystem()] ğŸ” [InstallerEngine] Starting inspectSystem()
[2025-11-22 13:40:35.323] [INFO] [SystemValidator.swift:143 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Starting validation #1
[2025-11-22 13:40:35.323] [INFO] [SystemValidator.swift:174 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 START: 1763847635.323
[2025-11-22 13:40:35.323] [INFO] [SystemValidator.swift:312 checkHelper()] ğŸ” [SystemValidator] Checking privileged helper
[2025-11-22 13:40:35.323] [INFO] [SystemValidator.swift:344 checkPermissions()] ğŸ” [SystemValidator] Checking permissions via Oracle
[2025-11-22 13:40:35.323] [INFO] [SystemValidator.swift:372 checkComponents()] ğŸ” [SystemValidator] Checking components
[2025-11-22 13:40:35.323] [INFO] [PermissionOracle.swift:173 currentSnapshot()] ğŸ”® [Oracle] Test mode snapshot generated (non-blocking)
[2025-11-22 13:40:35.323] [INFO] [KanataBinaryDetector.swift:66 detectCurrentStatus()] ğŸ” [KanataBinaryDetector] Starting unified kanata binary detection
[2025-11-22 13:40:35.324] [INFO] [KanataBinaryDetector.swift:81 detectCurrentStatus()] âŒ [KanataBinaryDetector] No kanata binary found
[2025-11-22 13:40:35.324] [INFO] [VHIDDeviceManager.swift:50 detectInstallation()] ğŸ” [VHIDManager] Manager app exists at /Applications/.Karabiner-VirtualHIDDevice-Manager.app/Contents/MacOS/Karabiner-VirtualHIDDevice-Manager: true
[2025-11-22 13:40:35.328] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:40:35.331] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:40:35.344] [INFO] [HelperManager.swift:830 verifyEmbeddedHelperSignature()] ğŸ”’ [HelperManager] Embedded helper signature looks valid
[2025-11-22 13:40:35.344] [INFO] [HelperManager.swift:105 getConnection()] ğŸ”— [HelperManager] Creating XPC connection to com.keypath.helper
[2025-11-22 13:40:35.344] [INFO] [HelperManager.swift:129 getConnection()] âœ… [HelperManager] XPC connection established (PID: 0)
[2025-11-22 13:40:35.344] [INFO] [HelperManager.swift:228 getHelperVersion()] ğŸ“¤ [HelperManager] Calling proxy.getVersion()
[2025-11-22 13:40:35.344] [INFO] [HelperManager.swift:243 getHelperVersion()] ğŸ“¤ [HelperManager] proxy.getVersion() call dispatched, waiting for callback
[2025-11-22 13:40:35.345] [INFO] [HelperManager.swift:121 getConnection()] âš ï¸ [HelperManager] XPC connection interrupted - will reconnect
[2025-11-22 13:40:35.345] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:40:35.345] [INFO] [HelperManager.swift:578 getRemoteProxy(errorHandler:)] âŒ [HelperManager] XPC proxy error: Couldnâ€™t communicate with a helper application.
[2025-11-22 13:40:35.345] [INFO] [HelperManager.swift:584 getRemoteProxy(errorHandler:)] âš ï¸ [HelperManager] XPC connection interrupted - this may indicate:
[2025-11-22 13:40:35.345] [INFO] [HelperManager.swift:585 getRemoteProxy(errorHandler:)]    1. Helper signature validation failed (app updated but not restarted)
[2025-11-22 13:40:35.345] [INFO] [HelperManager.swift:587 getRemoteProxy(errorHandler:)]    2. Helper process crashed
[2025-11-22 13:40:35.345] [INFO] [HelperManager.swift:588 getRemoteProxy(errorHandler:)]    3. Helper was killed by the system
[2025-11-22 13:40:35.345] [INFO] [HelperManager.swift:589 getRemoteProxy(errorHandler:)] ğŸ’¡ If you just updated KeyPath, try restarting the app
[2025-11-22 13:40:35.345] [INFO] [HelperManager.swift:116 getConnection()] âŒ [HelperManager] XPC connection invalidated
[2025-11-22 13:40:35.345] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:40:38.390] [INFO] [VHIDDeviceManager.swift:168 evaluateDaemonProcess()] âš ï¸ [VHIDManager] VHIDDevice process check timed out after 3s - fallback launchctl says running=false
[2025-11-22 13:40:38.406] [INFO] [HelperManager.swift:248 getHelperVersion()] âš ï¸ [HelperManager] getVersion timed out - clearing connection cache
[2025-11-22 13:40:38.406] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:40:38.459] [INFO] [VHIDDeviceManager.swift:88 detectRunning()] â³ [VHIDManager] Timeout while checking daemon; retrying to avoid false negatives
[2025-11-22 13:40:42.039] [INFO] [VHIDDeviceManager.swift:168 evaluateDaemonProcess()] âš ï¸ [VHIDManager] VHIDDevice process check timed out after 3s - fallback launchctl says running=false
[2025-11-22 13:40:42.109] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:40:42.109] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:40:42.109] [INFO] [VHIDDeviceManager.swift:343 getInstalledVersion()] ğŸ” [VHIDManager] Installed daemon version: 5.0.0
[2025-11-22 13:40:42.109] [INFO] [VHIDDeviceManager.swift:374 hasVersionMismatch()] âœ… [VHIDManager] Version compatible: v5.0.0
[2025-11-22 13:40:42.109] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:40:42.176] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:40:42.177] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:40:42.177] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:40:42.177] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:40:42.177] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:40:42.177] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:40:42.177] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:40:42.177] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:40:42.177] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:40:42.177] [INFO] [LaunchDaemonInstaller.swift:669 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Kanata service state: Uninstalled
[2025-11-22 13:40:42.177] [INFO] [LaunchDaemonInstaller.swift:696 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Service not installed (state: Uninstalled)
[2025-11-22 13:40:42.177] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:40:42.246] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:40:42.314] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhiddaemon loaded: false
[2025-11-22 13:40:42.382] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhidmanager loaded: false
[2025-11-22 13:40:42.382] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:40:42.450] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:40:42.450] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhidmanager
[2025-11-22 13:40:42.517] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhidmanager not found in system domain
[2025-11-22 13:40:42.517] [INFO] [SystemValidator.swift:400 checkComponents()] ğŸ” [SystemValidator] Components: kanata=false, driver=true, daemon=false, vhid=false, vhidVersionMismatch=false
[2025-11-22 13:40:42.517] [INFO] [SystemValidator.swift:418 checkConflicts()] ğŸ” [SystemValidator] Checking for conflicts
[2025-11-22 13:40:42.517] [INFO] [ProcessLifecycleManager.swift:117 detectConflicts()] ğŸ” [ProcessLifecycleManager] Detecting conflicts...
[2025-11-22 13:40:42.517] [INFO] [SystemValidator.swift:220 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 3 (Components) completed in 7.194s
[2025-11-22 13:40:42.517] [INFO] [ProcessLifecycleManager.swift:121 detectConflicts()] ğŸ§ª [TestEnvironment] Skipping process conflict detection - returning clean state
[2025-11-22 13:40:42.517] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 20% (1/5 steps)
[2025-11-22 13:40:42.517] [INFO] [SystemValidator.swift:443 checkConflicts()] ğŸ” [SystemValidator] Total conflicts: 0 (0 kanata, 0 karabiner)
[2025-11-22 13:40:42.517] [INFO] [SystemValidator.swift:484 checkHealth()] ğŸ” [SystemValidator] Checking system health
[2025-11-22 13:40:42.517] [INFO] [SystemValidator.swift:229 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 4 (Conflicts) completed in 7.194s
[2025-11-22 13:40:42.517] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:40:42.517] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 40% (2/5 steps)
[2025-11-22 13:40:42.585] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:40:42.585] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:40:42.653] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:40:45.720] [INFO] [VHIDDeviceManager.swift:168 evaluateDaemonProcess()] âš ï¸ [VHIDManager] VHIDDevice process check timed out after 3s - fallback launchctl says running=false
[2025-11-22 13:40:45.788] [INFO] [VHIDDeviceManager.swift:88 detectRunning()] â³ [VHIDManager] Timeout while checking daemon; retrying to avoid false negatives
[2025-11-22 13:40:49.363] [INFO] [VHIDDeviceManager.swift:168 evaluateDaemonProcess()] âš ï¸ [VHIDManager] VHIDDevice process check timed out after 3s - fallback launchctl says running=false
[2025-11-22 13:40:49.431] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:40:49.431] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:40:49.431] [INFO] [SystemValidator.swift:494 checkHealth()] ğŸ” [SystemValidator] Health: kanata=false, daemon=false (launchctl), vhid=false
[2025-11-22 13:40:49.431] [INFO] [SystemValidator.swift:238 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 5 (Health) completed in 14.108s
[2025-11-22 13:40:49.431] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 60% (3/5 steps)
[2025-11-22 13:40:49.432] [INFO] [SystemValidator.swift:359 checkPermissions()] âš ï¸ [SystemValidator] Oracle snapshot is 14.1s old (ignored in tests)
[2025-11-22 13:40:49.432] [INFO] [SystemValidator.swift:362 checkPermissions()] ğŸ” [SystemValidator] Oracle snapshot: ready=false, age=14.108s
[2025-11-22 13:40:49.432] [INFO] [SystemValidator.swift:328 checkHelper()] ğŸ” [SystemValidator] Helper state: registeredButUnresponsive Helper registered but XPC communication failed
[2025-11-22 13:40:49.432] [INFO] [SystemValidator.swift:211 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 2 (Permissions) completed in 14.108s
[2025-11-22 13:40:49.432] [INFO] [SystemValidator.swift:202 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 1 (Helper) completed in 14.108s
[2025-11-22 13:40:49.432] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 80% (4/5 steps)
[2025-11-22 13:40:49.432] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 100% (5/5 steps)
[2025-11-22 13:40:49.432] [INFO] [SystemValidator.swift:283 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 COMPLETE: Total duration 14.109s
[2025-11-22 13:40:49.432] [INFO] [SystemValidator.swift:297 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Validation #1 complete in 14.109s
[2025-11-22 13:40:49.432] [INFO] [SystemValidator.swift:299 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Result: ready=false, blocking=9, total=9
[2025-11-22 13:40:49.432] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:40:49.432] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:40:49.432] [INFO] [SystemRequirements.swift:135 validateSystemCompatibility()] ğŸ” [SystemRequirements] Validating system compatibility
[2025-11-22 13:40:49.432] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:40:49.432] [INFO] [SystemRequirements.swift:147 validateSystemCompatibility()] âœ… [SystemRequirements] Modern macOS detected: 26.0.1
[2025-11-22 13:40:49.432] [INFO] [SystemRequirements.swift:190 validateSystemCompatibility()] ğŸ” [SystemRequirements] Compatibility check complete: âœ… Compatible
[2025-11-22 13:40:49.432] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:40:49.432] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:40:49.432] [INFO] [InstallerEngine.swift:78 inspectSystem()] âœ… [InstallerEngine] inspectSystem() complete - ready=false, blocking=9
[2025-11-22 13:40:49.432] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:40:49.432] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:40:49.432] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:40:49.432] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:40:49.432] [INFO] [InstallerEngine.swift:194 execute(plan:using:)] âš™ï¸ [InstallerEngine] Starting execute(plan:, using:)
[2025-11-22 13:40:49.432] [INFO] [InstallerEngine.swift:213 execute(plan:using:)] âš™ï¸ [InstallerEngine] Executing recipe: install-bundled-kanata (type: installComponent)
[2025-11-22 13:40:49.432] [INFO] [PrivilegedOperationsCoordinator.swift:359 installBundledKanata()] ğŸ” [PrivCoordinator] Installing bundled Kanata binary
[2025-11-22 13:40:49.432] [INFO] [LaunchDaemonInstaller.swift:2898 installBundledKanataBinaryOnly()] ğŸ”§ [LaunchDaemon] Installing bundled kanata binary to system location
[2025-11-22 13:40:49.433] [INFO] [LaunchDaemonInstaller.swift:2906 installBundledKanataBinaryOnly()] âŒ [LaunchDaemon] CRITICAL: Bundled kanata binary not found at: /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata
[2025-11-22 13:40:49.433] [INFO] [LaunchDaemonInstaller.swift:2908 installBundledKanataBinaryOnly()] âŒ [LaunchDaemon] This indicates a packaging issue - the app bundle is missing the kanata binary
[2025-11-22 13:40:49.433] [INFO] [InstallerEngine.swift:255 execute(plan:using:)] âŒ [InstallerEngine] Recipe install-bundled-kanata failed: Operation failed: Bundled Kanata installation failed
[2025-11-22 13:40:49.433] [INFO] [InstallerEngine.swift:274 execute(plan:using:)] âœ… [InstallerEngine] execute() complete - success: false, recipes executed: 1
[2025-11-22 13:40:49.433] [INFO] [InstallerEngine.swift:432 run(intent:using:)] âœ… [InstallerEngine] run() complete - success: false
Test Case '-[KeyPathTests.InstallerEngineTests testRunChainsAllSteps]' passed (14.111 seconds).
Test Case '-[KeyPathTests.InstallerEngineTests testRunChainsStepsCorrectly]' started.
[2025-11-22 13:40:49.434] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:40:49.434] [INFO] [SystemValidator.swift:63 init(launchDaemonInstaller:vhidDeviceManager:processLifecycleManager:kanataManager:)] ğŸ” [SystemValidator] Initialized (stateless, no cache)
[2025-11-22 13:40:49.435] [INFO] [InstallerEngine.swift:35 init(processLifecycleManager:kanataManager:)] ğŸ”§ [InstallerEngine] Initialized
[2025-11-22 13:40:49.435] [INFO] [InstallerEngine.swift:419 run(intent:using:)] ğŸš€ [InstallerEngine] Starting run(intent: repair, using:)
[2025-11-22 13:40:49.435] [INFO] [InstallerEngine.swift:53 inspectSystem()] ğŸ” [InstallerEngine] Starting inspectSystem()
[2025-11-22 13:40:49.435] [INFO] [SystemValidator.swift:143 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Starting validation #1
[2025-11-22 13:40:49.435] [INFO] [SystemValidator.swift:174 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 START: 1763847649.435
[2025-11-22 13:40:49.435] [INFO] [SystemValidator.swift:312 checkHelper()] ğŸ” [SystemValidator] Checking privileged helper
[2025-11-22 13:40:49.435] [INFO] [SystemValidator.swift:344 checkPermissions()] ğŸ” [SystemValidator] Checking permissions via Oracle
[2025-11-22 13:40:49.435] [INFO] [SystemValidator.swift:372 checkComponents()] ğŸ” [SystemValidator] Checking components
[2025-11-22 13:40:49.435] [INFO] [KanataBinaryDetector.swift:66 detectCurrentStatus()] ğŸ” [KanataBinaryDetector] Starting unified kanata binary detection
[2025-11-22 13:40:49.435] [INFO] [PermissionOracle.swift:173 currentSnapshot()] ğŸ”® [Oracle] Test mode snapshot generated (non-blocking)
[2025-11-22 13:40:49.435] [INFO] [KanataBinaryDetector.swift:81 detectCurrentStatus()] âŒ [KanataBinaryDetector] No kanata binary found
[2025-11-22 13:40:49.435] [INFO] [VHIDDeviceManager.swift:50 detectInstallation()] ğŸ” [VHIDManager] Manager app exists at /Applications/.Karabiner-VirtualHIDDevice-Manager.app/Contents/MacOS/Karabiner-VirtualHIDDevice-Manager: true
[2025-11-22 13:40:49.446] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:40:49.454] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:40:49.477] [INFO] [HelperManager.swift:830 verifyEmbeddedHelperSignature()] ğŸ”’ [HelperManager] Embedded helper signature looks valid
[2025-11-22 13:40:49.477] [INFO] [HelperManager.swift:105 getConnection()] ğŸ”— [HelperManager] Creating XPC connection to com.keypath.helper
[2025-11-22 13:40:49.477] [INFO] [HelperManager.swift:129 getConnection()] âœ… [HelperManager] XPC connection established (PID: 0)
[2025-11-22 13:40:49.477] [INFO] [HelperManager.swift:228 getHelperVersion()] ğŸ“¤ [HelperManager] Calling proxy.getVersion()
[2025-11-22 13:40:49.477] [INFO] [HelperManager.swift:243 getHelperVersion()] ğŸ“¤ [HelperManager] proxy.getVersion() call dispatched, waiting for callback
[2025-11-22 13:40:49.479] [INFO] [HelperManager.swift:121 getConnection()] âš ï¸ [HelperManager] XPC connection interrupted - will reconnect
[2025-11-22 13:40:49.479] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:40:49.479] [INFO] [HelperManager.swift:578 getRemoteProxy(errorHandler:)] âŒ [HelperManager] XPC proxy error: Couldnâ€™t communicate with a helper application.
[2025-11-22 13:40:49.479] [INFO] [HelperManager.swift:584 getRemoteProxy(errorHandler:)] âš ï¸ [HelperManager] XPC connection interrupted - this may indicate:
[2025-11-22 13:40:49.479] [INFO] [HelperManager.swift:585 getRemoteProxy(errorHandler:)]    1. Helper signature validation failed (app updated but not restarted)
[2025-11-22 13:40:49.479] [INFO] [HelperManager.swift:587 getRemoteProxy(errorHandler:)]    2. Helper process crashed
[2025-11-22 13:40:49.479] [INFO] [HelperManager.swift:588 getRemoteProxy(errorHandler:)]    3. Helper was killed by the system
[2025-11-22 13:40:49.479] [INFO] [HelperManager.swift:589 getRemoteProxy(errorHandler:)] ğŸ’¡ If you just updated KeyPath, try restarting the app
[2025-11-22 13:40:49.479] [INFO] [HelperManager.swift:116 getConnection()] âŒ [HelperManager] XPC connection invalidated
[2025-11-22 13:40:49.479] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:40:49.503] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.068s)
[2025-11-22 13:40:49.503] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:40:50.076] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.068s)
[2025-11-22 13:40:50.076] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:40:50.076] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:40:50.076] [INFO] [VHIDDeviceManager.swift:343 getInstalledVersion()] ğŸ” [VHIDManager] Installed daemon version: 5.0.0
[2025-11-22 13:40:50.076] [INFO] [VHIDDeviceManager.swift:374 hasVersionMismatch()] âœ… [VHIDManager] Version compatible: v5.0.0
[2025-11-22 13:40:50.076] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:40:50.144] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:40:50.145] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:40:50.145] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:40:50.145] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:40:50.145] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:40:50.145] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:40:50.145] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:40:50.145] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:40:50.145] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:40:50.145] [INFO] [LaunchDaemonInstaller.swift:669 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Kanata service state: Uninstalled
[2025-11-22 13:40:50.145] [INFO] [LaunchDaemonInstaller.swift:696 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Service not installed (state: Uninstalled)
[2025-11-22 13:40:50.145] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:40:50.212] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:40:50.279] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhiddaemon loaded: false
[2025-11-22 13:40:50.346] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhidmanager loaded: false
[2025-11-22 13:40:50.346] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:40:50.413] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:40:50.413] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhidmanager
[2025-11-22 13:40:50.479] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhidmanager not found in system domain
[2025-11-22 13:40:50.479] [INFO] [SystemValidator.swift:400 checkComponents()] ğŸ” [SystemValidator] Components: kanata=false, driver=true, daemon=false, vhid=false, vhidVersionMismatch=false
[2025-11-22 13:40:50.479] [INFO] [SystemValidator.swift:418 checkConflicts()] ğŸ” [SystemValidator] Checking for conflicts
[2025-11-22 13:40:50.479] [INFO] [ProcessLifecycleManager.swift:117 detectConflicts()] ğŸ” [ProcessLifecycleManager] Detecting conflicts...
[2025-11-22 13:40:50.479] [INFO] [ProcessLifecycleManager.swift:121 detectConflicts()] ğŸ§ª [TestEnvironment] Skipping process conflict detection - returning clean state
[2025-11-22 13:40:50.479] [INFO] [SystemValidator.swift:443 checkConflicts()] ğŸ” [SystemValidator] Total conflicts: 0 (0 kanata, 0 karabiner)
[2025-11-22 13:40:50.479] [INFO] [SystemValidator.swift:484 checkHealth()] ğŸ” [SystemValidator] Checking system health
[2025-11-22 13:40:50.479] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:40:50.479] [INFO] [SystemValidator.swift:229 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 4 (Conflicts) completed in 1.045s
[2025-11-22 13:40:50.479] [INFO] [SystemValidator.swift:220 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 3 (Components) completed in 1.044s
[2025-11-22 13:40:50.479] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 40% (2/5 steps)
[2025-11-22 13:40:50.479] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 20% (1/5 steps)
[2025-11-22 13:40:50.546] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:40:50.546] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:40:50.612] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:40:50.679] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.067s)
[2025-11-22 13:40:50.679] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:40:52.521] [INFO] [HelperManager.swift:248 getHelperVersion()] âš ï¸ [HelperManager] getVersion timed out - clearing connection cache
[2025-11-22 13:40:52.522] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:40:54.250] [INFO] [VHIDDeviceManager.swift:168 evaluateDaemonProcess()] âš ï¸ [VHIDManager] VHIDDevice process check timed out after 3s - fallback launchctl says running=false
[2025-11-22 13:40:54.320] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:40:54.320] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:40:54.320] [INFO] [SystemValidator.swift:494 checkHealth()] ğŸ” [SystemValidator] Health: kanata=false, daemon=false (launchctl), vhid=false
[2025-11-22 13:40:54.320] [INFO] [SystemValidator.swift:362 checkPermissions()] ğŸ” [SystemValidator] Oracle snapshot: ready=false, age=4.885s
[2025-11-22 13:40:54.320] [INFO] [SystemValidator.swift:328 checkHelper()] ğŸ” [SystemValidator] Helper state: registeredButUnresponsive Helper registered but XPC communication failed
[2025-11-22 13:40:54.320] [INFO] [SystemValidator.swift:238 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 5 (Health) completed in 4.885s
[2025-11-22 13:40:54.320] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 60% (3/5 steps)
[2025-11-22 13:40:54.320] [INFO] [SystemValidator.swift:211 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 2 (Permissions) completed in 4.885s
[2025-11-22 13:40:54.320] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 80% (4/5 steps)
[2025-11-22 13:40:54.320] [INFO] [SystemValidator.swift:202 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 1 (Helper) completed in 4.885s
[2025-11-22 13:40:54.320] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 100% (5/5 steps)
[2025-11-22 13:40:54.326] [INFO] [SystemValidator.swift:283 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 COMPLETE: Total duration 4.891s
[2025-11-22 13:40:54.326] [INFO] [SystemValidator.swift:297 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Validation #1 complete in 4.891s
[2025-11-22 13:40:54.326] [INFO] [SystemValidator.swift:299 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Result: ready=false, blocking=9, total=9
[2025-11-22 13:40:54.327] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:40:54.327] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:40:54.327] [INFO] [SystemRequirements.swift:135 validateSystemCompatibility()] ğŸ” [SystemRequirements] Validating system compatibility
[2025-11-22 13:40:54.327] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:40:54.327] [INFO] [SystemRequirements.swift:147 validateSystemCompatibility()] âœ… [SystemRequirements] Modern macOS detected: 26.0.1
[2025-11-22 13:40:54.327] [INFO] [SystemRequirements.swift:190 validateSystemCompatibility()] ğŸ” [SystemRequirements] Compatibility check complete: âœ… Compatible
[2025-11-22 13:40:54.327] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:40:54.327] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:40:54.327] [INFO] [InstallerEngine.swift:78 inspectSystem()] âœ… [InstallerEngine] inspectSystem() complete - ready=false, blocking=9
[2025-11-22 13:40:54.327] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: repair, context:)
[2025-11-22 13:40:54.327] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: repair
[2025-11-22 13:40:54.327] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:40:54.327] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:40:54.327] [INFO] [InstallerEngine.swift:194 execute(plan:using:)] âš™ï¸ [InstallerEngine] Starting execute(plan:, using:)
[2025-11-22 13:40:54.328] [INFO] [InstallerEngine.swift:213 execute(plan:using:)] âš™ï¸ [InstallerEngine] Executing recipe: install-bundled-kanata (type: installComponent)
[2025-11-22 13:40:54.328] [INFO] [PrivilegedOperationsCoordinator.swift:359 installBundledKanata()] ğŸ” [PrivCoordinator] Installing bundled Kanata binary
[2025-11-22 13:40:54.328] [INFO] [LaunchDaemonInstaller.swift:2898 installBundledKanataBinaryOnly()] ğŸ”§ [LaunchDaemon] Installing bundled kanata binary to system location
[2025-11-22 13:40:54.328] [INFO] [LaunchDaemonInstaller.swift:2906 installBundledKanataBinaryOnly()] âŒ [LaunchDaemon] CRITICAL: Bundled kanata binary not found at: /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata
[2025-11-22 13:40:54.328] [INFO] [LaunchDaemonInstaller.swift:2908 installBundledKanataBinaryOnly()] âŒ [LaunchDaemon] This indicates a packaging issue - the app bundle is missing the kanata binary
[2025-11-22 13:40:54.328] [INFO] [InstallerEngine.swift:255 execute(plan:using:)] âŒ [InstallerEngine] Recipe install-bundled-kanata failed: Operation failed: Bundled Kanata installation failed
[2025-11-22 13:40:54.328] [INFO] [InstallerEngine.swift:274 execute(plan:using:)] âœ… [InstallerEngine] execute() complete - success: false, recipes executed: 1
[2025-11-22 13:40:54.328] [INFO] [InstallerEngine.swift:432 run(intent:using:)] âœ… [InstallerEngine] run() complete - success: false
Test Case '-[KeyPathTests.InstallerEngineTests testRunChainsStepsCorrectly]' passed (4.894 seconds).
Test Case '-[KeyPathTests.InstallerEngineTests testRunHandlesAllIntents]' started.
[2025-11-22 13:40:54.331] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:40:54.331] [INFO] [SystemValidator.swift:63 init(launchDaemonInstaller:vhidDeviceManager:processLifecycleManager:kanataManager:)] ğŸ” [SystemValidator] Initialized (stateless, no cache)
[2025-11-22 13:40:54.331] [INFO] [InstallerEngine.swift:35 init(processLifecycleManager:kanataManager:)] ğŸ”§ [InstallerEngine] Initialized
[2025-11-22 13:40:54.332] [INFO] [InstallerEngine.swift:419 run(intent:using:)] ğŸš€ [InstallerEngine] Starting run(intent: install, using:)
[2025-11-22 13:40:54.332] [INFO] [InstallerEngine.swift:53 inspectSystem()] ğŸ” [InstallerEngine] Starting inspectSystem()
[2025-11-22 13:40:54.332] [INFO] [SystemValidator.swift:143 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Starting validation #1
[2025-11-22 13:40:54.332] [INFO] [SystemValidator.swift:174 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 START: 1763847654.332
[2025-11-22 13:40:54.332] [INFO] [SystemValidator.swift:312 checkHelper()] ğŸ” [SystemValidator] Checking privileged helper
[2025-11-22 13:40:54.332] [INFO] [SystemValidator.swift:344 checkPermissions()] ğŸ” [SystemValidator] Checking permissions via Oracle
[2025-11-22 13:40:54.332] [INFO] [SystemValidator.swift:372 checkComponents()] ğŸ” [SystemValidator] Checking components
[2025-11-22 13:40:54.332] [INFO] [KanataBinaryDetector.swift:66 detectCurrentStatus()] ğŸ” [KanataBinaryDetector] Starting unified kanata binary detection
[2025-11-22 13:40:54.332] [INFO] [KanataBinaryDetector.swift:81 detectCurrentStatus()] âŒ [KanataBinaryDetector] No kanata binary found
[2025-11-22 13:40:54.333] [INFO] [VHIDDeviceManager.swift:50 detectInstallation()] ğŸ” [VHIDManager] Manager app exists at /Applications/.Karabiner-VirtualHIDDevice-Manager.app/Contents/MacOS/Karabiner-VirtualHIDDevice-Manager: true
[2025-11-22 13:40:54.333] [INFO] [PermissionOracle.swift:173 currentSnapshot()] ğŸ”® [Oracle] Test mode snapshot generated (non-blocking)
[2025-11-22 13:40:54.349] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:40:54.359] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:40:54.386] [INFO] [HelperManager.swift:830 verifyEmbeddedHelperSignature()] ğŸ”’ [HelperManager] Embedded helper signature looks valid
[2025-11-22 13:40:54.386] [INFO] [HelperManager.swift:105 getConnection()] ğŸ”— [HelperManager] Creating XPC connection to com.keypath.helper
[2025-11-22 13:40:54.387] [INFO] [HelperManager.swift:129 getConnection()] âœ… [HelperManager] XPC connection established (PID: 0)
[2025-11-22 13:40:54.387] [INFO] [HelperManager.swift:228 getHelperVersion()] ğŸ“¤ [HelperManager] Calling proxy.getVersion()
[2025-11-22 13:40:54.387] [INFO] [HelperManager.swift:243 getHelperVersion()] ğŸ“¤ [HelperManager] proxy.getVersion() call dispatched, waiting for callback
[2025-11-22 13:40:54.390] [INFO] [HelperManager.swift:121 getConnection()] âš ï¸ [HelperManager] XPC connection interrupted - will reconnect
[2025-11-22 13:40:54.391] [INFO] [HelperManager.swift:578 getRemoteProxy(errorHandler:)] âŒ [HelperManager] XPC proxy error: Couldnâ€™t communicate with a helper application.
[2025-11-22 13:40:54.391] [INFO] [HelperManager.swift:584 getRemoteProxy(errorHandler:)] âš ï¸ [HelperManager] XPC connection interrupted - this may indicate:
[2025-11-22 13:40:54.391] [INFO] [HelperManager.swift:585 getRemoteProxy(errorHandler:)]    1. Helper signature validation failed (app updated but not restarted)
[2025-11-22 13:40:54.391] [INFO] [HelperManager.swift:587 getRemoteProxy(errorHandler:)]    2. Helper process crashed
[2025-11-22 13:40:54.391] [INFO] [HelperManager.swift:588 getRemoteProxy(errorHandler:)]    3. Helper was killed by the system
[2025-11-22 13:40:54.391] [INFO] [HelperManager.swift:589 getRemoteProxy(errorHandler:)] ğŸ’¡ If you just updated KeyPath, try restarting the app
[2025-11-22 13:40:54.391] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:40:54.391] [INFO] [HelperManager.swift:116 getConnection()] âŒ [HelperManager] XPC connection invalidated
[2025-11-22 13:40:54.391] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:40:54.401] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.068s)
[2025-11-22 13:40:54.401] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:40:54.975] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.070s)
[2025-11-22 13:40:54.975] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:40:54.975] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:40:54.975] [INFO] [VHIDDeviceManager.swift:343 getInstalledVersion()] ğŸ” [VHIDManager] Installed daemon version: 5.0.0
[2025-11-22 13:40:54.975] [INFO] [VHIDDeviceManager.swift:374 hasVersionMismatch()] âœ… [VHIDManager] Version compatible: v5.0.0
[2025-11-22 13:40:54.975] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:40:55.043] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:40:55.044] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:40:55.044] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:40:55.044] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:40:55.044] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:40:55.047] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:40:55.047] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:40:55.047] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:40:55.047] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:40:55.047] [INFO] [LaunchDaemonInstaller.swift:669 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Kanata service state: Uninstalled
[2025-11-22 13:40:55.047] [INFO] [LaunchDaemonInstaller.swift:696 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Service not installed (state: Uninstalled)
[2025-11-22 13:40:55.047] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:40:55.116] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:40:55.187] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhiddaemon loaded: false
[2025-11-22 13:40:55.257] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhidmanager loaded: false
[2025-11-22 13:40:55.257] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:40:55.325] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:40:55.326] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhidmanager
[2025-11-22 13:40:55.396] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhidmanager not found in system domain
[2025-11-22 13:40:55.396] [INFO] [SystemValidator.swift:400 checkComponents()] ğŸ” [SystemValidator] Components: kanata=false, driver=true, daemon=false, vhid=false, vhidVersionMismatch=false
[2025-11-22 13:40:55.397] [INFO] [SystemValidator.swift:220 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 3 (Components) completed in 1.065s
[2025-11-22 13:40:55.397] [INFO] [SystemValidator.swift:418 checkConflicts()] ğŸ” [SystemValidator] Checking for conflicts
[2025-11-22 13:40:55.397] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 20% (1/5 steps)
[2025-11-22 13:40:55.397] [INFO] [ProcessLifecycleManager.swift:117 detectConflicts()] ğŸ” [ProcessLifecycleManager] Detecting conflicts...
[2025-11-22 13:40:55.397] [INFO] [ProcessLifecycleManager.swift:121 detectConflicts()] ğŸ§ª [TestEnvironment] Skipping process conflict detection - returning clean state
[2025-11-22 13:40:55.397] [INFO] [SystemValidator.swift:443 checkConflicts()] ğŸ” [SystemValidator] Total conflicts: 0 (0 kanata, 0 karabiner)
[2025-11-22 13:40:55.397] [INFO] [SystemValidator.swift:484 checkHealth()] ğŸ” [SystemValidator] Checking system health
[2025-11-22 13:40:55.397] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:40:55.397] [INFO] [SystemValidator.swift:229 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 4 (Conflicts) completed in 1.065s
[2025-11-22 13:40:55.397] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 40% (2/5 steps)
[2025-11-22 13:40:55.465] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:40:55.465] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:40:55.534] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:40:55.603] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.069s)
[2025-11-22 13:40:55.603] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:40:56.173] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.068s)
[2025-11-22 13:40:56.173] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:40:56.173] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:40:56.173] [INFO] [SystemValidator.swift:494 checkHealth()] ğŸ” [SystemValidator] Health: kanata=false, daemon=false (launchctl), vhid=false
[2025-11-22 13:40:56.173] [INFO] [SystemValidator.swift:238 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 5 (Health) completed in 1.841s
[2025-11-22 13:40:56.173] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 60% (3/5 steps)
[2025-11-22 13:40:56.173] [INFO] [SystemValidator.swift:362 checkPermissions()] ğŸ” [SystemValidator] Oracle snapshot: ready=false, age=1.840s
[2025-11-22 13:40:56.173] [INFO] [SystemValidator.swift:211 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 2 (Permissions) completed in 1.841s
[2025-11-22 13:40:56.173] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 80% (4/5 steps)
[2025-11-22 13:40:57.421] [INFO] [HelperManager.swift:248 getHelperVersion()] âš ï¸ [HelperManager] getVersion timed out - clearing connection cache
[2025-11-22 13:40:57.421] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:40:57.421] [INFO] [SystemValidator.swift:328 checkHelper()] ğŸ” [SystemValidator] Helper state: registeredButUnresponsive Helper registered but XPC communication failed
[2025-11-22 13:40:57.421] [INFO] [SystemValidator.swift:202 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 1 (Helper) completed in 3.089s
[2025-11-22 13:40:57.421] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 100% (5/5 steps)
[2025-11-22 13:40:57.421] [INFO] [SystemValidator.swift:283 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 COMPLETE: Total duration 3.089s
[2025-11-22 13:40:57.421] [INFO] [SystemValidator.swift:297 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Validation #1 complete in 3.089s
[2025-11-22 13:40:57.421] [INFO] [SystemValidator.swift:299 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Result: ready=false, blocking=9, total=9
[2025-11-22 13:40:57.421] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:40:57.421] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:40:57.421] [INFO] [SystemRequirements.swift:135 validateSystemCompatibility()] ğŸ” [SystemRequirements] Validating system compatibility
[2025-11-22 13:40:57.421] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:40:57.421] [INFO] [SystemRequirements.swift:147 validateSystemCompatibility()] âœ… [SystemRequirements] Modern macOS detected: 26.0.1
[2025-11-22 13:40:57.421] [INFO] [SystemRequirements.swift:190 validateSystemCompatibility()] ğŸ” [SystemRequirements] Compatibility check complete: âœ… Compatible
[2025-11-22 13:40:57.421] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:40:57.421] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:40:57.421] [INFO] [InstallerEngine.swift:78 inspectSystem()] âœ… [InstallerEngine] inspectSystem() complete - ready=false, blocking=9
[2025-11-22 13:40:57.421] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: install, context:)
[2025-11-22 13:40:57.421] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: install
[2025-11-22 13:40:57.421] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:40:57.421] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:40:57.421] [INFO] [InstallerEngine.swift:194 execute(plan:using:)] âš™ï¸ [InstallerEngine] Starting execute(plan:, using:)
[2025-11-22 13:40:57.421] [INFO] [InstallerEngine.swift:213 execute(plan:using:)] âš™ï¸ [InstallerEngine] Executing recipe: install-bundled-kanata (type: installComponent)
[2025-11-22 13:40:57.421] [INFO] [PrivilegedOperationsCoordinator.swift:359 installBundledKanata()] ğŸ” [PrivCoordinator] Installing bundled Kanata binary
[2025-11-22 13:40:57.421] [INFO] [LaunchDaemonInstaller.swift:2898 installBundledKanataBinaryOnly()] ğŸ”§ [LaunchDaemon] Installing bundled kanata binary to system location
[2025-11-22 13:40:57.422] [INFO] [LaunchDaemonInstaller.swift:2906 installBundledKanataBinaryOnly()] âŒ [LaunchDaemon] CRITICAL: Bundled kanata binary not found at: /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata
[2025-11-22 13:40:57.422] [INFO] [LaunchDaemonInstaller.swift:2908 installBundledKanataBinaryOnly()] âŒ [LaunchDaemon] This indicates a packaging issue - the app bundle is missing the kanata binary
[2025-11-22 13:40:57.422] [INFO] [InstallerEngine.swift:255 execute(plan:using:)] âŒ [InstallerEngine] Recipe install-bundled-kanata failed: Operation failed: Bundled Kanata installation failed
[2025-11-22 13:40:57.422] [INFO] [InstallerEngine.swift:274 execute(plan:using:)] âœ… [InstallerEngine] execute() complete - success: false, recipes executed: 1
[2025-11-22 13:40:57.422] [INFO] [InstallerEngine.swift:432 run(intent:using:)] âœ… [InstallerEngine] run() complete - success: false
[2025-11-22 13:40:57.422] [INFO] [InstallerEngine.swift:419 run(intent:using:)] ğŸš€ [InstallerEngine] Starting run(intent: repair, using:)
[2025-11-22 13:40:57.422] [INFO] [InstallerEngine.swift:53 inspectSystem()] ğŸ” [InstallerEngine] Starting inspectSystem()
[2025-11-22 13:40:57.422] [INFO] [SystemValidator.swift:143 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Starting validation #1
[2025-11-22 13:40:57.422] [INFO] [SystemValidator.swift:174 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 START: 1763847657.422
[2025-11-22 13:40:57.422] [INFO] [SystemValidator.swift:312 checkHelper()] ğŸ” [SystemValidator] Checking privileged helper
[2025-11-22 13:40:57.422] [INFO] [SystemValidator.swift:344 checkPermissions()] ğŸ” [SystemValidator] Checking permissions via Oracle
[2025-11-22 13:40:57.422] [INFO] [SystemValidator.swift:372 checkComponents()] ğŸ” [SystemValidator] Checking components
[2025-11-22 13:40:57.422] [INFO] [KanataBinaryDetector.swift:66 detectCurrentStatus()] ğŸ” [KanataBinaryDetector] Starting unified kanata binary detection
[2025-11-22 13:40:57.422] [INFO] [PermissionOracle.swift:173 currentSnapshot()] ğŸ”® [Oracle] Test mode snapshot generated (non-blocking)
[2025-11-22 13:40:57.422] [INFO] [KanataBinaryDetector.swift:81 detectCurrentStatus()] âŒ [KanataBinaryDetector] No kanata binary found
[2025-11-22 13:40:57.422] [INFO] [VHIDDeviceManager.swift:50 detectInstallation()] ğŸ” [VHIDManager] Manager app exists at /Applications/.Karabiner-VirtualHIDDevice-Manager.app/Contents/MacOS/Karabiner-VirtualHIDDevice-Manager: true
[2025-11-22 13:40:57.427] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:40:57.434] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:40:57.448] [INFO] [HelperManager.swift:830 verifyEmbeddedHelperSignature()] ğŸ”’ [HelperManager] Embedded helper signature looks valid
[2025-11-22 13:40:57.448] [INFO] [HelperManager.swift:105 getConnection()] ğŸ”— [HelperManager] Creating XPC connection to com.keypath.helper
[2025-11-22 13:40:57.448] [INFO] [HelperManager.swift:129 getConnection()] âœ… [HelperManager] XPC connection established (PID: 0)
[2025-11-22 13:40:57.449] [INFO] [HelperManager.swift:228 getHelperVersion()] ğŸ“¤ [HelperManager] Calling proxy.getVersion()
[2025-11-22 13:40:57.449] [INFO] [HelperManager.swift:243 getHelperVersion()] ğŸ“¤ [HelperManager] proxy.getVersion() call dispatched, waiting for callback
[2025-11-22 13:40:57.449] [INFO] [HelperManager.swift:121 getConnection()] âš ï¸ [HelperManager] XPC connection interrupted - will reconnect
[2025-11-22 13:40:57.449] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:40:57.450] [INFO] [HelperManager.swift:578 getRemoteProxy(errorHandler:)] âŒ [HelperManager] XPC proxy error: Couldnâ€™t communicate with a helper application.
[2025-11-22 13:40:57.450] [INFO] [HelperManager.swift:584 getRemoteProxy(errorHandler:)] âš ï¸ [HelperManager] XPC connection interrupted - this may indicate:
[2025-11-22 13:40:57.450] [INFO] [HelperManager.swift:585 getRemoteProxy(errorHandler:)]    1. Helper signature validation failed (app updated but not restarted)
[2025-11-22 13:40:57.450] [INFO] [HelperManager.swift:587 getRemoteProxy(errorHandler:)]    2. Helper process crashed
[2025-11-22 13:40:57.450] [INFO] [HelperManager.swift:588 getRemoteProxy(errorHandler:)]    3. Helper was killed by the system
[2025-11-22 13:40:57.450] [INFO] [HelperManager.swift:589 getRemoteProxy(errorHandler:)] ğŸ’¡ If you just updated KeyPath, try restarting the app
[2025-11-22 13:40:57.450] [INFO] [HelperManager.swift:116 getConnection()] âŒ [HelperManager] XPC connection invalidated
[2025-11-22 13:40:57.450] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:40:57.490] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.068s)
[2025-11-22 13:40:57.490] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:40:58.062] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.068s)
[2025-11-22 13:40:58.062] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:40:58.062] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:40:58.063] [INFO] [VHIDDeviceManager.swift:343 getInstalledVersion()] ğŸ” [VHIDManager] Installed daemon version: 5.0.0
[2025-11-22 13:40:58.063] [INFO] [VHIDDeviceManager.swift:374 hasVersionMismatch()] âœ… [VHIDManager] Version compatible: v5.0.0
[2025-11-22 13:40:58.063] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:40:58.130] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:40:58.131] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:40:58.131] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:40:58.131] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:40:58.131] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:40:58.131] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:40:58.131] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:40:58.131] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:40:58.131] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:40:58.131] [INFO] [LaunchDaemonInstaller.swift:669 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Kanata service state: Uninstalled
[2025-11-22 13:40:58.131] [INFO] [LaunchDaemonInstaller.swift:696 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Service not installed (state: Uninstalled)
[2025-11-22 13:40:58.131] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:40:58.199] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:40:58.266] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhiddaemon loaded: false
[2025-11-22 13:40:58.332] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhidmanager loaded: false
[2025-11-22 13:40:58.332] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:40:58.399] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:40:58.399] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhidmanager
[2025-11-22 13:40:58.466] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhidmanager not found in system domain
[2025-11-22 13:40:58.466] [INFO] [SystemValidator.swift:400 checkComponents()] ğŸ” [SystemValidator] Components: kanata=false, driver=true, daemon=false, vhid=false, vhidVersionMismatch=false
[2025-11-22 13:40:58.466] [INFO] [SystemValidator.swift:418 checkConflicts()] ğŸ” [SystemValidator] Checking for conflicts
[2025-11-22 13:40:58.466] [INFO] [ProcessLifecycleManager.swift:117 detectConflicts()] ğŸ” [ProcessLifecycleManager] Detecting conflicts...
[2025-11-22 13:40:58.466] [INFO] [SystemValidator.swift:220 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 3 (Components) completed in 1.045s
[2025-11-22 13:40:58.466] [INFO] [ProcessLifecycleManager.swift:121 detectConflicts()] ğŸ§ª [TestEnvironment] Skipping process conflict detection - returning clean state
[2025-11-22 13:40:58.466] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 20% (1/5 steps)
[2025-11-22 13:40:58.466] [INFO] [SystemValidator.swift:443 checkConflicts()] ğŸ” [SystemValidator] Total conflicts: 0 (0 kanata, 0 karabiner)
[2025-11-22 13:40:58.466] [INFO] [SystemValidator.swift:484 checkHealth()] ğŸ” [SystemValidator] Checking system health
[2025-11-22 13:40:58.466] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:40:58.466] [INFO] [SystemValidator.swift:229 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 4 (Conflicts) completed in 1.045s
[2025-11-22 13:40:58.466] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 40% (2/5 steps)
[2025-11-22 13:40:58.533] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:40:58.533] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:40:58.601] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:40:58.669] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.068s)
[2025-11-22 13:40:58.669] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:41:00.521] [INFO] [HelperManager.swift:248 getHelperVersion()] âš ï¸ [HelperManager] getVersion timed out - clearing connection cache
[2025-11-22 13:41:00.521] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:41:02.239] [INFO] [VHIDDeviceManager.swift:168 evaluateDaemonProcess()] âš ï¸ [VHIDManager] VHIDDevice process check timed out after 3s - fallback launchctl says running=false
[2025-11-22 13:41:02.309] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:41:02.309] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:41:02.309] [INFO] [SystemValidator.swift:494 checkHealth()] ğŸ” [SystemValidator] Health: kanata=false, daemon=false (launchctl), vhid=false
[2025-11-22 13:41:02.309] [INFO] [SystemValidator.swift:238 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 5 (Health) completed in 4.887s
[2025-11-22 13:41:02.309] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 60% (3/5 steps)
[2025-11-22 13:41:02.309] [INFO] [SystemValidator.swift:362 checkPermissions()] ğŸ” [SystemValidator] Oracle snapshot: ready=false, age=4.887s
[2025-11-22 13:41:02.309] [INFO] [SystemValidator.swift:328 checkHelper()] ğŸ” [SystemValidator] Helper state: registeredButUnresponsive Helper registered but XPC communication failed
[2025-11-22 13:41:02.309] [INFO] [SystemValidator.swift:202 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 1 (Helper) completed in 4.887s
[2025-11-22 13:41:02.309] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 80% (4/5 steps)
[2025-11-22 13:41:02.309] [INFO] [SystemValidator.swift:211 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 2 (Permissions) completed in 4.887s
[2025-11-22 13:41:02.309] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 100% (5/5 steps)
[2025-11-22 13:41:02.309] [INFO] [SystemValidator.swift:283 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 COMPLETE: Total duration 4.888s
[2025-11-22 13:41:02.309] [INFO] [SystemValidator.swift:297 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Validation #1 complete in 4.888s
[2025-11-22 13:41:02.309] [INFO] [SystemValidator.swift:299 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Result: ready=false, blocking=9, total=9
[2025-11-22 13:41:02.310] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:41:02.310] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:41:02.310] [INFO] [SystemRequirements.swift:135 validateSystemCompatibility()] ğŸ” [SystemRequirements] Validating system compatibility
[2025-11-22 13:41:02.310] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:41:02.310] [INFO] [SystemRequirements.swift:147 validateSystemCompatibility()] âœ… [SystemRequirements] Modern macOS detected: 26.0.1
[2025-11-22 13:41:02.310] [INFO] [SystemRequirements.swift:190 validateSystemCompatibility()] ğŸ” [SystemRequirements] Compatibility check complete: âœ… Compatible
[2025-11-22 13:41:02.310] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:41:02.310] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:41:02.310] [INFO] [InstallerEngine.swift:78 inspectSystem()] âœ… [InstallerEngine] inspectSystem() complete - ready=false, blocking=9
[2025-11-22 13:41:02.310] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: repair, context:)
[2025-11-22 13:41:02.310] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: repair
[2025-11-22 13:41:02.310] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:41:02.310] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:41:02.310] [INFO] [InstallerEngine.swift:194 execute(plan:using:)] âš™ï¸ [InstallerEngine] Starting execute(plan:, using:)
[2025-11-22 13:41:02.310] [INFO] [InstallerEngine.swift:213 execute(plan:using:)] âš™ï¸ [InstallerEngine] Executing recipe: install-bundled-kanata (type: installComponent)
[2025-11-22 13:41:02.310] [INFO] [PrivilegedOperationsCoordinator.swift:359 installBundledKanata()] ğŸ” [PrivCoordinator] Installing bundled Kanata binary
[2025-11-22 13:41:02.310] [INFO] [LaunchDaemonInstaller.swift:2898 installBundledKanataBinaryOnly()] ğŸ”§ [LaunchDaemon] Installing bundled kanata binary to system location
[2025-11-22 13:41:02.310] [INFO] [LaunchDaemonInstaller.swift:2906 installBundledKanataBinaryOnly()] âŒ [LaunchDaemon] CRITICAL: Bundled kanata binary not found at: /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata
[2025-11-22 13:41:02.310] [INFO] [LaunchDaemonInstaller.swift:2908 installBundledKanataBinaryOnly()] âŒ [LaunchDaemon] This indicates a packaging issue - the app bundle is missing the kanata binary
[2025-11-22 13:41:02.310] [INFO] [InstallerEngine.swift:255 execute(plan:using:)] âŒ [InstallerEngine] Recipe install-bundled-kanata failed: Operation failed: Bundled Kanata installation failed
[2025-11-22 13:41:02.310] [INFO] [InstallerEngine.swift:274 execute(plan:using:)] âœ… [InstallerEngine] execute() complete - success: false, recipes executed: 1
[2025-11-22 13:41:02.310] [INFO] [InstallerEngine.swift:432 run(intent:using:)] âœ… [InstallerEngine] run() complete - success: false
[2025-11-22 13:41:02.310] [INFO] [InstallerEngine.swift:419 run(intent:using:)] ğŸš€ [InstallerEngine] Starting run(intent: uninstall, using:)
[2025-11-22 13:41:02.310] [INFO] [InstallerEngine.swift:422 run(intent:using:)] ğŸ—‘ï¸ [InstallerEngine] Delegating uninstall intent to uninstall(deleteConfig:, using:)
[2025-11-22 13:41:02.310] [INFO] [InstallerEngine.swift:439 uninstall(deleteConfig:using:)] ğŸ—‘ï¸ [InstallerEngine] Starting uninstall (deleteConfig: false)
[2025-11-22 13:41:02.312] [INFO] [InstallerEngine.swift:463 uninstall(deleteConfig:using:)] ğŸ—‘ï¸ [InstallerEngine] uninstall complete - success: false
[2025-11-22 13:41:02.312] [INFO] [InstallerEngine.swift:419 run(intent:using:)] ğŸš€ [InstallerEngine] Starting run(intent: inspectOnly, using:)
[2025-11-22 13:41:02.312] [INFO] [InstallerEngine.swift:53 inspectSystem()] ğŸ” [InstallerEngine] Starting inspectSystem()
[2025-11-22 13:41:02.312] [INFO] [SystemValidator.swift:143 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Starting validation #1
[2025-11-22 13:41:02.312] [INFO] [SystemValidator.swift:174 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 START: 1763847662.312
[2025-11-22 13:41:02.312] [INFO] [SystemValidator.swift:312 checkHelper()] ğŸ” [SystemValidator] Checking privileged helper
[2025-11-22 13:41:02.312] [INFO] [SystemValidator.swift:344 checkPermissions()] ğŸ” [SystemValidator] Checking permissions via Oracle
[2025-11-22 13:41:02.312] [INFO] [SystemValidator.swift:372 checkComponents()] ğŸ” [SystemValidator] Checking components
[2025-11-22 13:41:02.312] [INFO] [KanataBinaryDetector.swift:66 detectCurrentStatus()] ğŸ” [KanataBinaryDetector] Starting unified kanata binary detection
[2025-11-22 13:41:02.312] [INFO] [PermissionOracle.swift:173 currentSnapshot()] ğŸ”® [Oracle] Test mode snapshot generated (non-blocking)
[2025-11-22 13:41:02.312] [INFO] [KanataBinaryDetector.swift:81 detectCurrentStatus()] âŒ [KanataBinaryDetector] No kanata binary found
[2025-11-22 13:41:02.312] [INFO] [VHIDDeviceManager.swift:50 detectInstallation()] ğŸ” [VHIDManager] Manager app exists at /Applications/.Karabiner-VirtualHIDDevice-Manager.app/Contents/MacOS/Karabiner-VirtualHIDDevice-Manager: true
[2025-11-22 13:41:02.320] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:41:02.326] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:41:02.344] [INFO] [HelperManager.swift:830 verifyEmbeddedHelperSignature()] ğŸ”’ [HelperManager] Embedded helper signature looks valid
[2025-11-22 13:41:02.344] [INFO] [HelperManager.swift:105 getConnection()] ğŸ”— [HelperManager] Creating XPC connection to com.keypath.helper
[2025-11-22 13:41:02.344] [INFO] [HelperManager.swift:129 getConnection()] âœ… [HelperManager] XPC connection established (PID: 0)
[2025-11-22 13:41:02.344] [INFO] [HelperManager.swift:228 getHelperVersion()] ğŸ“¤ [HelperManager] Calling proxy.getVersion()
[2025-11-22 13:41:02.344] [INFO] [HelperManager.swift:243 getHelperVersion()] ğŸ“¤ [HelperManager] proxy.getVersion() call dispatched, waiting for callback
[2025-11-22 13:41:02.344] [INFO] [HelperManager.swift:121 getConnection()] âš ï¸ [HelperManager] XPC connection interrupted - will reconnect
[2025-11-22 13:41:02.344] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:41:02.345] [INFO] [HelperManager.swift:578 getRemoteProxy(errorHandler:)] âŒ [HelperManager] XPC proxy error: Couldnâ€™t communicate with a helper application.
[2025-11-22 13:41:02.345] [INFO] [HelperManager.swift:584 getRemoteProxy(errorHandler:)] âš ï¸ [HelperManager] XPC connection interrupted - this may indicate:
[2025-11-22 13:41:02.345] [INFO] [HelperManager.swift:585 getRemoteProxy(errorHandler:)]    1. Helper signature validation failed (app updated but not restarted)
[2025-11-22 13:41:02.345] [INFO] [HelperManager.swift:587 getRemoteProxy(errorHandler:)]    2. Helper process crashed
[2025-11-22 13:41:02.345] [INFO] [HelperManager.swift:588 getRemoteProxy(errorHandler:)]    3. Helper was killed by the system
[2025-11-22 13:41:02.345] [INFO] [HelperManager.swift:589 getRemoteProxy(errorHandler:)] ğŸ’¡ If you just updated KeyPath, try restarting the app
[2025-11-22 13:41:02.345] [INFO] [HelperManager.swift:116 getConnection()] âŒ [HelperManager] XPC connection invalidated
[2025-11-22 13:41:02.345] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:41:02.380] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.068s)
[2025-11-22 13:41:02.381] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
