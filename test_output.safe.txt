Test Suite 'All tests' started at 2025-11-22 13:10:22.969.
Test Suite 'KeyPathPackageTests.xctest' started at 2025-11-22 13:10:22.970.
Test Suite 'AuthorizationServicesSmokeTests' started at 2025-11-22 13:10:22.970.
Test Case '-[KeyPathTests.AuthorizationServicesSmokeTests testAuthorizationServicesInstallationCreatesPlistsAndBootstraps]' started.
[2025-11-22 13:10:22.973] [INFO] [LaunchDaemonInstaller.swift:312 createAllLaunchDaemonServices()] ğŸ”§ [LaunchDaemon] Creating all LaunchDaemon services
[2025-11-22 13:10:22.974] [INFO] [ConfigurationService.swift:483 createInitialConfigIfNeeded()] âœ… [ConfigService] Config directory created at /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/auth-smoke-8F7E997D-9E28-4836-8300-E006816902A9/Users/malpern/.config/keypath
[2025-11-22 13:10:22.974] [INFO] [ConfigurationService.swift:488 createInitialConfigIfNeeded()] âš ï¸ [ConfigService] No existing config found at /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/auth-smoke-8F7E997D-9E28-4836-8300-E006816902A9/Users/malpern/.config/keypath/keypath.kbd
[2025-11-22 13:10:22.974] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:10:22.974] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:10:22.974] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 725 characters
[2025-11-22 13:10:22.974] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:10:22.974] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 10 src keys, 10 layer keys, deduplicated to 10 unique mappings
[2025-11-22 13:10:22.974] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:10:22.974] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:10:22.974] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 0 mappings
[2025-11-22 13:10:22.974] [INFO] [ConfigurationService.swift:492 createInitialConfigIfNeeded()] âœ… [ConfigService] Created initial empty configuration
[2025-11-22 13:10:22.974] [INFO] [LaunchDaemonInstaller.swift:945 ensureDefaultUserConfigExists()] âœ… [LaunchDaemon] Created default user config at /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/auth-smoke-8F7E997D-9E28-4836-8300-E006816902A9/Users/malpern/.config/keypath/keypath.kbd
[2025-11-22 13:10:22.974] [INFO] [LaunchDaemonInstaller.swift:229 getKanataBinaryPath()] âš ï¸ [LaunchDaemon] System kanata not found, using bundled path: /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/auth-smoke-8F7E997D-9E28-4836-8300-E006816902A9/bundled-kanata
[2025-11-22 13:10:22.975] [INFO] [LaunchDaemonInstaller.swift:2689 buildKanataPlistArguments(binaryPath:)] ğŸ“¡ [LaunchDaemon] TCP server enabled on port 45000
[2025-11-22 13:10:22.975] [INFO] [LaunchDaemonInstaller.swift:2705 buildKanataPlistArguments(binaryPath:)] ğŸ”§ [LaunchDaemon] Built plist arguments: /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/auth-smoke-8F7E997D-9E28-4836-8300-E006816902A9/bundled-kanata --cfg /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/auth-smoke-8F7E997D-9E28-4836-8300-E006816902A9/Users/malpern/.config/keypath/keypath.kbd --port 45000 --debug --log-layer-changes
[2025-11-22 13:10:22.976] [INFO] [LaunchDaemonInstaller.swift:1214 executeConsolidatedInstallationWithAuthServices(kanataTemp:vhidDaemonTemp:vhidManagerTemp:)] ğŸ”§ [LaunchDaemon] Starting consolidated installation with Authorization Services
[2025-11-22 13:10:22.976] [INFO] [LaunchDaemonInstaller.swift:1216 executeConsolidatedInstallationWithAuthServices(kanataTemp:vhidDaemonTemp:vhidManagerTemp:)] ğŸ”§ [LaunchDaemon] This approach bypasses osascript sandbox restrictions
[2025-11-22 13:10:23.511] [INFO] [LaunchDaemonInstaller.swift:1322 executeConsolidatedInstallationWithAuthServices(kanataTemp:vhidDaemonTemp:vhidManagerTemp:)] âœ… [LaunchDaemon] Authorization Services installation completed successfully
Test Case '-[KeyPathTests.AuthorizationServicesSmokeTests testAuthorizationServicesInstallationCreatesPlistsAndBootstraps]' passed (0.544 seconds).
Test Suite 'AuthorizationServicesSmokeTests' passed at 2025-11-22 13:10:23.514.
	 Executed 1 test, with 0 failures (0 unexpected) in 0.544 (0.544) seconds
Test Suite 'ConfigApplyTypesTests' started at 2025-11-22 13:10:23.514.
Test Case '-[KeyPathTests.ConfigApplyTypesTests testApplyResultInitConvenience]' started.
Test Case '-[KeyPathTests.ConfigApplyTypesTests testApplyResultInitConvenience]' passed (0.000 seconds).
Test Case '-[KeyPathTests.ConfigApplyTypesTests testConfigDiagnosticsInit]' started.
Test Case '-[KeyPathTests.ConfigApplyTypesTests testConfigDiagnosticsInit]' passed (0.000 seconds).
Test Case '-[KeyPathTests.ConfigApplyTypesTests testConfigEditCommandEquatable]' started.
Test Case '-[KeyPathTests.ConfigApplyTypesTests testConfigEditCommandEquatable]' passed (0.000 seconds).
Test Case '-[KeyPathTests.ConfigApplyTypesTests testConfigErrorEquality]' started.
Test Case '-[KeyPathTests.ConfigApplyTypesTests testConfigErrorEquality]' passed (0.000 seconds).
Test Case '-[KeyPathTests.ConfigApplyTypesTests testFeatureFlagDefaultsOff]' started.
Test Case '-[KeyPathTests.ConfigApplyTypesTests testFeatureFlagDefaultsOff]' passed (0.000 seconds).
Test Suite 'ConfigApplyTypesTests' passed at 2025-11-22 13:10:23.515.
	 Executed 5 tests, with 0 failures (0 unexpected) in 0.001 (0.001) seconds
Test Suite 'ConfigFileWatcherTests' started at 2025-11-22 13:10:23.515.
Test Case '-[KeyPathTests.ConfigFileWatcherTests testDebouncePreventsMultipleCallbacks]' started.
[2025-11-22 13:10:23.515] [INFO] [ConfigFileWatcher.swift:40 init()] ğŸ“ [FileWatcher] ConfigFileWatcher initialized with robust monitoring
[2025-11-22 13:10:23.515] [INFO] [ConfigFileWatcher.swift:80 startWatching(path:onChange:)] ğŸ“ [FileWatcher] Starting to watch file: /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/75064D51-C85F-481A-B25A-83C0E3BABFE2/config.kbd
[2025-11-22 13:10:23.515] [INFO] [ConfigFileWatcher.swift:81 startWatching(path:onChange:)] ğŸ“ [FileWatcher] Parent directory: /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/75064D51-C85F-481A-B25A-83C0E3BABFE2
[2025-11-22 13:10:23.515] [INFO] [ConfigFileWatcher.swift:85 startWatching(path:onChange:)] ğŸ“ [FileWatcher] Target file exists - setting up direct file monitoring
[2025-11-22 13:10:23.515] [INFO] [ConfigFileWatcher.swift:434 updateLastModificationDate()] ğŸ“ [FileWatcher] Updated last modification date: 2025-11-22 21:10:23 +0000
[2025-11-22 13:10:23.515] [INFO] [ConfigFileWatcher.swift:414 openFileDescriptor(at:)] ğŸ“ [FileWatcher] Successfully opened file descriptor 5 for: /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/75064D51-C85F-481A-B25A-83C0E3BABFE2/config.kbd
[2025-11-22 13:10:23.515] [INFO] [ConfigFileWatcher.swift:114 setupFileMonitoring()] ğŸ“ [FileWatcher] Successfully opened file descriptor 5 for: /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/75064D51-C85F-481A-B25A-83C0E3BABFE2/config.kbd
[2025-11-22 13:10:23.516] [INFO] [ConfigFileWatcher.swift:146 setupFileMonitoring()] âœ… [FileWatcher] Successfully started file monitoring for: /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/75064D51-C85F-481A-B25A-83C0E3BABFE2/config.kbd
[2025-11-22 13:10:23.516] [INFO] [ConfigFileWatcher.swift:129 setupFileMonitoring()] ğŸ“ [FileWatcher] File system event received - flags: FileSystemEvent(rawValue: 1)
[2025-11-22 13:10:23.517] [INFO] [ConfigFileWatcher.swift:270 handleFileEvent(flags:)] ğŸ“ [FileWatcher] Detected atomic write (rename/delete) - rebinding file descriptor
[2025-11-22 13:10:23.517] [INFO] [ConfigFileWatcher.swift:282 rebindFileMonitor(to:)] ğŸ”„ [FileWatcher] Rebinding file monitor to: /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/75064D51-C85F-481A-B25A-83C0E3BABFE2/config.kbd
[2025-11-22 13:10:23.517] [INFO] [ConfigFileWatcher.swift:331 handleFileChangeEvent()] ğŸ“ [FileWatcher] Processing file change event for: /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/75064D51-C85F-481A-B25A-83C0E3BABFE2/config.kbd
[2025-11-22 13:10:23.517] [INFO] [ConfigFileWatcher.swift:137 setupFileMonitoring()] ğŸ“ [FileWatcher] Closing file descriptor 5
[2025-11-22 13:10:23.571] [INFO] [ConfigFileWatcher.swift:434 updateLastModificationDate()] ğŸ“ [FileWatcher] Updated last modification date: 2025-11-22 21:10:23 +0000
[2025-11-22 13:10:23.571] [INFO] [ConfigFileWatcher.swift:414 openFileDescriptor(at:)] ğŸ“ [FileWatcher] Successfully opened file descriptor 5 for: /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/75064D51-C85F-481A-B25A-83C0E3BABFE2/config.kbd
[2025-11-22 13:10:23.571] [INFO] [ConfigFileWatcher.swift:114 setupFileMonitoring()] ğŸ“ [FileWatcher] Successfully opened file descriptor 5 for: /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/75064D51-C85F-481A-B25A-83C0E3BABFE2/config.kbd
[2025-11-22 13:10:23.571] [INFO] [ConfigFileWatcher.swift:146 setupFileMonitoring()] âœ… [FileWatcher] Successfully started file monitoring for: /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/75064D51-C85F-481A-B25A-83C0E3BABFE2/config.kbd
[2025-11-22 13:10:24.037] [INFO] [ConfigFileWatcher.swift:489 processFileChange()] ğŸ“ [FileWatcher] Processing debounced file change for: /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/75064D51-C85F-481A-B25A-83C0E3BABFE2/config.kbd
[2025-11-22 13:10:24.037] [INFO] [ConfigFileWatcher.swift:505 processFileChange()] ğŸ“ [FileWatcher] Atomic write detected - forcing change callback
[2025-11-22 13:10:24.037] [INFO] [ConfigFileWatcher.swift:518 processFileChange()] ğŸ“ [FileWatcher] Triggering file change callback for file (5 bytes)
[2025-11-22 13:10:24.037] [INFO] [ConfigFileWatcher.swift:529 processFileChange()] âœ… [FileWatcher] File change callback completed
[2025-11-22 13:10:24.038] [INFO] [ConfigFileWatcher.swift:208 stopWatching()] ğŸ“ [FileWatcher] Stopping all monitoring...
[2025-11-22 13:10:24.038] [INFO] [ConfigFileWatcher.swift:216 stopWatching()] ğŸ“ [FileWatcher] Stopping file monitoring
[2025-11-22 13:10:24.038] [INFO] [ConfigFileWatcher.swift:237 stopWatching()] âœ… [FileWatcher] All monitoring stopped and state cleared
[2025-11-22 13:10:24.038] [INFO] [ConfigFileWatcher.swift:137 setupFileMonitoring()] ğŸ“ [FileWatcher] Closing file descriptor 5
[2025-11-22 13:10:24.038] [INFO] [ConfigFileWatcher.swift:208 stopWatching()] ğŸ“ [FileWatcher] Stopping all monitoring...
[2025-11-22 13:10:24.038] [INFO] [ConfigFileWatcher.swift:237 stopWatching()] âœ… [FileWatcher] All monitoring stopped and state cleared
[2025-11-22 13:10:24.038] [INFO] [ConfigFileWatcher.swift:45 deinit] ğŸ“ [FileWatcher] ConfigFileWatcher deinitialized
Test Case '-[KeyPathTests.ConfigFileWatcherTests testDebouncePreventsMultipleCallbacks]' passed (0.524 seconds).
Test Suite 'ConfigFileWatcherTests' passed at 2025-11-22 13:10:24.038.
	 Executed 1 test, with 0 failures (0 unexpected) in 0.524 (0.524) seconds
Test Suite 'ConfigurationServiceTests' started at 2025-11-22 13:10:24.039.
Test Case '-[KeyPathTests.ConfigurationServiceTests testBackupFailedConfigAndApplySafe]' started.
[2025-11-22 13:10:24.040] [INFO] [ConfigurationService.swift:757 backupFailedConfigAndApplySafe(failedConfig:mappings:)] ğŸ›¡ï¸ [Config] Backing up failed config and applying safe default
[2025-11-22 13:10:24.041] [INFO] [ConfigurationService.swift:782 backupFailedConfigAndApplySafe(failedConfig:mappings:)] ğŸ’¾ [Config] Failed config backed up to: /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/KeyPathConfigTests_3DE6BA8C-407D-432A-B05C-B8F53A60610B/backups/failed_config_2025-11-22_13-10-24.kbd
[2025-11-22 13:10:24.042] [INFO] [ConfigurationService.swift:790 backupFailedConfigAndApplySafe(failedConfig:mappings:)] âœ… [Config] Safe default config applied
Test Case '-[KeyPathTests.ConfigurationServiceTests testBackupFailedConfigAndApplySafe]' passed (0.004 seconds).
Test Case '-[KeyPathTests.ConfigurationServiceTests testBackupFailedConfigAppliesSafeDefaults]' started.
[2025-11-22 13:10:24.043] [INFO] [ConfigurationService.swift:757 backupFailedConfigAndApplySafe(failedConfig:mappings:)] ğŸ›¡ï¸ [Config] Backing up failed config and applying safe default
[2025-11-22 13:10:24.045] [INFO] [ConfigurationService.swift:782 backupFailedConfigAndApplySafe(failedConfig:mappings:)] ğŸ’¾ [Config] Failed config backed up to: /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/KeyPathConfigTests_F88864A9-8DEB-4043-B7BF-9814A9C9E412/backups/failed_config_2025-11-22_13-10-24.kbd
[2025-11-22 13:10:24.046] [INFO] [ConfigurationService.swift:790 backupFailedConfigAndApplySafe(failedConfig:mappings:)] âœ… [Config] Safe default config applied
Test Case '-[KeyPathTests.ConfigurationServiceTests testBackupFailedConfigAppliesSafeDefaults]' passed (0.004 seconds).
Test Case '-[KeyPathTests.ConfigurationServiceTests testConvertToKanataKey_CaseInsensitive]' started.
Test Case '-[KeyPathTests.ConfigurationServiceTests testConvertToKanataKey_CaseInsensitive]' passed (0.000 seconds).
Test Case '-[KeyPathTests.ConfigurationServiceTests testConvertToKanataKey_ModifierKeys]' started.
Test Case '-[KeyPathTests.ConfigurationServiceTests testConvertToKanataKey_ModifierKeys]' passed (0.000 seconds).
Test Case '-[KeyPathTests.ConfigurationServiceTests testConvertToKanataKey_StandardKeys]' started.
Test Case '-[KeyPathTests.ConfigurationServiceTests testConvertToKanataKey_StandardKeys]' passed (0.000 seconds).
Test Case '-[KeyPathTests.ConfigurationServiceTests testConvertToKanataSequence_KeyNameNotMacro]' started.
Test Case '-[KeyPathTests.ConfigurationServiceTests testConvertToKanataSequence_KeyNameNotMacro]' passed (0.000 seconds).
Test Case '-[KeyPathTests.ConfigurationServiceTests testConvertToKanataSequence_MultipleKeys]' started.
Test Case '-[KeyPathTests.ConfigurationServiceTests testConvertToKanataSequence_MultipleKeys]' passed (0.000 seconds).
Test Case '-[KeyPathTests.ConfigurationServiceTests testConvertToKanataSequence_SingleKey]' started.
Test Case '-[KeyPathTests.ConfigurationServiceTests testConvertToKanataSequence_SingleKey]' passed (0.000 seconds).
Test Case '-[KeyPathTests.ConfigurationServiceTests testConvertToKanataSequence_SingleKeyVariants]' started.
Test Case '-[KeyPathTests.ConfigurationServiceTests testConvertToKanataSequence_SingleKeyVariants]' passed (0.000 seconds).
Test Case '-[KeyPathTests.ConfigurationServiceTests testConvertToKanataSequence_SingleLongKey]' started.
Test Case '-[KeyPathTests.ConfigurationServiceTests testConvertToKanataSequence_SingleLongKey]' passed (0.000 seconds).
Test Case '-[KeyPathTests.ConfigurationServiceTests testConvertToKanataSequence_TextMacro_Letters]' started.
Test Case '-[KeyPathTests.ConfigurationServiceTests testConvertToKanataSequence_TextMacro_Letters]' passed (0.000 seconds).
Test Case '-[KeyPathTests.ConfigurationServiceTests testConvertToKanataSequence_TextMacro_Numbers]' started.
Test Case '-[KeyPathTests.ConfigurationServiceTests testConvertToKanataSequence_TextMacro_Numbers]' passed (0.000 seconds).
Test Case '-[KeyPathTests.ConfigurationServiceTests testCreateInitialConfigWritesDefaultFile]' started.
[2025-11-22 13:10:24.050] [INFO] [ConfigurationService.swift:483 createInitialConfigIfNeeded()] âœ… [ConfigService] Config directory created at /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/KeyPathConfigTests_E6644132-2CAA-4BF0-8991-E148035E320E
[2025-11-22 13:10:24.051] [INFO] [ConfigurationService.swift:488 createInitialConfigIfNeeded()] âš ï¸ [ConfigService] No existing config found at /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/KeyPathConfigTests_E6644132-2CAA-4BF0-8991-E148035E320E/keypath.kbd
[2025-11-22 13:10:24.051] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:10:24.051] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:10:24.051] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 725 characters
[2025-11-22 13:10:24.051] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:10:24.051] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 10 src keys, 10 layer keys, deduplicated to 10 unique mappings
[2025-11-22 13:10:24.051] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:10:24.051] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:10:24.052] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 0 mappings
[2025-11-22 13:10:24.052] [INFO] [ConfigurationService.swift:492 createInitialConfigIfNeeded()] âœ… [ConfigService] Created initial empty configuration
Test Case '-[KeyPathTests.ConfigurationServiceTests testCreateInitialConfigWritesDefaultFile]' passed (0.002 seconds).
Test Case '-[KeyPathTests.ConfigurationServiceTests testDisablingMacFunctionKeysRemovesSpecialMappings]' started.
Test Case '-[KeyPathTests.ConfigurationServiceTests testDisablingMacFunctionKeysRemovesSpecialMappings]' passed (0.001 seconds).
Test Case '-[KeyPathTests.ConfigurationServiceTests testGeneratedConfigHasNoInvalidParentheses]' started.
Test Case '-[KeyPathTests.ConfigurationServiceTests testGeneratedConfigHasNoInvalidParentheses]' passed (0.001 seconds).
Test Case '-[KeyPathTests.ConfigurationServiceTests testGeneratedConfigWithTextMacro]' started.
Test Case '-[KeyPathTests.ConfigurationServiceTests testGeneratedConfigWithTextMacro]' passed (0.000 seconds).
Test Case '-[KeyPathTests.ConfigurationServiceTests testGenerateFromMappings_EmptyMappings]' started.
Test Case '-[KeyPathTests.ConfigurationServiceTests testGenerateFromMappings_EmptyMappings]' passed (0.000 seconds).
Test Case '-[KeyPathTests.ConfigurationServiceTests testGenerateFromMappings_MultipleMappings]' started.
Test Case '-[KeyPathTests.ConfigurationServiceTests testGenerateFromMappings_MultipleMappings]' passed (0.000 seconds).
Test Case '-[KeyPathTests.ConfigurationServiceTests testGenerateFromMappings_SingleMapping]' started.
Test Case '-[KeyPathTests.ConfigurationServiceTests testGenerateFromMappings_SingleMapping]' passed (0.001 seconds).
Test Case '-[KeyPathTests.ConfigurationServiceTests testGenerateFromMappings_UsesSingleDefsrcAndDeflayer]' started.
Test Case '-[KeyPathTests.ConfigurationServiceTests testGenerateFromMappings_UsesSingleDefsrcAndDeflayer]' passed (0.000 seconds).
Test Case '-[KeyPathTests.ConfigurationServiceTests testNavigationCollectionProducesSeparateLayerAndAlias]' started.
Test Case '-[KeyPathTests.ConfigurationServiceTests testNavigationCollectionProducesSeparateLayerAndAlias]' passed (0.001 seconds).
Test Case '-[KeyPathTests.ConfigurationServiceTests testObserverFiresOnMainActor_OnReload]' started.
[2025-11-22 13:10:24.059] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 0 src keys, 0 layer keys, deduplicated to 0 unique mappings
Test Case '-[KeyPathTests.ConfigurationServiceTests testObserverFiresOnMainActor_OnReload]' passed (0.002 seconds).
Test Case '-[KeyPathTests.ConfigurationServiceTests testObserverFiresOnMainActor_OnSave]' started.
[2025-11-22 13:10:24.060] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:10:24.060] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:10:24.060] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 1068 characters
[2025-11-22 13:10:24.060] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:10:24.060] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 11 src keys, 11 layer keys, deduplicated to 11 unique mappings
[2025-11-22 13:10:24.060] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:10:24.060] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:10:24.061] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 1 mappings
Test Case '-[KeyPathTests.ConfigurationServiceTests testObserverFiresOnMainActor_OnSave]' passed (0.002 seconds).
Test Case '-[KeyPathTests.ConfigurationServiceTests testParseConfigurationFromString_Deduplication]' started.
[2025-11-22 13:10:24.062] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 3 src keys, 3 layer keys, deduplicated to 2 unique mappings
Test Case '-[KeyPathTests.ConfigurationServiceTests testParseConfigurationFromString_Deduplication]' passed (0.001 seconds).
Test Case '-[KeyPathTests.ConfigurationServiceTests testParseConfigurationFromString_ValidConfig]' started.
[2025-11-22 13:10:24.062] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 3 src keys, 3 layer keys, deduplicated to 3 unique mappings
Test Case '-[KeyPathTests.ConfigurationServiceTests testParseConfigurationFromString_ValidConfig]' passed (0.000 seconds).
Test Case '-[KeyPathTests.ConfigurationServiceTests testParseConfigurationFromString_WithComments]' started.
[2025-11-22 13:10:24.063] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 1 src keys, 1 layer keys, deduplicated to 1 unique mappings
Test Case '-[KeyPathTests.ConfigurationServiceTests testParseConfigurationFromString_WithComments]' passed (0.000 seconds).
Test Case '-[KeyPathTests.ConfigurationServiceTests testParseKanataErrors_EmptyOutput]' started.
Test Case '-[KeyPathTests.ConfigurationServiceTests testParseKanataErrors_EmptyOutput]' passed (0.000 seconds).
Test Case '-[KeyPathTests.ConfigurationServiceTests testParseKanataErrors_NoErrorTags]' started.
Test Case '-[KeyPathTests.ConfigurationServiceTests testParseKanataErrors_NoErrorTags]' passed (0.000 seconds).
Test Case '-[KeyPathTests.ConfigurationServiceTests testParseKanataErrors_WithErrorTags]' started.
Test Case '-[KeyPathTests.ConfigurationServiceTests testParseKanataErrors_WithErrorTags]' passed (0.000 seconds).
Test Case '-[KeyPathTests.ConfigurationServiceTests testReloadCreatesDefaultConfigWhenMissing]' started.
[2025-11-22 13:10:24.064] [INFO] [ConfigurationService.swift:385 reload()] âš ï¸ [ConfigService] Config missing at /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/KeyPathConfigTests_3DA9B41C-E782-43AA-B134-872F5B85CF8B/keypath.kbd â€“ creating default before reload
[2025-11-22 13:10:24.064] [INFO] [ConfigurationService.swift:483 createInitialConfigIfNeeded()] âœ… [ConfigService] Config directory created at /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/KeyPathConfigTests_3DA9B41C-E782-43AA-B134-872F5B85CF8B
[2025-11-22 13:10:24.064] [INFO] [ConfigurationService.swift:488 createInitialConfigIfNeeded()] âš ï¸ [ConfigService] No existing config found at /var/folders/nj/b7p4n70x5sl6q3x8cz3pn3zm0000gn/T/KeyPathConfigTests_3DA9B41C-E782-43AA-B134-872F5B85CF8B/keypath.kbd
[2025-11-22 13:10:24.064] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:10:24.064] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:10:24.064] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 725 characters
[2025-11-22 13:10:24.064] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:10:24.065] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 10 src keys, 10 layer keys, deduplicated to 10 unique mappings
[2025-11-22 13:10:24.065] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:10:24.065] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:10:24.065] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 0 mappings
[2025-11-22 13:10:24.065] [INFO] [ConfigurationService.swift:492 createInitialConfigIfNeeded()] âœ… [ConfigService] Created initial empty configuration
[2025-11-22 13:10:24.065] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 10 src keys, 10 layer keys, deduplicated to 10 unique mappings
Test Case '-[KeyPathTests.ConfigurationServiceTests testReloadCreatesDefaultConfigWhenMissing]' passed (0.002 seconds).
Test Case '-[KeyPathTests.ConfigurationServiceTests testRepairConfiguration_MismatchedLengths]' started.
[2025-11-22 13:10:24.066] [INFO] [ConfigurationService.swift:808 repairConfiguration(config:errors:mappings:)] ğŸ”§ [Config] Performing rule-based repair for 1 errors
Test Case '-[KeyPathTests.ConfigurationServiceTests testRepairConfiguration_MismatchedLengths]' passed (0.001 seconds).
Test Case '-[KeyPathTests.ConfigurationServiceTests testRepairConfiguration_MissingDefcfg]' started.
[2025-11-22 13:10:24.066] [INFO] [ConfigurationService.swift:808 repairConfiguration(config:errors:mappings:)] ğŸ”§ [Config] Performing rule-based repair for 1 errors
Test Case '-[KeyPathTests.ConfigurationServiceTests testRepairConfiguration_MissingDefcfg]' passed (0.000 seconds).
Test Case '-[KeyPathTests.ConfigurationServiceTests testRoundTrip_GenerateParseGenerate]' started.
[2025-11-22 13:10:24.067] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 12 src keys, 12 layer keys, deduplicated to 12 unique mappings
Test Case '-[KeyPathTests.ConfigurationServiceTests testRoundTrip_GenerateParseGenerate]' passed (0.001 seconds).
Test Case '-[KeyPathTests.ConfigurationServiceTests testSaveConfiguration_WithCustomRules]' started.
[2025-11-22 13:10:24.068] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:10:24.068] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:10:24.068] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 1442 characters
[2025-11-22 13:10:24.068] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:10:24.068] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 11 src keys, 11 layer keys, deduplicated to 11 unique mappings
[2025-11-22 13:10:24.068] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:10:24.068] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:10:24.068] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 2 mappings
Test Case '-[KeyPathTests.ConfigurationServiceTests testSaveConfiguration_WithCustomRules]' passed (0.001 seconds).
Test Case '-[KeyPathTests.ConfigurationServiceTests testSaveConfiguration_WithInputOutput]' started.
[2025-11-22 13:10:24.069] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:10:24.069] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:10:24.069] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 1063 characters
[2025-11-22 13:10:24.069] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:10:24.069] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 11 src keys, 11 layer keys, deduplicated to 11 unique mappings
[2025-11-22 13:10:24.069] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:10:24.069] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:10:24.069] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 1 mappings
Test Case '-[KeyPathTests.ConfigurationServiceTests testSaveConfiguration_WithInputOutput]' passed (0.001 seconds).
Test Case '-[KeyPathTests.ConfigurationServiceTests testSaveConfiguration_WithKeyMappings]' started.
[2025-11-22 13:10:24.070] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:10:24.070] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:10:24.070] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 1068 characters
[2025-11-22 13:10:24.070] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:10:24.070] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 11 src keys, 11 layer keys, deduplicated to 11 unique mappings
[2025-11-22 13:10:24.070] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:10:24.070] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:10:24.071] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 1 mappings
Test Case '-[KeyPathTests.ConfigurationServiceTests testSaveConfiguration_WithKeyMappings]' passed (0.001 seconds).
Test Case '-[KeyPathTests.ConfigurationServiceTests testSaveConfiguration_WithRuleCollections]' started.
[2025-11-22 13:10:24.071] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:10:24.071] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:10:24.071] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 1166 characters
[2025-11-22 13:10:24.071] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:10:24.072] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 11 src keys, 11 layer keys, deduplicated to 11 unique mappings
[2025-11-22 13:10:24.072] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:10:24.072] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:10:24.072] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 1 mappings
[2025-11-22 13:10:24.072] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 11 src keys, 11 layer keys, deduplicated to 11 unique mappings
Test Case '-[KeyPathTests.ConfigurationServiceTests testSaveConfiguration_WithRuleCollections]' passed (0.001 seconds).
Test Case '-[KeyPathTests.ConfigurationServiceTests testValidateConfigurationInTestModePasses]' started.
[2025-11-22 13:10:24.072] [INFO] [TestEnvironment.swift:82 forceTestMode] ğŸ§ª [TestEnvironment] Force test mode enabled
[2025-11-22 13:10:24.073] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:10:24.073] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 79 characters
[2025-11-22 13:10:24.073] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:10:24.073] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 1 src keys, 1 layer keys, deduplicated to 1 unique mappings
[2025-11-22 13:10:24.073] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
Test Case '-[KeyPathTests.ConfigurationServiceTests testValidateConfigurationInTestModePasses]' passed (0.000 seconds).
Test Case '-[KeyPathTests.ConfigurationServiceTests testValidateConfigurationInTestModeRejectsEmptyContent]' started.
[2025-11-22 13:10:24.073] [INFO] [TestEnvironment.swift:82 forceTestMode] ğŸ§ª [TestEnvironment] Force test mode enabled
[2025-11-22 13:10:24.073] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:10:24.073] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 3 characters
[2025-11-22 13:10:24.073] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:10:24.073] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
Test Case '-[KeyPathTests.ConfigurationServiceTests testValidateConfigurationInTestModeRejectsEmptyContent]' passed (0.000 seconds).
Test Case '-[KeyPathTests.ConfigurationServiceTests testValidateConfigViaFileSkipsBinaryInTestMode]' started.
[2025-11-22 13:10:24.073] [INFO] [TestEnvironment.swift:82 forceTestMode] ğŸ§ª [TestEnvironment] Force test mode enabled
[2025-11-22 13:10:24.073] [INFO] [ConfigurationService.swift:566 validateConfigViaFile()] âŒ [ConfigService] File validation skipped: Kanata binary missing at /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata
Test Case '-[KeyPathTests.ConfigurationServiceTests testValidateConfigViaFileSkipsBinaryInTestMode]' passed (0.000 seconds).
Test Suite 'ConfigurationServiceTests' passed at 2025-11-22 13:10:24.074.
	 Executed 40 tests, with 0 failures (0 unexpected) in 0.030 (0.035) seconds
Test Suite 'ContentViewDebounceTests' started at 2025-11-22 13:10:24.074.
Test Case '-[KeyPathTests.ContentViewDebounceTests testConfigurationSaveDebouncing]' started.
[2025-11-22 13:10:24.074] [INFO] [KanataManager.swift:331 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] init() called
[2025-11-22 13:10:24.074] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:10:24.074] [INFO] [ConfigFileWatcher.swift:40 init()] ğŸ“ [FileWatcher] ConfigFileWatcher initialized with robust monitoring
[2025-11-22 13:10:24.074] [INFO] [ServiceHealthMonitor.swift:140 init(processLifecycle:)] [HealthMonitor] Initialized with process lifecycle manager
[2025-11-22 13:10:24.074] [DEBUG] [KanataManager.swift:403 init(engineClient:injectedConfigurationService:)] ğŸ§ª [KanataManager] Skipping background initialization in test environment
[2025-11-22 13:10:24.074] [INFO] [KanataManager.swift:411 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] About to call bootstrapRuleCollections and startLayerMonitoring
[2025-11-22 13:10:24.074] [INFO] [KanataManager.swift:583 startLayerMonitoring()] ğŸŒ [KanataManager] startLayerMonitoring() called
[2025-11-22 13:10:24.074] [INFO] [KanataManager.swift:585 startLayerMonitoring()] ğŸŒ [KanataManager] Skipping layer monitoring (test environment)
[2025-11-22 13:10:24.074] [INFO] [KanataManager.swift:415 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] init() completed
[2025-11-22 13:10:24.074] [INFO] [ContentViewDebounceTests.swift:38 testConfigurationSaveDebouncing()] âœ… [Test] Configuration debouncing behavior verified
Test Case '-[KeyPathTests.ContentViewDebounceTests testConfigurationSaveDebouncing]' passed (0.001 seconds).
Test Case '-[KeyPathTests.ContentViewDebounceTests testConfigurationSaveFlow]' started.
[2025-11-22 13:10:24.075] [INFO] [KanataManager.swift:331 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] init() called
[2025-11-22 13:10:24.075] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:10:24.075] [INFO] [ConfigFileWatcher.swift:40 init()] ğŸ“ [FileWatcher] ConfigFileWatcher initialized with robust monitoring
[2025-11-22 13:10:24.075] [INFO] [ServiceHealthMonitor.swift:140 init(processLifecycle:)] [HealthMonitor] Initialized with process lifecycle manager
[2025-11-22 13:10:24.075] [DEBUG] [KanataManager.swift:403 init(engineClient:injectedConfigurationService:)] ğŸ§ª [KanataManager] Skipping background initialization in test environment
[2025-11-22 13:10:24.075] [INFO] [KanataManager.swift:411 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] About to call bootstrapRuleCollections and startLayerMonitoring
[2025-11-22 13:10:24.075] [INFO] [KanataManager.swift:583 startLayerMonitoring()] ğŸŒ [KanataManager] startLayerMonitoring() called
[2025-11-22 13:10:24.075] [INFO] [KanataManager.swift:585 startLayerMonitoring()] ğŸŒ [KanataManager] Skipping layer monitoring (test environment)
[2025-11-22 13:10:24.075] [INFO] [KanataManager.swift:415 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] init() completed
[2025-11-22 13:10:24.075] [INFO] [ContentViewDebounceTests.swift:81 testConfigurationSaveFlow()] âœ… [Test] Configuration save flow structure verified
Test Case '-[KeyPathTests.ContentViewDebounceTests testConfigurationSaveFlow]' passed (0.001 seconds).
Test Case '-[KeyPathTests.ContentViewDebounceTests testErrorHandlingPreservesUIState]' started.
[2025-11-22 13:10:24.076] [INFO] [KanataManager.swift:331 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] init() called
[2025-11-22 13:10:24.076] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:10:24.076] [INFO] [ConfigFileWatcher.swift:40 init()] ğŸ“ [FileWatcher] ConfigFileWatcher initialized with robust monitoring
[2025-11-22 13:10:24.076] [INFO] [ServiceHealthMonitor.swift:140 init(processLifecycle:)] [HealthMonitor] Initialized with process lifecycle manager
[2025-11-22 13:10:24.076] [DEBUG] [KanataManager.swift:403 init(engineClient:injectedConfigurationService:)] ğŸ§ª [KanataManager] Skipping background initialization in test environment
[2025-11-22 13:10:24.076] [INFO] [KanataManager.swift:411 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] About to call bootstrapRuleCollections and startLayerMonitoring
[2025-11-22 13:10:24.076] [INFO] [KanataManager.swift:583 startLayerMonitoring()] ğŸŒ [KanataManager] startLayerMonitoring() called
[2025-11-22 13:10:24.076] [INFO] [KanataManager.swift:585 startLayerMonitoring()] ğŸŒ [KanataManager] Skipping layer monitoring (test environment)
[2025-11-22 13:10:24.076] [INFO] [KanataManager.swift:415 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] init() completed
[2025-11-22 13:10:24.076] [INFO] [ContentViewDebounceTests.swift:53 testErrorHandlingPreservesUIState()] âœ… [Test] Error handling structure verified
Test Case '-[KeyPathTests.ContentViewDebounceTests testErrorHandlingPreservesUIState]' passed (0.000 seconds).
Test Case '-[KeyPathTests.ContentViewDebounceTests testMultipleConcurrentSaves]' started.
[2025-11-22 13:10:24.076] [INFO] [KanataManager.swift:331 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] init() called
[2025-11-22 13:10:24.076] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:10:24.076] [INFO] [ConfigFileWatcher.swift:40 init()] ğŸ“ [FileWatcher] ConfigFileWatcher initialized with robust monitoring
[2025-11-22 13:10:24.076] [INFO] [ServiceHealthMonitor.swift:140 init(processLifecycle:)] [HealthMonitor] Initialized with process lifecycle manager
[2025-11-22 13:10:24.076] [DEBUG] [KanataManager.swift:403 init(engineClient:injectedConfigurationService:)] ğŸ§ª [KanataManager] Skipping background initialization in test environment
[2025-11-22 13:10:24.076] [INFO] [KanataManager.swift:411 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] About to call bootstrapRuleCollections and startLayerMonitoring
[2025-11-22 13:10:24.076] [INFO] [KanataManager.swift:583 startLayerMonitoring()] ğŸŒ [KanataManager] startLayerMonitoring() called
[2025-11-22 13:10:24.076] [INFO] [KanataManager.swift:585 startLayerMonitoring()] ğŸŒ [KanataManager] Skipping layer monitoring (test environment)
[2025-11-22 13:10:24.076] [INFO] [KanataManager.swift:415 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] init() completed
[2025-11-22 13:10:24.076] [INFO] [ContentViewDebounceTests.swift:91 testMultipleConcurrentSaves()] ğŸ§ª [Test] Starting concurrent save task 1
[2025-11-22 13:10:24.077] [INFO] [ContentViewDebounceTests.swift:99 testMultipleConcurrentSaves()] ğŸ§ª [Test] Completed concurrent save task 1
[2025-11-22 13:10:24.077] [INFO] [ContentViewDebounceTests.swift:91 testMultipleConcurrentSaves()] ğŸ§ª [Test] Starting concurrent save task 2
[2025-11-22 13:10:24.077] [INFO] [ContentViewDebounceTests.swift:99 testMultipleConcurrentSaves()] ğŸ§ª [Test] Completed concurrent save task 2
[2025-11-22 13:10:24.077] [INFO] [ContentViewDebounceTests.swift:91 testMultipleConcurrentSaves()] ğŸ§ª [Test] Starting concurrent save task 3
[2025-11-22 13:10:24.077] [INFO] [ContentViewDebounceTests.swift:99 testMultipleConcurrentSaves()] ğŸ§ª [Test] Completed concurrent save task 3
[2025-11-22 13:10:24.077] [INFO] [KanataManager.swift:609 updateActiveLayerName(_:)] ğŸ¯ [KanataManager] updateActiveLayerName: raw='base' normalized='base' display='Base' current='Base'
[2025-11-22 13:10:24.077] [INFO] [KanataManager.swift:609 updateActiveLayerName(_:)] ğŸ¯ [KanataManager] updateActiveLayerName: raw='base' normalized='base' display='Base' current='Base'
[2025-11-22 13:10:24.077] [INFO] [ContentViewDebounceTests.swift:108 testMultipleConcurrentSaves()] âœ… [Test] Concurrent saves handled successfully
Test Case '-[KeyPathTests.ContentViewDebounceTests testMultipleConcurrentSaves]' passed (0.001 seconds).
Test Suite 'ContentViewDebounceTests' passed at 2025-11-22 13:10:24.077.
	 Executed 4 tests, with 0 failures (0 unexpected) in 0.003 (0.003) seconds
Test Suite 'CustomRulesStoreTests' started at 2025-11-22 13:10:24.077.
Test Case '-[KeyPathTests.CustomRulesStoreTests testLoadGracefullyHandlesCorruptData]' started.
[2025-11-22 13:10:24.077] [INFO] [KanataManager.swift:609 updateActiveLayerName(_:)] ğŸ¯ [KanataManager] updateActiveLayerName: raw='base' normalized='base' display='Base' current='Base'
[2025-11-22 13:10:24.077] [INFO] [KanataManager.swift:609 updateActiveLayerName(_:)] ğŸ¯ [KanataManager] updateActiveLayerName: raw='base' normalized='base' display='Base' current='Base'
[2025-11-22 13:10:24.077] [INFO] [KanataManager.swift:609 updateActiveLayerName(_:)] ğŸ¯ [KanataManager] updateActiveLayerName: raw='base' normalized='base' display='Base' current='Base'
[2025-11-22 13:10:24.077] [INFO] [KanataManager.swift:609 updateActiveLayerName(_:)] ğŸ¯ [KanataManager] updateActiveLayerName: raw='base' normalized='base' display='Base' current='Base'
[2025-11-22 13:10:24.077] [INFO] [KanataManager.swift:609 updateActiveLayerName(_:)] ğŸ¯ [KanataManager] updateActiveLayerName: raw='base' normalized='base' display='Base' current='Base'
[2025-11-22 13:10:24.077] [INFO] [KanataManager.swift:609 updateActiveLayerName(_:)] ğŸ¯ [KanataManager] updateActiveLayerName: raw='base' normalized='base' display='Base' current='Base'
[2025-11-22 13:10:24.078] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:10:24.078] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:10:24.078] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 3827 characters
[2025-11-22 13:10:24.078] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:10:24.079] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 18 src keys, 88 layer keys, deduplicated to 18 unique mappings
[2025-11-22 13:10:24.079] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:10:24.079] [INFO] [CustomRulesStore.swift:35 loadRules()] âš ï¸ [CustomRulesStore] Failed to load rules: dataCorrupted(Swift.DecodingError.Context(codingPath: [], debugDescription: "The given data was not valid JSON.", underlyingError: Optional(Error Domain=NSCocoaErrorDomain Code=3840 "Unexpected character 'o' in expected null value around line 1, column 2." UserInfo={NSDebugDescription=Unexpected character 'o' in expected null value around line 1, column 2., NSJSONSerializationErrorIndex=1})))
[2025-11-22 13:10:24.079] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
Test Case '-[KeyPathTests.CustomRulesStoreTests testLoadGracefullyHandlesCorruptData]' passed (0.002 seconds).
Test Case '-[KeyPathTests.CustomRulesStoreTests testLoadReturnsEmptyWhenFileMissing]' started.
[2025-11-22 13:10:24.080] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:10:24.080] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:10:24.080] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 3827 characters
[2025-11-22 13:10:24.080] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:10:24.080] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 18 src keys, 88 layer keys, deduplicated to 18 unique mappings
[2025-11-22 13:10:24.080] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:10:24.080] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:10:24.080] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 18 mappings
[2025-11-22 13:10:24.080] [DEBUG] [KanataManager+Configuration.swift:53 triggerConfigReload()] ğŸ“¡ [Reload] Attempting TCP reload
[2025-11-22 13:10:24.080] [DEBUG] [KanataManager+Configuration.swift:84 triggerTCPReload()] ğŸ§ª [TCP Reload] Skipping TCP reload in test environment
[2025-11-22 13:10:24.080] [DEBUG] [KanataManager+Configuration.swift:65 triggerConfigReload()] ğŸ“¡ [Reload] TCP reload failed: Test environment - TCP disabled
[2025-11-22 13:10:24.080] [WARN] [KanataManager+Configuration.swift:68 triggerConfigReload()] âš ï¸ [Reload] Falling back to service restart
[2025-11-22 13:10:24.080] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:10:24.080] [INFO] [SystemValidator.swift:63 init(launchDaemonInstaller:vhidDeviceManager:processLifecycleManager:kanataManager:)] ğŸ” [SystemValidator] Initialized (stateless, no cache)
[2025-11-22 13:10:24.080] [INFO] [InstallerEngine.swift:35 init(processLifecycleManager:kanataManager:)] ğŸ”§ [InstallerEngine] Initialized
[2025-11-22 13:10:24.080] [INFO] [PrivilegedOperationsCoordinator.swift:35 init()] ğŸ” [PrivCoordinator] Initialized with operation mode: directSudo
[2025-11-22 13:10:24.080] [INFO] [InstallerEngine.swift:612 run(intent:using:)] ğŸš€ [InstallerEngine] Starting run(intent: repair, using:)
[2025-11-22 13:10:24.080] [INFO] [InstallerEngine.swift:53 inspectSystem()] ğŸ” [InstallerEngine] Starting inspectSystem()
Test Case '-[KeyPathTests.CustomRulesStoreTests testLoadReturnsEmptyWhenFileMissing]' passed (0.001 seconds).
Test Case '-[KeyPathTests.CustomRulesStoreTests testSaveAndLoadRoundTrip]' started.
[2025-11-22 13:10:24.081] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:10:24.081] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:10:24.081] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 3827 characters
[2025-11-22 13:10:24.081] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:10:24.081] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 18 src keys, 88 layer keys, deduplicated to 18 unique mappings
[2025-11-22 13:10:24.081] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:10:24.081] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:10:24.081] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:10:24.081] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:10:24.082] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 3827 characters
[2025-11-22 13:10:24.082] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:10:24.082] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 18 src keys, 88 layer keys, deduplicated to 18 unique mappings
[2025-11-22 13:10:24.082] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:10:24.082] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:10:24.082] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 18 mappings
[2025-11-22 13:10:24.082] [DEBUG] [KanataManager+Configuration.swift:53 triggerConfigReload()] ğŸ“¡ [Reload] Attempting TCP reload
[2025-11-22 13:10:24.082] [DEBUG] [KanataManager+Configuration.swift:84 triggerTCPReload()] ğŸ§ª [TCP Reload] Skipping TCP reload in test environment
[2025-11-22 13:10:24.082] [DEBUG] [KanataManager+Configuration.swift:65 triggerConfigReload()] ğŸ“¡ [Reload] TCP reload failed: Test environment - TCP disabled
[2025-11-22 13:10:24.082] [WARN] [KanataManager+Configuration.swift:68 triggerConfigReload()] âš ï¸ [Reload] Falling back to service restart
[2025-11-22 13:10:24.082] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:10:24.082] [INFO] [SystemValidator.swift:63 init(launchDaemonInstaller:vhidDeviceManager:processLifecycleManager:kanataManager:)] ğŸ” [SystemValidator] Initialized (stateless, no cache)
[2025-11-22 13:10:24.082] [INFO] [InstallerEngine.swift:35 init(processLifecycleManager:kanataManager:)] ğŸ”§ [InstallerEngine] Initialized
[2025-11-22 13:10:24.082] [INFO] [InstallerEngine.swift:612 run(intent:using:)] ğŸš€ [InstallerEngine] Starting run(intent: repair, using:)
[2025-11-22 13:10:24.082] [INFO] [InstallerEngine.swift:53 inspectSystem()] ğŸ” [InstallerEngine] Starting inspectSystem()
[2025-11-22 13:10:24.082] [INFO] [SystemValidator.swift:143 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Starting validation #1
[2025-11-22 13:10:24.082] [INFO] [SystemValidator.swift:174 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 START: 1763845824.082
Test Case '-[KeyPathTests.CustomRulesStoreTests testSaveAndLoadRoundTrip]' passed (0.002 seconds).
Test Suite 'CustomRulesStoreTests' passed at 2025-11-22 13:10:24.082.
	 Executed 3 tests, with 0 failures (0 unexpected) in 0.005 (0.005) seconds
Test Suite 'DiagnosticsServiceTests' started at 2025-11-22 13:10:24.082.
Test Case '-[KeyPathTests.DiagnosticsServiceTests testAnalyzeLogFileNotFound]' started.
[2025-11-22 13:10:24.082] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:10:24.082] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 18 mappings
[2025-11-22 13:10:24.082] [DEBUG] [KanataManager+Configuration.swift:53 triggerConfigReload()] ğŸ“¡ [Reload] Attempting TCP reload
[2025-11-22 13:10:24.082] [DEBUG] [KanataManager+Configuration.swift:84 triggerTCPReload()] ğŸ§ª [TCP Reload] Skipping TCP reload in test environment
[2025-11-22 13:10:24.082] [DEBUG] [KanataManager+Configuration.swift:65 triggerConfigReload()] ğŸ“¡ [Reload] TCP reload failed: Test environment - TCP disabled
[2025-11-22 13:10:24.082] [WARN] [KanataManager+Configuration.swift:68 triggerConfigReload()] âš ï¸ [Reload] Falling back to service restart
[2025-11-22 13:10:24.082] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:10:24.082] [INFO] [SystemValidator.swift:63 init(launchDaemonInstaller:vhidDeviceManager:processLifecycleManager:kanataManager:)] ğŸ” [SystemValidator] Initialized (stateless, no cache)
[2025-11-22 13:10:24.082] [INFO] [InstallerEngine.swift:35 init(processLifecycleManager:kanataManager:)] ğŸ”§ [InstallerEngine] Initialized
[2025-11-22 13:10:24.082] [INFO] [InstallerEngine.swift:612 run(intent:using:)] ğŸš€ [InstallerEngine] Starting run(intent: repair, using:)
[2025-11-22 13:10:24.082] [INFO] [InstallerEngine.swift:53 inspectSystem()] ğŸ” [InstallerEngine] Starting inspectSystem()
[2025-11-22 13:10:24.082] [INFO] [SystemValidator.swift:133 performValidationBody(progressCallback:)] âš ï¸ [SystemValidator] RAPID VALIDATION: 0.001s since last validation
This might indicate automatic triggers. Expected: manual user actions only.
[2025-11-22 13:10:24.082] [INFO] [SystemValidator.swift:143 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Starting validation #1
[2025-11-22 13:10:24.082] [INFO] [SystemValidator.swift:174 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 START: 1763845824.082
[2025-11-22 13:10:24.083] [INFO] [SystemValidator.swift:312 checkHelper()] ğŸ” [SystemValidator] Checking privileged helper
[2025-11-22 13:10:24.083] [INFO] [HelperManager.swift:64 init()] ğŸ”§ [HelperManager] Initialized
[2025-11-22 13:10:24.083] [INFO] [SystemValidator.swift:344 checkPermissions()] ğŸ” [SystemValidator] Checking permissions via Oracle
[2025-11-22 13:10:24.083] [INFO] [PermissionOracle.swift:135 init()] ğŸ”® [Oracle] Permission Oracle initialized - ending the chaos!
[2025-11-22 13:10:24.083] [INFO] [SystemValidator.swift:365 checkComponents()] ğŸ” [SystemValidator] Checking components
[2025-11-22 13:10:24.083] [INFO] [KanataBinaryDetector.swift:66 detectCurrentStatus()] ğŸ” [KanataBinaryDetector] Starting unified kanata binary detection
[2025-11-22 13:10:24.083] [INFO] [PermissionOracle.swift:173 currentSnapshot()] ğŸ”® [Oracle] Test mode snapshot generated (non-blocking)
[2025-11-22 13:10:24.083] [INFO] [KanataBinaryDetector.swift:81 detectCurrentStatus()] âŒ [KanataBinaryDetector] No kanata binary found
[2025-11-22 13:10:24.083] [INFO] [VHIDDeviceManager.swift:50 detectInstallation()] ğŸ” [VHIDManager] Manager app exists at /Applications/.Karabiner-VirtualHIDDevice-Manager.app/Contents/MacOS/Karabiner-VirtualHIDDevice-Manager: true
[2025-11-22 13:10:24.088] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:10:24.092] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:10:24.109] [INFO] [HelperManager.swift:830 verifyEmbeddedHelperSignature()] ğŸ”’ [HelperManager] Embedded helper signature looks valid
[2025-11-22 13:10:24.109] [INFO] [HelperManager.swift:105 getConnection()] ğŸ”— [HelperManager] Creating XPC connection to com.keypath.helper
[2025-11-22 13:10:24.109] [INFO] [HelperManager.swift:129 getConnection()] âœ… [HelperManager] XPC connection established (PID: 0)
[2025-11-22 13:10:24.109] [INFO] [HelperManager.swift:228 getHelperVersion()] ğŸ“¤ [HelperManager] Calling proxy.getVersion()
[2025-11-22 13:10:24.109] [INFO] [HelperManager.swift:243 getHelperVersion()] ğŸ“¤ [HelperManager] proxy.getVersion() call dispatched, waiting for callback
[2025-11-22 13:10:24.111] [INFO] [HelperManager.swift:121 getConnection()] âš ï¸ [HelperManager] XPC connection interrupted - will reconnect
[2025-11-22 13:10:24.111] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:10:24.112] [INFO] [HelperManager.swift:578 getRemoteProxy(errorHandler:)] âŒ [HelperManager] XPC proxy error: Couldnâ€™t communicate with a helper application.
[2025-11-22 13:10:24.112] [INFO] [HelperManager.swift:584 getRemoteProxy(errorHandler:)] âš ï¸ [HelperManager] XPC connection interrupted - this may indicate:
[2025-11-22 13:10:24.112] [INFO] [HelperManager.swift:585 getRemoteProxy(errorHandler:)]    1. Helper signature validation failed (app updated but not restarted)
[2025-11-22 13:10:24.112] [INFO] [HelperManager.swift:587 getRemoteProxy(errorHandler:)]    2. Helper process crashed
[2025-11-22 13:10:24.112] [INFO] [HelperManager.swift:588 getRemoteProxy(errorHandler:)]    3. Helper was killed by the system
[2025-11-22 13:10:24.112] [INFO] [HelperManager.swift:589 getRemoteProxy(errorHandler:)] ğŸ’¡ If you just updated KeyPath, try restarting the app
[2025-11-22 13:10:24.112] [INFO] [HelperManager.swift:116 getConnection()] âŒ [HelperManager] XPC connection invalidated
[2025-11-22 13:10:24.112] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:10:24.151] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.068s)
[2025-11-22 13:10:24.151] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:10:24.723] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.068s)
[2025-11-22 13:10:24.724] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:10:24.724] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:10:24.724] [INFO] [VHIDDeviceManager.swift:343 getInstalledVersion()] ğŸ” [VHIDManager] Installed daemon version: 5.0.0
[2025-11-22 13:10:24.724] [INFO] [VHIDDeviceManager.swift:374 hasVersionMismatch()] âœ… [VHIDManager] Version compatible: v5.0.0
[2025-11-22 13:10:24.724] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:10:24.792] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:10:24.795] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:10:24.795] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:10:24.795] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:10:24.795] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:10:24.795] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:10:24.795] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:10:24.795] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:10:24.795] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:10:24.795] [INFO] [LaunchDaemonInstaller.swift:669 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Kanata service state: Uninstalled
[2025-11-22 13:10:24.795] [INFO] [LaunchDaemonInstaller.swift:696 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Service not installed (state: Uninstalled)
[2025-11-22 13:10:24.795] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:10:24.863] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:10:24.931] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhiddaemon loaded: false
[2025-11-22 13:10:25.000] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhidmanager loaded: false
[2025-11-22 13:10:25.000] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:10:25.068] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:10:25.068] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhidmanager
[2025-11-22 13:10:25.134] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhidmanager not found in system domain
[2025-11-22 13:10:25.134] [INFO] [SystemValidator.swift:393 checkComponents()] ğŸ” [SystemValidator] Components: kanata=false, driver=true, daemon=false, vhid=false, vhidVersionMismatch=false
[2025-11-22 13:10:25.134] [INFO] [SystemValidator.swift:220 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 3 (Components) completed in 1.052s
[2025-11-22 13:10:25.134] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 20% (1/5 steps)
[2025-11-22 13:10:25.134] [INFO] [SystemValidator.swift:411 checkConflicts()] ğŸ” [SystemValidator] Checking for conflicts
[2025-11-22 13:10:25.134] [INFO] [ProcessLifecycleManager.swift:117 detectConflicts()] ğŸ” [ProcessLifecycleManager] Detecting conflicts...
[2025-11-22 13:10:25.134] [INFO] [ProcessLifecycleManager.swift:121 detectConflicts()] ğŸ§ª [TestEnvironment] Skipping process conflict detection - returning clean state
[2025-11-22 13:10:25.134] [INFO] [SystemValidator.swift:436 checkConflicts()] ğŸ” [SystemValidator] Total conflicts: 0 (0 kanata, 0 karabiner)
[2025-11-22 13:10:25.135] [INFO] [SystemValidator.swift:477 checkHealth()] ğŸ” [SystemValidator] Checking system health
[2025-11-22 13:10:25.135] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:10:25.135] [INFO] [SystemValidator.swift:229 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 4 (Conflicts) completed in 1.053s
[2025-11-22 13:10:25.135] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 40% (2/5 steps)
[2025-11-22 13:10:25.202] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:10:25.202] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:10:25.271] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:10:25.337] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.066s)
[2025-11-22 13:10:25.337] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:10:25.911] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.069s)
[2025-11-22 13:10:25.911] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:10:25.911] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:10:25.911] [INFO] [SystemValidator.swift:487 checkHealth()] ğŸ” [SystemValidator] Health: kanata=false, daemon=false (launchctl), vhid=false
[2025-11-22 13:10:25.911] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 18 mappings
[2025-11-22 13:10:25.911] [INFO] [SystemValidator.swift:238 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 5 (Health) completed in 1.829s
[2025-11-22 13:10:25.911] [DEBUG] [KanataManager+Configuration.swift:53 triggerConfigReload()] ğŸ“¡ [Reload] Attempting TCP reload
[2025-11-22 13:10:25.911] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 60% (3/5 steps)
[2025-11-22 13:10:25.911] [DEBUG] [KanataManager+Configuration.swift:84 triggerTCPReload()] ğŸ§ª [TCP Reload] Skipping TCP reload in test environment
[2025-11-22 13:10:25.911] [DEBUG] [KanataManager+Configuration.swift:65 triggerConfigReload()] ğŸ“¡ [Reload] TCP reload failed: Test environment - TCP disabled
[2025-11-22 13:10:25.911] [WARN] [KanataManager+Configuration.swift:68 triggerConfigReload()] âš ï¸ [Reload] Falling back to service restart
[2025-11-22 13:10:25.911] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:10:25.911] [INFO] [SystemValidator.swift:63 init(launchDaemonInstaller:vhidDeviceManager:processLifecycleManager:kanataManager:)] ğŸ” [SystemValidator] Initialized (stateless, no cache)
[2025-11-22 13:10:25.911] [INFO] [InstallerEngine.swift:35 init(processLifecycleManager:kanataManager:)] ğŸ”§ [InstallerEngine] Initialized
[2025-11-22 13:10:25.911] [INFO] [InstallerEngine.swift:612 run(intent:using:)] ğŸš€ [InstallerEngine] Starting run(intent: repair, using:)
[2025-11-22 13:10:25.911] [INFO] [InstallerEngine.swift:53 inspectSystem()] ğŸ” [InstallerEngine] Starting inspectSystem()
[2025-11-22 13:10:25.912] [INFO] [SystemValidator.swift:143 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Starting validation #1
[2025-11-22 13:10:25.912] [INFO] [SystemValidator.swift:174 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 START: 1763845825.912
[2025-11-22 13:10:25.912] [INFO] [SystemValidator.swift:312 checkHelper()] ğŸ” [SystemValidator] Checking privileged helper
[2025-11-22 13:10:25.912] [INFO] [SystemValidator.swift:344 checkPermissions()] ğŸ” [SystemValidator] Checking permissions via Oracle
[2025-11-22 13:10:25.912] [INFO] [SystemValidator.swift:365 checkComponents()] ğŸ” [SystemValidator] Checking components
[2025-11-22 13:10:25.912] [INFO] [KanataBinaryDetector.swift:66 detectCurrentStatus()] ğŸ” [KanataBinaryDetector] Starting unified kanata binary detection
[2025-11-22 13:10:25.912] [INFO] [PermissionOracle.swift:173 currentSnapshot()] ğŸ”® [Oracle] Test mode snapshot generated (non-blocking)
[2025-11-22 13:10:25.912] [INFO] [KanataBinaryDetector.swift:81 detectCurrentStatus()] âŒ [KanataBinaryDetector] No kanata binary found
[2025-11-22 13:10:25.912] [INFO] [VHIDDeviceManager.swift:50 detectInstallation()] ğŸ” [VHIDManager] Manager app exists at /Applications/.Karabiner-VirtualHIDDevice-Manager.app/Contents/MacOS/Karabiner-VirtualHIDDevice-Manager: true
[2025-11-22 13:10:25.919] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:10:25.925] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:10:25.945] [INFO] [HelperManager.swift:830 verifyEmbeddedHelperSignature()] ğŸ”’ [HelperManager] Embedded helper signature looks valid
[2025-11-22 13:10:25.945] [INFO] [HelperManager.swift:105 getConnection()] ğŸ”— [HelperManager] Creating XPC connection to com.keypath.helper
[2025-11-22 13:10:25.945] [INFO] [HelperManager.swift:129 getConnection()] âœ… [HelperManager] XPC connection established (PID: 0)
[2025-11-22 13:10:25.945] [INFO] [HelperManager.swift:228 getHelperVersion()] ğŸ“¤ [HelperManager] Calling proxy.getVersion()
[2025-11-22 13:10:25.945] [INFO] [HelperManager.swift:243 getHelperVersion()] ğŸ“¤ [HelperManager] proxy.getVersion() call dispatched, waiting for callback
[2025-11-22 13:10:25.946] [INFO] [HelperManager.swift:121 getConnection()] âš ï¸ [HelperManager] XPC connection interrupted - will reconnect
[2025-11-22 13:10:25.946] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:10:25.946] [INFO] [HelperManager.swift:578 getRemoteProxy(errorHandler:)] âŒ [HelperManager] XPC proxy error: Couldnâ€™t communicate with a helper application.
[2025-11-22 13:10:25.946] [INFO] [HelperManager.swift:584 getRemoteProxy(errorHandler:)] âš ï¸ [HelperManager] XPC connection interrupted - this may indicate:
[2025-11-22 13:10:25.946] [INFO] [HelperManager.swift:585 getRemoteProxy(errorHandler:)]    1. Helper signature validation failed (app updated but not restarted)
[2025-11-22 13:10:25.946] [INFO] [HelperManager.swift:587 getRemoteProxy(errorHandler:)]    2. Helper process crashed
[2025-11-22 13:10:25.946] [INFO] [HelperManager.swift:588 getRemoteProxy(errorHandler:)]    3. Helper was killed by the system
[2025-11-22 13:10:25.946] [INFO] [HelperManager.swift:589 getRemoteProxy(errorHandler:)] ğŸ’¡ If you just updated KeyPath, try restarting the app
[2025-11-22 13:10:25.946] [INFO] [HelperManager.swift:116 getConnection()] âŒ [HelperManager] XPC connection invalidated
[2025-11-22 13:10:25.946] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:10:25.980] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.068s)
[2025-11-22 13:10:25.980] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:10:26.554] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.068s)
[2025-11-22 13:10:26.554] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:10:26.554] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:10:26.554] [INFO] [VHIDDeviceManager.swift:343 getInstalledVersion()] ğŸ” [VHIDManager] Installed daemon version: 5.0.0
[2025-11-22 13:10:26.554] [INFO] [VHIDDeviceManager.swift:374 hasVersionMismatch()] âœ… [VHIDManager] Version compatible: v5.0.0
[2025-11-22 13:10:26.554] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:10:26.622] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:10:26.622] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:10:26.622] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:10:26.622] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:10:26.622] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:10:26.623] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:10:26.623] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:10:26.623] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:10:26.623] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:10:26.623] [INFO] [LaunchDaemonInstaller.swift:669 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Kanata service state: Uninstalled
[2025-11-22 13:10:26.623] [INFO] [LaunchDaemonInstaller.swift:696 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Service not installed (state: Uninstalled)
[2025-11-22 13:10:26.623] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:10:26.691] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:10:26.759] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhiddaemon loaded: false
[2025-11-22 13:10:26.825] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhidmanager loaded: false
[2025-11-22 13:10:26.825] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:10:26.894] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:10:26.894] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhidmanager
[2025-11-22 13:10:26.961] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhidmanager not found in system domain
[2025-11-22 13:10:26.961] [INFO] [SystemValidator.swift:393 checkComponents()] ğŸ” [SystemValidator] Components: kanata=false, driver=true, daemon=false, vhid=false, vhidVersionMismatch=false
[2025-11-22 13:10:26.961] [INFO] [SystemValidator.swift:411 checkConflicts()] ğŸ” [SystemValidator] Checking for conflicts
[2025-11-22 13:10:26.961] [INFO] [SystemValidator.swift:220 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 3 (Components) completed in 2.879s
[2025-11-22 13:10:26.961] [INFO] [ProcessLifecycleManager.swift:117 detectConflicts()] ğŸ” [ProcessLifecycleManager] Detecting conflicts...
[2025-11-22 13:10:26.961] [INFO] [ProcessLifecycleManager.swift:121 detectConflicts()] ğŸ§ª [TestEnvironment] Skipping process conflict detection - returning clean state
[2025-11-22 13:10:26.961] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 20% (1/5 steps)
[2025-11-22 13:10:26.961] [INFO] [SystemValidator.swift:436 checkConflicts()] ğŸ” [SystemValidator] Total conflicts: 0 (0 kanata, 0 karabiner)
[2025-11-22 13:10:26.961] [INFO] [SystemValidator.swift:477 checkHealth()] ğŸ” [SystemValidator] Checking system health
[2025-11-22 13:10:26.961] [INFO] [SystemValidator.swift:229 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 4 (Conflicts) completed in 2.879s
[2025-11-22 13:10:26.961] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:10:26.961] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 40% (2/5 steps)
[2025-11-22 13:10:27.028] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:10:27.029] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:10:27.097] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:10:27.142] [INFO] [HelperManager.swift:248 getHelperVersion()] âš ï¸ [HelperManager] getVersion timed out - clearing connection cache
[2025-11-22 13:10:27.142] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:10:27.164] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.067s)
[2025-11-22 13:10:27.164] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:10:27.738] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.068s)
[2025-11-22 13:10:27.738] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:10:27.738] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:10:27.738] [INFO] [SystemValidator.swift:487 checkHealth()] ğŸ” [SystemValidator] Health: kanata=false, daemon=false (launchctl), vhid=false
[2025-11-22 13:10:27.738] [INFO] [SystemValidator.swift:238 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 5 (Health) completed in 3.656s
[2025-11-22 13:10:27.738] [INFO] [SystemValidator.swift:355 checkPermissions()] ğŸ” [SystemValidator] Oracle snapshot: ready=false, age=3.656s
[2025-11-22 13:10:27.738] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 60% (3/5 steps)
[2025-11-22 13:10:27.738] [INFO] [SystemValidator.swift:143 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Starting validation #1
[2025-11-22 13:10:27.738] [INFO] [SystemValidator.swift:211 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 2 (Permissions) completed in 3.656s
[2025-11-22 13:10:27.738] [INFO] [SystemValidator.swift:174 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 START: 1763845827.738
[2025-11-22 13:10:27.738] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 80% (4/5 steps)
Test Case '-[KeyPathTests.DiagnosticsServiceTests testAnalyzeLogFileNotFound]' passed (3.656 seconds).
Test Case '-[KeyPathTests.DiagnosticsServiceTests testAnalyzeLogFileWithCleanLogs]' started.
[2025-11-22 13:10:27.739] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:10:27.739] [INFO] [SystemValidator.swift:312 checkHelper()] ğŸ” [SystemValidator] Checking privileged helper
[2025-11-22 13:10:27.739] [INFO] [SystemValidator.swift:365 checkComponents()] ğŸ” [SystemValidator] Checking components
[2025-11-22 13:10:27.739] [INFO] [KanataBinaryDetector.swift:66 detectCurrentStatus()] ğŸ” [KanataBinaryDetector] Starting unified kanata binary detection
[2025-11-22 13:10:27.739] [INFO] [KanataBinaryDetector.swift:81 detectCurrentStatus()] âŒ [KanataBinaryDetector] No kanata binary found
[2025-11-22 13:10:27.739] [INFO] [VHIDDeviceManager.swift:50 detectInstallation()] ğŸ” [VHIDManager] Manager app exists at /Applications/.Karabiner-VirtualHIDDevice-Manager.app/Contents/MacOS/Karabiner-VirtualHIDDevice-Manager: true
[2025-11-22 13:10:27.747] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:10:27.752] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:10:27.769] [INFO] [HelperManager.swift:830 verifyEmbeddedHelperSignature()] ğŸ”’ [HelperManager] Embedded helper signature looks valid
[2025-11-22 13:10:27.769] [INFO] [HelperManager.swift:105 getConnection()] ğŸ”— [HelperManager] Creating XPC connection to com.keypath.helper
[2025-11-22 13:10:27.769] [INFO] [HelperManager.swift:129 getConnection()] âœ… [HelperManager] XPC connection established (PID: 0)
[2025-11-22 13:10:27.769] [INFO] [HelperManager.swift:228 getHelperVersion()] ğŸ“¤ [HelperManager] Calling proxy.getVersion()
[2025-11-22 13:10:27.769] [INFO] [HelperManager.swift:243 getHelperVersion()] ğŸ“¤ [HelperManager] proxy.getVersion() call dispatched, waiting for callback
[2025-11-22 13:10:27.770] [INFO] [HelperManager.swift:121 getConnection()] âš ï¸ [HelperManager] XPC connection interrupted - will reconnect
[2025-11-22 13:10:27.770] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:10:27.770] [INFO] [HelperManager.swift:578 getRemoteProxy(errorHandler:)] âŒ [HelperManager] XPC proxy error: Couldnâ€™t communicate with a helper application.
[2025-11-22 13:10:27.770] [INFO] [HelperManager.swift:584 getRemoteProxy(errorHandler:)] âš ï¸ [HelperManager] XPC connection interrupted - this may indicate:
[2025-11-22 13:10:27.770] [INFO] [HelperManager.swift:585 getRemoteProxy(errorHandler:)]    1. Helper signature validation failed (app updated but not restarted)
[2025-11-22 13:10:27.770] [INFO] [HelperManager.swift:587 getRemoteProxy(errorHandler:)]    2. Helper process crashed
[2025-11-22 13:10:27.770] [INFO] [HelperManager.swift:588 getRemoteProxy(errorHandler:)]    3. Helper was killed by the system
[2025-11-22 13:10:27.770] [INFO] [HelperManager.swift:589 getRemoteProxy(errorHandler:)] ğŸ’¡ If you just updated KeyPath, try restarting the app
[2025-11-22 13:10:27.770] [INFO] [HelperManager.swift:116 getConnection()] âŒ [HelperManager] XPC connection invalidated
[2025-11-22 13:10:27.770] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:10:27.807] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.068s)
[2025-11-22 13:10:27.807] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:10:28.380] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.067s)
[2025-11-22 13:10:28.380] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:10:28.380] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:10:28.380] [INFO] [VHIDDeviceManager.swift:343 getInstalledVersion()] ğŸ” [VHIDManager] Installed daemon version: 5.0.0
[2025-11-22 13:10:28.380] [INFO] [VHIDDeviceManager.swift:374 hasVersionMismatch()] âœ… [VHIDManager] Version compatible: v5.0.0
[2025-11-22 13:10:28.380] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:10:28.446] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:10:28.447] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:10:28.447] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:10:28.447] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:10:28.447] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:10:28.447] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:10:28.448] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:10:28.448] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:10:28.448] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:10:28.448] [INFO] [LaunchDaemonInstaller.swift:669 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Kanata service state: Uninstalled
[2025-11-22 13:10:28.448] [INFO] [LaunchDaemonInstaller.swift:696 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Service not installed (state: Uninstalled)
[2025-11-22 13:10:28.448] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:10:28.516] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:10:28.583] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhiddaemon loaded: false
[2025-11-22 13:10:28.651] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhidmanager loaded: false
[2025-11-22 13:10:28.651] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:10:28.719] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:10:28.719] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhidmanager
[2025-11-22 13:10:28.787] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhidmanager not found in system domain
[2025-11-22 13:10:28.787] [INFO] [SystemValidator.swift:393 checkComponents()] ğŸ” [SystemValidator] Components: kanata=false, driver=true, daemon=false, vhid=false, vhidVersionMismatch=false
[2025-11-22 13:10:28.787] [INFO] [SystemValidator.swift:220 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 3 (Components) completed in 2.876s
[2025-11-22 13:10:28.787] [INFO] [SystemValidator.swift:411 checkConflicts()] ğŸ” [SystemValidator] Checking for conflicts
[2025-11-22 13:10:28.787] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 20% (1/5 steps)
[2025-11-22 13:10:28.787] [INFO] [ProcessLifecycleManager.swift:117 detectConflicts()] ğŸ” [ProcessLifecycleManager] Detecting conflicts...
[2025-11-22 13:10:28.787] [INFO] [ProcessLifecycleManager.swift:121 detectConflicts()] ğŸ§ª [TestEnvironment] Skipping process conflict detection - returning clean state
[2025-11-22 13:10:28.787] [INFO] [SystemValidator.swift:436 checkConflicts()] ğŸ” [SystemValidator] Total conflicts: 0 (0 kanata, 0 karabiner)
[2025-11-22 13:10:28.787] [INFO] [SystemValidator.swift:477 checkHealth()] ğŸ” [SystemValidator] Checking system health
[2025-11-22 13:10:28.787] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:10:28.787] [INFO] [SystemValidator.swift:229 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 4 (Conflicts) completed in 2.876s
[2025-11-22 13:10:28.787] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 40% (2/5 steps)
[2025-11-22 13:10:28.855] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:10:28.855] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:10:28.922] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:10:28.990] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.068s)
[2025-11-22 13:10:28.990] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:10:29.001] [INFO] [HelperManager.swift:248 getHelperVersion()] âš ï¸ [HelperManager] getVersion timed out - clearing connection cache
[2025-11-22 13:10:29.001] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:10:29.564] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.068s)
[2025-11-22 13:10:29.564] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:10:29.564] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:10:29.564] [INFO] [SystemValidator.swift:487 checkHealth()] ğŸ” [SystemValidator] Health: kanata=false, daemon=false (launchctl), vhid=false
[2025-11-22 13:10:29.564] [INFO] [SystemValidator.swift:238 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 5 (Health) completed in 3.652s
[2025-11-22 13:10:29.564] [INFO] [SystemValidator.swift:344 checkPermissions()] ğŸ” [SystemValidator] Checking permissions via Oracle
[2025-11-22 13:10:29.564] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 60% (3/5 steps)
[2025-11-22 13:10:29.564] [INFO] [SystemValidator.swift:355 checkPermissions()] ğŸ” [SystemValidator] Oracle snapshot: ready=false, age=3.652s
[2025-11-22 13:10:29.564] [INFO] [PermissionOracle.swift:173 currentSnapshot()] ğŸ”® [Oracle] Test mode snapshot generated (non-blocking)
[2025-11-22 13:10:29.564] [INFO] [SystemValidator.swift:328 checkHelper()] ğŸ” [SystemValidator] Helper state: registeredButUnresponsive Helper registered but XPC communication failed
[2025-11-22 13:10:29.564] [INFO] [SystemValidator.swift:344 checkPermissions()] ğŸ” [SystemValidator] Checking permissions via Oracle
[2025-11-22 13:10:29.564] [INFO] [SystemValidator.swift:211 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 2 (Permissions) completed in 5.482s
[2025-11-22 13:10:29.564] [INFO] [SystemValidator.swift:312 checkHelper()] ğŸ” [SystemValidator] Checking privileged helper
[2025-11-22 13:10:29.564] [INFO] [SystemValidator.swift:202 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 1 (Helper) completed in 5.482s
[2025-11-22 13:10:29.564] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 80% (4/5 steps)
[2025-11-22 13:10:29.564] [INFO] [SystemValidator.swift:365 checkComponents()] ğŸ” [SystemValidator] Checking components
[2025-11-22 13:10:29.564] [INFO] [PermissionOracle.swift:158 currentSnapshot()] ğŸ”® [Oracle] (Test) Returning cached snapshot
[2025-11-22 13:10:29.564] [INFO] [KanataBinaryDetector.swift:66 detectCurrentStatus()] ğŸ” [KanataBinaryDetector] Starting unified kanata binary detection
[2025-11-22 13:10:29.564] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 100% (5/5 steps)
[2025-11-22 13:10:29.565] [INFO] [KanataBinaryDetector.swift:81 detectCurrentStatus()] âŒ [KanataBinaryDetector] No kanata binary found
[2025-11-22 13:10:29.565] [INFO] [VHIDDeviceManager.swift:50 detectInstallation()] ğŸ” [VHIDManager] Manager app exists at /Applications/.Karabiner-VirtualHIDDevice-Manager.app/Contents/MacOS/Karabiner-VirtualHIDDevice-Manager: true
[2025-11-22 13:10:29.572] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:10:29.578] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:10:29.596] [INFO] [HelperManager.swift:830 verifyEmbeddedHelperSignature()] ğŸ”’ [HelperManager] Embedded helper signature looks valid
[2025-11-22 13:10:29.596] [INFO] [HelperManager.swift:105 getConnection()] ğŸ”— [HelperManager] Creating XPC connection to com.keypath.helper
[2025-11-22 13:10:29.596] [INFO] [HelperManager.swift:129 getConnection()] âœ… [HelperManager] XPC connection established (PID: 0)
[2025-11-22 13:10:29.596] [INFO] [HelperManager.swift:228 getHelperVersion()] ğŸ“¤ [HelperManager] Calling proxy.getVersion()
[2025-11-22 13:10:29.596] [INFO] [HelperManager.swift:243 getHelperVersion()] ğŸ“¤ [HelperManager] proxy.getVersion() call dispatched, waiting for callback
[2025-11-22 13:10:29.597] [INFO] [HelperManager.swift:121 getConnection()] âš ï¸ [HelperManager] XPC connection interrupted - will reconnect
[2025-11-22 13:10:29.597] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:10:29.597] [INFO] [HelperManager.swift:578 getRemoteProxy(errorHandler:)] âŒ [HelperManager] XPC proxy error: Couldnâ€™t communicate with a helper application.
[2025-11-22 13:10:29.597] [INFO] [HelperManager.swift:584 getRemoteProxy(errorHandler:)] âš ï¸ [HelperManager] XPC connection interrupted - this may indicate:
[2025-11-22 13:10:29.597] [INFO] [HelperManager.swift:585 getRemoteProxy(errorHandler:)]    1. Helper signature validation failed (app updated but not restarted)
[2025-11-22 13:10:29.597] [INFO] [HelperManager.swift:587 getRemoteProxy(errorHandler:)]    2. Helper process crashed
[2025-11-22 13:10:29.597] [INFO] [HelperManager.swift:588 getRemoteProxy(errorHandler:)]    3. Helper was killed by the system
[2025-11-22 13:10:29.597] [INFO] [HelperManager.swift:589 getRemoteProxy(errorHandler:)] ğŸ’¡ If you just updated KeyPath, try restarting the app
[2025-11-22 13:10:29.597] [INFO] [HelperManager.swift:116 getConnection()] âŒ [HelperManager] XPC connection invalidated
[2025-11-22 13:10:29.597] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:10:29.633] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.068s)
[2025-11-22 13:10:29.633] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:10:30.206] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.068s)
[2025-11-22 13:10:30.206] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:10:30.206] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:10:30.206] [INFO] [VHIDDeviceManager.swift:343 getInstalledVersion()] ğŸ” [VHIDManager] Installed daemon version: 5.0.0
[2025-11-22 13:10:30.207] [INFO] [VHIDDeviceManager.swift:374 hasVersionMismatch()] âœ… [VHIDManager] Version compatible: v5.0.0
[2025-11-22 13:10:30.207] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:10:30.274] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:10:30.275] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:10:30.275] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:10:30.275] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:10:30.275] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:10:30.275] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:10:30.275] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:10:30.275] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:10:30.275] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:10:30.275] [INFO] [LaunchDaemonInstaller.swift:669 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Kanata service state: Uninstalled
[2025-11-22 13:10:30.275] [INFO] [LaunchDaemonInstaller.swift:696 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Service not installed (state: Uninstalled)
[2025-11-22 13:10:30.275] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:10:30.343] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:10:30.412] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhiddaemon loaded: false
[2025-11-22 13:10:30.478] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhidmanager loaded: false
[2025-11-22 13:10:30.478] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:10:30.546] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:10:30.546] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhidmanager
[2025-11-22 13:10:30.612] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhidmanager not found in system domain
[2025-11-22 13:10:30.612] [INFO] [SystemValidator.swift:393 checkComponents()] ğŸ” [SystemValidator] Components: kanata=false, driver=true, daemon=false, vhid=false, vhidVersionMismatch=false
[2025-11-22 13:10:30.613] [INFO] [SystemValidator.swift:220 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 3 (Components) completed in 2.874s
[2025-11-22 13:10:30.613] [INFO] [SystemValidator.swift:411 checkConflicts()] ğŸ” [SystemValidator] Checking for conflicts
[2025-11-22 13:10:30.613] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 20% (1/5 steps)
[2025-11-22 13:10:30.613] [INFO] [ProcessLifecycleManager.swift:117 detectConflicts()] ğŸ” [ProcessLifecycleManager] Detecting conflicts...
[2025-11-22 13:10:30.613] [INFO] [ProcessLifecycleManager.swift:121 detectConflicts()] ğŸ§ª [TestEnvironment] Skipping process conflict detection - returning clean state
[2025-11-22 13:10:30.613] [INFO] [SystemValidator.swift:436 checkConflicts()] ğŸ” [SystemValidator] Total conflicts: 0 (0 kanata, 0 karabiner)
[2025-11-22 13:10:30.613] [INFO] [SystemValidator.swift:477 checkHealth()] ğŸ” [SystemValidator] Checking system health
[2025-11-22 13:10:30.613] [INFO] [SystemValidator.swift:229 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 4 (Conflicts) completed in 2.874s
[2025-11-22 13:10:30.613] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:10:30.613] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 40% (2/5 steps)
[2025-11-22 13:10:30.680] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:10:30.681] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:10:30.749] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:10:30.816] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.067s)
[2025-11-22 13:10:30.816] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:10:30.840] [INFO] [HelperManager.swift:248 getHelperVersion()] âš ï¸ [HelperManager] getVersion timed out - clearing connection cache
[2025-11-22 13:10:30.840] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:10:31.391] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.069s)
[2025-11-22 13:10:31.391] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:10:31.391] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:10:31.391] [INFO] [SystemValidator.swift:487 checkHealth()] ğŸ” [SystemValidator] Health: kanata=false, daemon=false (launchctl), vhid=false
[2025-11-22 13:10:31.391] [INFO] [SystemValidator.swift:238 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 5 (Health) completed in 3.653s
[2025-11-22 13:10:31.391] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 60% (3/5 steps)
[2025-11-22 13:10:31.393] [INFO] [SystemValidator.swift:328 checkHelper()] ğŸ” [SystemValidator] Helper state: registeredButUnresponsive Helper registered but XPC communication failed
[2025-11-22 13:10:31.393] [INFO] [SystemValidator.swift:355 checkPermissions()] ğŸ” [SystemValidator] Oracle snapshot: ready=false, age=1.829s
[2025-11-22 13:10:31.393] [INFO] [SystemValidator.swift:202 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 1 (Helper) completed in 7.310s
[2025-11-22 13:10:31.393] [INFO] [SystemValidator.swift:355 checkPermissions()] ğŸ” [SystemValidator] Oracle snapshot: ready=false, age=1.829s
[2025-11-22 13:10:31.393] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 100% (5/5 steps)
[2025-11-22 13:10:31.393] [INFO] [SystemValidator.swift:283 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 COMPLETE: Total duration 7.311s
[2025-11-22 13:10:31.393] [INFO] [SystemValidator.swift:211 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 2 (Permissions) completed in 3.655s
[2025-11-22 13:10:31.393] [INFO] [SystemValidator.swift:297 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Validation #1 complete in 7.311s
[2025-11-22 13:10:31.393] [INFO] [SystemValidator.swift:211 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 2 (Permissions) completed in 5.481s
[2025-11-22 13:10:31.393] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 80% (4/5 steps)
[2025-11-22 13:10:31.393] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 80% (4/5 steps)
[2025-11-22 13:10:31.393] [INFO] [SystemValidator.swift:299 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Result: ready=false, blocking=9, total=9
[2025-11-22 13:10:31.393] [INFO] [SystemValidator.swift:328 checkHelper()] ğŸ” [SystemValidator] Helper state: registeredButUnresponsive Helper registered but XPC communication failed
[2025-11-22 13:10:31.393] [INFO] [SystemValidator.swift:202 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 1 (Helper) completed in 5.482s
[2025-11-22 13:10:31.393] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 100% (5/5 steps)
[2025-11-22 13:10:31.393] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:10:31.393] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:10:31.393] [INFO] [SystemRequirements.swift:135 validateSystemCompatibility()] ğŸ” [SystemRequirements] Validating system compatibility
[2025-11-22 13:10:31.393] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:10:31.393] [INFO] [SystemRequirements.swift:147 validateSystemCompatibility()] âœ… [SystemRequirements] Modern macOS detected: 26.0.1
[2025-11-22 13:10:31.393] [INFO] [SystemRequirements.swift:190 validateSystemCompatibility()] ğŸ” [SystemRequirements] Compatibility check complete: âœ… Compatible
[2025-11-22 13:10:31.393] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:10:31.393] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:10:31.393] [INFO] [InstallerEngine.swift:78 inspectSystem()] âœ… [InstallerEngine] inspectSystem() complete - ready=false, blocking=9
[2025-11-22 13:10:31.393] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: repair, context:)
[2025-11-22 13:10:31.393] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: repair
[2025-11-22 13:10:31.394] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:10:31.394] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:10:31.394] [INFO] [InstallerEngine.swift:390 execute(plan:using:)] âš™ï¸ [InstallerEngine] Starting execute(plan:, using:)
[2025-11-22 13:10:31.394] [INFO] [InstallerEngine.swift:409 execute(plan:using:)] âš™ï¸ [InstallerEngine] Executing recipe: install-bundled-kanata (type: installComponent)
[2025-11-22 13:10:31.394] [INFO] [PrivilegedOperationsCoordinator.swift:359 installBundledKanata()] ğŸ” [PrivCoordinator] Installing bundled Kanata binary
[2025-11-22 13:10:31.394] [INFO] [LaunchDaemonInstaller.swift:2898 installBundledKanataBinaryOnly()] ğŸ”§ [LaunchDaemon] Installing bundled kanata binary to system location
[2025-11-22 13:10:31.394] [INFO] [LaunchDaemonInstaller.swift:2906 installBundledKanataBinaryOnly()] âŒ [LaunchDaemon] CRITICAL: Bundled kanata binary not found at: /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata
[2025-11-22 13:10:31.394] [INFO] [LaunchDaemonInstaller.swift:2908 installBundledKanataBinaryOnly()] âŒ [LaunchDaemon] This indicates a packaging issue - the app bundle is missing the kanata binary
[2025-11-22 13:10:31.394] [INFO] [InstallerEngine.swift:451 execute(plan:using:)] âŒ [InstallerEngine] Recipe install-bundled-kanata failed: Operation failed: Bundled Kanata installation failed
[2025-11-22 13:10:31.394] [INFO] [InstallerEngine.swift:470 execute(plan:using:)] âœ… [InstallerEngine] execute() complete - success: false, recipes executed: 1
[2025-11-22 13:10:31.394] [INFO] [InstallerEngine.swift:625 run(intent:using:)] âœ… [InstallerEngine] run() complete - success: false
[2025-11-22 13:10:31.394] [INFO] [ConfigFileWatcher.swift:208 stopWatching()] ğŸ“ [FileWatcher] Stopping all monitoring...
[2025-11-22 13:10:31.394] [INFO] [ConfigFileWatcher.swift:237 stopWatching()] âœ… [FileWatcher] All monitoring stopped and state cleared
[2025-11-22 13:10:31.395] [INFO] [ConfigFileWatcher.swift:45 deinit] ğŸ“ [FileWatcher] ConfigFileWatcher deinitialized
[2025-11-22 13:10:31.395] [INFO] [LayerChangeListener.swift:27 stop()] ğŸŒ [LayerListener] Stopping layer listener
Test Case '-[KeyPathTests.DiagnosticsServiceTests testAnalyzeLogFileWithCleanLogs]' passed (3.656 seconds).
Test Case '-[KeyPathTests.DiagnosticsServiceTests testAnalyzeLogFileWithConnectionError]' started.
[2025-11-22 13:10:31.395] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:10:31.395] [INFO] [SystemValidator.swift:283 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 COMPLETE: Total duration 7.313s
[2025-11-22 13:10:31.395] [INFO] [SystemValidator.swift:297 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Validation #1 complete in 7.313s
[2025-11-22 13:10:31.395] [INFO] [SystemValidator.swift:299 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Result: ready=false, blocking=9, total=9
[2025-11-22 13:10:31.395] [INFO] [SystemValidator.swift:283 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 COMPLETE: Total duration 5.483s
[2025-11-22 13:10:31.395] [INFO] [SystemValidator.swift:297 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Validation #1 complete in 5.483s
[2025-11-22 13:10:31.395] [INFO] [SystemValidator.swift:299 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Result: ready=false, blocking=9, total=9
[2025-11-22 13:10:31.396] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:10:31.396] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:10:31.396] [INFO] [SystemRequirements.swift:135 validateSystemCompatibility()] ğŸ” [SystemRequirements] Validating system compatibility
[2025-11-22 13:10:31.396] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:10:31.396] [INFO] [SystemRequirements.swift:147 validateSystemCompatibility()] âœ… [SystemRequirements] Modern macOS detected: 26.0.1
[2025-11-22 13:10:31.396] [INFO] [SystemRequirements.swift:190 validateSystemCompatibility()] ğŸ” [SystemRequirements] Compatibility check complete: âœ… Compatible
[2025-11-22 13:10:31.396] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:10:31.396] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:10:31.396] [INFO] [InstallerEngine.swift:78 inspectSystem()] âœ… [InstallerEngine] inspectSystem() complete - ready=false, blocking=9
[2025-11-22 13:10:31.396] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: repair, context:)
[2025-11-22 13:10:31.396] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: repair
[2025-11-22 13:10:31.396] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:10:31.396] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:10:31.396] [INFO] [InstallerEngine.swift:390 execute(plan:using:)] âš™ï¸ [InstallerEngine] Starting execute(plan:, using:)
[2025-11-22 13:10:31.396] [INFO] [InstallerEngine.swift:409 execute(plan:using:)] âš™ï¸ [InstallerEngine] Executing recipe: install-bundled-kanata (type: installComponent)
[2025-11-22 13:10:31.396] [INFO] [PrivilegedOperationsCoordinator.swift:359 installBundledKanata()] ğŸ” [PrivCoordinator] Installing bundled Kanata binary
[2025-11-22 13:10:31.396] [INFO] [LaunchDaemonInstaller.swift:2898 installBundledKanataBinaryOnly()] ğŸ”§ [LaunchDaemon] Installing bundled kanata binary to system location
[2025-11-22 13:10:31.396] [INFO] [LaunchDaemonInstaller.swift:2906 installBundledKanataBinaryOnly()] âŒ [LaunchDaemon] CRITICAL: Bundled kanata binary not found at: /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata
[2025-11-22 13:10:31.396] [INFO] [LaunchDaemonInstaller.swift:2908 installBundledKanataBinaryOnly()] âŒ [LaunchDaemon] This indicates a packaging issue - the app bundle is missing the kanata binary
[2025-11-22 13:10:31.396] [INFO] [InstallerEngine.swift:451 execute(plan:using:)] âŒ [InstallerEngine] Recipe install-bundled-kanata failed: Operation failed: Bundled Kanata installation failed
[2025-11-22 13:10:31.396] [INFO] [InstallerEngine.swift:470 execute(plan:using:)] âœ… [InstallerEngine] execute() complete - success: false, recipes executed: 1
[2025-11-22 13:10:31.396] [INFO] [InstallerEngine.swift:625 run(intent:using:)] âœ… [InstallerEngine] run() complete - success: false
[2025-11-22 13:10:31.396] [INFO] [ConfigFileWatcher.swift:208 stopWatching()] ğŸ“ [FileWatcher] Stopping all monitoring...
[2025-11-22 13:10:31.396] [INFO] [ConfigFileWatcher.swift:237 stopWatching()] âœ… [FileWatcher] All monitoring stopped and state cleared
[2025-11-22 13:10:31.396] [INFO] [ConfigFileWatcher.swift:45 deinit] ğŸ“ [FileWatcher] ConfigFileWatcher deinitialized
[2025-11-22 13:10:31.396] [INFO] [LayerChangeListener.swift:27 stop()] ğŸŒ [LayerListener] Stopping layer listener
[2025-11-22 13:10:31.396] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:10:31.396] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:10:31.396] [INFO] [SystemRequirements.swift:135 validateSystemCompatibility()] ğŸ” [SystemRequirements] Validating system compatibility
[2025-11-22 13:10:31.396] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:10:31.396] [INFO] [SystemRequirements.swift:147 validateSystemCompatibility()] âœ… [SystemRequirements] Modern macOS detected: 26.0.1
[2025-11-22 13:10:31.396] [INFO] [SystemRequirements.swift:190 validateSystemCompatibility()] ğŸ” [SystemRequirements] Compatibility check complete: âœ… Compatible
[2025-11-22 13:10:31.396] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:10:31.396] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:10:31.396] [INFO] [InstallerEngine.swift:78 inspectSystem()] âœ… [InstallerEngine] inspectSystem() complete - ready=false, blocking=9
[2025-11-22 13:10:31.396] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: repair, context:)
[2025-11-22 13:10:31.396] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: repair
[2025-11-22 13:10:31.396] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:10:31.396] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:10:31.396] [INFO] [InstallerEngine.swift:390 execute(plan:using:)] âš™ï¸ [InstallerEngine] Starting execute(plan:, using:)
[2025-11-22 13:10:31.397] [INFO] [InstallerEngine.swift:409 execute(plan:using:)] âš™ï¸ [InstallerEngine] Executing recipe: install-bundled-kanata (type: installComponent)
[2025-11-22 13:10:31.397] [INFO] [PrivilegedOperationsCoordinator.swift:359 installBundledKanata()] ğŸ” [PrivCoordinator] Installing bundled Kanata binary
[2025-11-22 13:10:31.397] [INFO] [LaunchDaemonInstaller.swift:2898 installBundledKanataBinaryOnly()] ğŸ”§ [LaunchDaemon] Installing bundled kanata binary to system location
[2025-11-22 13:10:31.397] [INFO] [LaunchDaemonInstaller.swift:2906 installBundledKanataBinaryOnly()] âŒ [LaunchDaemon] CRITICAL: Bundled kanata binary not found at: /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata
[2025-11-22 13:10:31.397] [INFO] [LaunchDaemonInstaller.swift:2908 installBundledKanataBinaryOnly()] âŒ [LaunchDaemon] This indicates a packaging issue - the app bundle is missing the kanata binary
[2025-11-22 13:10:31.397] [INFO] [InstallerEngine.swift:451 execute(plan:using:)] âŒ [InstallerEngine] Recipe install-bundled-kanata failed: Operation failed: Bundled Kanata installation failed
[2025-11-22 13:10:31.397] [INFO] [InstallerEngine.swift:470 execute(plan:using:)] âœ… [InstallerEngine] execute() complete - success: false, recipes executed: 1
[2025-11-22 13:10:31.397] [INFO] [InstallerEngine.swift:625 run(intent:using:)] âœ… [InstallerEngine] run() complete - success: false
[2025-11-22 13:10:31.397] [INFO] [ConfigFileWatcher.swift:208 stopWatching()] ğŸ“ [FileWatcher] Stopping all monitoring...
[2025-11-22 13:10:31.397] [INFO] [ConfigFileWatcher.swift:237 stopWatching()] âœ… [FileWatcher] All monitoring stopped and state cleared
[2025-11-22 13:10:31.397] [INFO] [LayerChangeListener.swift:27 stop()] ğŸŒ [LayerListener] Stopping layer listener
[2025-11-22 13:10:31.397] [INFO] [ConfigFileWatcher.swift:45 deinit] ğŸ“ [FileWatcher] ConfigFileWatcher deinitialized
Test Case '-[KeyPathTests.DiagnosticsServiceTests testAnalyzeLogFileWithConnectionError]' passed (0.003 seconds).
Test Case '-[KeyPathTests.DiagnosticsServiceTests testAnalyzeLogFileWithGenericError]' started.
[2025-11-22 13:10:31.398] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
Test Case '-[KeyPathTests.DiagnosticsServiceTests testAnalyzeLogFileWithGenericError]' passed (0.001 seconds).
Test Case '-[KeyPathTests.DiagnosticsServiceTests testAnalyzeLogFileWithPermissionError]' started.
[2025-11-22 13:10:31.399] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
Test Case '-[KeyPathTests.DiagnosticsServiceTests testAnalyzeLogFileWithPermissionError]' passed (0.001 seconds).
Test Case '-[KeyPathTests.DiagnosticsServiceTests testCheckProcessConflictsReturnsNonNilResult]' started.
[2025-11-22 13:10:31.400] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:10:31.400] [INFO] [ProcessLifecycleManager.swift:117 detectConflicts()] ğŸ” [ProcessLifecycleManager] Detecting conflicts...
[2025-11-22 13:10:31.400] [INFO] [ProcessLifecycleManager.swift:121 detectConflicts()] ğŸ§ª [TestEnvironment] Skipping process conflict detection - returning clean state
Test Case '-[KeyPathTests.DiagnosticsServiceTests testCheckProcessConflictsReturnsNonNilResult]' passed (0.000 seconds).
Test Case '-[KeyPathTests.DiagnosticsServiceTests testDiagnoseConfigurationError]' started.
[2025-11-22 13:10:31.400] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
Test Case '-[KeyPathTests.DiagnosticsServiceTests testDiagnoseConfigurationError]' passed (0.000 seconds).
Test Case '-[KeyPathTests.DiagnosticsServiceTests testDiagnoseDeviceConflict]' started.
[2025-11-22 13:10:31.400] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
Test Case '-[KeyPathTests.DiagnosticsServiceTests testDiagnoseDeviceConflict]' passed (0.000 seconds).
Test Case '-[KeyPathTests.DiagnosticsServiceTests testDiagnoseGenericExitCode6]' started.
[2025-11-22 13:10:31.400] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
Test Case '-[KeyPathTests.DiagnosticsServiceTests testDiagnoseGenericExitCode6]' passed (0.000 seconds).
Test Case '-[KeyPathTests.DiagnosticsServiceTests testDiagnosePermissionError]' started.
[2025-11-22 13:10:31.401] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
Test Case '-[KeyPathTests.DiagnosticsServiceTests testDiagnosePermissionError]' passed (0.000 seconds).
Test Case '-[KeyPathTests.DiagnosticsServiceTests testDiagnosePermissionRelatedUnknownExitCode]' started.
[2025-11-22 13:10:31.401] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
Test Case '-[KeyPathTests.DiagnosticsServiceTests testDiagnosePermissionRelatedUnknownExitCode]' passed (0.000 seconds).
Test Case '-[KeyPathTests.DiagnosticsServiceTests testDiagnoseSIGKILL]' started.
[2025-11-22 13:10:31.401] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
Test Case '-[KeyPathTests.DiagnosticsServiceTests testDiagnoseSIGKILL]' passed (0.000 seconds).
Test Case '-[KeyPathTests.DiagnosticsServiceTests testDiagnoseSIGTERM]' started.
[2025-11-22 13:10:31.401] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
Test Case '-[KeyPathTests.DiagnosticsServiceTests testDiagnoseSIGTERM]' passed (0.000 seconds).
Test Case '-[KeyPathTests.DiagnosticsServiceTests testDiagnoseUnknownExitCode]' started.
[2025-11-22 13:10:31.401] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
Test Case '-[KeyPathTests.DiagnosticsServiceTests testDiagnoseUnknownExitCode]' passed (0.000 seconds).
Test Case '-[KeyPathTests.DiagnosticsServiceTests testDiagnoseVirtualHIDConnectionFailure]' started.
[2025-11-22 13:10:31.401] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
Test Case '-[KeyPathTests.DiagnosticsServiceTests testDiagnoseVirtualHIDConnectionFailure]' passed (0.000 seconds).
Test Case '-[KeyPathTests.DiagnosticsServiceTests testDiagnosticCategoryRawValues]' started.
[2025-11-22 13:10:31.402] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
Test Case '-[KeyPathTests.DiagnosticsServiceTests testDiagnosticCategoryRawValues]' passed (0.000 seconds).
Test Case '-[KeyPathTests.DiagnosticsServiceTests testDiagnosticSeverityEmojis]' started.
[2025-11-22 13:10:31.402] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
Test Case '-[KeyPathTests.DiagnosticsServiceTests testDiagnosticSeverityEmojis]' passed (0.000 seconds).
Test Suite 'DiagnosticsServiceTests' passed at 2025-11-22 13:10:31.402.
	 Executed 17 tests, with 0 failures (0 unexpected) in 7.318 (7.320) seconds
Test Suite 'ErrorHandlingTests' started at 2025-11-22 13:10:31.402.
Test Case '-[KeyPathTests.ErrorHandlingTests testAsyncConfigurationErrors]' started.
[2025-11-22 13:10:31.402] [INFO] [KanataManager.swift:331 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] init() called
[2025-11-22 13:10:31.402] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:10:31.402] [INFO] [ConfigFileWatcher.swift:40 init()] ğŸ“ [FileWatcher] ConfigFileWatcher initialized with robust monitoring
[2025-11-22 13:10:31.402] [INFO] [ServiceHealthMonitor.swift:140 init(processLifecycle:)] [HealthMonitor] Initialized with process lifecycle manager
[2025-11-22 13:10:31.402] [DEBUG] [KanataManager.swift:403 init(engineClient:injectedConfigurationService:)] ğŸ§ª [KanataManager] Skipping background initialization in test environment
[2025-11-22 13:10:31.402] [INFO] [KanataManager.swift:411 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] About to call bootstrapRuleCollections and startLayerMonitoring
[2025-11-22 13:10:31.402] [INFO] [KanataManager.swift:583 startLayerMonitoring()] ğŸŒ [KanataManager] startLayerMonitoring() called
[2025-11-22 13:10:31.402] [INFO] [KanataManager.swift:585 startLayerMonitoring()] ğŸŒ [KanataManager] Skipping layer monitoring (test environment)
[2025-11-22 13:10:31.402] [INFO] [KanataManager.swift:415 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] init() completed
[2025-11-22 13:10:31.402] [INFO] [ConfigFileWatcher.swift:54 suppressEvents(for:reason:)] ğŸ”‡ [FileWatcher] Suppressing events for 1.0s - Internal saveConfiguration
Test Case '-[KeyPathTests.ErrorHandlingTests testAsyncConfigurationErrors]' passed (0.001 seconds).
Test Case '-[KeyPathTests.ErrorHandlingTests testAsyncResetConfigurationErrors]' started.
[2025-11-22 13:10:31.403] [INFO] [KanataManager.swift:331 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] init() called
[2025-11-22 13:10:31.403] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:10:31.403] [INFO] [ConfigFileWatcher.swift:40 init()] ğŸ“ [FileWatcher] ConfigFileWatcher initialized with robust monitoring
[2025-11-22 13:10:31.403] [INFO] [ServiceHealthMonitor.swift:140 init(processLifecycle:)] [HealthMonitor] Initialized with process lifecycle manager
[2025-11-22 13:10:31.403] [DEBUG] [KanataManager.swift:403 init(engineClient:injectedConfigurationService:)] ğŸ§ª [KanataManager] Skipping background initialization in test environment
[2025-11-22 13:10:31.403] [INFO] [KanataManager.swift:411 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] About to call bootstrapRuleCollections and startLayerMonitoring
[2025-11-22 13:10:31.403] [INFO] [KanataManager.swift:583 startLayerMonitoring()] ğŸŒ [KanataManager] startLayerMonitoring() called
[2025-11-22 13:10:31.403] [INFO] [KanataManager.swift:585 startLayerMonitoring()] ğŸŒ [KanataManager] Skipping layer monitoring (test environment)
[2025-11-22 13:10:31.403] [INFO] [KanataManager.swift:415 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] init() completed
[2025-11-22 13:10:31.403] [INFO] [KanataManager.swift:2122 resetToDefaultConfig()] ğŸ”„ [Reset] Forcing reset to default config (no validation - recovery mode)
[2025-11-22 13:10:31.404] [INFO] [ConfigBackupManager.swift:61 createPreEditBackup()] âœ… [BackupManager] Created pre-edit backup: keypath_2025-11-22_21-10-31.kbd
[2025-11-22 13:10:31.405] [INFO] [ConfigBackupManager.swift:190 cleanupOldBackups()] ğŸ—‘ï¸ [BackupManager] Deleted old backup: keypath_2025-11-22_16-04-24.kbd
[2025-11-22 13:10:31.405] [INFO] [KanataManager.swift:2128 resetToDefaultConfig()] ğŸ’¾ [Reset] Safety backup created before default reset
[2025-11-22 13:10:31.405] [INFO] [KanataManager.swift:2145 resetToDefaultConfig()] ğŸ’¾ [Config] Reset to default configuration (macOS Function Keys only)
[2025-11-22 13:10:31.406] [INFO] [KanataManager.swift:609 updateActiveLayerName(_:)] ğŸ¯ [KanataManager] updateActiveLayerName: raw='base' normalized='base' display='Base' current='Base'
[2025-11-22 13:10:31.406] [INFO] [KanataManager.swift:609 updateActiveLayerName(_:)] ğŸ¯ [KanataManager] updateActiveLayerName: raw='base' normalized='base' display='Base' current='Base'
[2025-11-22 13:10:31.406] [INFO] [KanataManager.swift:609 updateActiveLayerName(_:)] ğŸ¯ [KanataManager] updateActiveLayerName: raw='base' normalized='base' display='Base' current='Base'
[2025-11-22 13:10:31.406] [INFO] [KanataManager.swift:609 updateActiveLayerName(_:)] ğŸ¯ [KanataManager] updateActiveLayerName: raw='base' normalized='base' display='Base' current='Base'
[2025-11-22 13:10:31.406] [INFO] [KanataManager.swift:2159 resetToDefaultConfig()] ğŸ”„ [Reset] Updated stores and manager properties to match default state
[2025-11-22 13:10:31.406] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:10:31.406] [INFO] [SystemValidator.swift:63 init(launchDaemonInstaller:vhidDeviceManager:processLifecycleManager:kanataManager:)] ğŸ” [SystemValidator] Initialized (stateless, no cache)
[2025-11-22 13:10:31.406] [INFO] [InstallerEngine.swift:35 init(processLifecycleManager:kanataManager:)] ğŸ”§ [InstallerEngine] Initialized
[2025-11-22 13:10:31.406] [INFO] [InstallerEngine.swift:53 inspectSystem()] ğŸ” [InstallerEngine] Starting inspectSystem()
[2025-11-22 13:10:31.406] [INFO] [SystemValidator.swift:143 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Starting validation #1
[2025-11-22 13:10:31.406] [INFO] [SystemValidator.swift:174 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 START: 1763845831.406
[2025-11-22 13:10:31.406] [INFO] [KanataManager.swift:609 updateActiveLayerName(_:)] ğŸ¯ [KanataManager] updateActiveLayerName: raw='base' normalized='base' display='Base' current='Base'
[2025-11-22 13:10:31.406] [INFO] [KanataManager.swift:609 updateActiveLayerName(_:)] ğŸ¯ [KanataManager] updateActiveLayerName: raw='base' normalized='base' display='Base' current='Base'
[2025-11-22 13:10:31.406] [INFO] [SystemValidator.swift:312 checkHelper()] ğŸ” [SystemValidator] Checking privileged helper
[2025-11-22 13:10:31.406] [INFO] [SystemValidator.swift:344 checkPermissions()] ğŸ” [SystemValidator] Checking permissions via Oracle
[2025-11-22 13:10:31.406] [INFO] [SystemValidator.swift:365 checkComponents()] ğŸ” [SystemValidator] Checking components
[2025-11-22 13:10:31.406] [INFO] [KanataBinaryDetector.swift:66 detectCurrentStatus()] ğŸ” [KanataBinaryDetector] Starting unified kanata binary detection
[2025-11-22 13:10:31.406] [INFO] [PermissionOracle.swift:173 currentSnapshot()] ğŸ”® [Oracle] Test mode snapshot generated (non-blocking)
[2025-11-22 13:10:31.407] [INFO] [KanataBinaryDetector.swift:81 detectCurrentStatus()] âŒ [KanataBinaryDetector] No kanata binary found
[2025-11-22 13:10:31.407] [INFO] [VHIDDeviceManager.swift:50 detectInstallation()] ğŸ” [VHIDManager] Manager app exists at /Applications/.Karabiner-VirtualHIDDevice-Manager.app/Contents/MacOS/Karabiner-VirtualHIDDevice-Manager: true
[2025-11-22 13:10:31.411] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:10:31.414] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:10:31.429] [INFO] [HelperManager.swift:830 verifyEmbeddedHelperSignature()] ğŸ”’ [HelperManager] Embedded helper signature looks valid
[2025-11-22 13:10:31.429] [INFO] [HelperManager.swift:105 getConnection()] ğŸ”— [HelperManager] Creating XPC connection to com.keypath.helper
[2025-11-22 13:10:31.429] [INFO] [HelperManager.swift:129 getConnection()] âœ… [HelperManager] XPC connection established (PID: 0)
[2025-11-22 13:10:31.429] [INFO] [HelperManager.swift:228 getHelperVersion()] ğŸ“¤ [HelperManager] Calling proxy.getVersion()
[2025-11-22 13:10:31.429] [INFO] [HelperManager.swift:243 getHelperVersion()] ğŸ“¤ [HelperManager] proxy.getVersion() call dispatched, waiting for callback
[2025-11-22 13:10:31.429] [INFO] [HelperManager.swift:121 getConnection()] âš ï¸ [HelperManager] XPC connection interrupted - will reconnect
[2025-11-22 13:10:31.429] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:10:31.429] [INFO] [HelperManager.swift:578 getRemoteProxy(errorHandler:)] âŒ [HelperManager] XPC proxy error: Couldnâ€™t communicate with a helper application.
[2025-11-22 13:10:31.429] [INFO] [HelperManager.swift:584 getRemoteProxy(errorHandler:)] âš ï¸ [HelperManager] XPC connection interrupted - this may indicate:
[2025-11-22 13:10:31.429] [INFO] [HelperManager.swift:585 getRemoteProxy(errorHandler:)]    1. Helper signature validation failed (app updated but not restarted)
[2025-11-22 13:10:31.429] [INFO] [HelperManager.swift:587 getRemoteProxy(errorHandler:)]    2. Helper process crashed
[2025-11-22 13:10:31.429] [INFO] [HelperManager.swift:588 getRemoteProxy(errorHandler:)]    3. Helper was killed by the system
[2025-11-22 13:10:31.429] [INFO] [HelperManager.swift:589 getRemoteProxy(errorHandler:)] ğŸ’¡ If you just updated KeyPath, try restarting the app
[2025-11-22 13:10:31.429] [INFO] [HelperManager.swift:116 getConnection()] âŒ [HelperManager] XPC connection invalidated
[2025-11-22 13:10:31.430] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:10:31.474] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.067s)
[2025-11-22 13:10:31.474] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:10:32.047] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.068s)
[2025-11-22 13:10:32.048] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:10:32.048] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:10:32.048] [INFO] [VHIDDeviceManager.swift:343 getInstalledVersion()] ğŸ” [VHIDManager] Installed daemon version: 5.0.0
[2025-11-22 13:10:32.048] [INFO] [VHIDDeviceManager.swift:374 hasVersionMismatch()] âœ… [VHIDManager] Version compatible: v5.0.0
[2025-11-22 13:10:32.048] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:10:32.116] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:10:32.117] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:10:32.117] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:10:32.117] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:10:32.117] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:10:32.118] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:10:32.118] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:10:32.118] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:10:32.118] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:10:32.118] [INFO] [LaunchDaemonInstaller.swift:669 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Kanata service state: Uninstalled
[2025-11-22 13:10:32.118] [INFO] [LaunchDaemonInstaller.swift:696 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Service not installed (state: Uninstalled)
[2025-11-22 13:10:32.118] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:10:32.186] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:10:32.254] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhiddaemon loaded: false
[2025-11-22 13:10:32.321] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhidmanager loaded: false
[2025-11-22 13:10:32.321] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:10:32.388] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:10:32.389] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhidmanager
[2025-11-22 13:10:32.456] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhidmanager not found in system domain
[2025-11-22 13:10:32.456] [INFO] [SystemValidator.swift:393 checkComponents()] ğŸ” [SystemValidator] Components: kanata=false, driver=true, daemon=false, vhid=false, vhidVersionMismatch=false
[2025-11-22 13:10:32.456] [INFO] [SystemValidator.swift:220 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 3 (Components) completed in 1.050s
[2025-11-22 13:10:32.456] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 20% (1/5 steps)
[2025-11-22 13:10:32.456] [INFO] [SystemValidator.swift:411 checkConflicts()] ğŸ” [SystemValidator] Checking for conflicts
[2025-11-22 13:10:32.456] [INFO] [ProcessLifecycleManager.swift:117 detectConflicts()] ğŸ” [ProcessLifecycleManager] Detecting conflicts...
[2025-11-22 13:10:32.456] [INFO] [ProcessLifecycleManager.swift:121 detectConflicts()] ğŸ§ª [TestEnvironment] Skipping process conflict detection - returning clean state
[2025-11-22 13:10:32.456] [INFO] [SystemValidator.swift:436 checkConflicts()] ğŸ” [SystemValidator] Total conflicts: 0 (0 kanata, 0 karabiner)
[2025-11-22 13:10:32.456] [INFO] [SystemValidator.swift:229 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 4 (Conflicts) completed in 1.050s
[2025-11-22 13:10:32.456] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 40% (2/5 steps)
[2025-11-22 13:10:32.456] [INFO] [SystemValidator.swift:477 checkHealth()] ğŸ” [SystemValidator] Checking system health
[2025-11-22 13:10:32.456] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:10:32.524] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:10:32.524] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:10:32.592] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:10:32.660] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.068s)
[2025-11-22 13:10:32.660] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:10:32.670] [INFO] [HelperManager.swift:248 getHelperVersion()] âš ï¸ [HelperManager] getVersion timed out - clearing connection cache
[2025-11-22 13:10:32.670] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:10:33.234] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.068s)
[2025-11-22 13:10:33.234] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:10:33.234] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:10:33.234] [INFO] [SystemValidator.swift:487 checkHealth()] ğŸ” [SystemValidator] Health: kanata=false, daemon=false (launchctl), vhid=false
[2025-11-22 13:10:33.234] [INFO] [SystemValidator.swift:238 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 5 (Health) completed in 1.828s
[2025-11-22 13:10:33.234] [INFO] [SystemValidator.swift:355 checkPermissions()] ğŸ” [SystemValidator] Oracle snapshot: ready=false, age=1.828s
[2025-11-22 13:10:33.234] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 60% (3/5 steps)
[2025-11-22 13:10:33.234] [INFO] [SystemValidator.swift:211 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 2 (Permissions) completed in 1.828s
[2025-11-22 13:10:33.235] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 80% (4/5 steps)
[2025-11-22 13:10:33.235] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:10:33.235] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:10:33.235] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 3827 characters
[2025-11-22 13:10:33.235] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:10:33.236] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 18 src keys, 88 layer keys, deduplicated to 18 unique mappings
[2025-11-22 13:10:33.236] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:10:33.236] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:10:33.236] [INFO] [SystemValidator.swift:328 checkHelper()] ğŸ” [SystemValidator] Helper state: registeredButUnresponsive Helper registered but XPC communication failed
[2025-11-22 13:10:33.236] [INFO] [SystemValidator.swift:202 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 1 (Helper) completed in 5.498s
[2025-11-22 13:10:33.236] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 100% (5/5 steps)
[2025-11-22 13:10:33.236] [INFO] [SystemValidator.swift:283 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 COMPLETE: Total duration 5.498s
[2025-11-22 13:10:33.236] [INFO] [SystemValidator.swift:297 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Validation #1 complete in 5.498s
[2025-11-22 13:10:33.236] [INFO] [SystemValidator.swift:299 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Result: ready=false, blocking=9, total=9
[2025-11-22 13:10:33.236] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:10:33.236] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:10:33.236] [INFO] [SystemRequirements.swift:135 validateSystemCompatibility()] ğŸ” [SystemRequirements] Validating system compatibility
[2025-11-22 13:10:33.236] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:10:33.236] [INFO] [SystemRequirements.swift:147 validateSystemCompatibility()] âœ… [SystemRequirements] Modern macOS detected: 26.0.1
[2025-11-22 13:10:33.236] [INFO] [SystemRequirements.swift:190 validateSystemCompatibility()] ğŸ” [SystemRequirements] Compatibility check complete: âœ… Compatible
[2025-11-22 13:10:33.236] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:10:33.236] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:10:33.236] [INFO] [InstallerEngine.swift:78 inspectSystem()] âœ… [InstallerEngine] inspectSystem() complete - ready=false, blocking=9
[2025-11-22 13:10:33.236] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: repair, context:)
[2025-11-22 13:10:33.236] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: repair
[2025-11-22 13:10:33.236] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:10:33.236] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:10:33.236] [INFO] [InstallerEngine.swift:390 execute(plan:using:)] âš™ï¸ [InstallerEngine] Starting execute(plan:, using:)
[2025-11-22 13:10:33.236] [INFO] [InstallerEngine.swift:409 execute(plan:using:)] âš™ï¸ [InstallerEngine] Executing recipe: install-bundled-kanata (type: installComponent)
[2025-11-22 13:10:33.236] [INFO] [PrivilegedOperationsCoordinator.swift:359 installBundledKanata()] ğŸ” [PrivCoordinator] Installing bundled Kanata binary
[2025-11-22 13:10:33.236] [INFO] [LaunchDaemonInstaller.swift:2898 installBundledKanataBinaryOnly()] ğŸ”§ [LaunchDaemon] Installing bundled kanata binary to system location
[2025-11-22 13:10:33.237] [INFO] [LaunchDaemonInstaller.swift:2906 installBundledKanataBinaryOnly()] âŒ [LaunchDaemon] CRITICAL: Bundled kanata binary not found at: /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata
[2025-11-22 13:10:33.237] [INFO] [LaunchDaemonInstaller.swift:2908 installBundledKanataBinaryOnly()] âŒ [LaunchDaemon] This indicates a packaging issue - the app bundle is missing the kanata binary
[2025-11-22 13:10:33.237] [INFO] [InstallerEngine.swift:451 execute(plan:using:)] âŒ [InstallerEngine] Recipe install-bundled-kanata failed: Operation failed: Bundled Kanata installation failed
[2025-11-22 13:10:33.237] [INFO] [InstallerEngine.swift:470 execute(plan:using:)] âœ… [InstallerEngine] execute() complete - success: false, recipes executed: 1
[2025-11-22 13:10:33.237] [INFO] [InstallerEngine.swift:625 run(intent:using:)] âœ… [InstallerEngine] run() complete - success: false
[2025-11-22 13:10:33.237] [INFO] [ConfigFileWatcher.swift:208 stopWatching()] ğŸ“ [FileWatcher] Stopping all monitoring...
[2025-11-22 13:10:33.237] [INFO] [ConfigFileWatcher.swift:237 stopWatching()] âœ… [FileWatcher] All monitoring stopped and state cleared
[2025-11-22 13:10:33.237] [INFO] [ConfigFileWatcher.swift:45 deinit] ğŸ“ [FileWatcher] ConfigFileWatcher deinitialized
[2025-11-22 13:10:33.237] [INFO] [LayerChangeListener.swift:27 stop()] ğŸŒ [LayerListener] Stopping layer listener
[2025-11-22 13:10:33.238] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:10:33.238] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:10:33.238] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 3827 characters
[2025-11-22 13:10:33.238] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:10:33.238] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 18 src keys, 88 layer keys, deduplicated to 18 unique mappings
[2025-11-22 13:10:33.238] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:10:33.238] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:10:33.239] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 18 mappings
[2025-11-22 13:10:33.239] [DEBUG] [KanataManager+Configuration.swift:53 triggerConfigReload()] ğŸ“¡ [Reload] Attempting TCP reload
[2025-11-22 13:10:33.239] [DEBUG] [KanataManager+Configuration.swift:84 triggerTCPReload()] ğŸ§ª [TCP Reload] Skipping TCP reload in test environment
[2025-11-22 13:10:33.239] [DEBUG] [KanataManager+Configuration.swift:65 triggerConfigReload()] ğŸ“¡ [Reload] TCP reload failed: Test environment - TCP disabled
[2025-11-22 13:10:33.239] [WARN] [KanataManager+Configuration.swift:68 triggerConfigReload()] âš ï¸ [Reload] Falling back to service restart
[2025-11-22 13:10:33.239] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:10:33.239] [INFO] [SystemValidator.swift:63 init(launchDaemonInstaller:vhidDeviceManager:processLifecycleManager:kanataManager:)] ğŸ” [SystemValidator] Initialized (stateless, no cache)
[2025-11-22 13:10:33.239] [INFO] [InstallerEngine.swift:35 init(processLifecycleManager:kanataManager:)] ğŸ”§ [InstallerEngine] Initialized
[2025-11-22 13:10:33.239] [INFO] [InstallerEngine.swift:612 run(intent:using:)] ğŸš€ [InstallerEngine] Starting run(intent: repair, using:)
[2025-11-22 13:10:33.239] [INFO] [InstallerEngine.swift:53 inspectSystem()] ğŸ” [InstallerEngine] Starting inspectSystem()
[2025-11-22 13:10:33.239] [INFO] [SystemValidator.swift:143 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Starting validation #1
[2025-11-22 13:10:33.239] [INFO] [SystemValidator.swift:174 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 START: 1763845833.239
[2025-11-22 13:10:33.239] [INFO] [SystemValidator.swift:312 checkHelper()] ğŸ” [SystemValidator] Checking privileged helper
[2025-11-22 13:10:33.239] [INFO] [SystemValidator.swift:344 checkPermissions()] ğŸ” [SystemValidator] Checking permissions via Oracle
[2025-11-22 13:10:33.239] [INFO] [SystemValidator.swift:411 checkConflicts()] ğŸ” [SystemValidator] Checking for conflicts
[2025-11-22 13:10:33.239] [INFO] [ProcessLifecycleManager.swift:117 detectConflicts()] ğŸ” [ProcessLifecycleManager] Detecting conflicts...
[2025-11-22 13:10:33.239] [INFO] [ProcessLifecycleManager.swift:121 detectConflicts()] ğŸ§ª [TestEnvironment] Skipping process conflict detection - returning clean state
[2025-11-22 13:10:33.239] [INFO] [SystemValidator.swift:436 checkConflicts()] ğŸ” [SystemValidator] Total conflicts: 0 (0 kanata, 0 karabiner)
[2025-11-22 13:10:33.239] [INFO] [SystemValidator.swift:477 checkHealth()] ğŸ” [SystemValidator] Checking system health
[2025-11-22 13:10:33.239] [INFO] [PermissionOracle.swift:173 currentSnapshot()] ğŸ”® [Oracle] Test mode snapshot generated (non-blocking)
[2025-11-22 13:10:33.239] [INFO] [SystemValidator.swift:229 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 4 (Conflicts) completed in 0.000s
[2025-11-22 13:10:33.239] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:10:33.239] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 20% (1/5 steps)
[2025-11-22 13:10:33.247] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:10:33.252] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:10:33.269] [INFO] [HelperManager.swift:830 verifyEmbeddedHelperSignature()] ğŸ”’ [HelperManager] Embedded helper signature looks valid
[2025-11-22 13:10:33.269] [INFO] [HelperManager.swift:105 getConnection()] ğŸ”— [HelperManager] Creating XPC connection to com.keypath.helper
[2025-11-22 13:10:33.269] [INFO] [HelperManager.swift:129 getConnection()] âœ… [HelperManager] XPC connection established (PID: 0)
[2025-11-22 13:10:33.269] [INFO] [HelperManager.swift:228 getHelperVersion()] ğŸ“¤ [HelperManager] Calling proxy.getVersion()
[2025-11-22 13:10:33.269] [INFO] [HelperManager.swift:243 getHelperVersion()] ğŸ“¤ [HelperManager] proxy.getVersion() call dispatched, waiting for callback
[2025-11-22 13:10:33.270] [INFO] [HelperManager.swift:121 getConnection()] âš ï¸ [HelperManager] XPC connection interrupted - will reconnect
[2025-11-22 13:10:33.270] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:10:33.270] [INFO] [HelperManager.swift:578 getRemoteProxy(errorHandler:)] âŒ [HelperManager] XPC proxy error: Couldnâ€™t communicate with a helper application.
[2025-11-22 13:10:33.270] [INFO] [HelperManager.swift:584 getRemoteProxy(errorHandler:)] âš ï¸ [HelperManager] XPC connection interrupted - this may indicate:
[2025-11-22 13:10:33.270] [INFO] [HelperManager.swift:585 getRemoteProxy(errorHandler:)]    1. Helper signature validation failed (app updated but not restarted)
[2025-11-22 13:10:33.270] [INFO] [HelperManager.swift:587 getRemoteProxy(errorHandler:)]    2. Helper process crashed
[2025-11-22 13:10:33.270] [INFO] [HelperManager.swift:588 getRemoteProxy(errorHandler:)]    3. Helper was killed by the system
[2025-11-22 13:10:33.270] [INFO] [HelperManager.swift:589 getRemoteProxy(errorHandler:)] ğŸ’¡ If you just updated KeyPath, try restarting the app
[2025-11-22 13:10:33.270] [INFO] [HelperManager.swift:116 getConnection()] âŒ [HelperManager] XPC connection invalidated
[2025-11-22 13:10:33.270] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:10:33.307] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:10:33.307] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:10:33.375] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:10:33.443] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.068s)
[2025-11-22 13:10:33.443] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:10:34.017] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.068s)
[2025-11-22 13:10:34.017] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:10:34.017] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:10:34.017] [INFO] [SystemValidator.swift:487 checkHealth()] ğŸ” [SystemValidator] Health: kanata=false, daemon=false (launchctl), vhid=false
[2025-11-22 13:10:34.017] [INFO] [SystemValidator.swift:238 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 5 (Health) completed in 0.778s
[2025-11-22 13:10:34.017] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 40% (2/5 steps)
[2025-11-22 13:10:34.017] [INFO] [SystemValidator.swift:365 checkComponents()] ğŸ” [SystemValidator] Checking components
[2025-11-22 13:10:34.017] [INFO] [KanataBinaryDetector.swift:66 detectCurrentStatus()] ğŸ” [KanataBinaryDetector] Starting unified kanata binary detection
[2025-11-22 13:10:34.018] [INFO] [KanataBinaryDetector.swift:81 detectCurrentStatus()] âŒ [KanataBinaryDetector] No kanata binary found
[2025-11-22 13:10:34.018] [INFO] [VHIDDeviceManager.swift:50 detectInstallation()] ğŸ” [VHIDManager] Manager app exists at /Applications/.Karabiner-VirtualHIDDevice-Manager.app/Contents/MacOS/Karabiner-VirtualHIDDevice-Manager: true
[2025-11-22 13:10:34.085] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.067s)
[2025-11-22 13:10:34.085] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:10:34.497] [INFO] [HelperManager.swift:248 getHelperVersion()] âš ï¸ [HelperManager] getVersion timed out - clearing connection cache
[2025-11-22 13:10:34.498] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:10:34.657] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.067s)
[2025-11-22 13:10:34.657] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:10:34.657] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:10:34.658] [INFO] [VHIDDeviceManager.swift:343 getInstalledVersion()] ğŸ” [VHIDManager] Installed daemon version: 5.0.0
[2025-11-22 13:10:34.658] [INFO] [VHIDDeviceManager.swift:374 hasVersionMismatch()] âœ… [VHIDManager] Version compatible: v5.0.0
[2025-11-22 13:10:34.658] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:10:34.725] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:10:34.726] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:10:34.726] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:10:34.726] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:10:34.726] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:10:34.727] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:10:34.727] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:10:34.727] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:10:34.727] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:10:34.727] [INFO] [LaunchDaemonInstaller.swift:669 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Kanata service state: Uninstalled
[2025-11-22 13:10:34.727] [INFO] [LaunchDaemonInstaller.swift:696 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Service not installed (state: Uninstalled)
[2025-11-22 13:10:34.727] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:10:34.794] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:10:34.861] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhiddaemon loaded: false
[2025-11-22 13:10:34.927] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhidmanager loaded: false
[2025-11-22 13:10:34.927] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:10:34.995] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:10:34.995] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhidmanager
[2025-11-22 13:10:35.062] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhidmanager not found in system domain
[2025-11-22 13:10:35.062] [INFO] [SystemValidator.swift:393 checkComponents()] ğŸ” [SystemValidator] Components: kanata=false, driver=true, daemon=false, vhid=false, vhidVersionMismatch=false
[2025-11-22 13:10:35.063] [INFO] [SystemValidator.swift:220 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 3 (Components) completed in 1.824s
[2025-11-22 13:10:35.063] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 18 mappings
[2025-11-22 13:10:35.063] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 60% (3/5 steps)
[2025-11-22 13:10:35.063] [DEBUG] [KanataManager+Configuration.swift:53 triggerConfigReload()] ğŸ“¡ [Reload] Attempting TCP reload
[2025-11-22 13:10:35.063] [DEBUG] [KanataManager+Configuration.swift:84 triggerTCPReload()] ğŸ§ª [TCP Reload] Skipping TCP reload in test environment
[2025-11-22 13:10:35.063] [DEBUG] [KanataManager+Configuration.swift:65 triggerConfigReload()] ğŸ“¡ [Reload] TCP reload failed: Test environment - TCP disabled
[2025-11-22 13:10:35.063] [WARN] [KanataManager+Configuration.swift:68 triggerConfigReload()] âš ï¸ [Reload] Falling back to service restart
[2025-11-22 13:10:35.063] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:10:35.063] [INFO] [SystemValidator.swift:63 init(launchDaemonInstaller:vhidDeviceManager:processLifecycleManager:kanataManager:)] ğŸ” [SystemValidator] Initialized (stateless, no cache)
[2025-11-22 13:10:35.063] [INFO] [InstallerEngine.swift:35 init(processLifecycleManager:kanataManager:)] ğŸ”§ [InstallerEngine] Initialized
[2025-11-22 13:10:35.063] [INFO] [InstallerEngine.swift:612 run(intent:using:)] ğŸš€ [InstallerEngine] Starting run(intent: repair, using:)
[2025-11-22 13:10:35.063] [INFO] [InstallerEngine.swift:53 inspectSystem()] ğŸ” [InstallerEngine] Starting inspectSystem()
[2025-11-22 13:10:35.063] [INFO] [SystemValidator.swift:355 checkPermissions()] ğŸ” [SystemValidator] Oracle snapshot: ready=false, age=1.824s
[2025-11-22 13:10:35.063] [INFO] [SystemValidator.swift:211 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 2 (Permissions) completed in 1.824s
[2025-11-22 13:10:35.063] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 80% (4/5 steps)
[2025-11-22 13:10:35.063] [INFO] [SystemValidator.swift:328 checkHelper()] ğŸ” [SystemValidator] Helper state: registeredButUnresponsive Helper registered but XPC communication failed
[2025-11-22 13:10:35.063] [INFO] [SystemValidator.swift:143 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Starting validation #1
[2025-11-22 13:10:35.063] [INFO] [SystemValidator.swift:202 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 1 (Helper) completed in 3.656s
[2025-11-22 13:10:35.063] [INFO] [SystemValidator.swift:174 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 START: 1763845835.063
[2025-11-22 13:10:35.063] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 100% (5/5 steps)
[2025-11-22 13:10:35.063] [INFO] [SystemValidator.swift:312 checkHelper()] ğŸ” [SystemValidator] Checking privileged helper
[2025-11-22 13:10:35.063] [INFO] [SystemValidator.swift:344 checkPermissions()] ğŸ” [SystemValidator] Checking permissions via Oracle
[2025-11-22 13:10:35.063] [INFO] [SystemValidator.swift:365 checkComponents()] ğŸ” [SystemValidator] Checking components
[2025-11-22 13:10:35.063] [INFO] [KanataBinaryDetector.swift:66 detectCurrentStatus()] ğŸ” [KanataBinaryDetector] Starting unified kanata binary detection
[2025-11-22 13:10:35.063] [INFO] [PermissionOracle.swift:173 currentSnapshot()] ğŸ”® [Oracle] Test mode snapshot generated (non-blocking)
[2025-11-22 13:10:35.063] [INFO] [KanataBinaryDetector.swift:81 detectCurrentStatus()] âŒ [KanataBinaryDetector] No kanata binary found
[2025-11-22 13:10:35.063] [INFO] [VHIDDeviceManager.swift:50 detectInstallation()] ğŸ” [VHIDManager] Manager app exists at /Applications/.Karabiner-VirtualHIDDevice-Manager.app/Contents/MacOS/Karabiner-VirtualHIDDevice-Manager: true
[2025-11-22 13:10:35.069] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:10:35.073] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:10:35.090] [INFO] [HelperManager.swift:830 verifyEmbeddedHelperSignature()] ğŸ”’ [HelperManager] Embedded helper signature looks valid
[2025-11-22 13:10:35.090] [INFO] [HelperManager.swift:105 getConnection()] ğŸ”— [HelperManager] Creating XPC connection to com.keypath.helper
[2025-11-22 13:10:35.090] [INFO] [HelperManager.swift:129 getConnection()] âœ… [HelperManager] XPC connection established (PID: 0)
[2025-11-22 13:10:35.090] [INFO] [HelperManager.swift:228 getHelperVersion()] ğŸ“¤ [HelperManager] Calling proxy.getVersion()
[2025-11-22 13:10:35.090] [INFO] [HelperManager.swift:243 getHelperVersion()] ğŸ“¤ [HelperManager] proxy.getVersion() call dispatched, waiting for callback
[2025-11-22 13:10:35.090] [INFO] [HelperManager.swift:121 getConnection()] âš ï¸ [HelperManager] XPC connection interrupted - will reconnect
[2025-11-22 13:10:35.090] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:10:35.090] [INFO] [HelperManager.swift:578 getRemoteProxy(errorHandler:)] âŒ [HelperManager] XPC proxy error: Couldnâ€™t communicate with a helper application.
[2025-11-22 13:10:35.090] [INFO] [HelperManager.swift:584 getRemoteProxy(errorHandler:)] âš ï¸ [HelperManager] XPC connection interrupted - this may indicate:
[2025-11-22 13:10:35.090] [INFO] [HelperManager.swift:585 getRemoteProxy(errorHandler:)]    1. Helper signature validation failed (app updated but not restarted)
[2025-11-22 13:10:35.091] [INFO] [HelperManager.swift:587 getRemoteProxy(errorHandler:)]    2. Helper process crashed
[2025-11-22 13:10:35.091] [INFO] [HelperManager.swift:588 getRemoteProxy(errorHandler:)]    3. Helper was killed by the system
[2025-11-22 13:10:35.091] [INFO] [HelperManager.swift:589 getRemoteProxy(errorHandler:)] ğŸ’¡ If you just updated KeyPath, try restarting the app
[2025-11-22 13:10:35.091] [INFO] [HelperManager.swift:116 getConnection()] âŒ [HelperManager] XPC connection invalidated
[2025-11-22 13:10:35.091] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:10:35.130] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.066s)
[2025-11-22 13:10:35.130] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:10:35.703] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.068s)
[2025-11-22 13:10:35.703] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:10:35.703] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:10:35.704] [INFO] [VHIDDeviceManager.swift:343 getInstalledVersion()] ğŸ” [VHIDManager] Installed daemon version: 5.0.0
[2025-11-22 13:10:35.704] [INFO] [VHIDDeviceManager.swift:374 hasVersionMismatch()] âœ… [VHIDManager] Version compatible: v5.0.0
[2025-11-22 13:10:35.704] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:10:35.772] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:10:35.773] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:10:35.773] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:10:35.773] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:10:35.773] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:10:35.773] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:10:35.773] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:10:35.773] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:10:35.773] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:10:35.773] [INFO] [LaunchDaemonInstaller.swift:669 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Kanata service state: Uninstalled
[2025-11-22 13:10:35.773] [INFO] [LaunchDaemonInstaller.swift:696 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Service not installed (state: Uninstalled)
[2025-11-22 13:10:35.773] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:10:35.841] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:10:35.908] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhiddaemon loaded: false
[2025-11-22 13:10:35.976] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhidmanager loaded: false
[2025-11-22 13:10:35.976] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:10:36.044] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:10:36.044] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhidmanager
[2025-11-22 13:10:36.111] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhidmanager not found in system domain
[2025-11-22 13:10:36.111] [INFO] [SystemValidator.swift:393 checkComponents()] ğŸ” [SystemValidator] Components: kanata=false, driver=true, daemon=false, vhid=false, vhidVersionMismatch=false
[2025-11-22 13:10:36.111] [INFO] [SystemValidator.swift:220 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 3 (Components) completed in 1.048s
[2025-11-22 13:10:36.111] [INFO] [SystemValidator.swift:411 checkConflicts()] ğŸ” [SystemValidator] Checking for conflicts
[2025-11-22 13:10:36.111] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 20% (1/5 steps)
[2025-11-22 13:10:36.111] [INFO] [ProcessLifecycleManager.swift:117 detectConflicts()] ğŸ” [ProcessLifecycleManager] Detecting conflicts...
[2025-11-22 13:10:36.111] [INFO] [ProcessLifecycleManager.swift:121 detectConflicts()] ğŸ§ª [TestEnvironment] Skipping process conflict detection - returning clean state
[2025-11-22 13:10:36.111] [INFO] [SystemValidator.swift:436 checkConflicts()] ğŸ” [SystemValidator] Total conflicts: 0 (0 kanata, 0 karabiner)
[2025-11-22 13:10:36.111] [INFO] [SystemValidator.swift:477 checkHealth()] ğŸ” [SystemValidator] Checking system health
[2025-11-22 13:10:36.111] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:10:36.111] [INFO] [SystemValidator.swift:229 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 4 (Conflicts) completed in 1.048s
[2025-11-22 13:10:36.111] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 40% (2/5 steps)
[2025-11-22 13:10:36.179] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:10:36.179] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:10:36.247] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:10:36.314] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.067s)
[2025-11-22 13:10:36.314] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:10:36.343] [INFO] [HelperManager.swift:248 getHelperVersion()] âš ï¸ [HelperManager] getVersion timed out - clearing connection cache
[2025-11-22 13:10:36.343] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:10:36.887] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.067s)
[2025-11-22 13:10:36.887] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:10:36.887] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:10:36.887] [INFO] [SystemValidator.swift:487 checkHealth()] ğŸ” [SystemValidator] Health: kanata=false, daemon=false (launchctl), vhid=false
[2025-11-22 13:10:36.887] [INFO] [SystemValidator.swift:238 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 5 (Health) completed in 1.824s
[2025-11-22 13:10:36.887] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 60% (3/5 steps)
[2025-11-22 13:10:36.887] [INFO] [SystemValidator.swift:355 checkPermissions()] ğŸ” [SystemValidator] Oracle snapshot: ready=false, age=1.824s
[2025-11-22 13:10:36.887] [INFO] [SystemValidator.swift:328 checkHelper()] ğŸ” [SystemValidator] Helper state: registeredButUnresponsive Helper registered but XPC communication failed
[2025-11-22 13:10:36.887] [INFO] [SystemValidator.swift:211 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 2 (Permissions) completed in 1.824s
[2025-11-22 13:10:36.887] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 80% (4/5 steps)
[2025-11-22 13:10:36.887] [INFO] [SystemValidator.swift:283 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 COMPLETE: Total duration 5.481s
[2025-11-22 13:10:36.887] [INFO] [SystemValidator.swift:297 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Validation #1 complete in 5.481s
[2025-11-22 13:10:36.887] [INFO] [SystemValidator.swift:202 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 1 (Helper) completed in 3.648s
[2025-11-22 13:10:36.887] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 100% (5/5 steps)
[2025-11-22 13:10:36.887] [INFO] [SystemValidator.swift:299 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Result: ready=false, blocking=9, total=9
[2025-11-22 13:10:36.887] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:10:36.887] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:10:36.887] [INFO] [SystemRequirements.swift:135 validateSystemCompatibility()] ğŸ” [SystemRequirements] Validating system compatibility
[2025-11-22 13:10:36.887] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:10:36.887] [INFO] [SystemRequirements.swift:147 validateSystemCompatibility()] âœ… [SystemRequirements] Modern macOS detected: 26.0.1
[2025-11-22 13:10:36.887] [INFO] [SystemRequirements.swift:190 validateSystemCompatibility()] ğŸ” [SystemRequirements] Compatibility check complete: âœ… Compatible
[2025-11-22 13:10:36.887] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:10:36.887] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:10:36.887] [INFO] [InstallerEngine.swift:78 inspectSystem()] âœ… [InstallerEngine] inspectSystem() complete - ready=false, blocking=9
Test Case '-[KeyPathTests.ErrorHandlingTests testAsyncResetConfigurationErrors]' passed (5.485 seconds).
Test Case '-[KeyPathTests.ErrorHandlingTests testCommandKeyMappingErrorHandling]' started.
[2025-11-22 13:10:36.888] [INFO] [KanataManager.swift:331 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] init() called
[2025-11-22 13:10:36.888] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:10:36.888] [INFO] [ConfigFileWatcher.swift:40 init()] ğŸ“ [FileWatcher] ConfigFileWatcher initialized with robust monitoring
[2025-11-22 13:10:36.888] [INFO] [ServiceHealthMonitor.swift:140 init(processLifecycle:)] [HealthMonitor] Initialized with process lifecycle manager
[2025-11-22 13:10:36.888] [DEBUG] [KanataManager.swift:403 init(engineClient:injectedConfigurationService:)] ğŸ§ª [KanataManager] Skipping background initialization in test environment
[2025-11-22 13:10:36.888] [INFO] [KanataManager.swift:411 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] About to call bootstrapRuleCollections and startLayerMonitoring
[2025-11-22 13:10:36.888] [INFO] [KanataManager.swift:583 startLayerMonitoring()] ğŸŒ [KanataManager] startLayerMonitoring() called
[2025-11-22 13:10:36.888] [INFO] [KanataManager.swift:585 startLayerMonitoring()] ğŸŒ [KanataManager] Skipping layer monitoring (test environment)
[2025-11-22 13:10:36.888] [INFO] [KanataManager.swift:415 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] init() completed
Test Case '-[KeyPathTests.ErrorHandlingTests testCommandKeyMappingErrorHandling]' passed (0.001 seconds).
Test Case '-[KeyPathTests.ErrorHandlingTests testConcurrentConfigurationOperations]' started.
[2025-11-22 13:10:36.889] [INFO] [SystemValidator.swift:283 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 COMPLETE: Total duration 3.650s
[2025-11-22 13:10:36.889] [INFO] [SystemValidator.swift:297 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Validation #1 complete in 3.650s
[2025-11-22 13:10:36.889] [INFO] [SystemValidator.swift:299 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Result: ready=false, blocking=9, total=9
[2025-11-22 13:10:36.889] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:10:36.889] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:10:36.889] [INFO] [SystemRequirements.swift:135 validateSystemCompatibility()] ğŸ” [SystemRequirements] Validating system compatibility
[2025-11-22 13:10:36.889] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:10:36.889] [INFO] [SystemRequirements.swift:147 validateSystemCompatibility()] âœ… [SystemRequirements] Modern macOS detected: 26.0.1
[2025-11-22 13:10:36.889] [INFO] [SystemRequirements.swift:190 validateSystemCompatibility()] ğŸ” [SystemRequirements] Compatibility check complete: âœ… Compatible
[2025-11-22 13:10:36.889] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:10:36.889] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:10:36.889] [INFO] [InstallerEngine.swift:78 inspectSystem()] âœ… [InstallerEngine] inspectSystem() complete - ready=false, blocking=9
[2025-11-22 13:10:36.889] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: repair, context:)
[2025-11-22 13:10:36.889] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: repair
[2025-11-22 13:10:36.889] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:10:36.889] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:10:36.889] [INFO] [InstallerEngine.swift:390 execute(plan:using:)] âš™ï¸ [InstallerEngine] Starting execute(plan:, using:)
[2025-11-22 13:10:36.889] [INFO] [InstallerEngine.swift:409 execute(plan:using:)] âš™ï¸ [InstallerEngine] Executing recipe: install-bundled-kanata (type: installComponent)
[2025-11-22 13:10:36.889] [INFO] [PrivilegedOperationsCoordinator.swift:359 installBundledKanata()] ğŸ” [PrivCoordinator] Installing bundled Kanata binary
[2025-11-22 13:10:36.889] [INFO] [LaunchDaemonInstaller.swift:2898 installBundledKanataBinaryOnly()] ğŸ”§ [LaunchDaemon] Installing bundled kanata binary to system location
[2025-11-22 13:10:36.889] [INFO] [LaunchDaemonInstaller.swift:2906 installBundledKanataBinaryOnly()] âŒ [LaunchDaemon] CRITICAL: Bundled kanata binary not found at: /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata
[2025-11-22 13:10:36.889] [INFO] [LaunchDaemonInstaller.swift:2908 installBundledKanataBinaryOnly()] âŒ [LaunchDaemon] This indicates a packaging issue - the app bundle is missing the kanata binary
[2025-11-22 13:10:36.889] [INFO] [InstallerEngine.swift:451 execute(plan:using:)] âŒ [InstallerEngine] Recipe install-bundled-kanata failed: Operation failed: Bundled Kanata installation failed
[2025-11-22 13:10:36.889] [INFO] [InstallerEngine.swift:470 execute(plan:using:)] âœ… [InstallerEngine] execute() complete - success: false, recipes executed: 1
[2025-11-22 13:10:36.889] [INFO] [InstallerEngine.swift:625 run(intent:using:)] âœ… [InstallerEngine] run() complete - success: false
[2025-11-22 13:10:36.889] [INFO] [KanataManager.swift:331 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] init() called
[2025-11-22 13:10:36.890] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:10:36.890] [INFO] [ConfigFileWatcher.swift:40 init()] ğŸ“ [FileWatcher] ConfigFileWatcher initialized with robust monitoring
[2025-11-22 13:10:36.890] [INFO] [ServiceHealthMonitor.swift:140 init(processLifecycle:)] [HealthMonitor] Initialized with process lifecycle manager
[2025-11-22 13:10:36.890] [DEBUG] [KanataManager.swift:403 init(engineClient:injectedConfigurationService:)] ğŸ§ª [KanataManager] Skipping background initialization in test environment
[2025-11-22 13:10:36.890] [INFO] [KanataManager.swift:411 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] About to call bootstrapRuleCollections and startLayerMonitoring
[2025-11-22 13:10:36.890] [INFO] [KanataManager.swift:583 startLayerMonitoring()] ğŸŒ [KanataManager] startLayerMonitoring() called
[2025-11-22 13:10:36.890] [INFO] [KanataManager.swift:585 startLayerMonitoring()] ğŸŒ [KanataManager] Skipping layer monitoring (test environment)
[2025-11-22 13:10:36.890] [INFO] [KanataManager.swift:415 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] init() completed
[2025-11-22 13:10:36.890] [INFO] [ConfigFileWatcher.swift:54 suppressEvents(for:reason:)] ğŸ”‡ [FileWatcher] Suppressing events for 1.0s - Internal saveConfiguration
[2025-11-22 13:10:36.890] [INFO] [ConfigFileWatcher.swift:54 suppressEvents(for:reason:)] ğŸ”‡ [FileWatcher] Suppressing events for 1.0s - Internal saveConfiguration
[2025-11-22 13:10:36.890] [INFO] [ConfigFileWatcher.swift:54 suppressEvents(for:reason:)] ğŸ”‡ [FileWatcher] Suppressing events for 1.0s - Internal saveConfiguration
[2025-11-22 13:10:36.890] [INFO] [ConfigFileWatcher.swift:54 suppressEvents(for:reason:)] ğŸ”‡ [FileWatcher] Suppressing events for 1.0s - Internal saveConfiguration
[2025-11-22 13:10:36.890] [INFO] [ConfigFileWatcher.swift:54 suppressEvents(for:reason:)] ğŸ”‡ [FileWatcher] Suppressing events for 1.0s - Internal saveConfiguration
[2025-11-22 13:10:36.890] [INFO] [ConfigFileWatcher.swift:54 suppressEvents(for:reason:)] ğŸ”‡ [FileWatcher] Suppressing events for 1.0s - Internal saveConfiguration
[2025-11-22 13:10:36.890] [INFO] [ConfigFileWatcher.swift:54 suppressEvents(for:reason:)] ğŸ”‡ [FileWatcher] Suppressing events for 1.0s - Internal saveConfiguration
[2025-11-22 13:10:36.890] [INFO] [ConfigFileWatcher.swift:54 suppressEvents(for:reason:)] ğŸ”‡ [FileWatcher] Suppressing events for 1.0s - Internal saveConfiguration
[2025-11-22 13:10:36.890] [INFO] [ConfigFileWatcher.swift:54 suppressEvents(for:reason:)] ğŸ”‡ [FileWatcher] Suppressing events for 1.0s - Internal saveConfiguration
[2025-11-22 13:10:36.890] [INFO] [ConfigFileWatcher.swift:54 suppressEvents(for:reason:)] ğŸ”‡ [FileWatcher] Suppressing events for 1.0s - Internal saveConfiguration
[2025-11-22 13:10:36.890] [INFO] [KanataManager.swift:609 updateActiveLayerName(_:)] ğŸ¯ [KanataManager] updateActiveLayerName: raw='base' normalized='base' display='Base' current='Base'
[2025-11-22 13:10:36.890] [INFO] [KanataManager.swift:609 updateActiveLayerName(_:)] ğŸ¯ [KanataManager] updateActiveLayerName: raw='base' normalized='base' display='Base' current='Base'
[2025-11-22 13:10:36.890] [INFO] [KanataManager.swift:822 backupCurrentConfig()] ğŸ’¾ [Backup] Current config backed up successfully
[2025-11-22 13:10:36.890] [INFO] [KanataManager.swift:822 backupCurrentConfig()] ğŸ’¾ [Backup] Current config backed up successfully
[2025-11-22 13:10:36.890] [INFO] [KanataManager.swift:822 backupCurrentConfig()] ğŸ’¾ [Backup] Current config backed up successfully
[2025-11-22 13:10:36.890] [INFO] [KanataManager.swift:822 backupCurrentConfig()] ğŸ’¾ [Backup] Current config backed up successfully
[2025-11-22 13:10:36.890] [INFO] [KanataManager.swift:822 backupCurrentConfig()] ğŸ’¾ [Backup] Current config backed up successfully
[2025-11-22 13:10:36.890] [INFO] [KanataManager.swift:822 backupCurrentConfig()] ğŸ’¾ [Backup] Current config backed up successfully
[2025-11-22 13:10:36.890] [INFO] [KanataManager.swift:822 backupCurrentConfig()] ğŸ’¾ [Backup] Current config backed up successfully
[2025-11-22 13:10:36.890] [INFO] [KanataManager.swift:822 backupCurrentConfig()] ğŸ’¾ [Backup] Current config backed up successfully
[2025-11-22 13:10:36.890] [INFO] [KanataManager.swift:822 backupCurrentConfig()] ğŸ’¾ [Backup] Current config backed up successfully
[2025-11-22 13:10:36.890] [INFO] [KanataManager.swift:822 backupCurrentConfig()] ğŸ’¾ [Backup] Current config backed up successfully
[2025-11-22 13:10:36.891] [INFO] [KanataManager.swift:609 updateActiveLayerName(_:)] ğŸ¯ [KanataManager] updateActiveLayerName: raw='base' normalized='base' display='Base' current='Base'
[2025-11-22 13:10:36.891] [INFO] [KanataManager.swift:609 updateActiveLayerName(_:)] ğŸ¯ [KanataManager] updateActiveLayerName: raw='base' normalized='base' display='Base' current='Base'
[2025-11-22 13:10:36.892] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:10:36.892] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:10:36.892] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 3827 characters
[2025-11-22 13:10:36.892] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:10:36.893] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 18 src keys, 88 layer keys, deduplicated to 18 unique mappings
[2025-11-22 13:10:36.893] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:10:36.893] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:10:36.894] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:10:36.894] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:10:36.894] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 7007 characters
[2025-11-22 13:10:36.894] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:10:36.894] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 18 src keys, 88 layer keys, deduplicated to 18 unique mappings
[2025-11-22 13:10:36.894] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:10:36.894] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:10:36.895] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:10:36.895] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:10:36.895] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 7007 characters
[2025-11-22 13:10:36.895] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:10:36.896] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 18 src keys, 88 layer keys, deduplicated to 18 unique mappings
[2025-11-22 13:10:36.896] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:10:36.896] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:10:36.896] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 18 mappings
[2025-11-22 13:10:36.896] [DEBUG] [KanataManager+Configuration.swift:53 triggerConfigReload()] ğŸ“¡ [Reload] Attempting TCP reload
[2025-11-22 13:10:36.896] [DEBUG] [KanataManager+Configuration.swift:84 triggerTCPReload()] ğŸ§ª [TCP Reload] Skipping TCP reload in test environment
[2025-11-22 13:10:36.896] [DEBUG] [KanataManager+Configuration.swift:65 triggerConfigReload()] ğŸ“¡ [Reload] TCP reload failed: Test environment - TCP disabled
[2025-11-22 13:10:36.896] [WARN] [KanataManager+Configuration.swift:68 triggerConfigReload()] âš ï¸ [Reload] Falling back to service restart
[2025-11-22 13:10:36.896] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:10:36.896] [INFO] [SystemValidator.swift:63 init(launchDaemonInstaller:vhidDeviceManager:processLifecycleManager:kanataManager:)] ğŸ” [SystemValidator] Initialized (stateless, no cache)
[2025-11-22 13:10:36.896] [INFO] [InstallerEngine.swift:35 init(processLifecycleManager:kanataManager:)] ğŸ”§ [InstallerEngine] Initialized
[2025-11-22 13:10:36.896] [INFO] [InstallerEngine.swift:612 run(intent:using:)] ğŸš€ [InstallerEngine] Starting run(intent: repair, using:)
[2025-11-22 13:10:36.896] [INFO] [InstallerEngine.swift:53 inspectSystem()] ğŸ” [InstallerEngine] Starting inspectSystem()
[2025-11-22 13:10:36.896] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 28 mappings
[2025-11-22 13:10:36.896] [DEBUG] [KanataManager+Configuration.swift:53 triggerConfigReload()] ğŸ“¡ [Reload] Attempting TCP reload
[2025-11-22 13:10:36.896] [DEBUG] [KanataManager+Configuration.swift:84 triggerTCPReload()] ğŸ§ª [TCP Reload] Skipping TCP reload in test environment
[2025-11-22 13:10:36.896] [DEBUG] [KanataManager+Configuration.swift:65 triggerConfigReload()] ğŸ“¡ [Reload] TCP reload failed: Test environment - TCP disabled
[2025-11-22 13:10:36.896] [WARN] [KanataManager+Configuration.swift:68 triggerConfigReload()] âš ï¸ [Reload] Falling back to service restart
[2025-11-22 13:10:36.896] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:10:36.896] [INFO] [SystemValidator.swift:63 init(launchDaemonInstaller:vhidDeviceManager:processLifecycleManager:kanataManager:)] ğŸ” [SystemValidator] Initialized (stateless, no cache)
[2025-11-22 13:10:36.896] [INFO] [InstallerEngine.swift:35 init(processLifecycleManager:kanataManager:)] ğŸ”§ [InstallerEngine] Initialized
[2025-11-22 13:10:36.896] [INFO] [InstallerEngine.swift:612 run(intent:using:)] ğŸš€ [InstallerEngine] Starting run(intent: repair, using:)
[2025-11-22 13:10:36.896] [INFO] [InstallerEngine.swift:53 inspectSystem()] ğŸ” [InstallerEngine] Starting inspectSystem()
[2025-11-22 13:10:36.897] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:10:36.897] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:10:36.897] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 7007 characters
[2025-11-22 13:10:36.897] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:10:36.897] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 18 src keys, 88 layer keys, deduplicated to 18 unique mappings
[2025-11-22 13:10:36.897] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:10:36.897] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:10:36.898] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:10:36.898] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:10:36.898] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 7007 characters
[2025-11-22 13:10:36.898] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:10:36.898] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 18 src keys, 88 layer keys, deduplicated to 18 unique mappings
[2025-11-22 13:10:36.898] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:10:36.898] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:10:36.898] [INFO] [SystemValidator.swift:143 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Starting validation #1
[2025-11-22 13:10:36.898] [INFO] [SystemValidator.swift:174 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 START: 1763845836.898
[2025-11-22 13:10:36.899] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:10:36.899] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:10:36.899] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 7007 characters
[2025-11-22 13:10:36.899] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:10:36.899] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 18 src keys, 88 layer keys, deduplicated to 18 unique mappings
[2025-11-22 13:10:36.899] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:10:36.899] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:10:36.899] [INFO] [SystemValidator.swift:133 performValidationBody(progressCallback:)] âš ï¸ [SystemValidator] RAPID VALIDATION: 0.001s since last validation
This might indicate automatic triggers. Expected: manual user actions only.
[2025-11-22 13:10:36.899] [INFO] [SystemValidator.swift:143 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Starting validation #1
[2025-11-22 13:10:36.899] [INFO] [SystemValidator.swift:174 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 START: 1763845836.899
[2025-11-22 13:10:36.899] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 28 mappings
[2025-11-22 13:10:36.899] [DEBUG] [KanataManager.swift:1231 saveConfiguration(input:output:)] ğŸ“¡ [Config] Triggering TCP reload for validation
[2025-11-22 13:10:36.899] [DEBUG] [KanataManager+Configuration.swift:84 triggerTCPReload()] ğŸ§ª [TCP Reload] Skipping TCP reload in test environment
[2025-11-22 13:10:36.899] [ERROR] [KanataManager.swift:1247 saveConfiguration(input:output:)] âŒ [Config] TCP reload FAILED: Test environment - TCP disabled
[2025-11-22 13:10:36.899] [ERROR] [KanataManager.swift:1248 saveConfiguration(input:output:)] âŒ [Config] TCP server is required for validation-on-demand - restoring backup
[2025-11-22 13:10:36.900] [INFO] [KanataManager.swift:835 restoreLastGoodConfig()] ğŸ”„ [Restore] Restored last good config successfully
[2025-11-22 13:10:36.900] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:10:36.900] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:10:36.900] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 7007 characters
[2025-11-22 13:10:36.900] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:10:36.901] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 18 src keys, 88 layer keys, deduplicated to 18 unique mappings
[2025-11-22 13:10:36.901] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:10:36.901] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:10:36.901] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:10:36.901] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:10:36.901] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 7007 characters
[2025-11-22 13:10:36.901] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:10:36.901] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 18 src keys, 88 layer keys, deduplicated to 18 unique mappings
[2025-11-22 13:10:36.901] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:10:36.901] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:10:36.902] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:10:36.902] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:10:36.902] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 7007 characters
[2025-11-22 13:10:36.902] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:10:36.902] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 18 src keys, 88 layer keys, deduplicated to 18 unique mappings
[2025-11-22 13:10:36.902] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:10:36.902] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:10:36.903] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:10:36.903] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:10:36.903] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 7007 characters
[2025-11-22 13:10:36.903] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:10:36.903] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 18 src keys, 88 layer keys, deduplicated to 18 unique mappings
[2025-11-22 13:10:36.903] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:10:36.903] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:10:36.903] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 28 mappings
[2025-11-22 13:10:36.903] [DEBUG] [KanataManager.swift:1231 saveConfiguration(input:output:)] ğŸ“¡ [Config] Triggering TCP reload for validation
[2025-11-22 13:10:36.903] [DEBUG] [KanataManager+Configuration.swift:84 triggerTCPReload()] ğŸ§ª [TCP Reload] Skipping TCP reload in test environment
[2025-11-22 13:10:36.903] [ERROR] [KanataManager.swift:1247 saveConfiguration(input:output:)] âŒ [Config] TCP reload FAILED: Test environment - TCP disabled
[2025-11-22 13:10:36.903] [ERROR] [KanataManager.swift:1248 saveConfiguration(input:output:)] âŒ [Config] TCP server is required for validation-on-demand - restoring backup
[2025-11-22 13:10:36.903] [INFO] [KanataManager.swift:835 restoreLastGoodConfig()] ğŸ”„ [Restore] Restored last good config successfully
[2025-11-22 13:10:36.904] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:10:36.904] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:10:36.904] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 7007 characters
[2025-11-22 13:10:36.904] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:10:36.904] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 18 src keys, 88 layer keys, deduplicated to 18 unique mappings
[2025-11-22 13:10:36.904] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:10:36.904] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:10:36.904] [INFO] [SystemValidator.swift:312 checkHelper()] ğŸ” [SystemValidator] Checking privileged helper
[2025-11-22 13:10:36.904] [INFO] [SystemValidator.swift:365 checkComponents()] ğŸ” [SystemValidator] Checking components
[2025-11-22 13:10:36.904] [INFO] [KanataBinaryDetector.swift:66 detectCurrentStatus()] ğŸ” [KanataBinaryDetector] Starting unified kanata binary detection
[2025-11-22 13:10:36.904] [INFO] [KanataBinaryDetector.swift:81 detectCurrentStatus()] âŒ [KanataBinaryDetector] No kanata binary found
[2025-11-22 13:10:36.904] [INFO] [VHIDDeviceManager.swift:50 detectInstallation()] ğŸ” [VHIDManager] Manager app exists at /Applications/.Karabiner-VirtualHIDDevice-Manager.app/Contents/MacOS/Karabiner-VirtualHIDDevice-Manager: true
[2025-11-22 13:10:36.909] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:10:36.914] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:10:36.930] [INFO] [HelperManager.swift:830 verifyEmbeddedHelperSignature()] ğŸ”’ [HelperManager] Embedded helper signature looks valid
[2025-11-22 13:10:36.930] [INFO] [HelperManager.swift:105 getConnection()] ğŸ”— [HelperManager] Creating XPC connection to com.keypath.helper
[2025-11-22 13:10:36.930] [INFO] [HelperManager.swift:129 getConnection()] âœ… [HelperManager] XPC connection established (PID: 0)
[2025-11-22 13:10:36.930] [INFO] [HelperManager.swift:228 getHelperVersion()] ğŸ“¤ [HelperManager] Calling proxy.getVersion()
[2025-11-22 13:10:36.930] [INFO] [HelperManager.swift:243 getHelperVersion()] ğŸ“¤ [HelperManager] proxy.getVersion() call dispatched, waiting for callback
[2025-11-22 13:10:36.931] [INFO] [HelperManager.swift:121 getConnection()] âš ï¸ [HelperManager] XPC connection interrupted - will reconnect
[2025-11-22 13:10:36.931] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:10:36.931] [INFO] [HelperManager.swift:578 getRemoteProxy(errorHandler:)] âŒ [HelperManager] XPC proxy error: Couldnâ€™t communicate with a helper application.
[2025-11-22 13:10:36.931] [INFO] [HelperManager.swift:584 getRemoteProxy(errorHandler:)] âš ï¸ [HelperManager] XPC connection interrupted - this may indicate:
[2025-11-22 13:10:36.931] [INFO] [HelperManager.swift:585 getRemoteProxy(errorHandler:)]    1. Helper signature validation failed (app updated but not restarted)
[2025-11-22 13:10:36.931] [INFO] [HelperManager.swift:587 getRemoteProxy(errorHandler:)]    2. Helper process crashed
[2025-11-22 13:10:36.931] [INFO] [HelperManager.swift:588 getRemoteProxy(errorHandler:)]    3. Helper was killed by the system
[2025-11-22 13:10:36.931] [INFO] [HelperManager.swift:589 getRemoteProxy(errorHandler:)] ğŸ’¡ If you just updated KeyPath, try restarting the app
[2025-11-22 13:10:36.931] [INFO] [HelperManager.swift:116 getConnection()] âŒ [HelperManager] XPC connection invalidated
[2025-11-22 13:10:36.931] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:10:36.973] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.068s)
[2025-11-22 13:10:36.973] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:10:37.545] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.067s)
[2025-11-22 13:10:37.545] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:10:37.545] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:10:37.545] [INFO] [VHIDDeviceManager.swift:343 getInstalledVersion()] ğŸ” [VHIDManager] Installed daemon version: 5.0.0
[2025-11-22 13:10:37.545] [INFO] [VHIDDeviceManager.swift:374 hasVersionMismatch()] âœ… [VHIDManager] Version compatible: v5.0.0
[2025-11-22 13:10:37.545] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:10:37.612] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:10:37.613] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:10:37.613] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:10:37.613] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:10:37.613] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:10:37.613] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:10:37.613] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:10:37.613] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:10:37.613] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:10:37.613] [INFO] [LaunchDaemonInstaller.swift:669 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Kanata service state: Uninstalled
[2025-11-22 13:10:37.613] [INFO] [LaunchDaemonInstaller.swift:696 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Service not installed (state: Uninstalled)
[2025-11-22 13:10:37.613] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:10:37.679] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:10:37.747] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhiddaemon loaded: false
[2025-11-22 13:10:37.815] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhidmanager loaded: false
[2025-11-22 13:10:37.815] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:10:37.883] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:10:37.883] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhidmanager
[2025-11-22 13:10:37.951] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhidmanager not found in system domain
[2025-11-22 13:10:37.951] [INFO] [SystemValidator.swift:393 checkComponents()] ğŸ” [SystemValidator] Components: kanata=false, driver=true, daemon=false, vhid=false, vhidVersionMismatch=false
[2025-11-22 13:10:37.951] [INFO] [SystemValidator.swift:220 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 3 (Components) completed in 1.053s
[2025-11-22 13:10:37.951] [INFO] [SystemValidator.swift:411 checkConflicts()] ğŸ” [SystemValidator] Checking for conflicts
[2025-11-22 13:10:37.951] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 20% (1/5 steps)
[2025-11-22 13:10:37.951] [INFO] [ProcessLifecycleManager.swift:117 detectConflicts()] ğŸ” [ProcessLifecycleManager] Detecting conflicts...
[2025-11-22 13:10:37.951] [INFO] [ProcessLifecycleManager.swift:121 detectConflicts()] ğŸ§ª [TestEnvironment] Skipping process conflict detection - returning clean state
[2025-11-22 13:10:37.951] [INFO] [SystemValidator.swift:436 checkConflicts()] ğŸ” [SystemValidator] Total conflicts: 0 (0 kanata, 0 karabiner)
[2025-11-22 13:10:37.951] [INFO] [SystemValidator.swift:344 checkPermissions()] ğŸ” [SystemValidator] Checking permissions via Oracle
[2025-11-22 13:10:37.951] [INFO] [SystemValidator.swift:477 checkHealth()] ğŸ” [SystemValidator] Checking system health
[2025-11-22 13:10:37.951] [INFO] [SystemValidator.swift:229 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 4 (Conflicts) completed in 1.053s
[2025-11-22 13:10:37.951] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:10:37.951] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 40% (2/5 steps)
[2025-11-22 13:10:37.951] [INFO] [PermissionOracle.swift:173 currentSnapshot()] ğŸ”® [Oracle] Test mode snapshot generated (non-blocking)
[2025-11-22 13:10:38.019] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:10:38.019] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:10:38.087] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:10:38.146] [INFO] [HelperManager.swift:248 getHelperVersion()] âš ï¸ [HelperManager] getVersion timed out - clearing connection cache
[2025-11-22 13:10:38.146] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:10:38.154] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.066s)
[2025-11-22 13:10:38.154] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:10:38.726] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.067s)
[2025-11-22 13:10:38.727] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:10:38.727] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:10:38.727] [INFO] [SystemValidator.swift:487 checkHealth()] ğŸ” [SystemValidator] Health: kanata=false, daemon=false (launchctl), vhid=false
[2025-11-22 13:10:38.727] [INFO] [SystemValidator.swift:238 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 5 (Health) completed in 1.828s
[2025-11-22 13:10:38.727] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 60% (3/5 steps)
[2025-11-22 13:10:38.727] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 28 mappings
[2025-11-22 13:10:38.727] [DEBUG] [KanataManager.swift:1231 saveConfiguration(input:output:)] ğŸ“¡ [Config] Triggering TCP reload for validation
[2025-11-22 13:10:38.727] [DEBUG] [KanataManager+Configuration.swift:84 triggerTCPReload()] ğŸ§ª [TCP Reload] Skipping TCP reload in test environment
[2025-11-22 13:10:38.727] [ERROR] [KanataManager.swift:1247 saveConfiguration(input:output:)] âŒ [Config] TCP reload FAILED: Test environment - TCP disabled
[2025-11-22 13:10:38.727] [ERROR] [KanataManager.swift:1248 saveConfiguration(input:output:)] âŒ [Config] TCP server is required for validation-on-demand - restoring backup
[2025-11-22 13:10:38.728] [INFO] [KanataManager.swift:835 restoreLastGoodConfig()] ğŸ”„ [Restore] Restored last good config successfully
[2025-11-22 13:10:38.728] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:10:38.728] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:10:38.728] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 7007 characters
[2025-11-22 13:10:38.728] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:10:38.729] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 18 src keys, 88 layer keys, deduplicated to 18 unique mappings
[2025-11-22 13:10:38.729] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:10:38.729] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:10:38.729] [INFO] [SystemValidator.swift:312 checkHelper()] ğŸ” [SystemValidator] Checking privileged helper
[2025-11-22 13:10:38.729] [INFO] [SystemValidator.swift:344 checkPermissions()] ğŸ” [SystemValidator] Checking permissions via Oracle
[2025-11-22 13:10:38.729] [INFO] [SystemValidator.swift:365 checkComponents()] ğŸ” [SystemValidator] Checking components
[2025-11-22 13:10:38.729] [INFO] [KanataBinaryDetector.swift:66 detectCurrentStatus()] ğŸ” [KanataBinaryDetector] Starting unified kanata binary detection
[2025-11-22 13:10:38.729] [INFO] [PermissionOracle.swift:158 currentSnapshot()] ğŸ”® [Oracle] (Test) Returning cached snapshot
[2025-11-22 13:10:38.729] [INFO] [KanataBinaryDetector.swift:81 detectCurrentStatus()] âŒ [KanataBinaryDetector] No kanata binary found
[2025-11-22 13:10:38.729] [INFO] [VHIDDeviceManager.swift:50 detectInstallation()] ğŸ” [VHIDManager] Manager app exists at /Applications/.Karabiner-VirtualHIDDevice-Manager.app/Contents/MacOS/Karabiner-VirtualHIDDevice-Manager: true
[2025-11-22 13:10:38.736] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:10:38.742] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:10:38.761] [INFO] [HelperManager.swift:830 verifyEmbeddedHelperSignature()] ğŸ”’ [HelperManager] Embedded helper signature looks valid
[2025-11-22 13:10:38.762] [INFO] [HelperManager.swift:105 getConnection()] ğŸ”— [HelperManager] Creating XPC connection to com.keypath.helper
[2025-11-22 13:10:38.762] [INFO] [HelperManager.swift:129 getConnection()] âœ… [HelperManager] XPC connection established (PID: 0)
[2025-11-22 13:10:38.762] [INFO] [HelperManager.swift:228 getHelperVersion()] ğŸ“¤ [HelperManager] Calling proxy.getVersion()
[2025-11-22 13:10:38.762] [INFO] [HelperManager.swift:243 getHelperVersion()] ğŸ“¤ [HelperManager] proxy.getVersion() call dispatched, waiting for callback
[2025-11-22 13:10:38.763] [INFO] [HelperManager.swift:121 getConnection()] âš ï¸ [HelperManager] XPC connection interrupted - will reconnect
[2025-11-22 13:10:38.763] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:10:38.763] [INFO] [HelperManager.swift:578 getRemoteProxy(errorHandler:)] âŒ [HelperManager] XPC proxy error: Couldnâ€™t communicate with a helper application.
[2025-11-22 13:10:38.763] [INFO] [HelperManager.swift:584 getRemoteProxy(errorHandler:)] âš ï¸ [HelperManager] XPC connection interrupted - this may indicate:
[2025-11-22 13:10:38.763] [INFO] [HelperManager.swift:585 getRemoteProxy(errorHandler:)]    1. Helper signature validation failed (app updated but not restarted)
[2025-11-22 13:10:38.763] [INFO] [HelperManager.swift:587 getRemoteProxy(errorHandler:)]    2. Helper process crashed
[2025-11-22 13:10:38.763] [INFO] [HelperManager.swift:588 getRemoteProxy(errorHandler:)]    3. Helper was killed by the system
[2025-11-22 13:10:38.763] [INFO] [HelperManager.swift:589 getRemoteProxy(errorHandler:)] ğŸ’¡ If you just updated KeyPath, try restarting the app
[2025-11-22 13:10:38.763] [INFO] [HelperManager.swift:116 getConnection()] âŒ [HelperManager] XPC connection invalidated
[2025-11-22 13:10:38.763] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:10:38.797] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.068s)
[2025-11-22 13:10:38.797] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:10:39.371] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.069s)
[2025-11-22 13:10:39.371] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:10:39.371] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:10:39.371] [INFO] [VHIDDeviceManager.swift:343 getInstalledVersion()] ğŸ” [VHIDManager] Installed daemon version: 5.0.0
[2025-11-22 13:10:39.372] [INFO] [VHIDDeviceManager.swift:374 hasVersionMismatch()] âœ… [VHIDManager] Version compatible: v5.0.0
[2025-11-22 13:10:39.372] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:10:39.439] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:10:39.439] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:10:39.439] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:10:39.439] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:10:39.439] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:10:39.440] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:10:39.440] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:10:39.440] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:10:39.440] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:10:39.440] [INFO] [LaunchDaemonInstaller.swift:669 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Kanata service state: Uninstalled
[2025-11-22 13:10:39.440] [INFO] [LaunchDaemonInstaller.swift:696 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Service not installed (state: Uninstalled)
[2025-11-22 13:10:39.440] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:10:39.507] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:10:39.574] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhiddaemon loaded: false
[2025-11-22 13:10:39.642] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhidmanager loaded: false
[2025-11-22 13:10:39.642] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:10:39.709] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:10:39.709] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhidmanager
[2025-11-22 13:10:39.777] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhidmanager not found in system domain
[2025-11-22 13:10:39.777] [INFO] [SystemValidator.swift:393 checkComponents()] ğŸ” [SystemValidator] Components: kanata=false, driver=true, daemon=false, vhid=false, vhidVersionMismatch=false
[2025-11-22 13:10:39.777] [INFO] [SystemValidator.swift:411 checkConflicts()] ğŸ” [SystemValidator] Checking for conflicts
[2025-11-22 13:10:39.777] [INFO] [ProcessLifecycleManager.swift:117 detectConflicts()] ğŸ” [ProcessLifecycleManager] Detecting conflicts...
[2025-11-22 13:10:39.778] [INFO] [ProcessLifecycleManager.swift:121 detectConflicts()] ğŸ§ª [TestEnvironment] Skipping process conflict detection - returning clean state
[2025-11-22 13:10:39.778] [INFO] [SystemValidator.swift:436 checkConflicts()] ğŸ” [SystemValidator] Total conflicts: 0 (0 kanata, 0 karabiner)
[2025-11-22 13:10:39.778] [INFO] [SystemValidator.swift:477 checkHealth()] ğŸ” [SystemValidator] Checking system health
[2025-11-22 13:10:39.778] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:10:39.778] [INFO] [SystemValidator.swift:220 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 3 (Components) completed in 2.879s
[2025-11-22 13:10:39.778] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 20% (1/5 steps)
[2025-11-22 13:10:39.779] [INFO] [SystemValidator.swift:229 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 4 (Conflicts) completed in 2.879s
[2025-11-22 13:10:39.779] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 40% (2/5 steps)
[2025-11-22 13:10:39.846] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:10:39.846] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:10:39.914] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:10:39.980] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.066s)
[2025-11-22 13:10:39.980] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:10:40.004] [INFO] [HelperManager.swift:248 getHelperVersion()] âš ï¸ [HelperManager] getVersion timed out - clearing connection cache
[2025-11-22 13:10:40.004] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:10:40.554] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.068s)
[2025-11-22 13:10:40.554] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:10:40.554] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:10:40.554] [INFO] [SystemValidator.swift:487 checkHealth()] ğŸ” [SystemValidator] Health: kanata=false, daemon=false (launchctl), vhid=false
[2025-11-22 13:10:40.554] [INFO] [SystemValidator.swift:238 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 5 (Health) completed in 3.655s
[2025-11-22 13:10:40.554] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 60% (3/5 steps)
[2025-11-22 13:10:40.554] [INFO] [SoundManager.swift:15 playTinkSound()] ğŸ§ª [Sound] Suppressed tink sound in test environment
[2025-11-22 13:10:40.554] [INFO] [SoundManager.swift:35 playErrorSound()] ğŸ§ª [Sound] Suppressed error beep in test environment
[2025-11-22 13:10:40.554] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 28 mappings
[2025-11-22 13:10:40.554] [DEBUG] [KanataManager.swift:1231 saveConfiguration(input:output:)] ğŸ“¡ [Config] Triggering TCP reload for validation
[2025-11-22 13:10:40.554] [DEBUG] [KanataManager+Configuration.swift:84 triggerTCPReload()] ğŸ§ª [TCP Reload] Skipping TCP reload in test environment
[2025-11-22 13:10:40.554] [ERROR] [KanataManager.swift:1247 saveConfiguration(input:output:)] âŒ [Config] TCP reload FAILED: Test environment - TCP disabled
[2025-11-22 13:10:40.554] [ERROR] [KanataManager.swift:1248 saveConfiguration(input:output:)] âŒ [Config] TCP server is required for validation-on-demand - restoring backup
[2025-11-22 13:10:40.555] [INFO] [KanataManager.swift:835 restoreLastGoodConfig()] ğŸ”„ [Restore] Restored last good config successfully
[2025-11-22 13:10:40.555] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 28 mappings
[2025-11-22 13:10:40.555] [DEBUG] [KanataManager.swift:1231 saveConfiguration(input:output:)] ğŸ“¡ [Config] Triggering TCP reload for validation
[2025-11-22 13:10:40.555] [DEBUG] [KanataManager+Configuration.swift:84 triggerTCPReload()] ğŸ§ª [TCP Reload] Skipping TCP reload in test environment
[2025-11-22 13:10:40.555] [ERROR] [KanataManager.swift:1247 saveConfiguration(input:output:)] âŒ [Config] TCP reload FAILED: Test environment - TCP disabled
[2025-11-22 13:10:40.555] [ERROR] [KanataManager.swift:1248 saveConfiguration(input:output:)] âŒ [Config] TCP server is required for validation-on-demand - restoring backup
[2025-11-22 13:10:40.555] [INFO] [KanataManager.swift:835 restoreLastGoodConfig()] ğŸ”„ [Restore] Restored last good config successfully
[2025-11-22 13:10:40.555] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 28 mappings
[2025-11-22 13:10:40.555] [DEBUG] [KanataManager.swift:1231 saveConfiguration(input:output:)] ğŸ“¡ [Config] Triggering TCP reload for validation
[2025-11-22 13:10:40.555] [DEBUG] [KanataManager+Configuration.swift:84 triggerTCPReload()] ğŸ§ª [TCP Reload] Skipping TCP reload in test environment
[2025-11-22 13:10:40.555] [ERROR] [KanataManager.swift:1247 saveConfiguration(input:output:)] âŒ [Config] TCP reload FAILED: Test environment - TCP disabled
[2025-11-22 13:10:40.555] [ERROR] [KanataManager.swift:1248 saveConfiguration(input:output:)] âŒ [Config] TCP server is required for validation-on-demand - restoring backup
[2025-11-22 13:10:40.556] [INFO] [KanataManager.swift:835 restoreLastGoodConfig()] ğŸ”„ [Restore] Restored last good config successfully
[2025-11-22 13:10:40.556] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 28 mappings
[2025-11-22 13:10:40.556] [DEBUG] [KanataManager.swift:1231 saveConfiguration(input:output:)] ğŸ“¡ [Config] Triggering TCP reload for validation
[2025-11-22 13:10:40.556] [DEBUG] [KanataManager+Configuration.swift:84 triggerTCPReload()] ğŸ§ª [TCP Reload] Skipping TCP reload in test environment
[2025-11-22 13:10:40.556] [ERROR] [KanataManager.swift:1247 saveConfiguration(input:output:)] âŒ [Config] TCP reload FAILED: Test environment - TCP disabled
[2025-11-22 13:10:40.556] [ERROR] [KanataManager.swift:1248 saveConfiguration(input:output:)] âŒ [Config] TCP server is required for validation-on-demand - restoring backup
[2025-11-22 13:10:40.556] [INFO] [KanataManager.swift:835 restoreLastGoodConfig()] ğŸ”„ [Restore] Restored last good config successfully
[2025-11-22 13:10:40.556] [INFO] [SoundManager.swift:15 playTinkSound()] ğŸ§ª [Sound] Suppressed tink sound in test environment
[2025-11-22 13:10:40.556] [INFO] [SoundManager.swift:35 playErrorSound()] ğŸ§ª [Sound] Suppressed error beep in test environment
[2025-11-22 13:10:40.556] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 28 mappings
[2025-11-22 13:10:40.556] [DEBUG] [KanataManager.swift:1231 saveConfiguration(input:output:)] ğŸ“¡ [Config] Triggering TCP reload for validation
[2025-11-22 13:10:40.556] [DEBUG] [KanataManager+Configuration.swift:84 triggerTCPReload()] ğŸ§ª [TCP Reload] Skipping TCP reload in test environment
[2025-11-22 13:10:40.556] [ERROR] [KanataManager.swift:1247 saveConfiguration(input:output:)] âŒ [Config] TCP reload FAILED: Test environment - TCP disabled
[2025-11-22 13:10:40.556] [ERROR] [KanataManager.swift:1248 saveConfiguration(input:output:)] âŒ [Config] TCP server is required for validation-on-demand - restoring backup
[2025-11-22 13:10:40.557] [INFO] [KanataManager.swift:835 restoreLastGoodConfig()] ğŸ”„ [Restore] Restored last good config successfully
[2025-11-22 13:10:40.557] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 28 mappings
[2025-11-22 13:10:40.557] [DEBUG] [KanataManager.swift:1231 saveConfiguration(input:output:)] ğŸ“¡ [Config] Triggering TCP reload for validation
[2025-11-22 13:10:40.557] [DEBUG] [KanataManager+Configuration.swift:84 triggerTCPReload()] ğŸ§ª [TCP Reload] Skipping TCP reload in test environment
[2025-11-22 13:10:40.557] [ERROR] [KanataManager.swift:1247 saveConfiguration(input:output:)] âŒ [Config] TCP reload FAILED: Test environment - TCP disabled
[2025-11-22 13:10:40.557] [ERROR] [KanataManager.swift:1248 saveConfiguration(input:output:)] âŒ [Config] TCP server is required for validation-on-demand - restoring backup
[2025-11-22 13:10:40.557] [INFO] [KanataManager.swift:835 restoreLastGoodConfig()] ğŸ”„ [Restore] Restored last good config successfully
[2025-11-22 13:10:40.557] [INFO] [SystemValidator.swift:355 checkPermissions()] ğŸ” [SystemValidator] Oracle snapshot: ready=false, age=2.606s
[2025-11-22 13:10:40.557] [INFO] [SystemValidator.swift:328 checkHelper()] ğŸ” [SystemValidator] Helper state: registeredButUnresponsive Helper registered but XPC communication failed
[2025-11-22 13:10:40.557] [INFO] [SystemValidator.swift:211 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 2 (Permissions) completed in 3.659s
[2025-11-22 13:10:40.557] [INFO] [SoundManager.swift:15 playTinkSound()] ğŸ§ª [Sound] Suppressed tink sound in test environment
[2025-11-22 13:10:40.557] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 80% (4/5 steps)
[2025-11-22 13:10:40.557] [INFO] [SoundManager.swift:35 playErrorSound()] ğŸ§ª [Sound] Suppressed error beep in test environment
[2025-11-22 13:10:40.557] [INFO] [SystemValidator.swift:355 checkPermissions()] ğŸ” [SystemValidator] Oracle snapshot: ready=false, age=2.606s
[2025-11-22 13:10:40.557] [INFO] [SystemValidator.swift:202 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 1 (Helper) completed in 5.494s
[2025-11-22 13:10:40.557] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 28 mappings
[2025-11-22 13:10:40.557] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 100% (5/5 steps)
[2025-11-22 13:10:40.557] [DEBUG] [KanataManager.swift:1231 saveConfiguration(input:output:)] ğŸ“¡ [Config] Triggering TCP reload for validation
[2025-11-22 13:10:40.557] [INFO] [SystemValidator.swift:211 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 2 (Permissions) completed in 3.658s
[2025-11-22 13:10:40.557] [DEBUG] [KanataManager+Configuration.swift:84 triggerTCPReload()] ğŸ§ª [TCP Reload] Skipping TCP reload in test environment
[2025-11-22 13:10:40.557] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 80% (4/5 steps)
[2025-11-22 13:10:40.557] [ERROR] [KanataManager.swift:1247 saveConfiguration(input:output:)] âŒ [Config] TCP reload FAILED: Test environment - TCP disabled
[2025-11-22 13:10:40.557] [ERROR] [KanataManager.swift:1248 saveConfiguration(input:output:)] âŒ [Config] TCP server is required for validation-on-demand - restoring backup
[2025-11-22 13:10:40.558] [INFO] [KanataManager.swift:835 restoreLastGoodConfig()] ğŸ”„ [Restore] Restored last good config successfully
[2025-11-22 13:10:40.558] [INFO] [SystemValidator.swift:328 checkHelper()] ğŸ” [SystemValidator] Helper state: registeredButUnresponsive Helper registered but XPC communication failed
[2025-11-22 13:10:40.558] [INFO] [SoundManager.swift:15 playTinkSound()] ğŸ§ª [Sound] Suppressed tink sound in test environment
[2025-11-22 13:10:40.558] [INFO] [SystemValidator.swift:202 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 1 (Helper) completed in 3.660s
[2025-11-22 13:10:40.558] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 100% (5/5 steps)
[2025-11-22 13:10:40.558] [INFO] [SoundManager.swift:35 playErrorSound()] ğŸ§ª [Sound] Suppressed error beep in test environment
[2025-11-22 13:10:40.558] [INFO] [SoundManager.swift:15 playTinkSound()] ğŸ§ª [Sound] Suppressed tink sound in test environment
[2025-11-22 13:10:40.558] [INFO] [SoundManager.swift:35 playErrorSound()] ğŸ§ª [Sound] Suppressed error beep in test environment
[2025-11-22 13:10:40.558] [INFO] [SoundManager.swift:15 playTinkSound()] ğŸ§ª [Sound] Suppressed tink sound in test environment
[2025-11-22 13:10:40.558] [INFO] [SoundManager.swift:35 playErrorSound()] ğŸ§ª [Sound] Suppressed error beep in test environment
[2025-11-22 13:10:40.558] [INFO] [SoundManager.swift:15 playTinkSound()] ğŸ§ª [Sound] Suppressed tink sound in test environment
[2025-11-22 13:10:40.558] [INFO] [SoundManager.swift:35 playErrorSound()] ğŸ§ª [Sound] Suppressed error beep in test environment
[2025-11-22 13:10:40.558] [INFO] [SoundManager.swift:15 playTinkSound()] ğŸ§ª [Sound] Suppressed tink sound in test environment
[2025-11-22 13:10:40.558] [INFO] [SoundManager.swift:35 playErrorSound()] ğŸ§ª [Sound] Suppressed error beep in test environment
[2025-11-22 13:10:40.558] [INFO] [SoundManager.swift:15 playTinkSound()] ğŸ§ª [Sound] Suppressed tink sound in test environment
[2025-11-22 13:10:40.558] [INFO] [SoundManager.swift:35 playErrorSound()] ğŸ§ª [Sound] Suppressed error beep in test environment
[2025-11-22 13:10:40.558] [INFO] [SoundManager.swift:15 playTinkSound()] ğŸ§ª [Sound] Suppressed tink sound in test environment
[2025-11-22 13:10:40.558] [INFO] [SoundManager.swift:35 playErrorSound()] ğŸ§ª [Sound] Suppressed error beep in test environment
[2025-11-22 13:10:40.558] [INFO] [SystemValidator.swift:283 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 COMPLETE: Total duration 3.660s
[2025-11-22 13:10:40.558] [INFO] [SystemValidator.swift:297 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Validation #1 complete in 3.660s
[2025-11-22 13:10:40.559] [INFO] [SystemValidator.swift:299 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Result: ready=false, blocking=9, total=9
[2025-11-22 13:10:40.559] [INFO] [SystemValidator.swift:283 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 COMPLETE: Total duration 5.496s
[2025-11-22 13:10:40.559] [INFO] [SystemValidator.swift:297 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Validation #1 complete in 5.496s
[2025-11-22 13:10:40.559] [INFO] [SystemValidator.swift:299 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Result: ready=false, blocking=9, total=9
[2025-11-22 13:10:40.559] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:10:40.559] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:10:40.559] [INFO] [SystemRequirements.swift:135 validateSystemCompatibility()] ğŸ” [SystemRequirements] Validating system compatibility
[2025-11-22 13:10:40.559] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:10:40.559] [INFO] [SystemRequirements.swift:147 validateSystemCompatibility()] âœ… [SystemRequirements] Modern macOS detected: 26.0.1
[2025-11-22 13:10:40.559] [INFO] [SystemRequirements.swift:190 validateSystemCompatibility()] ğŸ” [SystemRequirements] Compatibility check complete: âœ… Compatible
[2025-11-22 13:10:40.559] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:10:40.559] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:10:40.559] [INFO] [InstallerEngine.swift:78 inspectSystem()] âœ… [InstallerEngine] inspectSystem() complete - ready=false, blocking=9
[2025-11-22 13:10:40.559] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: repair, context:)
[2025-11-22 13:10:40.559] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: repair
[2025-11-22 13:10:40.559] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:10:40.559] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:10:40.559] [INFO] [InstallerEngine.swift:390 execute(plan:using:)] âš™ï¸ [InstallerEngine] Starting execute(plan:, using:)
[2025-11-22 13:10:40.559] [INFO] [InstallerEngine.swift:409 execute(plan:using:)] âš™ï¸ [InstallerEngine] Executing recipe: install-bundled-kanata (type: installComponent)
[2025-11-22 13:10:40.559] [INFO] [PrivilegedOperationsCoordinator.swift:359 installBundledKanata()] ğŸ” [PrivCoordinator] Installing bundled Kanata binary
[2025-11-22 13:10:40.559] [INFO] [LaunchDaemonInstaller.swift:2898 installBundledKanataBinaryOnly()] ğŸ”§ [LaunchDaemon] Installing bundled kanata binary to system location
[2025-11-22 13:10:40.559] [INFO] [LaunchDaemonInstaller.swift:2906 installBundledKanataBinaryOnly()] âŒ [LaunchDaemon] CRITICAL: Bundled kanata binary not found at: /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata
[2025-11-22 13:10:40.559] [INFO] [LaunchDaemonInstaller.swift:2908 installBundledKanataBinaryOnly()] âŒ [LaunchDaemon] This indicates a packaging issue - the app bundle is missing the kanata binary
[2025-11-22 13:10:40.559] [INFO] [InstallerEngine.swift:451 execute(plan:using:)] âŒ [InstallerEngine] Recipe install-bundled-kanata failed: Operation failed: Bundled Kanata installation failed
[2025-11-22 13:10:40.559] [INFO] [InstallerEngine.swift:470 execute(plan:using:)] âœ… [InstallerEngine] execute() complete - success: false, recipes executed: 1
[2025-11-22 13:10:40.559] [INFO] [InstallerEngine.swift:625 run(intent:using:)] âœ… [InstallerEngine] run() complete - success: false
[2025-11-22 13:10:40.559] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:10:40.559] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:10:40.559] [INFO] [SystemRequirements.swift:135 validateSystemCompatibility()] ğŸ” [SystemRequirements] Validating system compatibility
[2025-11-22 13:10:40.559] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:10:40.559] [INFO] [SystemRequirements.swift:147 validateSystemCompatibility()] âœ… [SystemRequirements] Modern macOS detected: 26.0.1
[2025-11-22 13:10:40.559] [INFO] [SystemRequirements.swift:190 validateSystemCompatibility()] ğŸ” [SystemRequirements] Compatibility check complete: âœ… Compatible
[2025-11-22 13:10:40.559] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:10:40.559] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:10:40.559] [INFO] [InstallerEngine.swift:78 inspectSystem()] âœ… [InstallerEngine] inspectSystem() complete - ready=false, blocking=9
[2025-11-22 13:10:40.559] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: repair, context:)
[2025-11-22 13:10:40.559] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: repair
[2025-11-22 13:10:40.559] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:10:40.559] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:10:40.559] [INFO] [InstallerEngine.swift:390 execute(plan:using:)] âš™ï¸ [InstallerEngine] Starting execute(plan:, using:)
[2025-11-22 13:10:40.559] [INFO] [InstallerEngine.swift:409 execute(plan:using:)] âš™ï¸ [InstallerEngine] Executing recipe: install-bundled-kanata (type: installComponent)
[2025-11-22 13:10:40.559] [INFO] [PrivilegedOperationsCoordinator.swift:359 installBundledKanata()] ğŸ” [PrivCoordinator] Installing bundled Kanata binary
[2025-11-22 13:10:40.559] [INFO] [LaunchDaemonInstaller.swift:2898 installBundledKanataBinaryOnly()] ğŸ”§ [LaunchDaemon] Installing bundled kanata binary to system location
[2025-11-22 13:10:40.560] [INFO] [LaunchDaemonInstaller.swift:2906 installBundledKanataBinaryOnly()] âŒ [LaunchDaemon] CRITICAL: Bundled kanata binary not found at: /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata
[2025-11-22 13:10:40.560] [INFO] [LaunchDaemonInstaller.swift:2908 installBundledKanataBinaryOnly()] âŒ [LaunchDaemon] This indicates a packaging issue - the app bundle is missing the kanata binary
[2025-11-22 13:10:40.560] [INFO] [InstallerEngine.swift:451 execute(plan:using:)] âŒ [InstallerEngine] Recipe install-bundled-kanata failed: Operation failed: Bundled Kanata installation failed
[2025-11-22 13:10:40.560] [INFO] [InstallerEngine.swift:470 execute(plan:using:)] âœ… [InstallerEngine] execute() complete - success: false, recipes executed: 1
[2025-11-22 13:10:40.560] [INFO] [InstallerEngine.swift:625 run(intent:using:)] âœ… [InstallerEngine] run() complete - success: false
Test Case '-[KeyPathTests.ErrorHandlingTests testConcurrentConfigurationOperations]' passed (3.671 seconds).
Test Case '-[KeyPathTests.ErrorHandlingTests testConfigGenerationWithInvalidInputOutput]' started.
Test Case '-[KeyPathTests.ErrorHandlingTests testConfigGenerationWithInvalidInputOutput]' passed (0.002 seconds).
Test Case '-[KeyPathTests.ErrorHandlingTests testConfigurationIntegrity]' started.
Test Case '-[KeyPathTests.ErrorHandlingTests testConfigurationIntegrity]' passed (0.013 seconds).
Test Case '-[KeyPathTests.ErrorHandlingTests testConfigurationRoundTrip]' started.
Test Case '-[KeyPathTests.ErrorHandlingTests testConfigurationRoundTrip]' passed (0.001 seconds).
Test Case '-[KeyPathTests.ErrorHandlingTests testConfigWithNonASCIICharacters]' started.
Test Case '-[KeyPathTests.ErrorHandlingTests testConfigWithNonASCIICharacters]' passed (0.008 seconds).
Test Case '-[KeyPathTests.ErrorHandlingTests testConfigWithSpecialKanataCharacters]' started.
Test Case '-[KeyPathTests.ErrorHandlingTests testConfigWithSpecialKanataCharacters]' passed (0.002 seconds).
Test Case '-[KeyPathTests.ErrorHandlingTests testDirectoryCreationErrorHandling]' started.
[2025-11-22 13:10:40.586] [INFO] [KanataManager.swift:331 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] init() called
[2025-11-22 13:10:40.587] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:10:40.587] [INFO] [ConfigFileWatcher.swift:40 init()] ğŸ“ [FileWatcher] ConfigFileWatcher initialized with robust monitoring
[2025-11-22 13:10:40.587] [INFO] [ServiceHealthMonitor.swift:140 init(processLifecycle:)] [HealthMonitor] Initialized with process lifecycle manager
[2025-11-22 13:10:40.587] [DEBUG] [KanataManager.swift:403 init(engineClient:injectedConfigurationService:)] ğŸ§ª [KanataManager] Skipping background initialization in test environment
[2025-11-22 13:10:40.587] [INFO] [KanataManager.swift:411 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] About to call bootstrapRuleCollections and startLayerMonitoring
[2025-11-22 13:10:40.587] [INFO] [KanataManager.swift:583 startLayerMonitoring()] ğŸŒ [KanataManager] startLayerMonitoring() called
[2025-11-22 13:10:40.587] [INFO] [KanataManager.swift:585 startLayerMonitoring()] ğŸŒ [KanataManager] Skipping layer monitoring (test environment)
[2025-11-22 13:10:40.587] [INFO] [KanataManager.swift:415 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] init() completed
[2025-11-22 13:10:40.587] [INFO] [ConfigFileWatcher.swift:54 suppressEvents(for:reason:)] ğŸ”‡ [FileWatcher] Suppressing events for 1.0s - Internal saveConfiguration
[2025-11-22 13:10:40.587] [INFO] [KanataManager.swift:822 backupCurrentConfig()] ğŸ’¾ [Backup] Current config backed up successfully
[2025-11-22 13:10:40.587] [INFO] [KanataManager.swift:609 updateActiveLayerName(_:)] ğŸ¯ [KanataManager] updateActiveLayerName: raw='base' normalized='base' display='Base' current='Base'
[2025-11-22 13:10:40.587] [INFO] [KanataManager.swift:609 updateActiveLayerName(_:)] ğŸ¯ [KanataManager] updateActiveLayerName: raw='base' normalized='base' display='Base' current='Base'
[2025-11-22 13:10:40.588] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:10:40.588] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:10:40.588] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 7007 characters
[2025-11-22 13:10:40.588] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:10:40.589] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 18 src keys, 88 layer keys, deduplicated to 18 unique mappings
[2025-11-22 13:10:40.589] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:10:40.589] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:10:40.589] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:10:40.589] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:10:40.589] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 7007 characters
[2025-11-22 13:10:40.589] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:10:40.590] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 18 src keys, 88 layer keys, deduplicated to 18 unique mappings
[2025-11-22 13:10:40.590] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:10:40.590] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:10:40.590] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 28 mappings
[2025-11-22 13:10:40.590] [DEBUG] [KanataManager.swift:1231 saveConfiguration(input:output:)] ğŸ“¡ [Config] Triggering TCP reload for validation
[2025-11-22 13:10:40.590] [DEBUG] [KanataManager+Configuration.swift:84 triggerTCPReload()] ğŸ§ª [TCP Reload] Skipping TCP reload in test environment
[2025-11-22 13:10:40.590] [ERROR] [KanataManager.swift:1247 saveConfiguration(input:output:)] âŒ [Config] TCP reload FAILED: Test environment - TCP disabled
[2025-11-22 13:10:40.590] [ERROR] [KanataManager.swift:1248 saveConfiguration(input:output:)] âŒ [Config] TCP server is required for validation-on-demand - restoring backup
[2025-11-22 13:10:40.590] [INFO] [KanataManager.swift:835 restoreLastGoodConfig()] ğŸ”„ [Restore] Restored last good config successfully
[2025-11-22 13:10:40.590] [INFO] [SoundManager.swift:15 playTinkSound()] ğŸ§ª [Sound] Suppressed tink sound in test environment
[2025-11-22 13:10:40.590] [INFO] [SoundManager.swift:35 playErrorSound()] ğŸ§ª [Sound] Suppressed error beep in test environment
[2025-11-22 13:10:40.590] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 28 mappings
[2025-11-22 13:10:40.590] [DEBUG] [KanataManager+Configuration.swift:53 triggerConfigReload()] ğŸ“¡ [Reload] Attempting TCP reload
[2025-11-22 13:10:40.590] [DEBUG] [KanataManager+Configuration.swift:84 triggerTCPReload()] ğŸ§ª [TCP Reload] Skipping TCP reload in test environment
[2025-11-22 13:10:40.590] [DEBUG] [KanataManager+Configuration.swift:65 triggerConfigReload()] ğŸ“¡ [Reload] TCP reload failed: Test environment - TCP disabled
[2025-11-22 13:10:40.590] [WARN] [KanataManager+Configuration.swift:68 triggerConfigReload()] âš ï¸ [Reload] Falling back to service restart
[2025-11-22 13:10:40.590] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:10:40.590] [INFO] [SystemValidator.swift:63 init(launchDaemonInstaller:vhidDeviceManager:processLifecycleManager:kanataManager:)] ğŸ” [SystemValidator] Initialized (stateless, no cache)
[2025-11-22 13:10:40.590] [INFO] [InstallerEngine.swift:35 init(processLifecycleManager:kanataManager:)] ğŸ”§ [InstallerEngine] Initialized
[2025-11-22 13:10:40.590] [INFO] [InstallerEngine.swift:612 run(intent:using:)] ğŸš€ [InstallerEngine] Starting run(intent: repair, using:)
[2025-11-22 13:10:40.590] [INFO] [InstallerEngine.swift:53 inspectSystem()] ğŸ” [InstallerEngine] Starting inspectSystem()
[2025-11-22 13:10:40.590] [INFO] [SystemValidator.swift:143 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Starting validation #1
[2025-11-22 13:10:40.590] [INFO] [SystemValidator.swift:174 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 START: 1763845840.590
Test Case '-[KeyPathTests.ErrorHandlingTests testDirectoryCreationErrorHandling]' passed (0.004 seconds).
Test Case '-[KeyPathTests.ErrorHandlingTests testExtremeKeyCodeHandling]' started.
Test Case '-[KeyPathTests.ErrorHandlingTests testExtremeKeyCodeHandling]' passed (0.000 seconds).
Test Case '-[KeyPathTests.ErrorHandlingTests testInvalidKeyInputHandling]' started.
[2025-11-22 13:10:40.591] [INFO] [KanataManager.swift:331 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] init() called
[2025-11-22 13:10:40.591] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:10:40.591] [INFO] [ConfigFileWatcher.swift:40 init()] ğŸ“ [FileWatcher] ConfigFileWatcher initialized with robust monitoring
[2025-11-22 13:10:40.591] [INFO] [ServiceHealthMonitor.swift:140 init(processLifecycle:)] [HealthMonitor] Initialized with process lifecycle manager
[2025-11-22 13:10:40.591] [DEBUG] [KanataManager.swift:403 init(engineClient:injectedConfigurationService:)] ğŸ§ª [KanataManager] Skipping background initialization in test environment
[2025-11-22 13:10:40.591] [INFO] [KanataManager.swift:411 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] About to call bootstrapRuleCollections and startLayerMonitoring
[2025-11-22 13:10:40.591] [INFO] [KanataManager.swift:583 startLayerMonitoring()] ğŸŒ [KanataManager] startLayerMonitoring() called
[2025-11-22 13:10:40.591] [INFO] [KanataManager.swift:585 startLayerMonitoring()] ğŸŒ [KanataManager] Skipping layer monitoring (test environment)
[2025-11-22 13:10:40.591] [INFO] [KanataManager.swift:415 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] init() completed
Test Case '-[KeyPathTests.ErrorHandlingTests testInvalidKeyInputHandling]' passed (0.001 seconds).
Test Case '-[KeyPathTests.ErrorHandlingTests testInvalidPathHandling]' started.
[2025-11-22 13:10:40.592] [INFO] [KanataManager.swift:331 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] init() called
[2025-11-22 13:10:40.592] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:10:40.592] [INFO] [ConfigFileWatcher.swift:40 init()] ğŸ“ [FileWatcher] ConfigFileWatcher initialized with robust monitoring
[2025-11-22 13:10:40.592] [INFO] [ServiceHealthMonitor.swift:140 init(processLifecycle:)] [HealthMonitor] Initialized with process lifecycle manager
[2025-11-22 13:10:40.592] [DEBUG] [KanataManager.swift:403 init(engineClient:injectedConfigurationService:)] ğŸ§ª [KanataManager] Skipping background initialization in test environment
[2025-11-22 13:10:40.592] [INFO] [KanataManager.swift:411 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] About to call bootstrapRuleCollections and startLayerMonitoring
[2025-11-22 13:10:40.592] [INFO] [KanataManager.swift:583 startLayerMonitoring()] ğŸŒ [KanataManager] startLayerMonitoring() called
[2025-11-22 13:10:40.592] [INFO] [KanataManager.swift:585 startLayerMonitoring()] ğŸŒ [KanataManager] Skipping layer monitoring (test environment)
[2025-11-22 13:10:40.592] [INFO] [KanataManager.swift:415 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] init() completed
Test Case '-[KeyPathTests.ErrorHandlingTests testInvalidPathHandling]' passed (0.000 seconds).
Test Case '-[KeyPathTests.ErrorHandlingTests testKanataProcessErrorHandling]' started.
[2025-11-22 13:10:40.592] [INFO] [SystemValidator.swift:365 checkComponents()] ğŸ” [SystemValidator] Checking components
[2025-11-22 13:10:40.592] [INFO] [KanataBinaryDetector.swift:66 detectCurrentStatus()] ğŸ” [KanataBinaryDetector] Starting unified kanata binary detection
[2025-11-22 13:10:40.592] [INFO] [KanataBinaryDetector.swift:81 detectCurrentStatus()] âŒ [KanataBinaryDetector] No kanata binary found
[2025-11-22 13:10:40.592] [INFO] [VHIDDeviceManager.swift:50 detectInstallation()] ğŸ” [VHIDManager] Manager app exists at /Applications/.Karabiner-VirtualHIDDevice-Manager.app/Contents/MacOS/Karabiner-VirtualHIDDevice-Manager: true
[2025-11-22 13:10:40.660] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.067s)
[2025-11-22 13:10:40.660] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:10:41.234] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.068s)
[2025-11-22 13:10:41.234] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:10:41.234] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:10:41.234] [INFO] [VHIDDeviceManager.swift:343 getInstalledVersion()] ğŸ” [VHIDManager] Installed daemon version: 5.0.0
[2025-11-22 13:10:41.234] [INFO] [VHIDDeviceManager.swift:374 hasVersionMismatch()] âœ… [VHIDManager] Version compatible: v5.0.0
[2025-11-22 13:10:41.234] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:10:41.302] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:10:41.303] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:10:41.303] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:10:41.303] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:10:41.303] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:10:41.304] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:10:41.304] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:10:41.304] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:10:41.304] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:10:41.304] [INFO] [LaunchDaemonInstaller.swift:669 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Kanata service state: Uninstalled
[2025-11-22 13:10:41.304] [INFO] [LaunchDaemonInstaller.swift:696 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Service not installed (state: Uninstalled)
[2025-11-22 13:10:41.304] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:10:41.372] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:10:41.439] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhiddaemon loaded: false
[2025-11-22 13:10:41.507] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhidmanager loaded: false
[2025-11-22 13:10:41.507] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:10:41.575] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:10:41.575] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhidmanager
[2025-11-22 13:10:41.644] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhidmanager not found in system domain
[2025-11-22 13:10:41.644] [INFO] [SystemValidator.swift:393 checkComponents()] ğŸ” [SystemValidator] Components: kanata=false, driver=true, daemon=false, vhid=false, vhidVersionMismatch=false
[2025-11-22 13:10:41.644] [INFO] [SystemValidator.swift:220 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 3 (Components) completed in 1.054s
[2025-11-22 13:10:41.644] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 20% (1/5 steps)
[2025-11-22 13:10:41.644] [INFO] [SystemValidator.swift:312 checkHelper()] ğŸ” [SystemValidator] Checking privileged helper
[2025-11-22 13:10:41.644] [INFO] [SystemValidator.swift:344 checkPermissions()] ğŸ” [SystemValidator] Checking permissions via Oracle
[2025-11-22 13:10:41.644] [INFO] [SystemValidator.swift:477 checkHealth()] ğŸ” [SystemValidator] Checking system health
[2025-11-22 13:10:41.644] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:10:41.644] [INFO] [PermissionOracle.swift:173 currentSnapshot()] ğŸ”® [Oracle] Test mode snapshot generated (non-blocking)
[2025-11-22 13:10:41.648] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:10:41.651] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:10:41.663] [INFO] [HelperManager.swift:830 verifyEmbeddedHelperSignature()] ğŸ”’ [HelperManager] Embedded helper signature looks valid
[2025-11-22 13:10:41.663] [INFO] [HelperManager.swift:105 getConnection()] ğŸ”— [HelperManager] Creating XPC connection to com.keypath.helper
[2025-11-22 13:10:41.663] [INFO] [HelperManager.swift:129 getConnection()] âœ… [HelperManager] XPC connection established (PID: 0)
[2025-11-22 13:10:41.663] [INFO] [HelperManager.swift:228 getHelperVersion()] ğŸ“¤ [HelperManager] Calling proxy.getVersion()
[2025-11-22 13:10:41.663] [INFO] [HelperManager.swift:243 getHelperVersion()] ğŸ“¤ [HelperManager] proxy.getVersion() call dispatched, waiting for callback
[2025-11-22 13:10:41.663] [INFO] [HelperManager.swift:121 getConnection()] âš ï¸ [HelperManager] XPC connection interrupted - will reconnect
[2025-11-22 13:10:41.663] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:10:41.663] [INFO] [HelperManager.swift:578 getRemoteProxy(errorHandler:)] âŒ [HelperManager] XPC proxy error: Couldnâ€™t communicate with a helper application.
[2025-11-22 13:10:41.663] [INFO] [HelperManager.swift:584 getRemoteProxy(errorHandler:)] âš ï¸ [HelperManager] XPC connection interrupted - this may indicate:
[2025-11-22 13:10:41.663] [INFO] [HelperManager.swift:585 getRemoteProxy(errorHandler:)]    1. Helper signature validation failed (app updated but not restarted)
[2025-11-22 13:10:41.663] [INFO] [HelperManager.swift:587 getRemoteProxy(errorHandler:)]    2. Helper process crashed
[2025-11-22 13:10:41.663] [INFO] [HelperManager.swift:588 getRemoteProxy(errorHandler:)]    3. Helper was killed by the system
[2025-11-22 13:10:41.663] [INFO] [HelperManager.swift:589 getRemoteProxy(errorHandler:)] ğŸ’¡ If you just updated KeyPath, try restarting the app
[2025-11-22 13:10:41.663] [INFO] [HelperManager.swift:116 getConnection()] âŒ [HelperManager] XPC connection invalidated
[2025-11-22 13:10:41.663] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:10:41.711] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:10:41.711] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:10:41.779] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:10:41.808] [INFO] [HelperManager.swift:248 getHelperVersion()] âš ï¸ [HelperManager] getVersion timed out - clearing connection cache
[2025-11-22 13:10:41.808] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:10:41.847] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.067s)
[2025-11-22 13:10:41.847] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:10:42.420] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.068s)
[2025-11-22 13:10:42.421] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:10:42.421] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:10:42.421] [INFO] [SystemValidator.swift:487 checkHealth()] ğŸ” [SystemValidator] Health: kanata=false, daemon=false (launchctl), vhid=false
[2025-11-22 13:10:42.421] [INFO] [SystemValidator.swift:238 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 5 (Health) completed in 1.830s
[2025-11-22 13:10:42.421] [INFO] [SystemValidator.swift:411 checkConflicts()] ğŸ” [SystemValidator] Checking for conflicts
[2025-11-22 13:10:42.421] [INFO] [ProcessLifecycleManager.swift:117 detectConflicts()] ğŸ” [ProcessLifecycleManager] Detecting conflicts...
[2025-11-22 13:10:42.421] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 40% (2/5 steps)
[2025-11-22 13:10:42.421] [INFO] [ProcessLifecycleManager.swift:121 detectConflicts()] ğŸ§ª [TestEnvironment] Skipping process conflict detection - returning clean state
[2025-11-22 13:10:42.421] [INFO] [SystemValidator.swift:436 checkConflicts()] ğŸ” [SystemValidator] Total conflicts: 0 (0 kanata, 0 karabiner)
[2025-11-22 13:10:42.421] [INFO] [SystemValidator.swift:229 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 4 (Conflicts) completed in 1.830s
[2025-11-22 13:10:42.421] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 60% (3/5 steps)
[2025-11-22 13:10:42.421] [INFO] [KanataManager.swift:331 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] init() called
[2025-11-22 13:10:42.421] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:10:42.421] [INFO] [ConfigFileWatcher.swift:40 init()] ğŸ“ [FileWatcher] ConfigFileWatcher initialized with robust monitoring
[2025-11-22 13:10:42.421] [INFO] [ServiceHealthMonitor.swift:140 init(processLifecycle:)] [HealthMonitor] Initialized with process lifecycle manager
[2025-11-22 13:10:42.421] [DEBUG] [KanataManager.swift:403 init(engineClient:injectedConfigurationService:)] ğŸ§ª [KanataManager] Skipping background initialization in test environment
[2025-11-22 13:10:42.421] [INFO] [KanataManager.swift:411 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] About to call bootstrapRuleCollections and startLayerMonitoring
[2025-11-22 13:10:42.421] [INFO] [KanataManager.swift:583 startLayerMonitoring()] ğŸŒ [KanataManager] startLayerMonitoring() called
[2025-11-22 13:10:42.421] [INFO] [KanataManager.swift:585 startLayerMonitoring()] ğŸŒ [KanataManager] Skipping layer monitoring (test environment)
[2025-11-22 13:10:42.421] [INFO] [KanataManager.swift:415 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] init() completed
[2025-11-22 13:10:42.421] [INFO] [ProcessManager.swift:198 checkLaunchDaemonStatus()] ğŸ” [ProcessManager] Checking LaunchDaemon service status...
[2025-11-22 13:10:42.421] [INFO] [ProcessManager.swift:202 checkLaunchDaemonStatus()] ğŸ§ª [ProcessManager] Skipping launchctl check - returning mock data
[2025-11-22 13:10:42.421] [INFO] [SystemValidator.swift:355 checkPermissions()] ğŸ” [SystemValidator] Oracle snapshot: ready=false, age=0.777s
[2025-11-22 13:10:42.421] [INFO] [SystemValidator.swift:328 checkHelper()] ğŸ” [SystemValidator] Helper state: registeredButUnresponsive Helper registered but XPC communication failed
[2025-11-22 13:10:42.421] [INFO] [SystemValidator.swift:211 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 2 (Permissions) completed in 1.831s
[2025-11-22 13:10:42.421] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 80% (4/5 steps)
[2025-11-22 13:10:42.421] [INFO] [SystemValidator.swift:202 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 1 (Helper) completed in 5.522s
[2025-11-22 13:10:42.421] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 100% (5/5 steps)
[2025-11-22 13:10:42.422] [INFO] [KanataManager.swift:1371 performUpdateStatus()] ğŸ”„ [Status] LaunchDaemon service running - cleared stale diagnostics
[2025-11-22 13:10:42.422] [INFO] [KanataManager.swift:609 updateActiveLayerName(_:)] ğŸ¯ [KanataManager] updateActiveLayerName: raw='base' normalized='base' display='Base' current='Base'
[2025-11-22 13:10:42.422] [INFO] [KanataManager.swift:609 updateActiveLayerName(_:)] ğŸ¯ [KanataManager] updateActiveLayerName: raw='base' normalized='base' display='Base' current='Base'
[2025-11-22 13:10:42.422] [INFO] [PrivilegedOperationsCoordinator.swift:839 sudoExecuteCommand(_:description:)] ğŸ”§ [PrivCoordinator] Executing admin command: Stop Kanata service
[2025-11-22 13:10:42.422] [INFO] [SystemValidator.swift:283 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 COMPLETE: Total duration 5.522s
[2025-11-22 13:10:42.422] [INFO] [SystemValidator.swift:297 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Validation #1 complete in 5.522s
[2025-11-22 13:10:42.422] [INFO] [SystemValidator.swift:299 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Result: ready=false, blocking=9, total=9
[2025-11-22 13:10:42.422] [INFO] [KanataManager.swift:609 updateActiveLayerName(_:)] ğŸ¯ [KanataManager] updateActiveLayerName: raw='base' normalized='base' display='Base' current='Base'
[2025-11-22 13:10:42.422] [INFO] [KanataManager.swift:609 updateActiveLayerName(_:)] ğŸ¯ [KanataManager] updateActiveLayerName: raw='base' normalized='base' display='Base' current='Base'
[2025-11-22 13:10:42.422] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:10:42.422] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:10:42.422] [INFO] [SystemRequirements.swift:135 validateSystemCompatibility()] ğŸ” [SystemRequirements] Validating system compatibility
[2025-11-22 13:10:42.422] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:10:42.422] [INFO] [SystemRequirements.swift:147 validateSystemCompatibility()] âœ… [SystemRequirements] Modern macOS detected: 26.0.1
[2025-11-22 13:10:42.422] [INFO] [SystemRequirements.swift:190 validateSystemCompatibility()] ğŸ” [SystemRequirements] Compatibility check complete: âœ… Compatible
[2025-11-22 13:10:42.422] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:10:42.422] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:10:42.422] [INFO] [InstallerEngine.swift:78 inspectSystem()] âœ… [InstallerEngine] inspectSystem() complete - ready=false, blocking=9
[2025-11-22 13:10:42.422] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: repair, context:)
[2025-11-22 13:10:42.422] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: repair
[2025-11-22 13:10:42.422] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:10:42.422] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:10:42.422] [INFO] [InstallerEngine.swift:390 execute(plan:using:)] âš™ï¸ [InstallerEngine] Starting execute(plan:, using:)
[2025-11-22 13:10:42.422] [INFO] [InstallerEngine.swift:409 execute(plan:using:)] âš™ï¸ [InstallerEngine] Executing recipe: install-bundled-kanata (type: installComponent)
[2025-11-22 13:10:42.422] [INFO] [PrivilegedOperationsCoordinator.swift:359 installBundledKanata()] ğŸ” [PrivCoordinator] Installing bundled Kanata binary
[2025-11-22 13:10:42.422] [INFO] [LaunchDaemonInstaller.swift:2898 installBundledKanataBinaryOnly()] ğŸ”§ [LaunchDaemon] Installing bundled kanata binary to system location
[2025-11-22 13:10:42.422] [INFO] [LaunchDaemonInstaller.swift:2906 installBundledKanataBinaryOnly()] âŒ [LaunchDaemon] CRITICAL: Bundled kanata binary not found at: /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata
[2025-11-22 13:10:42.422] [INFO] [LaunchDaemonInstaller.swift:2908 installBundledKanataBinaryOnly()] âŒ [LaunchDaemon] This indicates a packaging issue - the app bundle is missing the kanata binary
[2025-11-22 13:10:42.422] [INFO] [InstallerEngine.swift:451 execute(plan:using:)] âŒ [InstallerEngine] Recipe install-bundled-kanata failed: Operation failed: Bundled Kanata installation failed
[2025-11-22 13:10:42.422] [INFO] [InstallerEngine.swift:470 execute(plan:using:)] âœ… [InstallerEngine] execute() complete - success: false, recipes executed: 1
[2025-11-22 13:10:42.422] [INFO] [InstallerEngine.swift:625 run(intent:using:)] âœ… [InstallerEngine] run() complete - success: false
[2025-11-22 13:10:42.422] [INFO] [KanataManager.swift:609 updateActiveLayerName(_:)] ğŸ¯ [KanataManager] updateActiveLayerName: raw='base' normalized='base' display='Base' current='Base'
[2025-11-22 13:10:42.422] [INFO] [KanataManager.swift:609 updateActiveLayerName(_:)] ğŸ¯ [KanataManager] updateActiveLayerName: raw='base' normalized='base' display='Base' current='Base'
[2025-11-22 13:10:42.424] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:10:42.424] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:10:42.424] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 7007 characters
[2025-11-22 13:10:42.424] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:10:42.425] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 18 src keys, 88 layer keys, deduplicated to 18 unique mappings
[2025-11-22 13:10:42.425] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:10:42.425] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:10:42.426] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:10:42.426] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:10:42.426] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 7007 characters
[2025-11-22 13:10:42.426] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:10:42.427] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 18 src keys, 88 layer keys, deduplicated to 18 unique mappings
[2025-11-22 13:10:42.427] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:10:42.427] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:10:42.428] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:10:42.428] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:10:42.428] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 7007 characters
[2025-11-22 13:10:42.428] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:10:42.428] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 18 src keys, 88 layer keys, deduplicated to 18 unique mappings
[2025-11-22 13:10:42.428] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:10:42.428] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:10:42.428] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 28 mappings
[2025-11-22 13:10:42.428] [DEBUG] [KanataManager+Configuration.swift:53 triggerConfigReload()] ğŸ“¡ [Reload] Attempting TCP reload
[2025-11-22 13:10:42.428] [DEBUG] [KanataManager+Configuration.swift:84 triggerTCPReload()] ğŸ§ª [TCP Reload] Skipping TCP reload in test environment
[2025-11-22 13:10:42.428] [DEBUG] [KanataManager+Configuration.swift:65 triggerConfigReload()] ğŸ“¡ [Reload] TCP reload failed: Test environment - TCP disabled
[2025-11-22 13:10:42.428] [WARN] [KanataManager+Configuration.swift:68 triggerConfigReload()] âš ï¸ [Reload] Falling back to service restart
[2025-11-22 13:10:42.428] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:10:42.428] [INFO] [SystemValidator.swift:63 init(launchDaemonInstaller:vhidDeviceManager:processLifecycleManager:kanataManager:)] ğŸ” [SystemValidator] Initialized (stateless, no cache)
[2025-11-22 13:10:42.428] [INFO] [InstallerEngine.swift:35 init(processLifecycleManager:kanataManager:)] ğŸ”§ [InstallerEngine] Initialized
[2025-11-22 13:10:42.428] [INFO] [InstallerEngine.swift:612 run(intent:using:)] ğŸš€ [InstallerEngine] Starting run(intent: repair, using:)
[2025-11-22 13:10:42.428] [INFO] [InstallerEngine.swift:53 inspectSystem()] ğŸ” [InstallerEngine] Starting inspectSystem()
[2025-11-22 13:10:42.429] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 28 mappings
[2025-11-22 13:10:42.429] [DEBUG] [KanataManager+Configuration.swift:53 triggerConfigReload()] ğŸ“¡ [Reload] Attempting TCP reload
[2025-11-22 13:10:42.429] [DEBUG] [KanataManager+Configuration.swift:84 triggerTCPReload()] ğŸ§ª [TCP Reload] Skipping TCP reload in test environment
[2025-11-22 13:10:42.429] [DEBUG] [KanataManager+Configuration.swift:65 triggerConfigReload()] ğŸ“¡ [Reload] TCP reload failed: Test environment - TCP disabled
[2025-11-22 13:10:42.429] [WARN] [KanataManager+Configuration.swift:68 triggerConfigReload()] âš ï¸ [Reload] Falling back to service restart
[2025-11-22 13:10:42.429] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:10:42.429] [INFO] [SystemValidator.swift:63 init(launchDaemonInstaller:vhidDeviceManager:processLifecycleManager:kanataManager:)] ğŸ” [SystemValidator] Initialized (stateless, no cache)
[2025-11-22 13:10:42.429] [INFO] [InstallerEngine.swift:35 init(processLifecycleManager:kanataManager:)] ğŸ”§ [InstallerEngine] Initialized
[2025-11-22 13:10:42.429] [INFO] [InstallerEngine.swift:612 run(intent:using:)] ğŸš€ [InstallerEngine] Starting run(intent: repair, using:)
[2025-11-22 13:10:42.429] [INFO] [InstallerEngine.swift:53 inspectSystem()] ğŸ” [InstallerEngine] Starting inspectSystem()
[2025-11-22 13:10:42.429] [INFO] [SystemValidator.swift:143 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Starting validation #1
[2025-11-22 13:10:42.429] [INFO] [SystemValidator.swift:174 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 START: 1763845842.429
[2025-11-22 13:10:42.429] [INFO] [SystemValidator.swift:133 performValidationBody(progressCallback:)] âš ï¸ [SystemValidator] RAPID VALIDATION: 0.000s since last validation
This might indicate automatic triggers. Expected: manual user actions only.
[2025-11-22 13:10:42.429] [INFO] [SystemValidator.swift:143 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Starting validation #1
[2025-11-22 13:10:42.429] [INFO] [SystemValidator.swift:174 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 START: 1763845842.429
[2025-11-22 13:10:42.429] [INFO] [SystemValidator.swift:312 checkHelper()] ğŸ” [SystemValidator] Checking privileged helper
[2025-11-22 13:10:42.429] [INFO] [SystemValidator.swift:344 checkPermissions()] ğŸ” [SystemValidator] Checking permissions via Oracle
[2025-11-22 13:10:42.429] [INFO] [SystemValidator.swift:365 checkComponents()] ğŸ” [SystemValidator] Checking components
[2025-11-22 13:10:42.429] [INFO] [KanataBinaryDetector.swift:66 detectCurrentStatus()] ğŸ” [KanataBinaryDetector] Starting unified kanata binary detection
[2025-11-22 13:10:42.429] [INFO] [PermissionOracle.swift:158 currentSnapshot()] ğŸ”® [Oracle] (Test) Returning cached snapshot
[2025-11-22 13:10:42.429] [INFO] [KanataBinaryDetector.swift:81 detectCurrentStatus()] âŒ [KanataBinaryDetector] No kanata binary found
[2025-11-22 13:10:42.429] [INFO] [VHIDDeviceManager.swift:50 detectInstallation()] ğŸ” [VHIDManager] Manager app exists at /Applications/.Karabiner-VirtualHIDDevice-Manager.app/Contents/MacOS/Karabiner-VirtualHIDDevice-Manager: true
[2025-11-22 13:10:42.434] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:10:42.439] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:10:42.456] [INFO] [HelperManager.swift:830 verifyEmbeddedHelperSignature()] ğŸ”’ [HelperManager] Embedded helper signature looks valid
[2025-11-22 13:10:42.456] [INFO] [HelperManager.swift:105 getConnection()] ğŸ”— [HelperManager] Creating XPC connection to com.keypath.helper
[2025-11-22 13:10:42.456] [INFO] [HelperManager.swift:129 getConnection()] âœ… [HelperManager] XPC connection established (PID: 0)
[2025-11-22 13:10:42.456] [INFO] [HelperManager.swift:228 getHelperVersion()] ğŸ“¤ [HelperManager] Calling proxy.getVersion()
[2025-11-22 13:10:42.456] [INFO] [HelperManager.swift:243 getHelperVersion()] ğŸ“¤ [HelperManager] proxy.getVersion() call dispatched, waiting for callback
[2025-11-22 13:10:42.457] [INFO] [HelperManager.swift:121 getConnection()] âš ï¸ [HelperManager] XPC connection interrupted - will reconnect
[2025-11-22 13:10:42.457] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:10:42.457] [INFO] [HelperManager.swift:578 getRemoteProxy(errorHandler:)] âŒ [HelperManager] XPC proxy error: Couldnâ€™t communicate with a helper application.
[2025-11-22 13:10:42.457] [INFO] [HelperManager.swift:584 getRemoteProxy(errorHandler:)] âš ï¸ [HelperManager] XPC connection interrupted - this may indicate:
[2025-11-22 13:10:42.457] [INFO] [HelperManager.swift:585 getRemoteProxy(errorHandler:)]    1. Helper signature validation failed (app updated but not restarted)
[2025-11-22 13:10:42.457] [INFO] [HelperManager.swift:587 getRemoteProxy(errorHandler:)]    2. Helper process crashed
[2025-11-22 13:10:42.457] [INFO] [HelperManager.swift:588 getRemoteProxy(errorHandler:)]    3. Helper was killed by the system
[2025-11-22 13:10:42.457] [INFO] [HelperManager.swift:589 getRemoteProxy(errorHandler:)] ğŸ’¡ If you just updated KeyPath, try restarting the app
[2025-11-22 13:10:42.457] [INFO] [HelperManager.swift:116 getConnection()] âŒ [HelperManager] XPC connection invalidated
[2025-11-22 13:10:42.457] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:10:42.492] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.063s)
[2025-11-22 13:10:42.492] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:10:43.070] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.072s)
[2025-11-22 13:10:43.070] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:10:43.070] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:10:43.070] [INFO] [VHIDDeviceManager.swift:343 getInstalledVersion()] ğŸ” [VHIDManager] Installed daemon version: 5.0.0
[2025-11-22 13:10:43.070] [INFO] [VHIDDeviceManager.swift:374 hasVersionMismatch()] âœ… [VHIDManager] Version compatible: v5.0.0
[2025-11-22 13:10:43.070] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:10:43.137] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:10:43.138] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:10:43.138] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:10:43.138] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:10:43.138] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:10:43.138] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:10:43.138] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:10:43.138] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:10:43.138] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:10:43.138] [INFO] [LaunchDaemonInstaller.swift:669 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Kanata service state: Uninstalled
[2025-11-22 13:10:43.138] [INFO] [LaunchDaemonInstaller.swift:696 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Service not installed (state: Uninstalled)
[2025-11-22 13:10:43.138] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:10:43.207] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:10:43.274] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhiddaemon loaded: false
[2025-11-22 13:10:43.342] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhidmanager loaded: false
[2025-11-22 13:10:43.342] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:10:43.409] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:10:43.409] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhidmanager
[2025-11-22 13:10:43.476] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhidmanager not found in system domain
[2025-11-22 13:10:43.476] [INFO] [SystemValidator.swift:393 checkComponents()] ğŸ” [SystemValidator] Components: kanata=false, driver=true, daemon=false, vhid=false, vhidVersionMismatch=false
[2025-11-22 13:10:43.476] [INFO] [SystemValidator.swift:220 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 3 (Components) completed in 1.047s
[2025-11-22 13:10:43.476] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 20% (1/5 steps)
[2025-11-22 13:10:43.476] [INFO] [SystemValidator.swift:411 checkConflicts()] ğŸ” [SystemValidator] Checking for conflicts
[2025-11-22 13:10:43.476] [INFO] [ProcessLifecycleManager.swift:117 detectConflicts()] ğŸ” [ProcessLifecycleManager] Detecting conflicts...
[2025-11-22 13:10:43.476] [INFO] [ProcessLifecycleManager.swift:121 detectConflicts()] ğŸ§ª [TestEnvironment] Skipping process conflict detection - returning clean state
[2025-11-22 13:10:43.476] [INFO] [SystemValidator.swift:436 checkConflicts()] ğŸ” [SystemValidator] Total conflicts: 0 (0 kanata, 0 karabiner)
[2025-11-22 13:10:43.476] [INFO] [SystemValidator.swift:477 checkHealth()] ğŸ” [SystemValidator] Checking system health
[2025-11-22 13:10:43.476] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:10:43.476] [INFO] [SystemValidator.swift:229 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 4 (Conflicts) completed in 1.047s
[2025-11-22 13:10:43.476] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 40% (2/5 steps)
[2025-11-22 13:10:43.544] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:10:43.544] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:10:43.612] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:10:43.679] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.066s)
[2025-11-22 13:10:43.679] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:10:44.252] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.067s)
[2025-11-22 13:10:44.252] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:10:44.252] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:10:44.252] [INFO] [SystemValidator.swift:487 checkHealth()] ğŸ” [SystemValidator] Health: kanata=false, daemon=false (launchctl), vhid=false
[2025-11-22 13:10:44.252] [INFO] [SystemValidator.swift:238 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 5 (Health) completed in 1.823s
[2025-11-22 13:10:44.252] [INFO] [SystemValidator.swift:312 checkHelper()] ğŸ” [SystemValidator] Checking privileged helper
[2025-11-22 13:10:44.252] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 60% (3/5 steps)
[2025-11-22 13:10:44.252] [INFO] [SystemValidator.swift:344 checkPermissions()] ğŸ” [SystemValidator] Checking permissions via Oracle
[2025-11-22 13:10:44.252] [INFO] [SystemValidator.swift:365 checkComponents()] ğŸ” [SystemValidator] Checking components
[2025-11-22 13:10:44.252] [INFO] [KanataBinaryDetector.swift:66 detectCurrentStatus()] ğŸ” [KanataBinaryDetector] Starting unified kanata binary detection
[2025-11-22 13:10:44.252] [INFO] [PermissionOracle.swift:173 currentSnapshot()] ğŸ”® [Oracle] Test mode snapshot generated (non-blocking)
[2025-11-22 13:10:44.252] [INFO] [KanataBinaryDetector.swift:81 detectCurrentStatus()] âŒ [KanataBinaryDetector] No kanata binary found
[2025-11-22 13:10:44.252] [INFO] [VHIDDeviceManager.swift:50 detectInstallation()] ğŸ” [VHIDManager] Manager app exists at /Applications/.Karabiner-VirtualHIDDevice-Manager.app/Contents/MacOS/Karabiner-VirtualHIDDevice-Manager: true
[2025-11-22 13:10:44.260] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:10:44.266] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:10:44.287] [INFO] [HelperManager.swift:830 verifyEmbeddedHelperSignature()] ğŸ”’ [HelperManager] Embedded helper signature looks valid
[2025-11-22 13:10:44.288] [INFO] [HelperManager.swift:105 getConnection()] ğŸ”— [HelperManager] Creating XPC connection to com.keypath.helper
[2025-11-22 13:10:44.288] [INFO] [HelperManager.swift:129 getConnection()] âœ… [HelperManager] XPC connection established (PID: 0)
[2025-11-22 13:10:44.288] [INFO] [HelperManager.swift:228 getHelperVersion()] ğŸ“¤ [HelperManager] Calling proxy.getVersion()
[2025-11-22 13:10:44.288] [INFO] [HelperManager.swift:243 getHelperVersion()] ğŸ“¤ [HelperManager] proxy.getVersion() call dispatched, waiting for callback
[2025-11-22 13:10:44.289] [INFO] [HelperManager.swift:121 getConnection()] âš ï¸ [HelperManager] XPC connection interrupted - will reconnect
[2025-11-22 13:10:44.289] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:10:44.289] [INFO] [HelperManager.swift:578 getRemoteProxy(errorHandler:)] âŒ [HelperManager] XPC proxy error: Couldnâ€™t communicate with a helper application.
[2025-11-22 13:10:44.289] [INFO] [HelperManager.swift:584 getRemoteProxy(errorHandler:)] âš ï¸ [HelperManager] XPC connection interrupted - this may indicate:
[2025-11-22 13:10:44.289] [INFO] [HelperManager.swift:585 getRemoteProxy(errorHandler:)]    1. Helper signature validation failed (app updated but not restarted)
[2025-11-22 13:10:44.289] [INFO] [HelperManager.swift:587 getRemoteProxy(errorHandler:)]    2. Helper process crashed
[2025-11-22 13:10:44.289] [INFO] [HelperManager.swift:588 getRemoteProxy(errorHandler:)]    3. Helper was killed by the system
[2025-11-22 13:10:44.289] [INFO] [HelperManager.swift:589 getRemoteProxy(errorHandler:)] ğŸ’¡ If you just updated KeyPath, try restarting the app
[2025-11-22 13:10:44.289] [INFO] [HelperManager.swift:116 getConnection()] âŒ [HelperManager] XPC connection invalidated
[2025-11-22 13:10:44.289] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:10:44.320] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.067s)
[2025-11-22 13:10:44.320] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:10:44.676] [INFO] [HelperManager.swift:248 getHelperVersion()] âš ï¸ [HelperManager] getVersion timed out - clearing connection cache
[2025-11-22 13:10:44.676] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:10:44.893] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.068s)
[2025-11-22 13:10:44.894] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:10:44.894] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:10:44.894] [INFO] [VHIDDeviceManager.swift:343 getInstalledVersion()] ğŸ” [VHIDManager] Installed daemon version: 5.0.0
[2025-11-22 13:10:44.894] [INFO] [VHIDDeviceManager.swift:374 hasVersionMismatch()] âœ… [VHIDManager] Version compatible: v5.0.0
[2025-11-22 13:10:44.894] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:10:44.961] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:10:44.962] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:10:44.962] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:10:44.962] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:10:44.962] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:10:44.963] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:10:44.963] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:10:44.963] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:10:44.963] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:10:44.963] [INFO] [LaunchDaemonInstaller.swift:669 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Kanata service state: Uninstalled
[2025-11-22 13:10:44.963] [INFO] [LaunchDaemonInstaller.swift:696 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Service not installed (state: Uninstalled)
[2025-11-22 13:10:44.963] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:10:45.028] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:10:45.094] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhiddaemon loaded: false
[2025-11-22 13:10:45.162] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhidmanager loaded: false
[2025-11-22 13:10:45.162] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:10:45.228] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:10:45.228] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhidmanager
[2025-11-22 13:10:45.295] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhidmanager not found in system domain
[2025-11-22 13:10:45.295] [INFO] [SystemValidator.swift:393 checkComponents()] ğŸ” [SystemValidator] Components: kanata=false, driver=true, daemon=false, vhid=false, vhidVersionMismatch=false
[2025-11-22 13:10:45.295] [INFO] [SystemValidator.swift:220 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 3 (Components) completed in 2.866s
[2025-11-22 13:10:45.295] [INFO] [SystemValidator.swift:411 checkConflicts()] ğŸ” [SystemValidator] Checking for conflicts
[2025-11-22 13:10:45.295] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 20% (1/5 steps)
[2025-11-22 13:10:45.295] [INFO] [ProcessLifecycleManager.swift:117 detectConflicts()] ğŸ” [ProcessLifecycleManager] Detecting conflicts...
[2025-11-22 13:10:45.295] [INFO] [ProcessLifecycleManager.swift:121 detectConflicts()] ğŸ§ª [TestEnvironment] Skipping process conflict detection - returning clean state
[2025-11-22 13:10:45.295] [INFO] [SystemValidator.swift:436 checkConflicts()] ğŸ” [SystemValidator] Total conflicts: 0 (0 kanata, 0 karabiner)
[2025-11-22 13:10:45.295] [INFO] [SystemValidator.swift:477 checkHealth()] ğŸ” [SystemValidator] Checking system health
[2025-11-22 13:10:45.295] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:10:45.295] [INFO] [SystemValidator.swift:229 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 4 (Conflicts) completed in 2.866s
[2025-11-22 13:10:45.295] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 40% (2/5 steps)
[2025-11-22 13:10:45.361] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:10:45.361] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:10:45.428] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:10:45.494] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.066s)
[2025-11-22 13:10:45.494] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:10:45.514] [INFO] [HelperManager.swift:248 getHelperVersion()] âš ï¸ [HelperManager] getVersion timed out - clearing connection cache
[2025-11-22 13:10:45.514] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:10:46.067] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.067s)
[2025-11-22 13:10:46.067] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:10:46.067] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:10:46.067] [INFO] [SystemValidator.swift:487 checkHealth()] ğŸ” [SystemValidator] Health: kanata=false, daemon=false (launchctl), vhid=false
[2025-11-22 13:10:46.067] [INFO] [SystemValidator.swift:238 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 5 (Health) completed in 3.639s
[2025-11-22 13:10:46.067] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 60% (3/5 steps)
[2025-11-22 13:10:46.068] [INFO] [SystemValidator.swift:355 checkPermissions()] ğŸ” [SystemValidator] Oracle snapshot: ready=false, age=4.424s
[2025-11-22 13:10:46.068] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 28 mappings
[2025-11-22 13:10:46.068] [INFO] [SystemValidator.swift:211 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 2 (Permissions) completed in 3.639s
[2025-11-22 13:10:46.068] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 80% (4/5 steps)
[2025-11-22 13:10:46.068] [DEBUG] [KanataManager+Configuration.swift:53 triggerConfigReload()] ğŸ“¡ [Reload] Attempting TCP reload
[2025-11-22 13:10:46.068] [DEBUG] [KanataManager+Configuration.swift:84 triggerTCPReload()] ğŸ§ª [TCP Reload] Skipping TCP reload in test environment
[2025-11-22 13:10:46.068] [DEBUG] [KanataManager+Configuration.swift:65 triggerConfigReload()] ğŸ“¡ [Reload] TCP reload failed: Test environment - TCP disabled
[2025-11-22 13:10:46.068] [WARN] [KanataManager+Configuration.swift:68 triggerConfigReload()] âš ï¸ [Reload] Falling back to service restart
[2025-11-22 13:10:46.068] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:10:46.068] [INFO] [SystemValidator.swift:63 init(launchDaemonInstaller:vhidDeviceManager:processLifecycleManager:kanataManager:)] ğŸ” [SystemValidator] Initialized (stateless, no cache)
[2025-11-22 13:10:46.068] [INFO] [InstallerEngine.swift:35 init(processLifecycleManager:kanataManager:)] ğŸ”§ [InstallerEngine] Initialized
[2025-11-22 13:10:46.068] [INFO] [InstallerEngine.swift:612 run(intent:using:)] ğŸš€ [InstallerEngine] Starting run(intent: repair, using:)
[2025-11-22 13:10:46.068] [INFO] [InstallerEngine.swift:53 inspectSystem()] ğŸ” [InstallerEngine] Starting inspectSystem()
[2025-11-22 13:10:46.068] [INFO] [SystemValidator.swift:355 checkPermissions()] ğŸ” [SystemValidator] Oracle snapshot: ready=false, age=1.816s
[2025-11-22 13:10:46.068] [INFO] [SystemValidator.swift:328 checkHelper()] ğŸ” [SystemValidator] Helper state: registeredButUnresponsive Helper registered but XPC communication failed
[2025-11-22 13:10:46.068] [INFO] [SystemValidator.swift:328 checkHelper()] ğŸ” [SystemValidator] Helper state: registeredButUnresponsive Helper registered but XPC communication failed
[2025-11-22 13:10:46.068] [INFO] [SystemValidator.swift:211 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 2 (Permissions) completed in 3.639s
[2025-11-22 13:10:46.068] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 80% (4/5 steps)
[2025-11-22 13:10:46.068] [INFO] [SystemValidator.swift:202 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 1 (Helper) completed in 5.478s
[2025-11-22 13:10:46.068] [INFO] [SystemValidator.swift:143 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Starting validation #1
[2025-11-22 13:10:46.068] [INFO] [SystemValidator.swift:202 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 1 (Helper) completed in 3.639s
[2025-11-22 13:10:46.068] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 100% (5/5 steps)
[2025-11-22 13:10:46.068] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 100% (5/5 steps)
[2025-11-22 13:10:46.068] [INFO] [SystemValidator.swift:174 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 START: 1763845846.068
[2025-11-22 13:10:46.068] [INFO] [SystemValidator.swift:312 checkHelper()] ğŸ” [SystemValidator] Checking privileged helper
[2025-11-22 13:10:46.068] [INFO] [SystemValidator.swift:344 checkPermissions()] ğŸ” [SystemValidator] Checking permissions via Oracle
[2025-11-22 13:10:46.068] [INFO] [SystemValidator.swift:365 checkComponents()] ğŸ” [SystemValidator] Checking components
[2025-11-22 13:10:46.068] [INFO] [KanataBinaryDetector.swift:66 detectCurrentStatus()] ğŸ” [KanataBinaryDetector] Starting unified kanata binary detection
[2025-11-22 13:10:46.068] [INFO] [PermissionOracle.swift:173 currentSnapshot()] ğŸ”® [Oracle] Test mode snapshot generated (non-blocking)
[2025-11-22 13:10:46.068] [INFO] [KanataBinaryDetector.swift:81 detectCurrentStatus()] âŒ [KanataBinaryDetector] No kanata binary found
[2025-11-22 13:10:46.068] [INFO] [VHIDDeviceManager.swift:50 detectInstallation()] ğŸ” [VHIDManager] Manager app exists at /Applications/.Karabiner-VirtualHIDDevice-Manager.app/Contents/MacOS/Karabiner-VirtualHIDDevice-Manager: true
[2025-11-22 13:10:46.076] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:10:46.082] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:10:46.100] [INFO] [HelperManager.swift:830 verifyEmbeddedHelperSignature()] ğŸ”’ [HelperManager] Embedded helper signature looks valid
[2025-11-22 13:10:46.100] [INFO] [HelperManager.swift:105 getConnection()] ğŸ”— [HelperManager] Creating XPC connection to com.keypath.helper
[2025-11-22 13:10:46.100] [INFO] [HelperManager.swift:129 getConnection()] âœ… [HelperManager] XPC connection established (PID: 0)
[2025-11-22 13:10:46.100] [INFO] [HelperManager.swift:228 getHelperVersion()] ğŸ“¤ [HelperManager] Calling proxy.getVersion()
[2025-11-22 13:10:46.100] [INFO] [HelperManager.swift:243 getHelperVersion()] ğŸ“¤ [HelperManager] proxy.getVersion() call dispatched, waiting for callback
[2025-11-22 13:10:46.101] [INFO] [HelperManager.swift:121 getConnection()] âš ï¸ [HelperManager] XPC connection interrupted - will reconnect
[2025-11-22 13:10:46.101] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:10:46.101] [INFO] [HelperManager.swift:578 getRemoteProxy(errorHandler:)] âŒ [HelperManager] XPC proxy error: Couldnâ€™t communicate with a helper application.
[2025-11-22 13:10:46.101] [INFO] [HelperManager.swift:584 getRemoteProxy(errorHandler:)] âš ï¸ [HelperManager] XPC connection interrupted - this may indicate:
[2025-11-22 13:10:46.101] [INFO] [HelperManager.swift:585 getRemoteProxy(errorHandler:)]    1. Helper signature validation failed (app updated but not restarted)
[2025-11-22 13:10:46.101] [INFO] [HelperManager.swift:587 getRemoteProxy(errorHandler:)]    2. Helper process crashed
[2025-11-22 13:10:46.101] [INFO] [HelperManager.swift:588 getRemoteProxy(errorHandler:)]    3. Helper was killed by the system
[2025-11-22 13:10:46.101] [INFO] [HelperManager.swift:589 getRemoteProxy(errorHandler:)] ğŸ’¡ If you just updated KeyPath, try restarting the app
[2025-11-22 13:10:46.101] [INFO] [HelperManager.swift:116 getConnection()] âŒ [HelperManager] XPC connection invalidated
[2025-11-22 13:10:46.101] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:10:46.137] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.068s)
[2025-11-22 13:10:46.137] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:10:46.709] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.067s)
[2025-11-22 13:10:46.709] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:10:46.709] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:10:46.710] [INFO] [VHIDDeviceManager.swift:343 getInstalledVersion()] ğŸ” [VHIDManager] Installed daemon version: 5.0.0
[2025-11-22 13:10:46.710] [INFO] [VHIDDeviceManager.swift:374 hasVersionMismatch()] âœ… [VHIDManager] Version compatible: v5.0.0
[2025-11-22 13:10:46.710] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:10:46.775] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:10:46.776] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:10:46.776] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:10:46.776] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:10:46.776] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:10:46.777] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:10:46.777] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:10:46.777] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:10:46.777] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:10:46.777] [INFO] [LaunchDaemonInstaller.swift:669 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Kanata service state: Uninstalled
[2025-11-22 13:10:46.777] [INFO] [LaunchDaemonInstaller.swift:696 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Service not installed (state: Uninstalled)
[2025-11-22 13:10:46.777] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:10:46.842] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:10:46.908] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhiddaemon loaded: false
[2025-11-22 13:10:46.974] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhidmanager loaded: false
[2025-11-22 13:10:46.974] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:10:47.039] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:10:47.039] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhidmanager
[2025-11-22 13:10:47.105] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhidmanager not found in system domain
[2025-11-22 13:10:47.105] [INFO] [SystemValidator.swift:393 checkComponents()] ğŸ” [SystemValidator] Components: kanata=false, driver=true, daemon=false, vhid=false, vhidVersionMismatch=false
[2025-11-22 13:10:47.105] [INFO] [SystemValidator.swift:411 checkConflicts()] ğŸ” [SystemValidator] Checking for conflicts
[2025-11-22 13:10:47.105] [INFO] [ProcessLifecycleManager.swift:117 detectConflicts()] ğŸ” [ProcessLifecycleManager] Detecting conflicts...
[2025-11-22 13:10:47.105] [INFO] [SystemValidator.swift:220 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 3 (Components) completed in 1.037s
[2025-11-22 13:10:47.105] [INFO] [ProcessLifecycleManager.swift:121 detectConflicts()] ğŸ§ª [TestEnvironment] Skipping process conflict detection - returning clean state
[2025-11-22 13:10:47.105] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 20% (1/5 steps)
[2025-11-22 13:10:47.105] [INFO] [SystemValidator.swift:436 checkConflicts()] ğŸ” [SystemValidator] Total conflicts: 0 (0 kanata, 0 karabiner)
[2025-11-22 13:10:47.105] [INFO] [SystemValidator.swift:477 checkHealth()] ğŸ” [SystemValidator] Checking system health
[2025-11-22 13:10:47.105] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:10:47.105] [INFO] [SystemValidator.swift:229 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 4 (Conflicts) completed in 1.037s
[2025-11-22 13:10:47.105] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 40% (2/5 steps)
[2025-11-22 13:10:47.171] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:10:47.171] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:10:47.236] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:10:47.301] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.065s)
[2025-11-22 13:10:47.301] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:10:47.358] [INFO] [HelperManager.swift:248 getHelperVersion()] âš ï¸ [HelperManager] getVersion timed out - clearing connection cache
[2025-11-22 13:10:47.358] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:10:47.875] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.069s)
[2025-11-22 13:10:47.875] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:10:47.875] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:10:47.875] [INFO] [SystemValidator.swift:487 checkHealth()] ğŸ” [SystemValidator] Health: kanata=false, daemon=false (launchctl), vhid=false
[2025-11-22 13:10:47.875] [INFO] [SystemValidator.swift:238 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 5 (Health) completed in 1.807s
[2025-11-22 13:10:47.875] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 60% (3/5 steps)
[2025-11-22 13:10:47.876] [INFO] [SystemValidator.swift:283 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 COMPLETE: Total duration 7.285s
[2025-11-22 13:10:47.876] [INFO] [SystemValidator.swift:297 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Validation #1 complete in 7.285s
[2025-11-22 13:10:47.876] [INFO] [SystemValidator.swift:299 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Result: ready=false, blocking=9, total=9
[2025-11-22 13:10:47.876] [INFO] [SystemValidator.swift:283 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 COMPLETE: Total duration 5.447s
[2025-11-22 13:10:47.876] [INFO] [SystemValidator.swift:297 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Validation #1 complete in 5.447s
[2025-11-22 13:10:47.876] [INFO] [SystemValidator.swift:299 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Result: ready=false, blocking=9, total=9
[2025-11-22 13:10:47.876] [INFO] [SystemValidator.swift:355 checkPermissions()] ğŸ” [SystemValidator] Oracle snapshot: ready=false, age=1.808s
[2025-11-22 13:10:47.876] [INFO] [SystemValidator.swift:328 checkHelper()] ğŸ” [SystemValidator] Helper state: registeredButUnresponsive Helper registered but XPC communication failed
[2025-11-22 13:10:47.876] [INFO] [SystemValidator.swift:211 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 2 (Permissions) completed in 1.808s
[2025-11-22 13:10:47.876] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 80% (4/5 steps)
[2025-11-22 13:10:47.876] [INFO] [SystemValidator.swift:202 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 1 (Helper) completed in 5.447s
[2025-11-22 13:10:47.876] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:10:47.876] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 100% (5/5 steps)
[2025-11-22 13:10:47.876] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:10:47.876] [INFO] [SystemRequirements.swift:135 validateSystemCompatibility()] ğŸ” [SystemRequirements] Validating system compatibility
[2025-11-22 13:10:47.876] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:10:47.876] [INFO] [SystemRequirements.swift:147 validateSystemCompatibility()] âœ… [SystemRequirements] Modern macOS detected: 26.0.1
[2025-11-22 13:10:47.876] [INFO] [SystemRequirements.swift:190 validateSystemCompatibility()] ğŸ” [SystemRequirements] Compatibility check complete: âœ… Compatible
[2025-11-22 13:10:47.876] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:10:47.876] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:10:47.876] [INFO] [InstallerEngine.swift:78 inspectSystem()] âœ… [InstallerEngine] inspectSystem() complete - ready=false, blocking=9
[2025-11-22 13:10:47.876] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: repair, context:)
[2025-11-22 13:10:47.876] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: repair
[2025-11-22 13:10:47.876] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:10:47.876] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:10:47.876] [INFO] [InstallerEngine.swift:390 execute(plan:using:)] âš™ï¸ [InstallerEngine] Starting execute(plan:, using:)
[2025-11-22 13:10:47.876] [INFO] [InstallerEngine.swift:409 execute(plan:using:)] âš™ï¸ [InstallerEngine] Executing recipe: install-bundled-kanata (type: installComponent)
[2025-11-22 13:10:47.876] [INFO] [PrivilegedOperationsCoordinator.swift:359 installBundledKanata()] ğŸ” [PrivCoordinator] Installing bundled Kanata binary
[2025-11-22 13:10:47.876] [INFO] [LaunchDaemonInstaller.swift:2898 installBundledKanataBinaryOnly()] ğŸ”§ [LaunchDaemon] Installing bundled kanata binary to system location
[2025-11-22 13:10:47.877] [INFO] [LaunchDaemonInstaller.swift:2906 installBundledKanataBinaryOnly()] âŒ [LaunchDaemon] CRITICAL: Bundled kanata binary not found at: /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata
[2025-11-22 13:10:47.877] [INFO] [LaunchDaemonInstaller.swift:2908 installBundledKanataBinaryOnly()] âŒ [LaunchDaemon] This indicates a packaging issue - the app bundle is missing the kanata binary
[2025-11-22 13:10:47.877] [INFO] [InstallerEngine.swift:451 execute(plan:using:)] âŒ [InstallerEngine] Recipe install-bundled-kanata failed: Operation failed: Bundled Kanata installation failed
[2025-11-22 13:10:47.877] [INFO] [InstallerEngine.swift:470 execute(plan:using:)] âœ… [InstallerEngine] execute() complete - success: false, recipes executed: 1
[2025-11-22 13:10:47.877] [INFO] [InstallerEngine.swift:625 run(intent:using:)] âœ… [InstallerEngine] run() complete - success: false
[2025-11-22 13:10:47.877] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:10:47.877] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:10:47.877] [INFO] [SystemRequirements.swift:135 validateSystemCompatibility()] ğŸ” [SystemRequirements] Validating system compatibility
[2025-11-22 13:10:47.877] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:10:47.877] [INFO] [SystemRequirements.swift:147 validateSystemCompatibility()] âœ… [SystemRequirements] Modern macOS detected: 26.0.1
[2025-11-22 13:10:47.877] [INFO] [SystemRequirements.swift:190 validateSystemCompatibility()] ğŸ” [SystemRequirements] Compatibility check complete: âœ… Compatible
[2025-11-22 13:10:47.877] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:10:47.877] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:10:47.877] [INFO] [InstallerEngine.swift:78 inspectSystem()] âœ… [InstallerEngine] inspectSystem() complete - ready=false, blocking=9
[2025-11-22 13:10:47.877] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: repair, context:)
[2025-11-22 13:10:47.877] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: repair
[2025-11-22 13:10:47.877] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:10:47.877] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:10:47.877] [INFO] [InstallerEngine.swift:390 execute(plan:using:)] âš™ï¸ [InstallerEngine] Starting execute(plan:, using:)
[2025-11-22 13:10:47.877] [INFO] [InstallerEngine.swift:409 execute(plan:using:)] âš™ï¸ [InstallerEngine] Executing recipe: install-bundled-kanata (type: installComponent)
[2025-11-22 13:10:47.877] [INFO] [PrivilegedOperationsCoordinator.swift:359 installBundledKanata()] ğŸ” [PrivCoordinator] Installing bundled Kanata binary
[2025-11-22 13:10:47.877] [INFO] [LaunchDaemonInstaller.swift:2898 installBundledKanataBinaryOnly()] ğŸ”§ [LaunchDaemon] Installing bundled kanata binary to system location
[2025-11-22 13:10:47.877] [INFO] [LaunchDaemonInstaller.swift:2906 installBundledKanataBinaryOnly()] âŒ [LaunchDaemon] CRITICAL: Bundled kanata binary not found at: /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata
[2025-11-22 13:10:47.877] [INFO] [LaunchDaemonInstaller.swift:2908 installBundledKanataBinaryOnly()] âŒ [LaunchDaemon] This indicates a packaging issue - the app bundle is missing the kanata binary
[2025-11-22 13:10:47.877] [INFO] [InstallerEngine.swift:451 execute(plan:using:)] âŒ [InstallerEngine] Recipe install-bundled-kanata failed: Operation failed: Bundled Kanata installation failed
[2025-11-22 13:10:47.877] [INFO] [InstallerEngine.swift:470 execute(plan:using:)] âœ… [InstallerEngine] execute() complete - success: false, recipes executed: 1
[2025-11-22 13:10:47.877] [INFO] [InstallerEngine.swift:625 run(intent:using:)] âœ… [InstallerEngine] run() complete - success: false
[2025-11-22 13:10:47.877] [INFO] [SystemValidator.swift:283 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 COMPLETE: Total duration 5.449s
[2025-11-22 13:10:47.877] [INFO] [SystemValidator.swift:297 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Validation #1 complete in 5.449s
[2025-11-22 13:10:47.877] [INFO] [SystemValidator.swift:299 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Result: ready=false, blocking=9, total=9
[2025-11-22 13:10:47.877] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:10:47.877] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:10:47.877] [INFO] [SystemRequirements.swift:135 validateSystemCompatibility()] ğŸ” [SystemRequirements] Validating system compatibility
[2025-11-22 13:10:47.877] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:10:47.878] [INFO] [SystemRequirements.swift:147 validateSystemCompatibility()] âœ… [SystemRequirements] Modern macOS detected: 26.0.1
[2025-11-22 13:10:47.878] [INFO] [SystemRequirements.swift:190 validateSystemCompatibility()] ğŸ” [SystemRequirements] Compatibility check complete: âœ… Compatible
[2025-11-22 13:10:47.878] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:10:47.878] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:10:47.878] [INFO] [InstallerEngine.swift:78 inspectSystem()] âœ… [InstallerEngine] inspectSystem() complete - ready=false, blocking=9
[2025-11-22 13:10:47.878] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: repair, context:)
[2025-11-22 13:10:47.878] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: repair
[2025-11-22 13:10:47.878] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:10:47.878] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:10:47.878] [INFO] [InstallerEngine.swift:390 execute(plan:using:)] âš™ï¸ [InstallerEngine] Starting execute(plan:, using:)
[2025-11-22 13:10:47.878] [INFO] [InstallerEngine.swift:409 execute(plan:using:)] âš™ï¸ [InstallerEngine] Executing recipe: install-bundled-kanata (type: installComponent)
[2025-11-22 13:10:47.878] [INFO] [PrivilegedOperationsCoordinator.swift:359 installBundledKanata()] ğŸ” [PrivCoordinator] Installing bundled Kanata binary
[2025-11-22 13:10:47.878] [INFO] [LaunchDaemonInstaller.swift:2898 installBundledKanataBinaryOnly()] ğŸ”§ [LaunchDaemon] Installing bundled kanata binary to system location
[2025-11-22 13:10:47.878] [INFO] [LaunchDaemonInstaller.swift:2906 installBundledKanataBinaryOnly()] âŒ [LaunchDaemon] CRITICAL: Bundled kanata binary not found at: /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata
[2025-11-22 13:10:47.878] [INFO] [LaunchDaemonInstaller.swift:2908 installBundledKanataBinaryOnly()] âŒ [LaunchDaemon] This indicates a packaging issue - the app bundle is missing the kanata binary
[2025-11-22 13:10:47.878] [INFO] [InstallerEngine.swift:451 execute(plan:using:)] âŒ [InstallerEngine] Recipe install-bundled-kanata failed: Operation failed: Bundled Kanata installation failed
[2025-11-22 13:10:47.878] [INFO] [InstallerEngine.swift:470 execute(plan:using:)] âœ… [InstallerEngine] execute() complete - success: false, recipes executed: 1
[2025-11-22 13:10:47.878] [INFO] [InstallerEngine.swift:625 run(intent:using:)] âœ… [InstallerEngine] run() complete - success: false
[2025-11-22 13:10:48.969] [INFO] [PrivilegedOperationsCoordinator.swift:844 sudoExecuteCommand(_:description:)] âœ… [PrivCoordinator] Successfully executed: Stop Kanata service
[2025-11-22 13:10:48.969] [INFO] [PrivilegedOperationsCoordinator.swift:330 killAllKanataProcesses()] ğŸ” [PrivCoordinator] Killing all Kanata processes
[2025-11-22 13:10:48.969] [INFO] [PrivilegedOperationsCoordinator.swift:839 sudoExecuteCommand(_:description:)] ğŸ”§ [PrivCoordinator] Executing admin command: Kill all Kanata processes
[2025-11-22 13:10:49.168] [INFO] [HelperManager.swift:248 getHelperVersion()] âš ï¸ [HelperManager] getVersion timed out - clearing connection cache
[2025-11-22 13:10:49.175] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:10:49.176] [INFO] [SystemValidator.swift:328 checkHelper()] ğŸ” [SystemValidator] Helper state: registeredButUnresponsive Helper registered but XPC communication failed
[2025-11-22 13:10:49.181] [INFO] [SystemValidator.swift:202 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 1 (Helper) completed in 3.113s
[2025-11-22 13:10:49.181] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 100% (5/5 steps)
[2025-11-22 13:10:49.182] [INFO] [SystemValidator.swift:283 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 COMPLETE: Total duration 3.113s
[2025-11-22 13:10:49.182] [INFO] [SystemValidator.swift:297 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Validation #1 complete in 3.114s
[2025-11-22 13:10:49.182] [INFO] [SystemValidator.swift:299 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Result: ready=false, blocking=9, total=9
[2025-11-22 13:10:49.182] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:10:49.183] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:10:49.183] [INFO] [SystemRequirements.swift:135 validateSystemCompatibility()] ğŸ” [SystemRequirements] Validating system compatibility
[2025-11-22 13:10:49.183] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:10:49.183] [INFO] [SystemRequirements.swift:147 validateSystemCompatibility()] âœ… [SystemRequirements] Modern macOS detected: 26.0.1
[2025-11-22 13:10:49.183] [INFO] [SystemRequirements.swift:190 validateSystemCompatibility()] ğŸ” [SystemRequirements] Compatibility check complete: âœ… Compatible
[2025-11-22 13:10:49.183] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:10:49.183] [INFO] [SystemRequirements.swift:102 detectMacOSVersion()] ğŸ” [SystemRequirements] Detected macOS version: 26.0.1
[2025-11-22 13:10:49.183] [INFO] [InstallerEngine.swift:78 inspectSystem()] âœ… [InstallerEngine] inspectSystem() complete - ready=false, blocking=9
[2025-11-22 13:10:49.183] [INFO] [InstallerEngine.swift:88 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Starting makePlan(for: repair, context:)
[2025-11-22 13:10:49.183] [INFO] [InstallerEngine.swift:105 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Determined 5 actions for intent: repair
[2025-11-22 13:10:49.183] [INFO] [InstallerEngine.swift:110 makePlan(for:context:)] ğŸ“‹ [InstallerEngine] Generated 5 recipes
[2025-11-22 13:10:49.183] [INFO] [InstallerEngine.swift:123 makePlan(for:context:)] âœ… [InstallerEngine] makePlan() complete - status: ready, recipes: 5
[2025-11-22 13:10:49.183] [INFO] [InstallerEngine.swift:390 execute(plan:using:)] âš™ï¸ [InstallerEngine] Starting execute(plan:, using:)
[2025-11-22 13:10:49.183] [INFO] [InstallerEngine.swift:409 execute(plan:using:)] âš™ï¸ [InstallerEngine] Executing recipe: install-bundled-kanata (type: installComponent)
[2025-11-22 13:10:49.183] [INFO] [PrivilegedOperationsCoordinator.swift:359 installBundledKanata()] ğŸ” [PrivCoordinator] Installing bundled Kanata binary
[2025-11-22 13:10:49.183] [INFO] [LaunchDaemonInstaller.swift:2898 installBundledKanataBinaryOnly()] ğŸ”§ [LaunchDaemon] Installing bundled kanata binary to system location
[2025-11-22 13:10:49.184] [INFO] [LaunchDaemonInstaller.swift:2906 installBundledKanataBinaryOnly()] âŒ [LaunchDaemon] CRITICAL: Bundled kanata binary not found at: /Applications/Xcode.app/Contents/Developer/usr/bin/Contents/Library/KeyPath/kanata
[2025-11-22 13:10:49.184] [INFO] [LaunchDaemonInstaller.swift:2908 installBundledKanataBinaryOnly()] âŒ [LaunchDaemon] This indicates a packaging issue - the app bundle is missing the kanata binary
[2025-11-22 13:10:49.184] [INFO] [InstallerEngine.swift:451 execute(plan:using:)] âŒ [InstallerEngine] Recipe install-bundled-kanata failed: Operation failed: Bundled Kanata installation failed
[2025-11-22 13:10:49.184] [INFO] [InstallerEngine.swift:470 execute(plan:using:)] âœ… [InstallerEngine] execute() complete - success: false, recipes executed: 1
[2025-11-22 13:10:49.184] [INFO] [InstallerEngine.swift:625 run(intent:using:)] âœ… [InstallerEngine] run() complete - success: false
[2025-11-22 13:10:54.832] [INFO] [PrivilegedOperationsCoordinator.swift:846 sudoExecuteCommand(_:description:)] âŒ [PrivCoordinator] Failed to execute: Kill all Kanata processes
[2025-11-22 13:10:54.832] [INFO] [PrivilegedOperationsCoordinator.swift:847 sudoExecuteCommand(_:description:)] âŒ [PrivCoordinator] Output: 
Test Case '-[KeyPathTests.ErrorHandlingTests testKanataProcessErrorHandling]' passed (14.240 seconds).
Test Case '-[KeyPathTests.ErrorHandlingTests testMemoryPressureErrorHandling]' started.
Test Case '-[KeyPathTests.ErrorHandlingTests testMemoryPressureErrorHandling]' passed (0.017 seconds).
Test Case '-[KeyPathTests.ErrorHandlingTests testNilAndOptionalHandling]' started.
[2025-11-22 13:10:54.850] [INFO] [KanataManager.swift:331 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] init() called
[2025-11-22 13:10:54.850] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:10:54.850] [INFO] [ConfigFileWatcher.swift:40 init()] ğŸ“ [FileWatcher] ConfigFileWatcher initialized with robust monitoring
[2025-11-22 13:10:54.850] [INFO] [ServiceHealthMonitor.swift:140 init(processLifecycle:)] [HealthMonitor] Initialized with process lifecycle manager
[2025-11-22 13:10:54.850] [DEBUG] [KanataManager.swift:403 init(engineClient:injectedConfigurationService:)] ğŸ§ª [KanataManager] Skipping background initialization in test environment
[2025-11-22 13:10:54.850] [INFO] [KanataManager.swift:411 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] About to call bootstrapRuleCollections and startLayerMonitoring
[2025-11-22 13:10:54.850] [INFO] [KanataManager.swift:583 startLayerMonitoring()] ğŸŒ [KanataManager] startLayerMonitoring() called
[2025-11-22 13:10:54.850] [INFO] [KanataManager.swift:585 startLayerMonitoring()] ğŸŒ [KanataManager] Skipping layer monitoring (test environment)
[2025-11-22 13:10:54.850] [INFO] [KanataManager.swift:415 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] init() completed
Test Case '-[KeyPathTests.ErrorHandlingTests testNilAndOptionalHandling]' passed (0.000 seconds).
Test Case '-[KeyPathTests.ErrorHandlingTests testPermissionErrorHandling]' started.
[2025-11-22 13:10:54.850] [INFO] [KanataManager.swift:331 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] init() called
[2025-11-22 13:10:54.850] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:10:54.850] [INFO] [ConfigFileWatcher.swift:40 init()] ğŸ“ [FileWatcher] ConfigFileWatcher initialized with robust monitoring
[2025-11-22 13:10:54.850] [INFO] [ServiceHealthMonitor.swift:140 init(processLifecycle:)] [HealthMonitor] Initialized with process lifecycle manager
[2025-11-22 13:10:54.850] [DEBUG] [KanataManager.swift:403 init(engineClient:injectedConfigurationService:)] ğŸ§ª [KanataManager] Skipping background initialization in test environment
[2025-11-22 13:10:54.850] [INFO] [KanataManager.swift:411 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] About to call bootstrapRuleCollections and startLayerMonitoring
[2025-11-22 13:10:54.850] [INFO] [KanataManager.swift:583 startLayerMonitoring()] ğŸŒ [KanataManager] startLayerMonitoring() called
[2025-11-22 13:10:54.850] [INFO] [KanataManager.swift:585 startLayerMonitoring()] ğŸŒ [KanataManager] Skipping layer monitoring (test environment)
[2025-11-22 13:10:54.850] [INFO] [KanataManager.swift:415 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] init() completed
[2025-11-22 13:10:54.850] [INFO] [PermissionOracle.swift:173 currentSnapshot()] ğŸ”® [Oracle] Test mode snapshot generated (non-blocking)
Test Case '-[KeyPathTests.ErrorHandlingTests testPermissionErrorHandling]' passed (0.011 seconds).
Test Case '-[KeyPathTests.ErrorHandlingTests testResourceCleanupErrorHandling]' started.
[2025-11-22 13:10:54.861] [DEBUG] [KeyboardCapture.swift:331 setupEventTap(at:)] ğŸ§ª [KeyboardCapture] Test environment detected â€“ skipping CGEvent tap setup
[2025-11-22 13:10:54.861] [DEBUG] [KeyboardCapture.swift:331 setupEventTap(at:)] ğŸ§ª [KeyboardCapture] Test environment detected â€“ skipping CGEvent tap setup
[2025-11-22 13:10:54.861] [DEBUG] [KeyboardCapture.swift:331 setupEventTap(at:)] ğŸ§ª [KeyboardCapture] Test environment detected â€“ skipping CGEvent tap setup
[2025-11-22 13:10:54.861] [DEBUG] [KeyboardCapture.swift:331 setupEventTap(at:)] ğŸ§ª [KeyboardCapture] Test environment detected â€“ skipping CGEvent tap setup
[2025-11-22 13:10:54.861] [DEBUG] [KeyboardCapture.swift:331 setupEventTap(at:)] ğŸ§ª [KeyboardCapture] Test environment detected â€“ skipping CGEvent tap setup
[2025-11-22 13:10:54.861] [DEBUG] [KeyboardCapture.swift:331 setupEventTap(at:)] ğŸ§ª [KeyboardCapture] Test environment detected â€“ skipping CGEvent tap setup
[2025-11-22 13:10:54.861] [DEBUG] [KeyboardCapture.swift:331 setupEventTap(at:)] ğŸ§ª [KeyboardCapture] Test environment detected â€“ skipping CGEvent tap setup
[2025-11-22 13:10:54.861] [DEBUG] [KeyboardCapture.swift:331 setupEventTap(at:)] ğŸ§ª [KeyboardCapture] Test environment detected â€“ skipping CGEvent tap setup
[2025-11-22 13:10:54.861] [DEBUG] [KeyboardCapture.swift:331 setupEventTap(at:)] ğŸ§ª [KeyboardCapture] Test environment detected â€“ skipping CGEvent tap setup
[2025-11-22 13:10:54.861] [DEBUG] [KeyboardCapture.swift:331 setupEventTap(at:)] ğŸ§ª [KeyboardCapture] Test environment detected â€“ skipping CGEvent tap setup
[2025-11-22 13:10:54.861] [DEBUG] [KeyboardCapture.swift:331 setupEventTap(at:)] ğŸ§ª [KeyboardCapture] Test environment detected â€“ skipping CGEvent tap setup
[2025-11-22 13:10:54.861] [DEBUG] [KeyboardCapture.swift:331 setupEventTap(at:)] ğŸ§ª [KeyboardCapture] Test environment detected â€“ skipping CGEvent tap setup
[2025-11-22 13:10:54.861] [DEBUG] [KeyboardCapture.swift:331 setupEventTap(at:)] ğŸ§ª [KeyboardCapture] Test environment detected â€“ skipping CGEvent tap setup
[2025-11-22 13:10:54.861] [DEBUG] [KeyboardCapture.swift:331 setupEventTap(at:)] ğŸ§ª [KeyboardCapture] Test environment detected â€“ skipping CGEvent tap setup
[2025-11-22 13:10:54.861] [DEBUG] [KeyboardCapture.swift:331 setupEventTap(at:)] ğŸ§ª [KeyboardCapture] Test environment detected â€“ skipping CGEvent tap setup
[2025-11-22 13:10:54.861] [DEBUG] [KeyboardCapture.swift:331 setupEventTap(at:)] ğŸ§ª [KeyboardCapture] Test environment detected â€“ skipping CGEvent tap setup
[2025-11-22 13:10:54.861] [DEBUG] [KeyboardCapture.swift:331 setupEventTap(at:)] ğŸ§ª [KeyboardCapture] Test environment detected â€“ skipping CGEvent tap setup
[2025-11-22 13:10:54.861] [DEBUG] [KeyboardCapture.swift:331 setupEventTap(at:)] ğŸ§ª [KeyboardCapture] Test environment detected â€“ skipping CGEvent tap setup
[2025-11-22 13:10:54.861] [DEBUG] [KeyboardCapture.swift:331 setupEventTap(at:)] ğŸ§ª [KeyboardCapture] Test environment detected â€“ skipping CGEvent tap setup
[2025-11-22 13:10:54.861] [DEBUG] [KeyboardCapture.swift:331 setupEventTap(at:)] ğŸ§ª [KeyboardCapture] Test environment detected â€“ skipping CGEvent tap setup
[2025-11-22 13:10:54.861] [DEBUG] [KeyboardCapture.swift:600 startEmergencyMonitoring(callback:)] ğŸ§ª [KeyboardCapture] Test environment â€“ skipping emergency monitoring tap
[2025-11-22 13:10:54.861] [DEBUG] [KeyboardCapture.swift:600 startEmergencyMonitoring(callback:)] ğŸ§ª [KeyboardCapture] Test environment â€“ skipping emergency monitoring tap
[2025-11-22 13:10:54.861] [DEBUG] [KeyboardCapture.swift:600 startEmergencyMonitoring(callback:)] ğŸ§ª [KeyboardCapture] Test environment â€“ skipping emergency monitoring tap
[2025-11-22 13:10:54.861] [DEBUG] [KeyboardCapture.swift:600 startEmergencyMonitoring(callback:)] ğŸ§ª [KeyboardCapture] Test environment â€“ skipping emergency monitoring tap
[2025-11-22 13:10:54.861] [DEBUG] [KeyboardCapture.swift:600 startEmergencyMonitoring(callback:)] ğŸ§ª [KeyboardCapture] Test environment â€“ skipping emergency monitoring tap
[2025-11-22 13:10:54.861] [DEBUG] [KeyboardCapture.swift:600 startEmergencyMonitoring(callback:)] ğŸ§ª [KeyboardCapture] Test environment â€“ skipping emergency monitoring tap
[2025-11-22 13:10:54.861] [DEBUG] [KeyboardCapture.swift:600 startEmergencyMonitoring(callback:)] ğŸ§ª [KeyboardCapture] Test environment â€“ skipping emergency monitoring tap
[2025-11-22 13:10:54.862] [DEBUG] [KeyboardCapture.swift:600 startEmergencyMonitoring(callback:)] ğŸ§ª [KeyboardCapture] Test environment â€“ skipping emergency monitoring tap
[2025-11-22 13:10:54.862] [DEBUG] [KeyboardCapture.swift:600 startEmergencyMonitoring(callback:)] ğŸ§ª [KeyboardCapture] Test environment â€“ skipping emergency monitoring tap
[2025-11-22 13:10:54.862] [DEBUG] [KeyboardCapture.swift:600 startEmergencyMonitoring(callback:)] ğŸ§ª [KeyboardCapture] Test environment â€“ skipping emergency monitoring tap
[2025-11-22 13:10:54.862] [DEBUG] [KeyboardCapture.swift:600 startEmergencyMonitoring(callback:)] ğŸ§ª [KeyboardCapture] Test environment â€“ skipping emergency monitoring tap
[2025-11-22 13:10:54.862] [DEBUG] [KeyboardCapture.swift:600 startEmergencyMonitoring(callback:)] ğŸ§ª [KeyboardCapture] Test environment â€“ skipping emergency monitoring tap
[2025-11-22 13:10:54.862] [DEBUG] [KeyboardCapture.swift:600 startEmergencyMonitoring(callback:)] ğŸ§ª [KeyboardCapture] Test environment â€“ skipping emergency monitoring tap
[2025-11-22 13:10:54.862] [DEBUG] [KeyboardCapture.swift:600 startEmergencyMonitoring(callback:)] ğŸ§ª [KeyboardCapture] Test environment â€“ skipping emergency monitoring tap
[2025-11-22 13:10:54.862] [DEBUG] [KeyboardCapture.swift:600 startEmergencyMonitoring(callback:)] ğŸ§ª [KeyboardCapture] Test environment â€“ skipping emergency monitoring tap
[2025-11-22 13:10:54.862] [DEBUG] [KeyboardCapture.swift:600 startEmergencyMonitoring(callback:)] ğŸ§ª [KeyboardCapture] Test environment â€“ skipping emergency monitoring tap
[2025-11-22 13:10:54.862] [DEBUG] [KeyboardCapture.swift:600 startEmergencyMonitoring(callback:)] ğŸ§ª [KeyboardCapture] Test environment â€“ skipping emergency monitoring tap
[2025-11-22 13:10:54.862] [DEBUG] [KeyboardCapture.swift:600 startEmergencyMonitoring(callback:)] ğŸ§ª [KeyboardCapture] Test environment â€“ skipping emergency monitoring tap
[2025-11-22 13:10:54.862] [DEBUG] [KeyboardCapture.swift:600 startEmergencyMonitoring(callback:)] ğŸ§ª [KeyboardCapture] Test environment â€“ skipping emergency monitoring tap
[2025-11-22 13:10:54.862] [DEBUG] [KeyboardCapture.swift:600 startEmergencyMonitoring(callback:)] ğŸ§ª [KeyboardCapture] Test environment â€“ skipping emergency monitoring tap
Test Case '-[KeyPathTests.ErrorHandlingTests testResourceCleanupErrorHandling]' passed (0.000 seconds).
Test Case '-[KeyPathTests.ErrorHandlingTests testSequenceGenerationErrorHandling]' started.
[2025-11-22 13:10:54.862] [INFO] [KanataManager.swift:331 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] init() called
[2025-11-22 13:10:54.862] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:10:54.862] [INFO] [ConfigFileWatcher.swift:40 init()] ğŸ“ [FileWatcher] ConfigFileWatcher initialized with robust monitoring
[2025-11-22 13:10:54.862] [INFO] [ServiceHealthMonitor.swift:140 init(processLifecycle:)] [HealthMonitor] Initialized with process lifecycle manager
[2025-11-22 13:10:54.862] [DEBUG] [KanataManager.swift:403 init(engineClient:injectedConfigurationService:)] ğŸ§ª [KanataManager] Skipping background initialization in test environment
[2025-11-22 13:10:54.862] [INFO] [KanataManager.swift:411 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] About to call bootstrapRuleCollections and startLayerMonitoring
[2025-11-22 13:10:54.862] [INFO] [KanataManager.swift:583 startLayerMonitoring()] ğŸŒ [KanataManager] startLayerMonitoring() called
[2025-11-22 13:10:54.862] [INFO] [KanataManager.swift:585 startLayerMonitoring()] ğŸŒ [KanataManager] Skipping layer monitoring (test environment)
[2025-11-22 13:10:54.862] [INFO] [KanataManager.swift:415 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] init() completed
Test Case '-[KeyPathTests.ErrorHandlingTests testSequenceGenerationErrorHandling]' passed (0.001 seconds).
Test Case '-[KeyPathTests.ErrorHandlingTests testServiceInstallationErrorHandling]' started.
[2025-11-22 13:10:54.862] [INFO] [KanataManager.swift:331 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] init() called
[2025-11-22 13:10:54.862] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:10:54.862] [INFO] [ConfigFileWatcher.swift:40 init()] ğŸ“ [FileWatcher] ConfigFileWatcher initialized with robust monitoring
[2025-11-22 13:10:54.862] [INFO] [ServiceHealthMonitor.swift:140 init(processLifecycle:)] [HealthMonitor] Initialized with process lifecycle manager
[2025-11-22 13:10:54.862] [DEBUG] [KanataManager.swift:403 init(engineClient:injectedConfigurationService:)] ğŸ§ª [KanataManager] Skipping background initialization in test environment
[2025-11-22 13:10:54.862] [INFO] [KanataManager.swift:411 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] About to call bootstrapRuleCollections and startLayerMonitoring
[2025-11-22 13:10:54.862] [INFO] [KanataManager.swift:583 startLayerMonitoring()] ğŸŒ [KanataManager] startLayerMonitoring() called
[2025-11-22 13:10:54.862] [INFO] [KanataManager.swift:585 startLayerMonitoring()] ğŸŒ [KanataManager] Skipping layer monitoring (test environment)
[2025-11-22 13:10:54.862] [INFO] [KanataManager.swift:415 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] init() completed
[2025-11-22 13:10:54.862] [INFO] [KanataBinaryDetector.swift:66 detectCurrentStatus()] ğŸ” [KanataBinaryDetector] Starting unified kanata binary detection
[2025-11-22 13:10:54.863] [INFO] [KanataBinaryDetector.swift:81 detectCurrentStatus()] âŒ [KanataBinaryDetector] No kanata binary found
[2025-11-22 13:10:54.863] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:10:54.863] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:10:54.863] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:10:54.863] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:10:54.863] [INFO] [KanataBinaryDetector.swift:66 detectCurrentStatus()] ğŸ” [KanataBinaryDetector] Starting unified kanata binary detection
[2025-11-22 13:10:54.863] [INFO] [KanataBinaryDetector.swift:81 detectCurrentStatus()] âŒ [KanataBinaryDetector] No kanata binary found
[2025-11-22 13:10:54.863] [INFO] [KanataBinaryDetector.swift:66 detectCurrentStatus()] ğŸ” [KanataBinaryDetector] Starting unified kanata binary detection
[2025-11-22 13:10:54.863] [INFO] [KanataBinaryDetector.swift:81 detectCurrentStatus()] âŒ [KanataBinaryDetector] No kanata binary found
Test Case '-[KeyPathTests.ErrorHandlingTests testServiceInstallationErrorHandling]' passed (0.001 seconds).
Test Case '-[KeyPathTests.ErrorHandlingTests testSpecialCharacterKeyMapping]' started.
[2025-11-22 13:10:54.863] [INFO] [KanataManager.swift:331 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] init() called
[2025-11-22 13:10:54.863] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:10:54.863] [INFO] [ConfigFileWatcher.swift:40 init()] ğŸ“ [FileWatcher] ConfigFileWatcher initialized with robust monitoring
[2025-11-22 13:10:54.864] [INFO] [ServiceHealthMonitor.swift:140 init(processLifecycle:)] [HealthMonitor] Initialized with process lifecycle manager
[2025-11-22 13:10:54.864] [DEBUG] [KanataManager.swift:403 init(engineClient:injectedConfigurationService:)] ğŸ§ª [KanataManager] Skipping background initialization in test environment
[2025-11-22 13:10:54.864] [INFO] [KanataManager.swift:411 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] About to call bootstrapRuleCollections and startLayerMonitoring
[2025-11-22 13:10:54.864] [INFO] [KanataManager.swift:583 startLayerMonitoring()] ğŸŒ [KanataManager] startLayerMonitoring() called
[2025-11-22 13:10:54.864] [INFO] [KanataManager.swift:585 startLayerMonitoring()] ğŸŒ [KanataManager] Skipping layer monitoring (test environment)
[2025-11-22 13:10:54.864] [INFO] [KanataManager.swift:415 init(engineClient:injectedConfigurationService:)] ğŸ—ï¸ [KanataManager] init() completed
Test Case '-[KeyPathTests.ErrorHandlingTests testSpecialCharacterKeyMapping]' passed (0.000 seconds).
Test Suite 'ErrorHandlingTests' passed at 2025-11-22 13:10:54.864.
	 Executed 21 tests, with 0 failures (0 unexpected) in 23.460 (23.462) seconds
Test Suite 'FDADetectionTests' started at 2025-11-22 13:10:54.864.
Test Case '-[KeyPathTests.FDADetectionTests testDetectionModalTiming]' started.
Test Case '-[KeyPathTests.FDADetectionTests testDetectionModalTiming]' passed (0.000 seconds).
Test Case '-[KeyPathTests.FDADetectionTests testFDACaching]' started.
Test Case '-[KeyPathTests.FDADetectionTests testFDACaching]' passed (0.000 seconds).
Test Case '-[KeyPathTests.FDADetectionTests testFDACheckPerformance]' started.
[2025-11-22 13:10:54.865] [INFO] [KanataManager.swift:609 updateActiveLayerName(_:)] ğŸ¯ [KanataManager] updateActiveLayerName: raw='base' normalized='base' display='Base' current='Base'
[2025-11-22 13:10:54.865] [INFO] [KanataManager.swift:609 updateActiveLayerName(_:)] ğŸ¯ [KanataManager] updateActiveLayerName: raw='base' normalized='base' display='Base' current='Base'
[2025-11-22 13:10:54.865] [INFO] [KanataManager.swift:609 updateActiveLayerName(_:)] ğŸ¯ [KanataManager] updateActiveLayerName: raw='base' normalized='base' display='Base' current='Base'
[2025-11-22 13:10:54.865] [INFO] [KanataManager.swift:609 updateActiveLayerName(_:)] ğŸ¯ [KanataManager] updateActiveLayerName: raw='base' normalized='base' display='Base' current='Base'
[2025-11-22 13:10:54.865] [INFO] [KanataManager.swift:609 updateActiveLayerName(_:)] ğŸ¯ [KanataManager] updateActiveLayerName: raw='base' normalized='base' display='Base' current='Base'
[2025-11-22 13:10:54.865] [INFO] [KanataManager.swift:609 updateActiveLayerName(_:)] ğŸ¯ [KanataManager] updateActiveLayerName: raw='base' normalized='base' display='Base' current='Base'
[2025-11-22 13:10:54.865] [INFO] [KanataManager.swift:609 updateActiveLayerName(_:)] ğŸ¯ [KanataManager] updateActiveLayerName: raw='base' normalized='base' display='Base' current='Base'
[2025-11-22 13:10:54.865] [INFO] [KanataManager.swift:609 updateActiveLayerName(_:)] ğŸ¯ [KanataManager] updateActiveLayerName: raw='base' normalized='base' display='Base' current='Base'
[2025-11-22 13:10:54.869] [INFO] [KanataManager.swift:609 updateActiveLayerName(_:)] ğŸ¯ [KanataManager] updateActiveLayerName: raw='base' normalized='base' display='Base' current='Base'
[2025-11-22 13:10:54.869] [INFO] [KanataManager.swift:609 updateActiveLayerName(_:)] ğŸ¯ [KanataManager] updateActiveLayerName: raw='base' normalized='base' display='Base' current='Base'
[2025-11-22 13:10:54.869] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:10:54.869] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:10:54.869] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 7007 characters
[2025-11-22 13:10:54.869] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:10:54.870] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 18 src keys, 88 layer keys, deduplicated to 18 unique mappings
[2025-11-22 13:10:54.870] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:10:54.870] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:10:54.870] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 28 mappings
[2025-11-22 13:10:54.870] [DEBUG] [KanataManager+Configuration.swift:53 triggerConfigReload()] ğŸ“¡ [Reload] Attempting TCP reload
[2025-11-22 13:10:54.870] [DEBUG] [KanataManager+Configuration.swift:84 triggerTCPReload()] ğŸ§ª [TCP Reload] Skipping TCP reload in test environment
[2025-11-22 13:10:54.870] [DEBUG] [KanataManager+Configuration.swift:65 triggerConfigReload()] ğŸ“¡ [Reload] TCP reload failed: Test environment - TCP disabled
[2025-11-22 13:10:54.870] [WARN] [KanataManager+Configuration.swift:68 triggerConfigReload()] âš ï¸ [Reload] Falling back to service restart
[2025-11-22 13:10:54.870] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:10:54.870] [INFO] [SystemValidator.swift:63 init(launchDaemonInstaller:vhidDeviceManager:processLifecycleManager:kanataManager:)] ğŸ” [SystemValidator] Initialized (stateless, no cache)
[2025-11-22 13:10:54.870] [INFO] [InstallerEngine.swift:35 init(processLifecycleManager:kanataManager:)] ğŸ”§ [InstallerEngine] Initialized
[2025-11-22 13:10:54.870] [INFO] [InstallerEngine.swift:612 run(intent:using:)] ğŸš€ [InstallerEngine] Starting run(intent: repair, using:)
[2025-11-22 13:10:54.870] [INFO] [InstallerEngine.swift:53 inspectSystem()] ğŸ” [InstallerEngine] Starting inspectSystem()
[2025-11-22 13:10:54.870] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:10:54.870] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:10:54.870] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 7007 characters
[2025-11-22 13:10:54.870] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:10:54.871] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 18 src keys, 88 layer keys, deduplicated to 18 unique mappings
[2025-11-22 13:10:54.871] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:10:54.871] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:10:54.871] [INFO] [SystemValidator.swift:143 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Starting validation #1
[2025-11-22 13:10:54.871] [INFO] [SystemValidator.swift:174 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 START: 1763845854.871
[2025-11-22 13:10:54.871] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:10:54.871] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:10:54.871] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 7007 characters
[2025-11-22 13:10:54.871] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:10:54.871] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 18 src keys, 88 layer keys, deduplicated to 18 unique mappings
[2025-11-22 13:10:54.871] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:10:54.871] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:10:54.871] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:10:54.871] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:10:54.871] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 7007 characters
[2025-11-22 13:10:54.871] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:10:54.872] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 18 src keys, 88 layer keys, deduplicated to 18 unique mappings
[2025-11-22 13:10:54.872] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:10:54.872] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:10:54.872] [INFO] [ConfigurationService.swift:509 saveConfiguration(ruleCollections:customRules:)] ğŸ” [ConfigService] Validating config before save...
[2025-11-22 13:10:54.872] [INFO] [ConfigurationService.swift:616 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION START ==========
[2025-11-22 13:10:54.872] [INFO] [ConfigurationService.swift:617 validateConfiguration(_:)] ğŸ” [Validation] Config size: 7007 characters
[2025-11-22 13:10:54.872] [INFO] [ConfigurationService.swift:620 validateConfiguration(_:)] ğŸ§ª [Validation] Test mode detected â€“ using lightweight validation
[2025-11-22 13:10:54.872] [INFO] [ConfigurationService.swift:916 extractKeyMappingsFromContent(_:)] ğŸ” [Parse] Found 18 src keys, 88 layer keys, deduplicated to 18 unique mappings
[2025-11-22 13:10:54.872] [INFO] [ConfigurationService.swift:622 validateConfiguration(_:)] ğŸ” [Validation] ========== CONFIG VALIDATION END ==========
[2025-11-22 13:10:54.872] [INFO] [ConfigurationService.swift:518 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Config validation passed
[2025-11-22 13:10:54.872] [INFO] [SystemValidator.swift:312 checkHelper()] ğŸ” [SystemValidator] Checking privileged helper
[2025-11-22 13:10:54.872] [INFO] [SystemValidator.swift:344 checkPermissions()] ğŸ” [SystemValidator] Checking permissions via Oracle
[2025-11-22 13:10:54.872] [INFO] [SystemValidator.swift:365 checkComponents()] ğŸ” [SystemValidator] Checking components
[2025-11-22 13:10:54.872] [INFO] [KanataBinaryDetector.swift:66 detectCurrentStatus()] ğŸ” [KanataBinaryDetector] Starting unified kanata binary detection
[2025-11-22 13:10:54.872] [INFO] [PermissionOracle.swift:158 currentSnapshot()] ğŸ”® [Oracle] (Test) Returning cached snapshot
[2025-11-22 13:10:54.872] [INFO] [KanataBinaryDetector.swift:81 detectCurrentStatus()] âŒ [KanataBinaryDetector] No kanata binary found
[2025-11-22 13:10:54.872] [INFO] [VHIDDeviceManager.swift:50 detectInstallation()] ğŸ” [VHIDManager] Manager app exists at /Applications/.Karabiner-VirtualHIDDevice-Manager.app/Contents/MacOS/Karabiner-VirtualHIDDevice-Manager: true
[2025-11-22 13:10:54.878] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:10:54.881] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:10:54.894] [INFO] [HelperManager.swift:830 verifyEmbeddedHelperSignature()] ğŸ”’ [HelperManager] Embedded helper signature looks valid
[2025-11-22 13:10:54.894] [INFO] [HelperManager.swift:105 getConnection()] ğŸ”— [HelperManager] Creating XPC connection to com.keypath.helper
[2025-11-22 13:10:54.894] [INFO] [HelperManager.swift:129 getConnection()] âœ… [HelperManager] XPC connection established (PID: 0)
[2025-11-22 13:10:54.894] [INFO] [HelperManager.swift:228 getHelperVersion()] ğŸ“¤ [HelperManager] Calling proxy.getVersion()
[2025-11-22 13:10:54.894] [INFO] [HelperManager.swift:243 getHelperVersion()] ğŸ“¤ [HelperManager] proxy.getVersion() call dispatched, waiting for callback
[2025-11-22 13:10:54.894] [INFO] [HelperManager.swift:121 getConnection()] âš ï¸ [HelperManager] XPC connection interrupted - will reconnect
[2025-11-22 13:10:54.894] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:10:54.894] [INFO] [HelperManager.swift:578 getRemoteProxy(errorHandler:)] âŒ [HelperManager] XPC proxy error: Couldnâ€™t communicate with a helper application.
[2025-11-22 13:10:54.894] [INFO] [HelperManager.swift:584 getRemoteProxy(errorHandler:)] âš ï¸ [HelperManager] XPC connection interrupted - this may indicate:
[2025-11-22 13:10:54.894] [INFO] [HelperManager.swift:585 getRemoteProxy(errorHandler:)]    1. Helper signature validation failed (app updated but not restarted)
[2025-11-22 13:10:54.894] [INFO] [HelperManager.swift:587 getRemoteProxy(errorHandler:)]    2. Helper process crashed
[2025-11-22 13:10:54.895] [INFO] [HelperManager.swift:588 getRemoteProxy(errorHandler:)]    3. Helper was killed by the system
[2025-11-22 13:10:54.895] [INFO] [HelperManager.swift:589 getRemoteProxy(errorHandler:)] ğŸ’¡ If you just updated KeyPath, try restarting the app
[2025-11-22 13:10:54.895] [INFO] [HelperManager.swift:116 getConnection()] âŒ [HelperManager] XPC connection invalidated
[2025-11-22 13:10:54.895] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:10:54.940] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.068s)
[2025-11-22 13:10:54.940] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:10:55.514] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.068s)
[2025-11-22 13:10:55.514] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:10:55.514] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:10:55.514] [INFO] [VHIDDeviceManager.swift:343 getInstalledVersion()] ğŸ” [VHIDManager] Installed daemon version: 5.0.0
[2025-11-22 13:10:55.514] [INFO] [VHIDDeviceManager.swift:374 hasVersionMismatch()] âœ… [VHIDManager] Version compatible: v5.0.0
[2025-11-22 13:10:55.514] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:10:55.582] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:10:55.583] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:10:55.583] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:10:55.583] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:10:55.583] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:10:55.584] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:10:55.584] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:10:55.584] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:10:55.584] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:10:55.584] [INFO] [LaunchDaemonInstaller.swift:669 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Kanata service state: Uninstalled
[2025-11-22 13:10:55.584] [INFO] [LaunchDaemonInstaller.swift:696 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Service not installed (state: Uninstalled)
[2025-11-22 13:10:55.584] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:10:55.655] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:10:55.726] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhiddaemon loaded: false
[2025-11-22 13:10:55.793] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhidmanager loaded: false
[2025-11-22 13:10:55.793] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:10:55.860] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:10:55.860] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhidmanager
[2025-11-22 13:10:55.926] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhidmanager not found in system domain
[2025-11-22 13:10:55.926] [INFO] [SystemValidator.swift:393 checkComponents()] ğŸ” [SystemValidator] Components: kanata=false, driver=true, daemon=false, vhid=false, vhidVersionMismatch=false
[2025-11-22 13:10:55.926] [INFO] [SystemValidator.swift:220 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 3 (Components) completed in 1.056s
[2025-11-22 13:10:55.926] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 20% (1/5 steps)
[2025-11-22 13:10:55.926] [INFO] [SystemValidator.swift:411 checkConflicts()] ğŸ” [SystemValidator] Checking for conflicts
[2025-11-22 13:10:55.926] [INFO] [ProcessLifecycleManager.swift:117 detectConflicts()] ğŸ” [ProcessLifecycleManager] Detecting conflicts...
[2025-11-22 13:10:55.926] [INFO] [ProcessLifecycleManager.swift:121 detectConflicts()] ğŸ§ª [TestEnvironment] Skipping process conflict detection - returning clean state
[2025-11-22 13:10:55.926] [INFO] [SystemValidator.swift:436 checkConflicts()] ğŸ” [SystemValidator] Total conflicts: 0 (0 kanata, 0 karabiner)
[2025-11-22 13:10:55.926] [INFO] [SystemValidator.swift:477 checkHealth()] ğŸ” [SystemValidator] Checking system health
[2025-11-22 13:10:55.926] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:10:55.926] [INFO] [SystemValidator.swift:229 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 4 (Conflicts) completed in 1.056s
[2025-11-22 13:10:55.926] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 40% (2/5 steps)
[2025-11-22 13:10:55.993] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:10:55.993] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:10:56.061] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:10:56.129] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.067s)
[2025-11-22 13:10:56.129] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:10:56.703] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.068s)
[2025-11-22 13:10:56.703] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:10:56.703] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:10:56.703] [INFO] [SystemValidator.swift:487 checkHealth()] ğŸ” [SystemValidator] Health: kanata=false, daemon=false (launchctl), vhid=false
[2025-11-22 13:10:56.703] [INFO] [SystemValidator.swift:238 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 5 (Health) completed in 1.832s
[2025-11-22 13:10:56.703] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 60% (3/5 steps)
/Users/malpern/local-code/KeyPath/Tests/KeyPathTests/FDADetectionTests.swift:154: Test Case '-[KeyPathTests.FDADetectionTests testFDACheckPerformance]' measured [Time, seconds] average: 0.000, relative standard deviation: 100.140%, values: [0.001387, 0.000380, 0.000263, 0.000233, 0.000217, 0.000202, 0.000192, 0.000198, 0.000212, 0.000209], performanceMetricID:com.apple.XCTPerformanceMetric_WallClockTime, baselineName: "", baselineAverage: , polarity: prefers smaller, maxPercentRegression: 10.000%, maxPercentRelativeStandardDeviation: 10.000%, maxRegression: 0.100, maxStandardDeviation: 0.100
Test Case '-[KeyPathTests.FDADetectionTests testFDACheckPerformance]' passed (2.047 seconds).
Test Case '-[KeyPathTests.FDADetectionTests testFDADetectionWithoutAccess]' started.
Test Case '-[KeyPathTests.FDADetectionTests testFDADetectionWithoutAccess]' passed (0.001 seconds).
Test Case '-[KeyPathTests.FDADetectionTests testProtectedPathDetection]' started.
No FDA access to: /Users/malpern/Library/Mail
No FDA access to: /Users/malpern/Library/Messages
Has FDA access to: /Users/malpern/Library/Safari/Bookmarks.plist
Test Case '-[KeyPathTests.FDADetectionTests testProtectedPathDetection]' passed (0.000 seconds).
Test Case '-[KeyPathTests.FDADetectionTests testRestartTimingWindow]' started.
Test Case '-[KeyPathTests.FDADetectionTests testRestartTimingWindow]' passed (0.001 seconds).
Test Case '-[KeyPathTests.FDADetectionTests testWizardStatePreservation]' started.
Test Case '-[KeyPathTests.FDADetectionTests testWizardStatePreservation]' passed (0.000 seconds).
Test Suite 'FDADetectionTests' passed at 2025-11-22 13:10:56.915.
	 Executed 7 tests, with 0 failures (0 unexpected) in 2.050 (2.051) seconds
Test Suite 'HealthCheckServiceTests' started at 2025-11-22 13:10:56.915.
Test Case '-[KeyPathTests.HealthCheckServiceTests testEvaluate_Healthy_NoRestart]' started.
[2025-11-22 13:10:56.915] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 28 mappings
[2025-11-22 13:10:56.915] [DEBUG] [KanataManager+Configuration.swift:53 triggerConfigReload()] ğŸ“¡ [Reload] Attempting TCP reload
[2025-11-22 13:10:56.915] [DEBUG] [KanataManager+Configuration.swift:84 triggerTCPReload()] ğŸ§ª [TCP Reload] Skipping TCP reload in test environment
[2025-11-22 13:10:56.915] [DEBUG] [KanataManager+Configuration.swift:65 triggerConfigReload()] ğŸ“¡ [Reload] TCP reload failed: Test environment - TCP disabled
[2025-11-22 13:10:56.915] [WARN] [KanataManager+Configuration.swift:68 triggerConfigReload()] âš ï¸ [Reload] Falling back to service restart
[2025-11-22 13:10:56.915] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:10:56.915] [INFO] [SystemValidator.swift:63 init(launchDaemonInstaller:vhidDeviceManager:processLifecycleManager:kanataManager:)] ğŸ” [SystemValidator] Initialized (stateless, no cache)
[2025-11-22 13:10:56.915] [INFO] [InstallerEngine.swift:35 init(processLifecycleManager:kanataManager:)] ğŸ”§ [InstallerEngine] Initialized
[2025-11-22 13:10:56.915] [INFO] [InstallerEngine.swift:612 run(intent:using:)] ğŸš€ [InstallerEngine] Starting run(intent: repair, using:)
[2025-11-22 13:10:56.915] [INFO] [InstallerEngine.swift:53 inspectSystem()] ğŸ” [InstallerEngine] Starting inspectSystem()
[2025-11-22 13:10:56.915] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 28 mappings
[2025-11-22 13:10:56.915] [DEBUG] [KanataManager+Configuration.swift:53 triggerConfigReload()] ğŸ“¡ [Reload] Attempting TCP reload
[2025-11-22 13:10:56.915] [DEBUG] [KanataManager+Configuration.swift:84 triggerTCPReload()] ğŸ§ª [TCP Reload] Skipping TCP reload in test environment
[2025-11-22 13:10:56.915] [DEBUG] [KanataManager+Configuration.swift:65 triggerConfigReload()] ğŸ“¡ [Reload] TCP reload failed: Test environment - TCP disabled
[2025-11-22 13:10:56.915] [WARN] [KanataManager+Configuration.swift:68 triggerConfigReload()] âš ï¸ [Reload] Falling back to service restart
[2025-11-22 13:10:56.915] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:10:56.915] [INFO] [SystemValidator.swift:63 init(launchDaemonInstaller:vhidDeviceManager:processLifecycleManager:kanataManager:)] ğŸ” [SystemValidator] Initialized (stateless, no cache)
[2025-11-22 13:10:56.915] [INFO] [InstallerEngine.swift:35 init(processLifecycleManager:kanataManager:)] ğŸ”§ [InstallerEngine] Initialized
[2025-11-22 13:10:56.915] [INFO] [InstallerEngine.swift:612 run(intent:using:)] ğŸš€ [InstallerEngine] Starting run(intent: repair, using:)
[2025-11-22 13:10:56.915] [INFO] [InstallerEngine.swift:53 inspectSystem()] ğŸ” [InstallerEngine] Starting inspectSystem()
[2025-11-22 13:10:56.915] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 28 mappings
[2025-11-22 13:10:56.915] [DEBUG] [KanataManager+Configuration.swift:53 triggerConfigReload()] ğŸ“¡ [Reload] Attempting TCP reload
[2025-11-22 13:10:56.915] [DEBUG] [KanataManager+Configuration.swift:84 triggerTCPReload()] ğŸ§ª [TCP Reload] Skipping TCP reload in test environment
[2025-11-22 13:10:56.915] [DEBUG] [KanataManager+Configuration.swift:65 triggerConfigReload()] ğŸ“¡ [Reload] TCP reload failed: Test environment - TCP disabled
[2025-11-22 13:10:56.915] [WARN] [KanataManager+Configuration.swift:68 triggerConfigReload()] âš ï¸ [Reload] Falling back to service restart
[2025-11-22 13:10:56.915] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:10:56.915] [INFO] [SystemValidator.swift:63 init(launchDaemonInstaller:vhidDeviceManager:processLifecycleManager:kanataManager:)] ğŸ” [SystemValidator] Initialized (stateless, no cache)
[2025-11-22 13:10:56.915] [INFO] [InstallerEngine.swift:35 init(processLifecycleManager:kanataManager:)] ğŸ”§ [InstallerEngine] Initialized
[2025-11-22 13:10:56.915] [INFO] [InstallerEngine.swift:612 run(intent:using:)] ğŸš€ [InstallerEngine] Starting run(intent: repair, using:)
[2025-11-22 13:10:56.915] [INFO] [InstallerEngine.swift:53 inspectSystem()] ğŸ” [InstallerEngine] Starting inspectSystem()
[2025-11-22 13:10:56.915] [INFO] [SystemValidator.swift:355 checkPermissions()] ğŸ” [SystemValidator] Oracle snapshot: ready=false, age=2.065s
[2025-11-22 13:10:56.915] [INFO] [ConfigurationService.swift:540 saveConfiguration(ruleCollections:customRules:)] âœ… [ConfigService] Configuration saved with 28 mappings
[2025-11-22 13:10:56.915] [DEBUG] [KanataManager+Configuration.swift:53 triggerConfigReload()] ğŸ“¡ [Reload] Attempting TCP reload
[2025-11-22 13:10:56.915] [INFO] [SystemValidator.swift:211 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 2 (Permissions) completed in 2.044s
[2025-11-22 13:10:56.915] [DEBUG] [KanataManager+Configuration.swift:84 triggerTCPReload()] ğŸ§ª [TCP Reload] Skipping TCP reload in test environment
[2025-11-22 13:10:56.915] [DEBUG] [KanataManager+Configuration.swift:65 triggerConfigReload()] ğŸ“¡ [Reload] TCP reload failed: Test environment - TCP disabled
[2025-11-22 13:10:56.915] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 80% (4/5 steps)
[2025-11-22 13:10:56.915] [WARN] [KanataManager+Configuration.swift:68 triggerConfigReload()] âš ï¸ [Reload] Falling back to service restart
[2025-11-22 13:10:56.915] [INFO] [ProcessLifecycleManager.swift:43 init()] ğŸ—ï¸ [ProcessLifecycleManager] Initialized with simplified PID-based tracking and caching
[2025-11-22 13:10:56.915] [INFO] [SystemValidator.swift:63 init(launchDaemonInstaller:vhidDeviceManager:processLifecycleManager:kanataManager:)] ğŸ” [SystemValidator] Initialized (stateless, no cache)
[2025-11-22 13:10:56.915] [INFO] [InstallerEngine.swift:35 init(processLifecycleManager:kanataManager:)] ğŸ”§ [InstallerEngine] Initialized
[2025-11-22 13:10:56.915] [INFO] [InstallerEngine.swift:612 run(intent:using:)] ğŸš€ [InstallerEngine] Starting run(intent: repair, using:)
[2025-11-22 13:10:56.915] [INFO] [InstallerEngine.swift:53 inspectSystem()] ğŸ” [InstallerEngine] Starting inspectSystem()
[2025-11-22 13:10:56.915] [INFO] [SystemValidator.swift:143 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Starting validation #1
[2025-11-22 13:10:56.915] [INFO] [SystemValidator.swift:174 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 START: 1763845856.915
[2025-11-22 13:10:56.915] [INFO] [SystemValidator.swift:133 performValidationBody(progressCallback:)] âš ï¸ [SystemValidator] RAPID VALIDATION: 0.000s since last validation
This might indicate automatic triggers. Expected: manual user actions only.
[2025-11-22 13:10:56.915] [INFO] [SystemValidator.swift:143 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Starting validation #1
[2025-11-22 13:10:56.915] [INFO] [SystemValidator.swift:174 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 START: 1763845856.915
[2025-11-22 13:10:56.915] [INFO] [SystemValidator.swift:133 performValidationBody(progressCallback:)] âš ï¸ [SystemValidator] RAPID VALIDATION: 0.000s since last validation
This might indicate automatic triggers. Expected: manual user actions only.
[2025-11-22 13:10:56.915] [INFO] [SystemValidator.swift:143 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Starting validation #1
[2025-11-22 13:10:56.915] [INFO] [SystemValidator.swift:174 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 START: 1763845856.915
[2025-11-22 13:10:56.915] [INFO] [SystemValidator.swift:133 performValidationBody(progressCallback:)] âš ï¸ [SystemValidator] RAPID VALIDATION: 0.000s since last validation
This might indicate automatic triggers. Expected: manual user actions only.
[2025-11-22 13:10:56.915] [INFO] [SystemValidator.swift:143 performValidationBody(progressCallback:)] ğŸ” [SystemValidator] Starting validation #1
[2025-11-22 13:10:56.915] [INFO] [SystemValidator.swift:174 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Validation #1 START: 1763845856.915
Test Case '-[KeyPathTests.HealthCheckServiceTests testEvaluate_Healthy_NoRestart]' passed (0.001 seconds).
Test Case '-[KeyPathTests.HealthCheckServiceTests testEvaluate_Unhealthy_ShouldRestart]' started.
[2025-11-22 13:10:56.915] [INFO] [SystemValidator.swift:312 checkHelper()] ğŸ” [SystemValidator] Checking privileged helper
[2025-11-22 13:10:56.915] [INFO] [SystemValidator.swift:344 checkPermissions()] ğŸ” [SystemValidator] Checking permissions via Oracle
[2025-11-22 13:10:56.915] [INFO] [SystemValidator.swift:365 checkComponents()] ğŸ” [SystemValidator] Checking components
[2025-11-22 13:10:56.915] [INFO] [KanataBinaryDetector.swift:66 detectCurrentStatus()] ğŸ” [KanataBinaryDetector] Starting unified kanata binary detection
[2025-11-22 13:10:56.915] [INFO] [PermissionOracle.swift:173 currentSnapshot()] ğŸ”® [Oracle] Test mode snapshot generated (non-blocking)
[2025-11-22 13:10:56.916] [INFO] [KanataBinaryDetector.swift:81 detectCurrentStatus()] âŒ [KanataBinaryDetector] No kanata binary found
[2025-11-22 13:10:56.916] [INFO] [VHIDDeviceManager.swift:50 detectInstallation()] ğŸ” [VHIDManager] Manager app exists at /Applications/.Karabiner-VirtualHIDDevice-Manager.app/Contents/MacOS/Karabiner-VirtualHIDDevice-Manager: true
[2025-11-22 13:10:56.919] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:10:56.921] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:10:56.932] [INFO] [HelperManager.swift:830 verifyEmbeddedHelperSignature()] ğŸ”’ [HelperManager] Embedded helper signature looks valid
[2025-11-22 13:10:56.932] [INFO] [HelperManager.swift:105 getConnection()] ğŸ”— [HelperManager] Creating XPC connection to com.keypath.helper
[2025-11-22 13:10:56.932] [INFO] [HelperManager.swift:129 getConnection()] âœ… [HelperManager] XPC connection established (PID: 0)
[2025-11-22 13:10:56.932] [INFO] [HelperManager.swift:228 getHelperVersion()] ğŸ“¤ [HelperManager] Calling proxy.getVersion()
[2025-11-22 13:10:56.932] [INFO] [HelperManager.swift:243 getHelperVersion()] ğŸ“¤ [HelperManager] proxy.getVersion() call dispatched, waiting for callback
[2025-11-22 13:10:56.932] [INFO] [HelperManager.swift:121 getConnection()] âš ï¸ [HelperManager] XPC connection interrupted - will reconnect
[2025-11-22 13:10:56.932] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:10:56.932] [INFO] [HelperManager.swift:578 getRemoteProxy(errorHandler:)] âŒ [HelperManager] XPC proxy error: Couldnâ€™t communicate with a helper application.
[2025-11-22 13:10:56.932] [INFO] [HelperManager.swift:584 getRemoteProxy(errorHandler:)] âš ï¸ [HelperManager] XPC connection interrupted - this may indicate:
[2025-11-22 13:10:56.932] [INFO] [HelperManager.swift:585 getRemoteProxy(errorHandler:)]    1. Helper signature validation failed (app updated but not restarted)
[2025-11-22 13:10:56.932] [INFO] [HelperManager.swift:587 getRemoteProxy(errorHandler:)]    2. Helper process crashed
[2025-11-22 13:10:56.932] [INFO] [HelperManager.swift:588 getRemoteProxy(errorHandler:)]    3. Helper was killed by the system
[2025-11-22 13:10:56.932] [INFO] [HelperManager.swift:589 getRemoteProxy(errorHandler:)] ğŸ’¡ If you just updated KeyPath, try restarting the app
[2025-11-22 13:10:56.932] [INFO] [HelperManager.swift:116 getConnection()] âŒ [HelperManager] XPC connection invalidated
[2025-11-22 13:10:56.932] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:10:56.982] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.067s)
[2025-11-22 13:10:56.982] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:10:57.556] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.068s)
[2025-11-22 13:10:57.556] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:10:57.556] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:10:57.557] [INFO] [VHIDDeviceManager.swift:343 getInstalledVersion()] ğŸ” [VHIDManager] Installed daemon version: 5.0.0
[2025-11-22 13:10:57.557] [INFO] [VHIDDeviceManager.swift:374 hasVersionMismatch()] âœ… [VHIDManager] Version compatible: v5.0.0
[2025-11-22 13:10:57.557] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:10:57.625] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:10:57.626] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:10:57.626] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:10:57.626] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:10:57.626] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:10:57.626] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:10:57.626] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:10:57.626] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:10:57.627] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:10:57.627] [INFO] [LaunchDaemonInstaller.swift:669 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Kanata service state: Uninstalled
[2025-11-22 13:10:57.627] [INFO] [LaunchDaemonInstaller.swift:696 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Service not installed (state: Uninstalled)
[2025-11-22 13:10:57.627] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:10:57.695] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:10:57.762] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhiddaemon loaded: false
[2025-11-22 13:10:57.829] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhidmanager loaded: false
[2025-11-22 13:10:57.829] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:10:57.898] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:10:57.898] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhidmanager
[2025-11-22 13:10:57.908] [INFO] [HelperManager.swift:248 getHelperVersion()] âš ï¸ [HelperManager] getVersion timed out - clearing connection cache
[2025-11-22 13:10:57.908] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:10:57.972] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhidmanager not found in system domain
[2025-11-22 13:10:57.972] [INFO] [SystemValidator.swift:393 checkComponents()] ğŸ” [SystemValidator] Components: kanata=false, driver=true, daemon=false, vhid=false, vhidVersionMismatch=false
[2025-11-22 13:10:57.972] [INFO] [SystemValidator.swift:220 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 3 (Components) completed in 1.057s
[2025-11-22 13:10:57.972] [INFO] [SystemValidator.swift:411 checkConflicts()] ğŸ” [SystemValidator] Checking for conflicts
[2025-11-22 13:10:57.972] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 20% (1/5 steps)
[2025-11-22 13:10:57.972] [INFO] [ProcessLifecycleManager.swift:117 detectConflicts()] ğŸ” [ProcessLifecycleManager] Detecting conflicts...
[2025-11-22 13:10:57.972] [INFO] [ProcessLifecycleManager.swift:121 detectConflicts()] ğŸ§ª [TestEnvironment] Skipping process conflict detection - returning clean state
[2025-11-22 13:10:57.972] [INFO] [SystemValidator.swift:436 checkConflicts()] ğŸ” [SystemValidator] Total conflicts: 0 (0 kanata, 0 karabiner)
[2025-11-22 13:10:57.972] [INFO] [SystemValidator.swift:477 checkHealth()] ğŸ” [SystemValidator] Checking system health
[2025-11-22 13:10:57.972] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:10:57.972] [INFO] [SystemValidator.swift:229 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 4 (Conflicts) completed in 1.057s
[2025-11-22 13:10:57.972] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 40% (2/5 steps)
[2025-11-22 13:10:58.039] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:10:58.039] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:10:58.105] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:10:58.174] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.068s)
[2025-11-22 13:10:58.174] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:10:58.748] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.069s)
[2025-11-22 13:10:58.748] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:10:58.748] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:10:58.748] [INFO] [SystemValidator.swift:487 checkHealth()] ğŸ” [SystemValidator] Health: kanata=false, daemon=false (launchctl), vhid=false
[2025-11-22 13:10:58.748] [INFO] [SystemValidator.swift:312 checkHelper()] ğŸ” [SystemValidator] Checking privileged helper
[2025-11-22 13:10:58.748] [INFO] [SystemValidator.swift:238 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 5 (Health) completed in 1.833s
[2025-11-22 13:10:58.748] [INFO] [SystemValidator.swift:344 checkPermissions()] ğŸ” [SystemValidator] Checking permissions via Oracle
[2025-11-22 13:10:58.748] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 60% (3/5 steps)
[2025-11-22 13:10:58.748] [INFO] [SystemValidator.swift:365 checkComponents()] ğŸ” [SystemValidator] Checking components
[2025-11-22 13:10:58.748] [INFO] [KanataBinaryDetector.swift:66 detectCurrentStatus()] ğŸ” [KanataBinaryDetector] Starting unified kanata binary detection
[2025-11-22 13:10:58.748] [INFO] [PermissionOracle.swift:173 currentSnapshot()] ğŸ”® [Oracle] Test mode snapshot generated (non-blocking)
[2025-11-22 13:10:58.748] [INFO] [KanataBinaryDetector.swift:81 detectCurrentStatus()] âŒ [KanataBinaryDetector] No kanata binary found
[2025-11-22 13:10:58.748] [INFO] [VHIDDeviceManager.swift:50 detectInstallation()] ğŸ” [VHIDManager] Manager app exists at /Applications/.Karabiner-VirtualHIDDevice-Manager.app/Contents/MacOS/Karabiner-VirtualHIDDevice-Manager: true
[2025-11-22 13:10:58.755] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:10:58.761] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:10:58.777] [INFO] [HelperManager.swift:830 verifyEmbeddedHelperSignature()] ğŸ”’ [HelperManager] Embedded helper signature looks valid
[2025-11-22 13:10:58.777] [INFO] [HelperManager.swift:105 getConnection()] ğŸ”— [HelperManager] Creating XPC connection to com.keypath.helper
[2025-11-22 13:10:58.777] [INFO] [HelperManager.swift:129 getConnection()] âœ… [HelperManager] XPC connection established (PID: 0)
[2025-11-22 13:10:58.777] [INFO] [HelperManager.swift:228 getHelperVersion()] ğŸ“¤ [HelperManager] Calling proxy.getVersion()
[2025-11-22 13:10:58.777] [INFO] [HelperManager.swift:243 getHelperVersion()] ğŸ“¤ [HelperManager] proxy.getVersion() call dispatched, waiting for callback
[2025-11-22 13:10:58.778] [INFO] [HelperManager.swift:121 getConnection()] âš ï¸ [HelperManager] XPC connection interrupted - will reconnect
[2025-11-22 13:10:58.778] [INFO] [HelperManager.swift:578 getRemoteProxy(errorHandler:)] âŒ [HelperManager] XPC proxy error: Couldnâ€™t communicate with a helper application.
[2025-11-22 13:10:58.778] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:10:58.778] [INFO] [HelperManager.swift:584 getRemoteProxy(errorHandler:)] âš ï¸ [HelperManager] XPC connection interrupted - this may indicate:
[2025-11-22 13:10:58.778] [INFO] [HelperManager.swift:585 getRemoteProxy(errorHandler:)]    1. Helper signature validation failed (app updated but not restarted)
[2025-11-22 13:10:58.778] [INFO] [HelperManager.swift:587 getRemoteProxy(errorHandler:)]    2. Helper process crashed
[2025-11-22 13:10:58.778] [INFO] [HelperManager.swift:588 getRemoteProxy(errorHandler:)]    3. Helper was killed by the system
[2025-11-22 13:10:58.778] [INFO] [HelperManager.swift:589 getRemoteProxy(errorHandler:)] ğŸ’¡ If you just updated KeyPath, try restarting the app
[2025-11-22 13:10:58.778] [INFO] [HelperManager.swift:116 getConnection()] âŒ [HelperManager] XPC connection invalidated
[2025-11-22 13:10:58.778] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:10:58.816] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.067s)
[2025-11-22 13:10:58.816] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:10:59.390] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.068s)
[2025-11-22 13:10:59.390] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:10:59.390] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:10:59.390] [INFO] [VHIDDeviceManager.swift:343 getInstalledVersion()] ğŸ” [VHIDManager] Installed daemon version: 5.0.0
[2025-11-22 13:10:59.390] [INFO] [VHIDDeviceManager.swift:374 hasVersionMismatch()] âœ… [VHIDManager] Version compatible: v5.0.0
[2025-11-22 13:10:59.390] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:10:59.458] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:10:59.459] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:10:59.459] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:10:59.459] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:10:59.459] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:10:59.460] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:10:59.460] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:10:59.460] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:10:59.460] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:10:59.460] [INFO] [LaunchDaemonInstaller.swift:669 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Kanata service state: Uninstalled
[2025-11-22 13:10:59.460] [INFO] [LaunchDaemonInstaller.swift:696 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Service not installed (state: Uninstalled)
[2025-11-22 13:10:59.460] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:10:59.528] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:10:59.596] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhiddaemon loaded: false
[2025-11-22 13:10:59.663] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhidmanager loaded: false
[2025-11-22 13:10:59.663] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:10:59.731] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:10:59.731] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhidmanager
[2025-11-22 13:10:59.799] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhidmanager not found in system domain
[2025-11-22 13:10:59.799] [INFO] [SystemValidator.swift:393 checkComponents()] ğŸ” [SystemValidator] Components: kanata=false, driver=true, daemon=false, vhid=false, vhidVersionMismatch=false
[2025-11-22 13:10:59.799] [INFO] [SystemValidator.swift:411 checkConflicts()] ğŸ” [SystemValidator] Checking for conflicts
[2025-11-22 13:10:59.799] [INFO] [SystemValidator.swift:220 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 3 (Components) completed in 2.884s
[2025-11-22 13:10:59.799] [INFO] [ProcessLifecycleManager.swift:117 detectConflicts()] ğŸ” [ProcessLifecycleManager] Detecting conflicts...
[2025-11-22 13:10:59.799] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 20% (1/5 steps)
[2025-11-22 13:10:59.799] [INFO] [ProcessLifecycleManager.swift:121 detectConflicts()] ğŸ§ª [TestEnvironment] Skipping process conflict detection - returning clean state
[2025-11-22 13:10:59.799] [INFO] [SystemValidator.swift:436 checkConflicts()] ğŸ” [SystemValidator] Total conflicts: 0 (0 kanata, 0 karabiner)
[2025-11-22 13:10:59.799] [INFO] [SystemValidator.swift:477 checkHealth()] ğŸ” [SystemValidator] Checking system health
[2025-11-22 13:10:59.799] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:10:59.799] [INFO] [SystemValidator.swift:229 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 4 (Conflicts) completed in 2.884s
[2025-11-22 13:10:59.799] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 40% (2/5 steps)
[2025-11-22 13:10:59.867] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:10:59.867] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:10:59.935] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:10:59.992] [INFO] [HelperManager.swift:248 getHelperVersion()] âš ï¸ [HelperManager] getVersion timed out - clearing connection cache
[2025-11-22 13:10:59.992] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:11:00.003] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.068s)
[2025-11-22 13:11:00.003] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:11:00.577] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.068s)
[2025-11-22 13:11:00.577] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:11:00.577] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:11:00.577] [INFO] [SystemValidator.swift:487 checkHealth()] ğŸ” [SystemValidator] Health: kanata=false, daemon=false (launchctl), vhid=false
[2025-11-22 13:11:00.577] [INFO] [SystemValidator.swift:238 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 5 (Health) completed in 3.662s
[2025-11-22 13:11:00.577] [INFO] [SystemValidator.swift:312 checkHelper()] ğŸ” [SystemValidator] Checking privileged helper
[2025-11-22 13:11:00.577] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 60% (3/5 steps)
[2025-11-22 13:11:00.577] [INFO] [SystemValidator.swift:344 checkPermissions()] ğŸ” [SystemValidator] Checking permissions via Oracle
[2025-11-22 13:11:00.577] [INFO] [SystemValidator.swift:365 checkComponents()] ğŸ” [SystemValidator] Checking components
[2025-11-22 13:11:00.577] [INFO] [KanataBinaryDetector.swift:66 detectCurrentStatus()] ğŸ” [KanataBinaryDetector] Starting unified kanata binary detection
[2025-11-22 13:11:00.577] [INFO] [PermissionOracle.swift:173 currentSnapshot()] ğŸ”® [Oracle] Test mode snapshot generated (non-blocking)
[2025-11-22 13:11:00.578] [INFO] [KanataBinaryDetector.swift:81 detectCurrentStatus()] âŒ [KanataBinaryDetector] No kanata binary found
[2025-11-22 13:11:00.578] [INFO] [VHIDDeviceManager.swift:50 detectInstallation()] ğŸ” [VHIDManager] Manager app exists at /Applications/.Karabiner-VirtualHIDDevice-Manager.app/Contents/MacOS/Karabiner-VirtualHIDDevice-Manager: true
[2025-11-22 13:11:00.585] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:11:00.592] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:11:00.610] [INFO] [HelperManager.swift:830 verifyEmbeddedHelperSignature()] ğŸ”’ [HelperManager] Embedded helper signature looks valid
[2025-11-22 13:11:00.610] [INFO] [HelperManager.swift:105 getConnection()] ğŸ”— [HelperManager] Creating XPC connection to com.keypath.helper
[2025-11-22 13:11:00.610] [INFO] [HelperManager.swift:129 getConnection()] âœ… [HelperManager] XPC connection established (PID: 0)
[2025-11-22 13:11:00.610] [INFO] [HelperManager.swift:228 getHelperVersion()] ğŸ“¤ [HelperManager] Calling proxy.getVersion()
[2025-11-22 13:11:00.610] [INFO] [HelperManager.swift:243 getHelperVersion()] ğŸ“¤ [HelperManager] proxy.getVersion() call dispatched, waiting for callback
[2025-11-22 13:11:00.611] [INFO] [HelperManager.swift:121 getConnection()] âš ï¸ [HelperManager] XPC connection interrupted - will reconnect
[2025-11-22 13:11:00.611] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:11:00.611] [INFO] [HelperManager.swift:578 getRemoteProxy(errorHandler:)] âŒ [HelperManager] XPC proxy error: Couldnâ€™t communicate with a helper application.
[2025-11-22 13:11:00.611] [INFO] [HelperManager.swift:584 getRemoteProxy(errorHandler:)] âš ï¸ [HelperManager] XPC connection interrupted - this may indicate:
[2025-11-22 13:11:00.611] [INFO] [HelperManager.swift:585 getRemoteProxy(errorHandler:)]    1. Helper signature validation failed (app updated but not restarted)
[2025-11-22 13:11:00.611] [INFO] [HelperManager.swift:587 getRemoteProxy(errorHandler:)]    2. Helper process crashed
[2025-11-22 13:11:00.611] [INFO] [HelperManager.swift:588 getRemoteProxy(errorHandler:)]    3. Helper was killed by the system
[2025-11-22 13:11:00.611] [INFO] [HelperManager.swift:589 getRemoteProxy(errorHandler:)] ğŸ’¡ If you just updated KeyPath, try restarting the app
[2025-11-22 13:11:00.611] [INFO] [HelperManager.swift:116 getConnection()] âŒ [HelperManager] XPC connection invalidated
[2025-11-22 13:11:00.611] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:11:00.644] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.066s)
[2025-11-22 13:11:00.644] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:11:01.217] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.069s)
[2025-11-22 13:11:01.217] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:11:01.217] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:11:01.217] [INFO] [VHIDDeviceManager.swift:343 getInstalledVersion()] ğŸ” [VHIDManager] Installed daemon version: 5.0.0
[2025-11-22 13:11:01.217] [INFO] [VHIDDeviceManager.swift:374 hasVersionMismatch()] âœ… [VHIDManager] Version compatible: v5.0.0
[2025-11-22 13:11:01.217] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:11:01.284] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:11:01.285] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:11:01.285] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:11:01.285] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:11:01.285] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:11:01.285] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:11:01.285] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:11:01.285] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:11:01.285] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:11:01.285] [INFO] [LaunchDaemonInstaller.swift:669 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Kanata service state: Uninstalled
[2025-11-22 13:11:01.285] [INFO] [LaunchDaemonInstaller.swift:696 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Service not installed (state: Uninstalled)
[2025-11-22 13:11:01.285] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:11:01.354] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:11:01.422] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhiddaemon loaded: false
[2025-11-22 13:11:01.489] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhidmanager loaded: false
[2025-11-22 13:11:01.489] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:11:01.557] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:11:01.557] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhidmanager
[2025-11-22 13:11:01.625] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhidmanager not found in system domain
[2025-11-22 13:11:01.626] [INFO] [SystemValidator.swift:393 checkComponents()] ğŸ” [SystemValidator] Components: kanata=false, driver=true, daemon=false, vhid=false, vhidVersionMismatch=false
[2025-11-22 13:11:01.626] [INFO] [SystemValidator.swift:411 checkConflicts()] ğŸ” [SystemValidator] Checking for conflicts
[2025-11-22 13:11:01.626] [INFO] [ProcessLifecycleManager.swift:117 detectConflicts()] ğŸ” [ProcessLifecycleManager] Detecting conflicts...
[2025-11-22 13:11:01.626] [INFO] [ProcessLifecycleManager.swift:121 detectConflicts()] ğŸ§ª [TestEnvironment] Skipping process conflict detection - returning clean state
[2025-11-22 13:11:01.626] [INFO] [SystemValidator.swift:220 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 3 (Components) completed in 4.711s
[2025-11-22 13:11:01.626] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 20% (1/5 steps)
[2025-11-22 13:11:01.626] [INFO] [SystemValidator.swift:436 checkConflicts()] ğŸ” [SystemValidator] Total conflicts: 0 (0 kanata, 0 karabiner)
[2025-11-22 13:11:01.626] [INFO] [SystemValidator.swift:477 checkHealth()] ğŸ” [SystemValidator] Checking system health
[2025-11-22 13:11:01.626] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:11:01.626] [INFO] [SystemValidator.swift:229 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 4 (Conflicts) completed in 4.711s
[2025-11-22 13:11:01.626] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 40% (2/5 steps)
[2025-11-22 13:11:01.693] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:11:01.693] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:11:01.760] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:11:01.808] [INFO] [HelperManager.swift:248 getHelperVersion()] âš ï¸ [HelperManager] getVersion timed out - clearing connection cache
[2025-11-22 13:11:01.808] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:11:01.828] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.067s)
[2025-11-22 13:11:01.828] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:11:02.402] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.068s)
[2025-11-22 13:11:02.402] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:11:02.402] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:11:02.402] [INFO] [SystemValidator.swift:487 checkHealth()] ğŸ” [SystemValidator] Health: kanata=false, daemon=false (launchctl), vhid=false
[2025-11-22 13:11:02.402] [INFO] [SystemValidator.swift:312 checkHelper()] ğŸ” [SystemValidator] Checking privileged helper
[2025-11-22 13:11:02.402] [INFO] [SystemValidator.swift:238 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 5 (Health) completed in 5.487s
[2025-11-22 13:11:02.402] [INFO] [SystemValidator.swift:344 checkPermissions()] ğŸ” [SystemValidator] Checking permissions via Oracle
[2025-11-22 13:11:02.402] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 60% (3/5 steps)
[2025-11-22 13:11:02.402] [INFO] [SystemValidator.swift:365 checkComponents()] ğŸ” [SystemValidator] Checking components
[2025-11-22 13:11:02.402] [INFO] [KanataBinaryDetector.swift:66 detectCurrentStatus()] ğŸ” [KanataBinaryDetector] Starting unified kanata binary detection
[2025-11-22 13:11:02.402] [INFO] [PermissionOracle.swift:173 currentSnapshot()] ğŸ”® [Oracle] Test mode snapshot generated (non-blocking)
[2025-11-22 13:11:02.402] [INFO] [KanataBinaryDetector.swift:81 detectCurrentStatus()] âŒ [KanataBinaryDetector] No kanata binary found
[2025-11-22 13:11:02.402] [INFO] [VHIDDeviceManager.swift:50 detectInstallation()] ğŸ” [VHIDManager] Manager app exists at /Applications/.Karabiner-VirtualHIDDevice-Manager.app/Contents/MacOS/Karabiner-VirtualHIDDevice-Manager: true
[2025-11-22 13:11:02.432] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:11:02.470] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.068s)
[2025-11-22 13:11:02.470] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:11:02.478] [INFO] [HelperManager.swift:194 isHelperInstalled()] â„¹ï¸ [HelperManager] launchctl reports helper present while SMAppService status=SMAppServiceStatus(rawValue: 3)
[2025-11-22 13:11:02.493] [INFO] [HelperManager.swift:830 verifyEmbeddedHelperSignature()] ğŸ”’ [HelperManager] Embedded helper signature looks valid
[2025-11-22 13:11:02.493] [INFO] [HelperManager.swift:105 getConnection()] ğŸ”— [HelperManager] Creating XPC connection to com.keypath.helper
[2025-11-22 13:11:02.494] [INFO] [HelperManager.swift:129 getConnection()] âœ… [HelperManager] XPC connection established (PID: 0)
[2025-11-22 13:11:02.494] [INFO] [HelperManager.swift:228 getHelperVersion()] ğŸ“¤ [HelperManager] Calling proxy.getVersion()
[2025-11-22 13:11:02.494] [INFO] [HelperManager.swift:243 getHelperVersion()] ğŸ“¤ [HelperManager] proxy.getVersion() call dispatched, waiting for callback
[2025-11-22 13:11:02.494] [INFO] [HelperManager.swift:121 getConnection()] âš ï¸ [HelperManager] XPC connection interrupted - will reconnect
[2025-11-22 13:11:02.494] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:11:02.494] [INFO] [HelperManager.swift:578 getRemoteProxy(errorHandler:)] âŒ [HelperManager] XPC proxy error: Couldnâ€™t communicate with a helper application.
[2025-11-22 13:11:02.494] [INFO] [HelperManager.swift:584 getRemoteProxy(errorHandler:)] âš ï¸ [HelperManager] XPC connection interrupted - this may indicate:
[2025-11-22 13:11:02.494] [INFO] [HelperManager.swift:585 getRemoteProxy(errorHandler:)]    1. Helper signature validation failed (app updated but not restarted)
[2025-11-22 13:11:02.494] [INFO] [HelperManager.swift:587 getRemoteProxy(errorHandler:)]    2. Helper process crashed
[2025-11-22 13:11:02.494] [INFO] [HelperManager.swift:588 getRemoteProxy(errorHandler:)]    3. Helper was killed by the system
[2025-11-22 13:11:02.494] [INFO] [HelperManager.swift:589 getRemoteProxy(errorHandler:)] ğŸ’¡ If you just updated KeyPath, try restarting the app
[2025-11-22 13:11:02.495] [INFO] [HelperManager.swift:116 getConnection()] âŒ [HelperManager] XPC connection invalidated
[2025-11-22 13:11:02.495] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:11:03.043] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.068s)
[2025-11-22 13:11:03.043] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:11:03.043] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:11:03.043] [INFO] [VHIDDeviceManager.swift:343 getInstalledVersion()] ğŸ” [VHIDManager] Installed daemon version: 5.0.0
[2025-11-22 13:11:03.043] [INFO] [VHIDDeviceManager.swift:374 hasVersionMismatch()] âœ… [VHIDManager] Version compatible: v5.0.0
[2025-11-22 13:11:03.043] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:11:03.110] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:11:03.111] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:11:03.111] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:11:03.111] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:11:03.111] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:11:03.111] [INFO] [KanataDaemonManager.swift:105 determineServiceManagementState()] ğŸ” [KanataDaemonManager] State determination:
[2025-11-22 13:11:03.111] [INFO] [KanataDaemonManager.swift:106 determineServiceManagementState()]   - Legacy plist exists: false
[2025-11-22 13:11:03.111] [INFO] [KanataDaemonManager.swift:107 determineServiceManagementState()]   - SMAppService status: 3 (SMAppServiceStatus(rawValue: 3))
[2025-11-22 13:11:03.111] [INFO] [KanataDaemonManager.swift:133 determineServiceManagementState()] ğŸ§ª [KanataDaemonManager] Test mode - treating missing plist as uninstalled
[2025-11-22 13:11:03.111] [INFO] [LaunchDaemonInstaller.swift:669 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Kanata service state: Uninstalled
[2025-11-22 13:11:03.111] [INFO] [LaunchDaemonInstaller.swift:696 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] Service not installed (state: Uninstalled)
[2025-11-22 13:11:03.111] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:11:03.177] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:11:03.245] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhiddaemon loaded: false
[2025-11-22 13:11:03.313] [INFO] [LaunchDaemonInstaller.swift:721 isServiceLoaded(serviceID:)] ğŸ” [LaunchDaemon] (system) Service com.keypath.karabiner-vhidmanager loaded: false
[2025-11-22 13:11:03.313] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:11:03.380] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:11:03.380] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhidmanager
[2025-11-22 13:11:03.446] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhidmanager not found in system domain
[2025-11-22 13:11:03.446] [INFO] [SystemValidator.swift:393 checkComponents()] ğŸ” [SystemValidator] Components: kanata=false, driver=true, daemon=false, vhid=false, vhidVersionMismatch=false
[2025-11-22 13:11:03.446] [INFO] [SystemValidator.swift:220 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 3 (Components) completed in 6.531s
[2025-11-22 13:11:03.446] [INFO] [SystemValidator.swift:411 checkConflicts()] ğŸ” [SystemValidator] Checking for conflicts
[2025-11-22 13:11:03.446] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 20% (1/5 steps)
[2025-11-22 13:11:03.446] [INFO] [ProcessLifecycleManager.swift:117 detectConflicts()] ğŸ” [ProcessLifecycleManager] Detecting conflicts...
[2025-11-22 13:11:03.446] [INFO] [ProcessLifecycleManager.swift:121 detectConflicts()] ğŸ§ª [TestEnvironment] Skipping process conflict detection - returning clean state
[2025-11-22 13:11:03.446] [INFO] [SystemValidator.swift:436 checkConflicts()] ğŸ” [SystemValidator] Total conflicts: 0 (0 kanata, 0 karabiner)
[2025-11-22 13:11:03.446] [INFO] [SystemValidator.swift:477 checkHealth()] ğŸ” [SystemValidator] Checking system health
[2025-11-22 13:11:03.446] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.kanata
[2025-11-22 13:11:03.446] [INFO] [SystemValidator.swift:229 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 4 (Conflicts) completed in 6.531s
[2025-11-22 13:11:03.446] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 40% (2/5 steps)
[2025-11-22 13:11:03.513] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.kanata not found in system domain
[2025-11-22 13:11:03.513] [INFO] [LaunchDaemonInstaller.swift:735 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] HEALTH CHECK (system/print) for: com.keypath.karabiner-vhiddaemon
[2025-11-22 13:11:03.582] [INFO] [LaunchDaemonInstaller.swift:758 isServiceHealthy(serviceID:)] ğŸ” [LaunchDaemon] com.keypath.karabiner-vhiddaemon not found in system domain
[2025-11-22 13:11:03.634] [INFO] [HelperManager.swift:248 getHelperVersion()] âš ï¸ [HelperManager] getVersion timed out - clearing connection cache
[2025-11-22 13:11:03.634] [INFO] [HelperManager.swift:160 clearConnection()] ğŸ§¹ [HelperManager] Clearing XPC connection cache
[2025-11-22 13:11:03.649] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.067s)
[2025-11-22 13:11:03.649] [INFO] [VHIDDeviceManager.swift:77 detectRunning()] â³ [VHIDManager] Daemon reported not running; retrying shortly to avoid false positives
[2025-11-22 13:11:04.217] [INFO] [VHIDDeviceManager.swift:199 evaluateDaemonProcess()] ğŸ” [VHIDManager] VHIDDevice daemon health: NOT RUNNING (took 0.066s)
[2025-11-22 13:11:04.217] [INFO] [VHIDDeviceManager.swift:314 detectConnectionHealth()] ğŸ” [VHIDManager] detectConnectionHealth() -> isRunning=false
[2025-11-22 13:11:04.217] [INFO] [VHIDDeviceManager.swift:316 detectConnectionHealth()] ğŸ” [VHIDManager] Process health check failed - daemon not running
[2025-11-22 13:11:04.217] [INFO] [SystemValidator.swift:487 checkHealth()] ğŸ” [SystemValidator] Health: kanata=false, daemon=false (launchctl), vhid=false
[2025-11-22 13:11:04.217] [INFO] [SystemValidator.swift:238 performValidationBody(progressCallback:)] â±ï¸ [TIMING] Step 5 (Health) completed in 7.302s
[2025-11-22 13:11:04.217] [INFO] [SystemValidator.swift:161 performValidationBody(progressCallback:)] ğŸ“Š [SystemValidator] Progress: 60% (3/5 steps)
KeyPathAppKit/SystemValidator.swift:351: Assertion failed: Oracle snapshot is 7.3s old - Oracle cache may be broken
